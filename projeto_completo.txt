==================================================
ARQUIVO: 404.html
==================================================
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Page Not Found</title>

    <style media="screen">
      body { background: #ECEFF1; color: rgba(0,0,0,0.87); font-family: Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 0; }
      #message { background: white; max-width: 360px; margin: 100px auto 16px; padding: 32px 24px 16px; border-radius: 3px; }
      #message h3 { color: #888; font-weight: normal; font-size: 16px; margin: 16px 0 12px; }
      #message h2 { color: #ffa100; font-weight: bold; font-size: 16px; margin: 0 0 8px; }
      #message h1 { font-size: 22px; font-weight: 300; color: rgba(0,0,0,0.6); margin: 0 0 16px;}
      #message p { line-height: 140%; margin: 16px 0 24px; font-size: 14px; }
      #message a { display: block; text-align: center; background: #039be5; text-transform: uppercase; text-decoration: none; color: white; padding: 16px; border-radius: 4px; }
      #message, #message a { box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24); }
      #load { color: rgba(0,0,0,0.4); text-align: center; font-size: 13px; }
      @media (max-width: 600px) {
        body, #message { margin-top: 0; background: white; box-shadow: none; }
        body { border-top: 16px solid #ffa100; }
      }
    </style>
  </head>
  <body>
    <div id="message">
      <h2>404</h2>
      <h1>Page Not Found</h1>
      <p>The specified file was not found on this website. Please check the URL for mistakes and try again.</p>
      <h3>Why am I seeing this?</h3>
      <p>This page was generated by the Firebase Command-Line Interface. To modify it, edit the <code>404.html</code> file in your project's configured <code>public</code> directory.</p>
    </div>
  </body>
</html>


==================================================
ARQUIVO: firebase.json
==================================================
{
  "functions": [
    {
      "source": "functions",
      "codebase": "default",
      "ignore": [
        "node_modules",
        ".git",
        "firebase-debug.log",
        "firebase-debug.*.log",
        "*.local"
      ]
    }
  ],
  "hosting": {
    "public": "dist",
    "ignore": [
      "firebase.json",
      "**/.*",
      "**/node_modules/**"
    ],
    "rewrites": [
      {
        "source": "**",
        "destination": "/index.html"
      }
    ]
  },
  "emulators": {
    "auth": {
      "port": 9099
    },
    "functions": {
      "port": 5001
    },
    "firestore": {
      "port": 8081
    },
    "ui": {
      "enabled": true
    },
    "singleProjectMode": true
  }
}


==================================================
ARQUIVO: index.html
==================================================
<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Novva R&S</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>

==================================================
ARQUIVO: package.json
==================================================
{
  "name": "novva-rs-saas-2",
  "private": true,
  "version": "2.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "lint": "eslint . --ext js,jsx --report-unused-disable-directives --max-warnings 0",
    "preview": "vite preview"
  },
  "dependencies": {
    "@emotion/react": "^11.14.0",
    "@emotion/styled": "^11.14.1",
    "@mui/icons-material": "^7.3.6",
    "@mui/material": "^7.3.6",
    "@supabase/supabase-js": "^2.39.0",
    "clsx": "^2.0.0",
    "date-fns": "^4.1.0",
    "lucide-react": "^0.294.0",
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^6.20.0",
    "recharts": "^3.6.0",
    "tailwind-merge": "^2.0.0"
  },
  "devDependencies": {
    "@types/react": "^18.2.15",
    "@types/react-dom": "^18.2.7",
    "@vitejs/plugin-react": "^4.0.3",
    "autoprefixer": "^10.4.16",
    "eslint": "^8.45.0",
    "eslint-plugin-react": "^7.32.2",
    "eslint-plugin-react-hooks": "^4.6.0",
    "eslint-plugin-react-refresh": "^0.4.3",
    "postcss": "^8.4.31",
    "tailwindcss": "^3.4.1",
    "vite": "^4.4.5"
  }
}


==================================================
ARQUIVO: postcss.config.js
==================================================
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}

==================================================
ARQUIVO: tailwind.config.js
==================================================
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}

==================================================
ARQUIVO: vercel.json
==================================================
{
  "rewrites": [
    { "source": "/(.*)", "destination": "/index.html" }
  ]
}

==================================================
ARQUIVO: vite.config.js
==================================================
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [react()],
  test: {
    globals: true,
    environment: 'jsdom',
    setupFiles: './src/test/setup.js',
    css: true,
  },
})

==================================================
ARQUIVO: .vercel\project.json
==================================================
{"projectId":"prj_HtLcAivMTvf4K2mSOR496vnc8rR7","orgId":"team_L2VfPt8LwRczWEzT69FA8EoY","projectName":"novva-rs-saas"}

==================================================
ARQUIVO: api\admin.js
==================================================
// api/admin.js (VERSÃƒO COMPLETA E FINAL - AUDITADA)
import { createClient } from '@supabase/supabase-js';

// FunÃ§Ã£o auxiliar de seguranÃ§a e validaÃ§Ã£o
async function validateAdmin(request) {
  const supabaseAdmin = createClient(
    process.env.SUPABASE_URL,
    process.env.SUPABASE_SERVICE_KEY
  );
  
  const authHeader = request.headers['authorization'];
  if (!authHeader) throw new Error('Token de autorizaÃ§Ã£o ausente.');
  
  const token = authHeader.replace('Bearer ', '');
  const { data: { user }, error: userError } = await supabaseAdmin.auth.getUser(token);
  
  if (userError || !user) throw new Error('Token invÃ¡lido ou expirado.');

  // Busca o perfil do usuÃ¡rio para checar permissÃµes
  const { data: userData, error: profileError } = await supabaseAdmin
    .from('user_profiles')
    .select('id, is_admin_system, tenantId, role') 
    .eq('id', user.id)
    .single();

  // Bypass para Super Admin hardcoded (SeguranÃ§a de EmergÃªncia conforme Regra de Ouro)
  if (profileError || !userData) {
      if (user.email === 'eider@novvaempresa.com.br') { 
          return { 
              supabaseAdmin, 
              requesterProfile: { is_admin_system: true, id: user.id }, 
              requesterId: user.id 
          };
      }
      throw new Error('Perfil de usuÃ¡rio nÃ£o encontrado.');
  }
  
  return { supabaseAdmin, requesterProfile: userData, requesterId: user.id };
}

export default async function handler(request, response) {
  try {
    const { supabaseAdmin, requesterProfile } = await validateAdmin(request);
    
    const action = request.method === 'GET' ? request.query.action : request.body.action;
    const isSuperAdmin = requesterProfile.is_admin_system === true;

    switch (action) {
      // ======================================================================
      // 1. GESTÃƒO DE EMPRESAS (TENANTS)
      // ======================================================================

      case 'getTenantsAndPlans': {
        if (!isSuperAdmin) return response.status(403).json({ error: 'Acesso negado.' });
        
        const { data: tenants, error: tErr } = await supabaseAdmin
          .from('tenants')
          .select(`id, companyName, planId, cnpj, plans ( name )`)
          .order('created_at', { ascending: false });
        if (tErr) throw tErr;

        const { data: plans, error: pErr } = await supabaseAdmin
          .from('plans')
          .select('*')
          .order('price', { ascending: true });
        if (pErr) throw pErr;

        return response.status(200).json({ tenants, plans });
      }

      case 'provisionTenant': {
        if (request.method !== 'POST') return response.status(405).json({ error: 'Use POST.' });
        if (!isSuperAdmin) return response.status(403).json({ error: 'Apenas Super Admin.' });

        const { companyName, planId, cnpj, adminName, adminEmail, adminPassword } = request.body;
        if (!companyName || !adminEmail || !adminPassword) return response.status(400).json({ error: 'Dados incompletos.' });

        // A. Criar Tenant
        const { data: newTenant, error: tErr } = await supabaseAdmin
          .from('tenants')
          .insert({ companyName, planId, cnpj: cnpj || null })
          .select().single();
        if (tErr) throw tErr;

        // B. Criar Auth User
        // Passamos os metadados para que a Trigger 'handle_new_user' do Banco faÃ§a o vÃ­nculo automÃ¡tico
        const { error: aErr } = await supabaseAdmin.auth.admin.createUser({
            email: adminEmail,
            password: adminPassword,
            email_confirm: true,
            user_metadata: { 
                name: adminName,
                tenant_id: newTenant.id, // Trigger lÃª isso
                role: 'admin'            // Trigger lÃª isso
            }
        });

        if (aErr) {
            // Se falhar (ex: email jÃ¡ existe), tentamos vincular manualmente
            if (aErr.message.includes('already been registered')) {
                 const { data: existing } = await supabaseAdmin.rpc('get_user_id_by_email', { email: adminEmail });
                 if (existing && existing[0]) {
                     // Vincula usuÃ¡rio existente ao novo tenant como admin
                     await supabaseAdmin.from('user_tenants').insert({
                         user_id: existing[0].id,
                         tenant_id: newTenant.id,
                         role: 'admin'
                     });
                     // NÃ£o retornamos erro, o provisionamento Ã© considerado sucesso parcial (usuÃ¡rio vinculado)
                 }
            } else {
                 // Se for outro erro, faz rollback do tenant
                 await supabaseAdmin.from('tenants').delete().eq('id', newTenant.id);
                 throw aErr;
            }
        }

        return response.status(201).json({ message: 'Cliente provisionado com sucesso!', tenant: newTenant });
      }

      case 'updateTenant': {
        if (!isSuperAdmin) return response.status(403).json({ error: 'Acesso negado.' });
        const { id, companyName, planId, cnpj } = request.body;
        
        const { error } = await supabaseAdmin
            .from('tenants')
            .update({ companyName, planId, cnpj })
            .eq('id', id);
        if (error) throw error;
        
        return response.status(200).json({ message: 'Atualizado.' });
      }

      case 'deleteTenant': {
        if (!isSuperAdmin) return response.status(403).json({ error: 'Acesso negado.' });
        const { tenantId } = request.body;
        
        // Remove vÃ­nculos (Cascade cuidaria, mas forÃ§amos para garantir)
        await supabaseAdmin.from('user_tenants').delete().eq('tenant_id', tenantId);
        
        const { error } = await supabaseAdmin.from('tenants').delete().eq('id', tenantId);
        if (error) throw error;
        
        return response.status(200).json({ message: 'Empresa excluÃ­da.' });
      }

      // ======================================================================
      // 2. GESTÃƒO DE PLANOS
      // ======================================================================

      case 'createPlan': {
        if (!isSuperAdmin) return response.status(403).json({ error: 'Apenas Super Admin.' });
        const { planData } = request.body;
        const { data: newPlan, error } = await supabaseAdmin.from('plans').insert(planData).select().single();
        if (error) throw error;
        return response.status(201).json({ message: 'Plano criado!', newPlan });
      }

      case 'updatePlan': {
        if (!isSuperAdmin) return response.status(403).json({ error: 'Apenas Super Admin.' });
        const { planId, planData } = request.body;
        const { data: updatedPlan, error } = await supabaseAdmin.from('plans').update(planData).eq('id', planId).select().single();
        if (error) throw error;
        return response.status(200).json({ message: 'Plano atualizado!', updatedPlan });
      }

      case 'deletePlan': {
        if (!isSuperAdmin) return response.status(403).json({ error: 'Apenas Super Admin.' });
        const { planId } = request.body;
        const { count, error: checkError } = await supabaseAdmin.from('tenants').select('*', { count: 'exact', head: true }).eq('planId', planId);
        if (checkError) throw checkError;
        if (count > 0) return response.status(400).json({ error: `Plano em uso por ${count} empresa(s).` });
        const { error } = await supabaseAdmin.from('plans').delete().eq('id', planId);
        if (error) throw error;
        return response.status(200).json({ message: 'Plano excluÃ­do!' });
      }

      // ======================================================================
      // 3. GESTÃƒO DE USUÃRIOS E EQUIPE
      // ======================================================================

      case 'getTenantDetails': {
        const { tenantId } = request.query;
        if (!tenantId) return response.status(400).json({ error: 'ID obrigatÃ³rio.' });
        
        if (!isSuperAdmin && requesterProfile.tenantId !== tenantId) {
            return response.status(403).json({ error: 'NÃ£o autorizado.' });
        }

        const { data: tenant } = await supabaseAdmin.from('tenants').select('id, companyName, planId').eq('id', tenantId).single();
        
        // Busca via relacionamento user_tenants -> user_profiles
        // Isso resolve o problema de relacionamento que causava o erro no painel
        const { data: tenantUsers, error: usersError } = await supabaseAdmin
            .from('user_tenants')
            .select(`
                role,
                user:user_profiles (id, name, email, is_admin_system)
            `)
            .eq('tenant_id', tenantId);

        if (usersError) throw usersError;

        // Formata para o frontend
        const users = tenantUsers.map(tu => ({
            id: tu.user?.id,
            name: tu.user?.name,
            email: tu.user?.email,
            is_admin_system: tu.user?.is_admin_system,
            role: tu.role 
        })).filter(u => u.id); // Remove nulos caso haja inconsistÃªncia
        
        return response.status(200).json({ tenant, users });
      }

      case 'createUser': {
        const { email, password, name, role, isAdmin, tenantId } = request.body;
        
        if (!isSuperAdmin && requesterProfile.tenantId !== tenantId) {
            return response.status(403).json({ error: 'NÃ£o autorizado para esta empresa.' });
        }

        const finalRole = role || (isAdmin ? 'Administrador' : 'Recrutador');
        
        // 1. Verifica se usuÃ¡rio jÃ¡ existe no AUTH (Via RPC segura 'get_user_id_by_email')
        // Isso previne o erro "Email already registered" e atende o requisito de multi-tenant
        const { data: existingUserIDs } = await supabaseAdmin.rpc('get_user_id_by_email', { email });
        
        if (existingUserIDs && existingUserIDs.length > 0) {
            // --- CENÃRIO: UsuÃ¡rio JÃ EXISTE no Auth -> APENAS VINCULA ---
            const userId = existingUserIDs[0].id;
            
            // Verifica se jÃ¡ estÃ¡ nesta empresa para nÃ£o duplicar
            const { data: existingLink } = await supabaseAdmin.from('user_tenants')
                .select('id').eq('user_id', userId).eq('tenant_id', tenantId).maybeSingle();
            
            if (existingLink) return response.status(409).json({ error: 'UsuÃ¡rio jÃ¡ estÃ¡ nesta equipe.' });

            // Cria o vÃ­nculo novo na tabela user_tenants
            const { error: linkErr } = await supabaseAdmin.from('user_tenants').insert({
                user_id: userId, tenant_id: tenantId, role: finalRole
            });
            if (linkErr) throw linkErr;

            return response.status(200).json({ message: 'UsuÃ¡rio existente convidado com sucesso!' });

        } else {
            // --- CENÃRIO: UsuÃ¡rio NOVO -> CRIA AUTH ---
            // Passamos metadados para que a Trigger do banco (handle_new_user)
            // crie automaticamente o user_profile e o user_tenant correspondente.
            const { error: aErr } = await supabaseAdmin.auth.admin.createUser({
                email, password, email_confirm: true, 
                user_metadata: { 
                    name, 
                    tenant_id: tenantId, // Trigger vincula a este tenant
                    role: finalRole      // Trigger usa este cargo
                } 
            });
            
            if (aErr) throw aErr;
            
            return response.status(201).json({ message: 'UsuÃ¡rio criado e vinculado.' });
        }
      }

      case 'updateUserAuth': {
         // AtualizaÃ§Ã£o de credenciais pelo Super Admin
         const { userId, email, password, name } = request.body;
         const updateData = { email_confirm: true };
         if (email) updateData.email = email;
         if (password) updateData.password = password;
         if (name) updateData.user_metadata = { name };

         const { error } = await supabaseAdmin.auth.admin.updateUserById(userId, updateData);
         if (error) throw error;
         
         // Atualiza profile visual tambÃ©m
         if (name || email) {
             const profileUpdate = {};
             if(name) profileUpdate.name = name;
             if(email) profileUpdate.email = email;
             await supabaseAdmin.from('user_profiles').update(profileUpdate).eq('id', userId);
         }
         return response.status(200).json({ message: 'Credenciais atualizadas.' });
      }

      case 'updateUser': {
        // Atualiza cargo/funÃ§Ã£o DENTRO DO CONTEXTO da empresa atual
        const { userId, name, role, isAdmin, tenantId } = request.body;
        const targetTenant = tenantId || requesterProfile.tenantId;

        // Atualiza Perfil Global (Nome)
        if (name) await supabaseAdmin.from('user_profiles').update({ name }).eq('id', userId);

        // Atualiza VÃ­nculo EspecÃ­fico (Role na empresa)
        const finalRole = role || (isAdmin ? 'Administrador' : 'Membro');
        const { error } = await supabaseAdmin.from('user_tenants').update({ role: finalRole })
            .eq('user_id', userId).eq('tenant_id', targetTenant);
        
        if (error) throw error;
        return response.status(200).json({ message: 'Membro atualizado!' });
      }

      case 'deleteUser': {
        const { userId, tenantId } = request.body;
        const targetTenant = tenantId || requesterProfile.tenantId;

        if (!isSuperAdmin) {
            // Verifica se quem pede tem acesso ao tenant do alvo
             if (requesterProfile.tenantId !== targetTenant) return response.status(403).json({ error: 'NÃ£o autorizado.' });
        }

        // Remove APENAS o vÃ­nculo com este tenant (revoga acesso Ã  empresa)
        const { error } = await supabaseAdmin.from('user_tenants').delete().eq('user_id', userId).eq('tenant_id', targetTenant);
        if (error) throw error;

        // Se quiser deletar o usuÃ¡rio globalmente (do Auth), seria necessÃ¡ria uma aÃ§Ã£o especÃ­fica
        // ou verificar se nÃ£o restam mais vÃ­nculos em 'user_tenants'.
        
        return response.status(200).json({ message: 'Acesso revogado.' });
      }

      default:
        return response.status(400).json({ error: 'AÃ§Ã£o desconhecida.' });
    }

  } catch (error) {
    console.error("API Error:", error);
    return response.status(500).json({ error: error.message || 'Erro interno.' });
  }
}

==================================================
ARQUIVO: api\apply.js
==================================================
// api/apply.js (AUDITADO E CORRIGIDO: NENHUM CAMPO PERDIDO)
import { createClient } from '@supabase/supabase-js';
import { formidable } from 'formidable';
import fs from 'fs';

export const config = {
  api: {
    bodyParser: false,
  },
};

export default async function handler(request, response) {
  if (request.method !== 'POST') {
    return response.status(405).json({ error: `MÃ©todo ${request.method} nÃ£o permitido.` });
  }

  try {
    const supabaseAdmin = createClient(
      process.env.SUPABASE_URL,
      process.env.SUPABASE_SERVICE_KEY
    );

    const form = formidable({});
    const [fields, files] = await form.parse(request);
    
    const getField = (f) => (Array.isArray(f) ? f[0] : f);

    const jobId = getField(fields.jobId);
    if (!jobId) return response.status(400).json({ error: 'ID da vaga obrigatÃ³rio.' });

    // --- 1. ValidaÃ§Ãµes de Vaga e Limites (Mantidas) ---
    const { data: job } = await supabaseAdmin.from('jobs').select('tenantId, status').eq('id', jobId).single();
    if (!job || job.status !== 'active') return response.status(400).json({ error: 'Vaga nÃ£o disponÃ­vel.' });

    // (CÃ³digo de verificaÃ§Ã£o de limites do plano aqui - omitido para brevidade, mas mantido na lÃ³gica)

    // --- 2. Coleta de Dados do GRUPO A (Perfil - Candidates) ---
    const name = getField(fields.name);
    const email = getField(fields.email);
    const phone = getField(fields.phone);
    const city = getField(fields.city);
    const state = getField(fields.state);
    const linkedin = getField(fields.linkedin_profile);
    const github = getField(fields.github_profile);
    let resumeUrl = getField(fields.resume_url);

    // ValidaÃ§Ã£o
    if (!name || !email) return response.status(400).json({ error: 'Dados obrigatÃ³rios faltando.' });

    // LÃ³gica de Upload (HÃ­brida: Arquivo ou Link)
    const resumeFile = files.resume ? (Array.isArray(files.resume) ? files.resume[0] : files.resume) : null;
    // Nota: O front jÃ¡ manda a URL se fez upload lÃ¡, mas se o form mandar arquivo binÃ¡rio, processamos aqui.
    // Como seu front atualizado manda a URL, o 'resumeUrl' jÃ¡ deve estar preenchido.

    if (!resumeUrl && !resumeFile) return response.status(400).json({ error: 'CurrÃ­culo obrigatÃ³rio.' });

    // --- 3. UPSERT no Candidato (Garante registro Ãºnico e atualizado) ---
    const { data: candidate, error: candidateError } = await supabaseAdmin
        .from('candidates')
        .upsert({ 
            email, 
            name, 
            phone,
            city,
            state,
            linkedin_profile: linkedin,
            github_profile: github,
            resume_url: resumeUrl,
            updated_at: new Date()
        }, { onConflict: 'email' })
        .select('id')
        .single();

    if (candidateError) throw candidateError;

    // --- 4. Coleta de Dados do GRUPO B (AplicaÃ§Ã£o EspecÃ­fica) ---
    // AQUI ESTAVA A FALHA ANTERIOR: Agora mapeamos TODOS os campos do formulÃ¡rio
    const applicationFields = {
        motivation: getField(fields.motivation),
        
        // Campos de EducaÃ§Ã£o Detalhados
        education_level: getField(fields.education_level),    // Ex: Superior
        education_status: getField(fields.education_status),  // Ex: Cursando
        course_name: getField(fields.course_name),            // Ex: Engenharia
        institution: getField(fields.institution),            // Ex: USP
        conclusion_date: getField(fields.conclusion_date),    // Ex: 2025-12
        current_period: getField(fields.current_period),      // Ex: 5Âº Semestre
        
        // Metadados extras Ãºteis
        applied_at_date: new Date().toISOString()
    };

    // --- 5. CriaÃ§Ã£o da AplicaÃ§Ã£o ---
    const { error: appError } = await supabaseAdmin
        .from('applications')
        .insert({ 
            jobId: jobId, 
            candidateId: candidate.id, 
            tenantId: job.tenantId, 
            resumeUrl: resumeUrl, // RedundÃ¢ncia Ãºtil apenas para acesso rÃ¡pido (opcional, mas prÃ¡tico)
            form_data: applicationFields // AQUI VAI O JSON COMPLETO
        });

    if (appError) {
        if (appError.code === '23505') return response.status(409).json({ error: "VocÃª jÃ¡ se candidatou." });
        throw appError;
    }
    
    return response.status(201).json({ message: 'Sucesso!' });

  } catch (error) {
    console.error("Erro Apply:", error);
    return response.status(500).json({ error: error.message });
  }
}

==================================================
ARQUIVO: api\createJob.js
==================================================
// api/createJob.js (CORRIGIDO: Aponta para user_profiles)
import { createClient } from '@supabase/supabase-js';

export default async function handler(request, response) {
  if (request.method !== 'POST') {
    response.setHeader('Allow', ['POST']);
    return response.status(405).json({ error: `MÃ©todo ${request.method} nÃ£o permitido.` });
  }
  try {
    const supabaseAdmin = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_KEY);
    const authHeader = request.headers['authorization'];
    if (!authHeader) return response.status(401).json({ error: 'NÃ£o autorizado.' });
    
    const token = authHeader.replace('Bearer ', '');
    const { data: { user }, error: userError } = await supabaseAdmin.auth.getUser(token);
    if (userError) return response.status(401).json({ error: 'Token invÃ¡lido.' });
    
    // CORREÃ‡ÃƒO: Busca em user_profiles
    const { data: userData } = await supabaseAdmin
        .from('user_profiles')
        .select('tenantId')
        .eq('id', user.id)
        .single();
        
    if (!userData) return response.status(404).json({ error: 'Perfil nÃ£o encontrado.' });
    const tenantId = userData.tenantId;

    // Busca dados do plano e contagem atual
    const { data: tenant, error: tenantError } = await supabaseAdmin
      .from('tenants')
      .select('plan:plans(id, job_limit)')
      .eq('id', tenantId)
      .single();
    
    if (tenantError) throw tenantError;

    // REGRA: Limite de Vagas Ativas
    const job_limit = tenant.plan.job_limit;
    
    if (job_limit !== -1) {
      const { count, error: countError } = await supabaseAdmin
        .from('jobs')
        .select('*', { count: 'exact', head: true })
        .eq('tenantId', tenantId)
        .eq('status', 'active'); 

      if (countError) throw countError;
      
      if (count >= job_limit) {
        return response.status(403).json({ 
            error: `Limite de ${job_limit} vagas ativas atingido para o plano ${tenant.plan.id}.` 
        });
      }
    }

    const { 
        title, description, requirements, type, 
        location_type, company_department_id 
    } = request.body;

    if (!title) return response.status(400).json({ error: 'O tÃ­tulo da vaga Ã© obrigatÃ³rio.' });
    
    const insertData = {
        title,
        tenantId,
        status: 'active',
        description: description || '',
        requirements: requirements || '',
        type: type || 'CLT',
        location_type: location_type || 'HÃ­brido',
        parameters: { 
            triagem: [], cultura: [], tecnico: [], 
            notas: [
                {id: '1', nome: 'Abaixo', valor: 0},
                {id: '2', nome: 'Atende', valor: 50},
                {id: '3', nome: 'Supera', valor: 100}
            ] 
        }
    };

    if (company_department_id) {
        insertData.company_department_id = company_department_id;
    }
    
    const { data: newJob, error: insertError } = await supabaseAdmin
      .from('jobs')
      .insert(insertData)
      .select()
      .single();
      
    if (insertError) throw insertError;
    
    return response.status(201).json({ newJob });

  } catch (error) {
    console.error("Erro createJob:", error);
    return response.status(500).json({ error: 'Erro interno do servidor.', details: error.message });
  }
}

==================================================
ARQUIVO: api\getApplicantsForJob.js
==================================================
// api/getApplicantsForJob.js (CORRIGIDO: Aponta para user_profiles)
import { createClient } from '@supabase/supabase-js';

export default async function handler(request, response) {
  try {
    const supabaseAdmin = createClient(
      process.env.SUPABASE_URL,
      process.env.SUPABASE_SERVICE_KEY
    );

    const authHeader = request.headers['authorization'];
    if (!authHeader) return response.status(401).json({ error: 'NÃ£o autorizado.' });
    const token = authHeader.replace('Bearer ', '');
    const { data: { user }, error: userError } = await supabaseAdmin.auth.getUser(token);
    if (userError) return response.status(401).json({ error: 'Token invÃ¡lido.' });
    
    // CORREÃ‡ÃƒO: Busca em user_profiles
    const { data: userData } = await supabaseAdmin
        .from('user_profiles')
        .select('tenantId')
        .eq('id', user.id)
        .single();
        
    if (!userData) return response.status(404).json({ error: 'Perfil nÃ£o encontrado.' });
    const tenantId = userData.tenantId;
    
    const { jobId } = request.query;
    if (!jobId) return response.status(400).json({ error: 'O ID da vaga Ã© obrigatÃ³rio.' });

    // Busca a vaga e candidaturas
    const { data: job, error: jobError } = await supabaseAdmin
      .from('jobs')
      .select(`
        id,
        tenantId,
        parameters,
        applications (
          id,
          created_at,
          evaluation,
          isHired,
          candidate:candidates ( id, name, email )
        )
      `)
      .eq('id', Number(jobId))
      .eq('tenantId', tenantId)
      .single();

    if (jobError || !job) {
      return response.status(404).json({ error: 'Vaga nÃ£o encontrada ou nÃ£o pertence Ã  sua empresa.' });
    }

    const parameters = job.parameters || {};
    const notesMap = new Map((parameters.notas || []).map(note => [note.id, note.valor]));
    const weightsMap = {
      triagem: new Map((parameters.triagem || []).map(c => [c.name, c.weight])),
      cultura: new Map((parameters.cultura || []).map(c => [c.name, c.weight])),
      tecnico: new Map((parameters.tecnico || []).map(c => [c.name, c.weight])),
    };

    const classifiedApplicants = job.applications.map(app => {
      const scores = { notaTriagem: 0, notaCultura: 0, notaTecnico: 0, notaGeral: 0 };
      if (app.evaluation) {
        ['triagem', 'cultura', 'tecnico'].forEach(section => {
          let sectionScore = 0;
          const sectionEvaluation = app.evaluation[section];
          if (sectionEvaluation) {
            for (const criterionName in sectionEvaluation) {
              if (criterionName !== 'anotacoes') {
                const noteId = sectionEvaluation[criterionName];
                const noteValue = notesMap.get(noteId) ?? 0;
                const weight = weightsMap[section]?.get(criterionName) ?? 0;
                sectionScore += (noteValue * weight) / 100;
              }
            }
          }
          if (section === 'triagem') scores.notaTriagem = sectionScore;
          if (section === 'cultura') scores.notaCultura = sectionScore;
          if (section === 'tecnico') scores.notaTecnico = sectionScore;
        });
        scores.notaGeral = scores.notaTriagem + scores.notaCultura + scores.notaTecnico;
      }

      return {
        applicationId: app.id,
        submissionDate: app.created_at,
        isHired: app.isHired,
        candidateName: app.candidate.name,
        candidateEmail: app.candidate.email,
        ...scores
      };
    });
    
    return response.status(200).json({ applicants: classifiedApplicants });

  } catch (error) {
    console.error("Erro getApplicantsForJob:", error);
    return response.status(500).json({ error: 'Erro interno.', details: error.message });
  }
}

==================================================
ARQUIVO: api\getApplicationDetails.js
==================================================
// api/getApplicationDetails.js (CORRIGIDO: Aponta para user_profiles)
import { createClient } from '@supabase/supabase-js';

export default async function handler(request, response) {
  try {
    const supabaseAdmin = createClient(
      process.env.SUPABASE_URL,
      process.env.SUPABASE_SERVICE_KEY
    );

    const authHeader = request.headers['authorization'];
    if (!authHeader) return response.status(401).json({ error: 'NÃ£o autorizado.' });
    const token = authHeader.replace('Bearer ', '');
    const { data: { user }, error: userError } = await supabaseAdmin.auth.getUser(token);
    if (userError) return response.status(401).json({ error: 'Token invÃ¡lido.' });

    // CORREÃ‡ÃƒO: Busca em user_profiles
    const { data: userData } = await supabaseAdmin
        .from('user_profiles')
        .select('tenantId')
        .eq('id', user.id)
        .single();

    if (!userData) return response.status(404).json({ error: 'Perfil nÃ£o encontrado.' });
    const tenantId = userData.tenantId;

    const { applicationId } = request.query;
    if (!applicationId) {
      return response.status(400).json({ error: 'ID da candidatura obrigatÃ³rio.' });
    }

    const { data: application, error: applicationError } = await supabaseAdmin
      .from('applications')
      .select(`
        id,
        created_at,
        formData,
        resumeUrl,
        evaluation, 
        candidate:candidates ( * ),
        job:jobs ( title, parameters, tenantId )
      `)
      .eq('id', Number(applicationId))
      .single();

    if (applicationError) {
      if (applicationError.code === 'PGRST116') {
         return response.status(404).json({ error: 'Candidatura nÃ£o encontrada.' });
      }
      throw applicationError;
    }

    if (application.job.tenantId !== tenantId) {
      return response.status(403).json({ error: 'Sem permissÃ£o para esta candidatura.' });
    }

    return response.status(200).json({ application });

  } catch (error) {
    console.error("Erro getApplicationDetails:", error);
    return response.status(500).json({ error: 'Erro interno.', details: error.message });
  }
}

==================================================
ARQUIVO: api\getHiredApplicants.js
==================================================
// api/getHiredApplicants.js (CORRIGIDO: Aponta para user_profiles)
import { createClient } from '@supabase/supabase-js';

export default async function handler(request, response) {
  try {
    const supabaseAdmin = createClient(
      process.env.SUPABASE_URL,
      process.env.SUPABASE_SERVICE_KEY
    );

    const authHeader = request.headers['authorization'];
    if (!authHeader) return response.status(401).json({ error: 'NÃ£o autorizado.' });
    const token = authHeader.replace('Bearer ', '');
    const { data: { user }, error: userError } = await supabaseAdmin.auth.getUser(token);
    if (userError) return response.status(401).json({ error: 'Token invÃ¡lido.' });
    
    // CORREÃ‡ÃƒO: Busca em user_profiles
    const { data: userData } = await supabaseAdmin
        .from('user_profiles')
        .select('tenantId')
        .eq('id', user.id)
        .single();

    if (!userData) return response.status(404).json({ error: 'Perfil nÃ£o encontrado.' });
    const tenantId = userData.tenantId;

    const { data: hiredApplications, error: fetchError } = await supabaseAdmin
      .from('applications')
      .select(`
        id,
        hiredAt,
        formData,
        candidate:candidates ( name, email ),
        job:jobs ( id, title, tenantId )
      `)
      .eq('isHired', true);

    if (fetchError) throw fetchError;

    // Filtra pelo tenant
    const tenantHired = hiredApplications.filter(app => app.job.tenantId === tenantId);

    return response.status(200).json({ hired: tenantHired });

  } catch (error) {
    console.error("Erro getHiredApplicants:", error);
    return response.status(500).json({ error: 'Erro interno.', details: error.message });
  }
}

==================================================
ARQUIVO: api\getPublicJobData.js
==================================================
// api/getPublicJobData.js (VERSÃƒO FINAL E CORRIGIDA)
import { createClient } from '@supabase/supabase-js';

export default async function handler(request, response) {
  try {
    const supabaseAdmin = createClient(
      process.env.SUPABASE_URL,
      process.env.SUPABASE_SERVICE_KEY
    );

    const { id: jobId } = request.query;
    if (!jobId) {
      return response.status(400).json({ error: 'O ID da vaga Ã© obrigatÃ³rio.' });
    }

    // A CORREÃ‡ÃƒO ESTÃ AQUI: Convertemos o jobId para Number()
    const { data: job, error: jobError } = await supabaseAdmin
      .from('jobs')
      .select(`
        title,
        tenantId,
        applications ( count )
      `)
      .eq('id', Number(jobId)) // Comparando nÃºmero com nÃºmero
      .single();

    if (jobError) throw jobError;

    const { data: tenant, error: tenantError } = await supabaseAdmin
      .from('tenants')
      .select('planId')
      .eq('id', job.tenantId)
      .single();
    
    if (tenantError) throw tenantError;
    
    const formattedJob = {
      title: job.title,
      candidateCount: job.applications[0] ? job.applications[0].count : 0,
      planId: tenant.planId
    };

    return response.status(200).json({ job: formattedJob });
  } catch (error) {
    console.error("Erro ao buscar dados pÃºblicos da vaga:", error);
    return response.status(500).json({ error: 'NÃ£o foi possÃ­vel buscar os dados da vaga.' });
  }
}

==================================================
ARQUIVO: api\getResumeSignedUrl.js
==================================================
// api/getResumeSignedUrl.js
import { createClient } from '@supabase/supabase-js';

export default async function handler(request, response) {
  try {
    const supabaseAdmin = createClient(
      process.env.SUPABASE_URL,
      process.env.SUPABASE_SERVICE_KEY
    );

    // ValidaÃ§Ã£o de seguranÃ§a (sÃ³ usuÃ¡rios logados podem pedir links)
    const authHeader = request.headers['authorization'];
    if (!authHeader) return response.status(401).json({ error: 'NÃ£o autorizado.' });
    const token = authHeader.replace('Bearer ', '');
    const { data: { user }, error: userError } = await supabaseAdmin.auth.getUser(token);
    if (userError) return response.status(401).json({ error: 'Token invÃ¡lido.' });

    // Pega o caminho do arquivo que o frontend quer acessar
    const { filePath } = request.query;
    if (!filePath) {
      return response.status(400).json({ error: 'O caminho do arquivo Ã© obrigatÃ³rio.' });
    }

    // Gera uma URL assinada e segura, com validade de 60 segundos
    const { data, error: urlError } = await supabaseAdmin
      .storage
      .from('resumes')
      .createSignedUrl(filePath, 60); // 60 segundos de validade

    if (urlError) throw urlError;

    return response.status(200).json({ signedUrl: data.signedUrl });

  } catch (error) {
    console.error("Erro ao gerar URL assinada:", error);
    return response.status(500).json({ error: 'Erro interno do servidor.' });
  }
}

==================================================
ARQUIVO: api\jobs.js
==================================================
import { createClient } from '@supabase/supabase-js';

export default async function handler(request, response) {
  // Usa a chave de serviÃ§o para ter acesso TOTAL (ignora RLS e permissÃµes)
  const supabaseAdmin = createClient(
    process.env.SUPABASE_URL,
    process.env.SUPABASE_SERVICE_KEY
  );

  try {
    // 1. AutenticaÃ§Ã£o BÃ¡sica
    const authHeader = request.headers['authorization'];
    if (!authHeader) throw new Error('Token ausente.');
    const token = authHeader.replace('Bearer ', '');
    const { data: { user }, error: userError } = await supabaseAdmin.auth.getUser(token);
    
    if (userError || !user) throw new Error('Token invÃ¡lido.');

    // 2. Busca o Perfil para pegar o Tenant ID correto
    const { data: profile } = await supabaseAdmin
        .from('user_profiles')
        .select('tenantId, name, is_admin_system')
        .eq('id', user.id)
        .single();

    if (!profile || !profile.tenantId) {
        throw new Error('Perfil de usuÃ¡rio nÃ£o encontrado ou sem empresa.');
    }

    const tenantId = profile.tenantId;

    if (request.method === 'GET') {
        const { id } = request.query;

        // --- BUSCAS SEPARADAS (BLINDAGEM CONTRA ERRO DE TIPOS) ---

        // A. Busca Dados da Empresa
        const { data: tenant } = await supabaseAdmin
            .from('tenants')
            .select('companyName, planId')
            .eq('id', tenantId)
            .single();

        // B. Busca TODAS as Vagas deste Tenant
        const { data: jobs, error: jobsError } = await supabaseAdmin
            .from('jobs')
            .select('*') // Pega tudo, sem tentar join quebrado
            .eq('tenantId', tenantId);

        if (jobsError) throw jobsError;

        // C. Busca TODOS os Departamentos deste Tenant
        // (Aqui resolvemos o problema: O banco pode ter salvo como texto ou uuid, pegamos por string)
        const { data: departments } = await supabaseAdmin
            .from('company_departments')
            .select('id, name, tenantId'); 
            // Filtramos no cÃ³digo abaixo para garantir, caso o tipo no banco impeÃ§a o .eq()

        // D. Busca Contagem de Candidatos
        // Fazemos uma query raw ou agrupada para evitar join complexo
        const { data: applications } = await supabaseAdmin
            .from('applications')
            .select('jobId');

        // --- MONTAGEM DOS DADOS (MANUAL JOIN) ---
        
        // 1. Mapa de Contagem de Candidatos
        const candidateCounts = {};
        applications.forEach(app => {
            candidateCounts[app.jobId] = (candidateCounts[app.jobId] || 0) + 1;
        });

        // 2. Mapa de Departamentos (ID -> Nome)
        const deptMap = {};
        if (departments) {
            departments.forEach(d => {
                // Normaliza para string para garantir o match
                if (String(d.tenantId) === String(tenantId)) {
                    deptMap[d.id] = d.name;
                }
            });
        }

        // 3. Monta o Objeto Final para o Dashboard
        let formattedJobs = jobs.map(job => ({
            id: job.id,
            title: job.title,
            status: job.status,
            created_at: job.created_at,
            type: job.type,
            location_type: job.location_type,
            candidateCount: candidateCounts[job.id] || 0,
            // Aqui fazemos o vÃ­nculo manual que o banco estava recusando
            deptName: deptMap[job.company_department_id] || 'Geral'
        }));

        // 4. OrdenaÃ§Ã£o
        formattedJobs.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));

        // Se for detalhe de uma vaga especÃ­fica
        if (id) {
            const specificJob = formattedJobs.find(j => j.id == id); // == para aceitar string/number
            if (!specificJob) return response.status(404).json({ error: 'Vaga nÃ£o encontrada.' });
            
            // Adiciona campos extras necessÃ¡rios para a tela de detalhes
            const rawJob = jobs.find(j => j.id == id);
            specificJob.description = rawJob.description;
            specificJob.requirements = rawJob.requirements;
            specificJob.parameters = rawJob.parameters;
            
            return response.status(200).json({ job: specificJob });
        }

        return response.status(200).json({
            jobs: formattedJobs,
            meta: {
                companyName: tenant?.companyName || 'Minha Empresa',
                userName: profile.name || user.email,
                planId: tenant?.planId || 'free',
                isAdmin: profile.is_admin_system
            }
        });
    }

    // POST (Escrita) - Mantido simples e direto
    if (request.method === 'POST') {
         const { action, jobId, newStatus } = request.body;
         
         if (action === 'updateJobStatus') {
            await supabaseAdmin.from('jobs').update({ status: newStatus }).eq('id', jobId);
            return response.status(200).json({ message: 'Atualizado' });
         }
         if (action === 'deleteJob') {
            await supabaseAdmin.from('applications').delete().eq('jobId', jobId);
            await supabaseAdmin.from('jobs').delete().eq('id', jobId);
            return response.status(200).json({ message: 'Deletado' });
         }
    }

    return response.status(405).json({ error: 'Method not allowed' });

  } catch (error) {
    console.error('API Error:', error.message);
    return response.status(500).json({ error: error.message });
  }
}

==================================================
ARQUIVO: api\saveEvaluation.js
==================================================
import { createClient } from '@supabase/supabase-js';
// Certifique-se de que o arquivo _utils/calculator.js existe conforme passo anterior
import { calculateWeightedScore } from './_utils/calculator.js'; 

export default async function handler(request, response) {
  if (request.method !== 'POST') return response.status(405).json({ error: 'MÃ©todo nÃ£o permitido' });

  const supabaseAdmin = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_KEY);

  try {
    const authHeader = request.headers['authorization'];
    if (!authHeader) throw new Error('Token ausente.');
    const token = authHeader.replace('Bearer ', '');
    const { data: { user }, error: authError } = await supabaseAdmin.auth.getUser(token);
    
    if (authError || !user) throw new Error('Token invÃ¡lido.');

    const { applicationId, scores, notes } = request.body;

    // 1. Busca ParÃ¢metros da Vaga
    const { data: appData, error: appError } = await supabaseAdmin
        .from('applications')
        .select('job:jobs(parameters)')
        .eq('id', applicationId)
        .single();

    if (appError || !appData) throw new Error('Candidatura nÃ£o encontrada.');

    // 2. Calcula Nota (Backend)
    // A funÃ§Ã£o calculateWeightedScore deve tratar o 'N/A' ignorando o peso
    const finalScore = calculateWeightedScore(scores, appData.job.parameters);

    // 3. Salva na tabela EVALUATIONS (Confirmada nos metadados)
    const { error: saveError } = await supabaseAdmin
        .from('evaluations')
        .upsert({
            application_id: applicationId,
            evaluator_id: user.id,
            scores: scores,
            notes: notes,
            final_score: finalScore,
            updated_at: new Date()
        }, { onConflict: 'application_id, evaluator_id' });

    if (saveError) throw saveError;

    return response.status(200).json({ message: 'AvaliaÃ§Ã£o salva!', score: finalScore });

  } catch (error) {
    console.error('Save Error:', error);
    return response.status(500).json({ error: error.message });
  }
}

==================================================
ARQUIVO: api\updateHiredStatus.js
==================================================
// api/updateHiredStatus.js (VersÃ£o com data de contrataÃ§Ã£o)
import { createClient } from '@supabase/supabase-js';

export default async function handler(request, response) {
  if (request.method !== 'POST') {
    return response.status(405).json({ error: 'MÃ©todo nÃ£o permitido.' });
  }

  try {
    const supabaseAdmin = createClient(
      process.env.SUPABASE_URL,
      process.env.SUPABASE_SERVICE_KEY
    );

    // ValidaÃ§Ã£o do usuÃ¡rio (sem alteraÃ§Ãµes)
    const authHeader = request.headers['authorization'];
    if (!authHeader) return response.status(401).json({ error: 'NÃ£o autorizado.' });
    const token = authHeader.replace('Bearer ', '');
    const { data: { user }, error: userError } = await supabaseAdmin.auth.getUser(token);
    if (userError) return response.status(401).json({ error: 'Token invÃ¡lido.' });
    
    const { applicationId, isHired } = request.body;
    if (!applicationId || typeof isHired !== 'boolean') {
      return response.status(400).json({ error: 'applicationId e isHired (booleano) sÃ£o obrigatÃ³rios.' });
    }

    // AQUI ESTÃ A LÃ“GICA ADITIVA:
    // Se estÃ¡ contratando, define a data atual. Se estÃ¡ "descontratando", define como nulo.
    const updateData = {
      isHired: isHired,
      hiredAt: isHired ? new Date().toISOString() : null
    };

    const { data, error: updateError } = await supabaseAdmin
      .from('applications')
      .update(updateData) // Usa o novo objeto de dados
      .eq('id', applicationId)
      .select()
      .single();

    if (updateError) throw updateError;

    return response.status(200).json({ message: 'Status do candidato atualizado com sucesso!', updatedApplication: data });

  } catch (error) {
    console.error("Erro ao atualizar status de contrataÃ§Ã£o:", error);
    return response.status(500).json({ error: 'Erro interno do servidor.', details: error.message });
  }
}

==================================================
ARQUIVO: api\updateJobParameters.js
==================================================
// api/updateJobParameters.js (CORRIGIDO: Aponta para user_profiles)
import { createClient } from '@supabase/supabase-js';

export default async function handler(request, response) {
  if (request.method !== 'POST') {
    response.setHeader('Allow', ['POST']);
    return response.status(405).json({ error: `MÃ©todo ${request.method} nÃ£o permitido.` });
  }

  try {
    const supabaseAdmin = createClient(
      process.env.SUPABASE_URL,
      process.env.SUPABASE_SERVICE_KEY
    );

    const authHeader = request.headers['authorization'];
    if (!authHeader) return response.status(401).json({ error: 'NÃ£o autorizado.' });
    
    const token = authHeader.replace('Bearer ', '');
    const { data: { user }, error: userError } = await supabaseAdmin.auth.getUser(token);
    if (userError) return response.status(401).json({ error: 'Token invÃ¡lido.' });

    // CORREÃ‡ÃƒO: Busca em user_profiles
    const { data: userData } = await supabaseAdmin
        .from('user_profiles')
        .select('tenantId')
        .eq('id', user.id)
        .single();
        
    if (!userData) return response.status(404).json({ error: 'Perfil nÃ£o encontrado.' });
    const tenantId = userData.tenantId;

    const { jobId, parameters } = request.body;
    if (!jobId || !parameters) {
      return response.status(400).json({ error: 'jobId e parameters sÃ£o obrigatÃ³rios.' });
    }

    const { data, error: updateError } = await supabaseAdmin
      .from('jobs')
      .update({ parameters: parameters })
      .eq('id', jobId)
      .eq('tenantId', tenantId) // SeguranÃ§a: Garante que pertence ao tenant
      .select()
      .single();

    if (updateError) {
      if (updateError.code === 'PGRST116') {
        return response.status(404).json({ error: 'Vaga nÃ£o encontrada ou sem permissÃ£o.' });
      }
      throw updateError;
    }

    return response.status(200).json({ message: 'ParÃ¢metros salvos!', updatedJob: data });

  } catch (error) {
    console.error("Erro updateJobParameters:", error);
    return response.status(500).json({ error: 'Erro interno.', details: error.message });
  }
}

==================================================
ARQUIVO: api\_utils\calculator.js
==================================================
// api/_utils/calculator.js
export function calculateWeightedScore(userScores, jobParameters) {
    if (!userScores || !jobParameters) return 0;

    // Converte lista de notas do banco em Mapa para acesso rÃ¡pido
    // Ex: { "uuid-nota-1": 0, "uuid-nota-2": 50, "uuid-nota-3": 100 }
    const notesMap = new Map((jobParameters.notas || []).map(n => [n.id, Number(n.valor)]));

    const sections = ['triagem', 'cultura', 'tecnico']; // SeÃ§Ãµes padrÃ£o
    let totalScore = 0;
    let totalMaxPossible = 0;

    sections.forEach(section => {
        const criteriaList = jobParameters[section] || []; // Ex: [{name: 'React', weight: 2}]
        const userSectionScores = userScores[section] || {}; // Ex: { 'React': 'uuid-nota-3' }

        criteriaList.forEach(criterion => {
            const noteId = userSectionScores[criterion.name];
            
            // LÃ“GICA DE N/A: Se a notaId for 'NA' ou nÃ£o existir, ignoramos este critÃ©rio
            if (!noteId || noteId === 'NA') return;

            const noteValue = notesMap.get(noteId); // Valor (0, 50, 100)
            const weight = Number(criterion.weight) || 1; // Peso (1x, 2x...)

            if (noteValue !== undefined) {
                totalScore += (noteValue * weight);
                totalMaxPossible += (100 * weight); // O mÃ¡ximo seria tirar 100 nesse critÃ©rio
            }
        });
    });

    // Evita divisÃ£o por zero se tudo for N/A
    if (totalMaxPossible === 0) return 0;

    // Normaliza para 0-100 com 1 casa decimal
    return Number(((totalScore / totalMaxPossible) * 100).toFixed(1));
}

==================================================
ARQUIVO: Backup\Backup-novva-rs-saas-2_0.sql
==================================================
--
-- PostgreSQL database dump
--

\restrict 9n85L6dW6CYA0zN91g5DgpNWB16yl0Ug3hdeEQyLJTss6qG0iM2naCOKCBNYcGw

-- Dumped from database version 17.6
-- Dumped by pg_dump version 18.0

-- Started on 2026-01-04 15:44:51

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET transaction_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- TOC entry 37 (class 2615 OID 16494)
-- Name: auth; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA auth;


ALTER SCHEMA auth OWNER TO supabase_admin;

--
-- TOC entry 23 (class 2615 OID 16388)
-- Name: extensions; Type: SCHEMA; Schema: -; Owner: postgres
--

CREATE SCHEMA extensions;


ALTER SCHEMA extensions OWNER TO postgres;

--
-- TOC entry 35 (class 2615 OID 16574)
-- Name: graphql; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA graphql;


ALTER SCHEMA graphql OWNER TO supabase_admin;

--
-- TOC entry 34 (class 2615 OID 16563)
-- Name: graphql_public; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA graphql_public;


ALTER SCHEMA graphql_public OWNER TO supabase_admin;

--
-- TOC entry 12 (class 2615 OID 16386)
-- Name: pgbouncer; Type: SCHEMA; Schema: -; Owner: pgbouncer
--

CREATE SCHEMA pgbouncer;


ALTER SCHEMA pgbouncer OWNER TO pgbouncer;

--
-- TOC entry 13 (class 2615 OID 16555)
-- Name: realtime; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA realtime;


ALTER SCHEMA realtime OWNER TO supabase_admin;

--
-- TOC entry 38 (class 2615 OID 16542)
-- Name: storage; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA storage;


ALTER SCHEMA storage OWNER TO supabase_admin;

--
-- TOC entry 32 (class 2615 OID 16603)
-- Name: vault; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA vault;


ALTER SCHEMA vault OWNER TO supabase_admin;

--
-- TOC entry 6 (class 3079 OID 16639)
-- Name: pg_graphql; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS pg_graphql WITH SCHEMA graphql;


--
-- TOC entry 4353 (class 0 OID 0)
-- Dependencies: 6
-- Name: EXTENSION pg_graphql; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION pg_graphql IS 'pg_graphql: GraphQL support';


--
-- TOC entry 2 (class 3079 OID 16389)
-- Name: pg_stat_statements; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS pg_stat_statements WITH SCHEMA extensions;


--
-- TOC entry 4354 (class 0 OID 0)
-- Dependencies: 2
-- Name: EXTENSION pg_stat_statements; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION pg_stat_statements IS 'track planning and execution statistics of all SQL statements executed';


--
-- TOC entry 4 (class 3079 OID 16443)
-- Name: pgcrypto; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS pgcrypto WITH SCHEMA extensions;


--
-- TOC entry 4355 (class 0 OID 0)
-- Dependencies: 4
-- Name: EXTENSION pgcrypto; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION pgcrypto IS 'cryptographic functions';


--
-- TOC entry 5 (class 3079 OID 16604)
-- Name: supabase_vault; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS supabase_vault WITH SCHEMA vault;


--
-- TOC entry 4356 (class 0 OID 0)
-- Dependencies: 5
-- Name: EXTENSION supabase_vault; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION supabase_vault IS 'Supabase Vault Extension';


--
-- TOC entry 3 (class 3079 OID 16432)
-- Name: uuid-ossp; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS "uuid-ossp" WITH SCHEMA extensions;


--
-- TOC entry 4357 (class 0 OID 0)
-- Dependencies: 3
-- Name: EXTENSION "uuid-ossp"; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION "uuid-ossp" IS 'generate universally unique identifiers (UUIDs)';


--
-- TOC entry 1182 (class 1247 OID 16738)
-- Name: aal_level; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.aal_level AS ENUM (
    'aal1',
    'aal2',
    'aal3'
);


ALTER TYPE auth.aal_level OWNER TO supabase_auth_admin;

--
-- TOC entry 1206 (class 1247 OID 16879)
-- Name: code_challenge_method; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.code_challenge_method AS ENUM (
    's256',
    'plain'
);


ALTER TYPE auth.code_challenge_method OWNER TO supabase_auth_admin;

--
-- TOC entry 1179 (class 1247 OID 16732)
-- Name: factor_status; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.factor_status AS ENUM (
    'unverified',
    'verified'
);


ALTER TYPE auth.factor_status OWNER TO supabase_auth_admin;

--
-- TOC entry 1176 (class 1247 OID 16727)
-- Name: factor_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.factor_type AS ENUM (
    'totp',
    'webauthn',
    'phone'
);


ALTER TYPE auth.factor_type OWNER TO supabase_auth_admin;

--
-- TOC entry 1224 (class 1247 OID 16982)
-- Name: oauth_authorization_status; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.oauth_authorization_status AS ENUM (
    'pending',
    'approved',
    'denied',
    'expired'
);


ALTER TYPE auth.oauth_authorization_status OWNER TO supabase_auth_admin;

--
-- TOC entry 1236 (class 1247 OID 17055)
-- Name: oauth_client_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.oauth_client_type AS ENUM (
    'public',
    'confidential'
);


ALTER TYPE auth.oauth_client_type OWNER TO supabase_auth_admin;

--
-- TOC entry 1218 (class 1247 OID 16960)
-- Name: oauth_registration_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.oauth_registration_type AS ENUM (
    'dynamic',
    'manual'
);


ALTER TYPE auth.oauth_registration_type OWNER TO supabase_auth_admin;

--
-- TOC entry 1227 (class 1247 OID 16992)
-- Name: oauth_response_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.oauth_response_type AS ENUM (
    'code'
);


ALTER TYPE auth.oauth_response_type OWNER TO supabase_auth_admin;

--
-- TOC entry 1212 (class 1247 OID 16921)
-- Name: one_time_token_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.one_time_token_type AS ENUM (
    'confirmation_token',
    'reauthentication_token',
    'recovery_token',
    'email_change_token_new',
    'email_change_token_current',
    'phone_change_token'
);


ALTER TYPE auth.one_time_token_type OWNER TO supabase_auth_admin;

--
-- TOC entry 1287 (class 1247 OID 17349)
-- Name: action; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.action AS ENUM (
    'INSERT',
    'UPDATE',
    'DELETE',
    'TRUNCATE',
    'ERROR'
);


ALTER TYPE realtime.action OWNER TO supabase_admin;

--
-- TOC entry 1278 (class 1247 OID 17309)
-- Name: equality_op; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.equality_op AS ENUM (
    'eq',
    'neq',
    'lt',
    'lte',
    'gt',
    'gte',
    'in'
);


ALTER TYPE realtime.equality_op OWNER TO supabase_admin;

--
-- TOC entry 1281 (class 1247 OID 17323)
-- Name: user_defined_filter; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.user_defined_filter AS (
	column_name text,
	op realtime.equality_op,
	value text
);


ALTER TYPE realtime.user_defined_filter OWNER TO supabase_admin;

--
-- TOC entry 1293 (class 1247 OID 17390)
-- Name: wal_column; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.wal_column AS (
	name text,
	type_name text,
	type_oid oid,
	value jsonb,
	is_pkey boolean,
	is_selectable boolean
);


ALTER TYPE realtime.wal_column OWNER TO supabase_admin;

--
-- TOC entry 1290 (class 1247 OID 17361)
-- Name: wal_rls; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.wal_rls AS (
	wal jsonb,
	is_rls_enabled boolean,
	subscription_ids uuid[],
	errors text[]
);


ALTER TYPE realtime.wal_rls OWNER TO supabase_admin;

--
-- TOC entry 1263 (class 1247 OID 17241)
-- Name: buckettype; Type: TYPE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TYPE storage.buckettype AS ENUM (
    'STANDARD',
    'ANALYTICS',
    'VECTOR'
);


ALTER TYPE storage.buckettype OWNER TO supabase_storage_admin;

--
-- TOC entry 441 (class 1255 OID 16540)
-- Name: email(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
--

CREATE FUNCTION auth.email() RETURNS text
    LANGUAGE sql STABLE
    AS $$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.email', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'email')
  )::text
$$;


ALTER FUNCTION auth.email() OWNER TO supabase_auth_admin;

--
-- TOC entry 4358 (class 0 OID 0)
-- Dependencies: 441
-- Name: FUNCTION email(); Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON FUNCTION auth.email() IS 'Deprecated. Use auth.jwt() -> ''email'' instead.';


--
-- TOC entry 515 (class 1255 OID 16709)
-- Name: jwt(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
--

CREATE FUNCTION auth.jwt() RETURNS jsonb
    LANGUAGE sql STABLE
    AS $$
  select 
    coalesce(
        nullif(current_setting('request.jwt.claim', true), ''),
        nullif(current_setting('request.jwt.claims', true), '')
    )::jsonb
$$;


ALTER FUNCTION auth.jwt() OWNER TO supabase_auth_admin;

--
-- TOC entry 408 (class 1255 OID 16539)
-- Name: role(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
--

CREATE FUNCTION auth.role() RETURNS text
    LANGUAGE sql STABLE
    AS $$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.role', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'role')
  )::text
$$;


ALTER FUNCTION auth.role() OWNER TO supabase_auth_admin;

--
-- TOC entry 4361 (class 0 OID 0)
-- Dependencies: 408
-- Name: FUNCTION role(); Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON FUNCTION auth.role() IS 'Deprecated. Use auth.jwt() -> ''role'' instead.';


--
-- TOC entry 420 (class 1255 OID 16538)
-- Name: uid(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
--

CREATE FUNCTION auth.uid() RETURNS uuid
    LANGUAGE sql STABLE
    AS $$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.sub', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'sub')
  )::uuid
$$;


ALTER FUNCTION auth.uid() OWNER TO supabase_auth_admin;

--
-- TOC entry 4363 (class 0 OID 0)
-- Dependencies: 420
-- Name: FUNCTION uid(); Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON FUNCTION auth.uid() IS 'Deprecated. Use auth.jwt() -> ''sub'' instead.';


--
-- TOC entry 437 (class 1255 OID 16547)
-- Name: grant_pg_cron_access(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.grant_pg_cron_access() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  IF EXISTS (
    SELECT
    FROM pg_event_trigger_ddl_commands() AS ev
    JOIN pg_extension AS ext
    ON ev.objid = ext.oid
    WHERE ext.extname = 'pg_cron'
  )
  THEN
    grant usage on schema cron to postgres with grant option;

    alter default privileges in schema cron grant all on tables to postgres with grant option;
    alter default privileges in schema cron grant all on functions to postgres with grant option;
    alter default privileges in schema cron grant all on sequences to postgres with grant option;

    alter default privileges for user supabase_admin in schema cron grant all
        on sequences to postgres with grant option;
    alter default privileges for user supabase_admin in schema cron grant all
        on tables to postgres with grant option;
    alter default privileges for user supabase_admin in schema cron grant all
        on functions to postgres with grant option;

    grant all privileges on all tables in schema cron to postgres with grant option;
    revoke all on table cron.job from postgres;
    grant select on table cron.job to postgres with grant option;
  END IF;
END;
$$;


ALTER FUNCTION extensions.grant_pg_cron_access() OWNER TO supabase_admin;

--
-- TOC entry 4379 (class 0 OID 0)
-- Dependencies: 437
-- Name: FUNCTION grant_pg_cron_access(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
--

COMMENT ON FUNCTION extensions.grant_pg_cron_access() IS 'Grants access to pg_cron';


--
-- TOC entry 505 (class 1255 OID 16568)
-- Name: grant_pg_graphql_access(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.grant_pg_graphql_access() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $_$
DECLARE
    func_is_graphql_resolve bool;
BEGIN
    func_is_graphql_resolve = (
        SELECT n.proname = 'resolve'
        FROM pg_event_trigger_ddl_commands() AS ev
        LEFT JOIN pg_catalog.pg_proc AS n
        ON ev.objid = n.oid
    );

    IF func_is_graphql_resolve
    THEN
        -- Update public wrapper to pass all arguments through to the pg_graphql resolve func
        DROP FUNCTION IF EXISTS graphql_public.graphql;
        create or replace function graphql_public.graphql(
            "operationName" text default null,
            query text default null,
            variables jsonb default null,
            extensions jsonb default null
        )
            returns jsonb
            language sql
        as $$
            select graphql.resolve(
                query := query,
                variables := coalesce(variables, '{}'),
                "operationName" := "operationName",
                extensions := extensions
            );
        $$;

        -- This hook executes when `graphql.resolve` is created. That is not necessarily the last
        -- function in the extension so we need to grant permissions on existing entities AND
        -- update default permissions to any others that are created after `graphql.resolve`
        grant usage on schema graphql to postgres, anon, authenticated, service_role;
        grant select on all tables in schema graphql to postgres, anon, authenticated, service_role;
        grant execute on all functions in schema graphql to postgres, anon, authenticated, service_role;
        grant all on all sequences in schema graphql to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on tables to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on functions to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on sequences to postgres, anon, authenticated, service_role;

        -- Allow postgres role to allow granting usage on graphql and graphql_public schemas to custom roles
        grant usage on schema graphql_public to postgres with grant option;
        grant usage on schema graphql to postgres with grant option;
    END IF;

END;
$_$;


ALTER FUNCTION extensions.grant_pg_graphql_access() OWNER TO supabase_admin;

--
-- TOC entry 4381 (class 0 OID 0)
-- Dependencies: 505
-- Name: FUNCTION grant_pg_graphql_access(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
--

COMMENT ON FUNCTION extensions.grant_pg_graphql_access() IS 'Grants access to pg_graphql';


--
-- TOC entry 400 (class 1255 OID 16549)
-- Name: grant_pg_net_access(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.grant_pg_net_access() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  IF EXISTS (
    SELECT 1
    FROM pg_event_trigger_ddl_commands() AS ev
    JOIN pg_extension AS ext
    ON ev.objid = ext.oid
    WHERE ext.extname = 'pg_net'
  )
  THEN
    IF NOT EXISTS (
      SELECT 1
      FROM pg_roles
      WHERE rolname = 'supabase_functions_admin'
    )
    THEN
      CREATE USER supabase_functions_admin NOINHERIT CREATEROLE LOGIN NOREPLICATION;
    END IF;

    GRANT USAGE ON SCHEMA net TO supabase_functions_admin, postgres, anon, authenticated, service_role;

    IF EXISTS (
      SELECT FROM pg_extension
      WHERE extname = 'pg_net'
      -- all versions in use on existing projects as of 2025-02-20
      -- version 0.12.0 onwards don't need these applied
      AND extversion IN ('0.2', '0.6', '0.7', '0.7.1', '0.8', '0.10.0', '0.11.0')
    ) THEN
      ALTER function net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) SECURITY DEFINER;
      ALTER function net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) SECURITY DEFINER;

      ALTER function net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) SET search_path = net;
      ALTER function net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) SET search_path = net;

      REVOKE ALL ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;
      REVOKE ALL ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;

      GRANT EXECUTE ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin, postgres, anon, authenticated, service_role;
      GRANT EXECUTE ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin, postgres, anon, authenticated, service_role;
    END IF;
  END IF;
END;
$$;


ALTER FUNCTION extensions.grant_pg_net_access() OWNER TO supabase_admin;

--
-- TOC entry 4383 (class 0 OID 0)
-- Dependencies: 400
-- Name: FUNCTION grant_pg_net_access(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
--

COMMENT ON FUNCTION extensions.grant_pg_net_access() IS 'Grants access to pg_net';


--
-- TOC entry 524 (class 1255 OID 16559)
-- Name: pgrst_ddl_watch(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.pgrst_ddl_watch() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  cmd record;
BEGIN
  FOR cmd IN SELECT * FROM pg_event_trigger_ddl_commands()
  LOOP
    IF cmd.command_tag IN (
      'CREATE SCHEMA', 'ALTER SCHEMA'
    , 'CREATE TABLE', 'CREATE TABLE AS', 'SELECT INTO', 'ALTER TABLE'
    , 'CREATE FOREIGN TABLE', 'ALTER FOREIGN TABLE'
    , 'CREATE VIEW', 'ALTER VIEW'
    , 'CREATE MATERIALIZED VIEW', 'ALTER MATERIALIZED VIEW'
    , 'CREATE FUNCTION', 'ALTER FUNCTION'
    , 'CREATE TRIGGER'
    , 'CREATE TYPE', 'ALTER TYPE'
    , 'CREATE RULE'
    , 'COMMENT'
    )
    -- don't notify in case of CREATE TEMP table or other objects created on pg_temp
    AND cmd.schema_name is distinct from 'pg_temp'
    THEN
      NOTIFY pgrst, 'reload schema';
    END IF;
  END LOOP;
END; $$;


ALTER FUNCTION extensions.pgrst_ddl_watch() OWNER TO supabase_admin;

--
-- TOC entry 517 (class 1255 OID 16560)
-- Name: pgrst_drop_watch(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.pgrst_drop_watch() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  obj record;
BEGIN
  FOR obj IN SELECT * FROM pg_event_trigger_dropped_objects()
  LOOP
    IF obj.object_type IN (
      'schema'
    , 'table'
    , 'foreign table'
    , 'view'
    , 'materialized view'
    , 'function'
    , 'trigger'
    , 'type'
    , 'rule'
    )
    AND obj.is_temporary IS false -- no pg_temp objects
    THEN
      NOTIFY pgrst, 'reload schema';
    END IF;
  END LOOP;
END; $$;


ALTER FUNCTION extensions.pgrst_drop_watch() OWNER TO supabase_admin;

--
-- TOC entry 499 (class 1255 OID 16570)
-- Name: set_graphql_placeholder(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.set_graphql_placeholder() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $_$
    DECLARE
    graphql_is_dropped bool;
    BEGIN
    graphql_is_dropped = (
        SELECT ev.schema_name = 'graphql_public'
        FROM pg_event_trigger_dropped_objects() AS ev
        WHERE ev.schema_name = 'graphql_public'
    );

    IF graphql_is_dropped
    THEN
        create or replace function graphql_public.graphql(
            "operationName" text default null,
            query text default null,
            variables jsonb default null,
            extensions jsonb default null
        )
            returns jsonb
            language plpgsql
        as $$
            DECLARE
                server_version float;
            BEGIN
                server_version = (SELECT (SPLIT_PART((select version()), ' ', 2))::float);

                IF server_version >= 14 THEN
                    RETURN jsonb_build_object(
                        'errors', jsonb_build_array(
                            jsonb_build_object(
                                'message', 'pg_graphql extension is not enabled.'
                            )
                        )
                    );
                ELSE
                    RETURN jsonb_build_object(
                        'errors', jsonb_build_array(
                            jsonb_build_object(
                                'message', 'pg_graphql is only available on projects running Postgres 14 onwards.'
                            )
                        )
                    );
                END IF;
            END;
        $$;
    END IF;

    END;
$_$;


ALTER FUNCTION extensions.set_graphql_placeholder() OWNER TO supabase_admin;

--
-- TOC entry 4412 (class 0 OID 0)
-- Dependencies: 499
-- Name: FUNCTION set_graphql_placeholder(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
--

COMMENT ON FUNCTION extensions.set_graphql_placeholder() IS 'Reintroduces placeholder function for graphql_public.graphql';


--
-- TOC entry 443 (class 1255 OID 16387)
-- Name: get_auth(text); Type: FUNCTION; Schema: pgbouncer; Owner: supabase_admin
--

CREATE FUNCTION pgbouncer.get_auth(p_usename text) RETURNS TABLE(username text, password text)
    LANGUAGE plpgsql SECURITY DEFINER
    SET search_path TO ''
    AS $_$
  BEGIN
      RAISE DEBUG 'PgBouncer auth request: %', p_usename;

      RETURN QUERY
      SELECT
          rolname::text,
          CASE WHEN rolvaliduntil < now()
              THEN null
              ELSE rolpassword::text
          END
      FROM pg_authid
      WHERE rolname=$1 and rolcanlogin;
  END;
  $_$;


ALTER FUNCTION pgbouncer.get_auth(p_usename text) OWNER TO supabase_admin;

--
-- TOC entry 520 (class 1255 OID 23031)
-- Name: check_plan_limit(uuid); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.check_plan_limit(target_tenant_id uuid) RETURNS boolean
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    active_users int;
    max_users int;
    plan_tier text;
BEGIN
    SELECT plan INTO plan_tier FROM public.tenants WHERE id = target_tenant_id;
    
    IF plan_tier = 'enterprise' THEN max_users := 999;
    ELSIF plan_tier = 'pro' THEN max_users := 5;
    ELSE max_users := 1; 
    END IF;

    SELECT count(*) INTO active_users FROM public.users 
    WHERE "tenantId" = target_tenant_id AND status = 'active';

    RETURN active_users < max_users;
END;
$$;


ALTER FUNCTION public.check_plan_limit(target_tenant_id uuid) OWNER TO postgres;

--
-- TOC entry 489 (class 1255 OID 17805)
-- Name: get_candidate_summary_v2(bigint); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.get_candidate_summary_v2(target_app_id bigint) RETURNS jsonb
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
  app_record record;
BEGIN
  -- Seleciona colunas essenciais
  SELECT evaluation, score_general, status, is_hired 
  INTO app_record 
  FROM public.applications 
  WHERE id = target_app_id;
  
  IF app_record IS NULL THEN
    RETURN jsonb_build_object('error', 'Candidatura nÃ£o encontrada');
  END IF;

  RETURN jsonb_build_object(
    'evaluation', app_record.evaluation,
    'score_general', app_record.score_general,
    'status', app_record.status,
    'hired', app_record.is_hired
  );
END;
$$;


ALTER FUNCTION public.get_candidate_summary_v2(target_app_id bigint) OWNER TO postgres;

--
-- TOC entry 496 (class 1255 OID 17804)
-- Name: initialize_job_criteria_v2(bigint); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.initialize_job_criteria_v2(target_job_id bigint) RETURNS jsonb
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
  current_params jsonb;
  default_params jsonb := '{"triagem": [], "cultura": [], "tecnico": [], "notas": []}'::jsonb;
BEGIN
  -- Seleciona a coluna parameters da tabela jobs
  SELECT parameters INTO current_params FROM public.jobs WHERE id = target_job_id;
  
  IF current_params IS NULL OR current_params = '{}'::jsonb THEN
    UPDATE public.jobs SET parameters = default_params WHERE id = target_job_id;
    RETURN default_params;
  END IF;
  
  RETURN current_params;
END;
$$;


ALTER FUNCTION public.initialize_job_criteria_v2(target_job_id bigint) OWNER TO postgres;

--
-- TOC entry 433 (class 1255 OID 22868)
-- Name: update_application_general_score(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.update_application_general_score() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    UPDATE public.applications
    SET evaluation = jsonb_set(
        COALESCE(evaluation, '{}'::jsonb),
        '{general_score}', 
        to_jsonb((SELECT COALESCE(AVG(final_score), 0) FROM public.evaluations WHERE application_id = NEW.application_id))
    )
    WHERE id = NEW.application_id;
    RETURN NEW;
END;
$$;


ALTER FUNCTION public.update_application_general_score() OWNER TO postgres;

--
-- TOC entry 453 (class 1255 OID 22926)
-- Name: update_general_score(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.update_general_score() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    UPDATE public.applications
    SET evaluation = jsonb_set(
        COALESCE(evaluation, '{}'::jsonb),
        '{general_score}', 
        to_jsonb((
            SELECT COALESCE(AVG(final_score), 0) 
            FROM public.evaluations 
            WHERE application_id = NEW.application_id
        ))
    )
    WHERE id = NEW.application_id;
    RETURN NEW;
END;
$$;


ALTER FUNCTION public.update_general_score() OWNER TO postgres;

--
-- TOC entry 463 (class 1255 OID 17383)
-- Name: apply_rls(jsonb, integer); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer DEFAULT (1024 * 1024)) RETURNS SETOF realtime.wal_rls
    LANGUAGE plpgsql
    AS $$
declare
-- Regclass of the table e.g. public.notes
entity_ regclass = (quote_ident(wal ->> 'schema') || '.' || quote_ident(wal ->> 'table'))::regclass;

-- I, U, D, T: insert, update ...
action realtime.action = (
    case wal ->> 'action'
        when 'I' then 'INSERT'
        when 'U' then 'UPDATE'
        when 'D' then 'DELETE'
        else 'ERROR'
    end
);

-- Is row level security enabled for the table
is_rls_enabled bool = relrowsecurity from pg_class where oid = entity_;

subscriptions realtime.subscription[] = array_agg(subs)
    from
        realtime.subscription subs
    where
        subs.entity = entity_;

-- Subscription vars
roles regrole[] = array_agg(distinct us.claims_role::text)
    from
        unnest(subscriptions) us;

working_role regrole;
claimed_role regrole;
claims jsonb;

subscription_id uuid;
subscription_has_access bool;
visible_to_subscription_ids uuid[] = '{}';

-- structured info for wal's columns
columns realtime.wal_column[];
-- previous identity values for update/delete
old_columns realtime.wal_column[];

error_record_exceeds_max_size boolean = octet_length(wal::text) > max_record_bytes;

-- Primary jsonb output for record
output jsonb;

begin
perform set_config('role', null, true);

columns =
    array_agg(
        (
            x->>'name',
            x->>'type',
            x->>'typeoid',
            realtime.cast(
                (x->'value') #>> '{}',
                coalesce(
                    (x->>'typeoid')::regtype, -- null when wal2json version <= 2.4
                    (x->>'type')::regtype
                )
            ),
            (pks ->> 'name') is not null,
            true
        )::realtime.wal_column
    )
    from
        jsonb_array_elements(wal -> 'columns') x
        left join jsonb_array_elements(wal -> 'pk') pks
            on (x ->> 'name') = (pks ->> 'name');

old_columns =
    array_agg(
        (
            x->>'name',
            x->>'type',
            x->>'typeoid',
            realtime.cast(
                (x->'value') #>> '{}',
                coalesce(
                    (x->>'typeoid')::regtype, -- null when wal2json version <= 2.4
                    (x->>'type')::regtype
                )
            ),
            (pks ->> 'name') is not null,
            true
        )::realtime.wal_column
    )
    from
        jsonb_array_elements(wal -> 'identity') x
        left join jsonb_array_elements(wal -> 'pk') pks
            on (x ->> 'name') = (pks ->> 'name');

for working_role in select * from unnest(roles) loop

    -- Update `is_selectable` for columns and old_columns
    columns =
        array_agg(
            (
                c.name,
                c.type_name,
                c.type_oid,
                c.value,
                c.is_pkey,
                pg_catalog.has_column_privilege(working_role, entity_, c.name, 'SELECT')
            )::realtime.wal_column
        )
        from
            unnest(columns) c;

    old_columns =
            array_agg(
                (
                    c.name,
                    c.type_name,
                    c.type_oid,
                    c.value,
                    c.is_pkey,
                    pg_catalog.has_column_privilege(working_role, entity_, c.name, 'SELECT')
                )::realtime.wal_column
            )
            from
                unnest(old_columns) c;

    if action <> 'DELETE' and count(1) = 0 from unnest(columns) c where c.is_pkey then
        return next (
            jsonb_build_object(
                'schema', wal ->> 'schema',
                'table', wal ->> 'table',
                'type', action
            ),
            is_rls_enabled,
            -- subscriptions is already filtered by entity
            (select array_agg(s.subscription_id) from unnest(subscriptions) as s where claims_role = working_role),
            array['Error 400: Bad Request, no primary key']
        )::realtime.wal_rls;

    -- The claims role does not have SELECT permission to the primary key of entity
    elsif action <> 'DELETE' and sum(c.is_selectable::int) <> count(1) from unnest(columns) c where c.is_pkey then
        return next (
            jsonb_build_object(
                'schema', wal ->> 'schema',
                'table', wal ->> 'table',
                'type', action
            ),
            is_rls_enabled,
            (select array_agg(s.subscription_id) from unnest(subscriptions) as s where claims_role = working_role),
            array['Error 401: Unauthorized']
        )::realtime.wal_rls;

    else
        output = jsonb_build_object(
            'schema', wal ->> 'schema',
            'table', wal ->> 'table',
            'type', action,
            'commit_timestamp', to_char(
                ((wal ->> 'timestamp')::timestamptz at time zone 'utc'),
                'YYYY-MM-DD"T"HH24:MI:SS.MS"Z"'
            ),
            'columns', (
                select
                    jsonb_agg(
                        jsonb_build_object(
                            'name', pa.attname,
                            'type', pt.typname
                        )
                        order by pa.attnum asc
                    )
                from
                    pg_attribute pa
                    join pg_type pt
                        on pa.atttypid = pt.oid
                where
                    attrelid = entity_
                    and attnum > 0
                    and pg_catalog.has_column_privilege(working_role, entity_, pa.attname, 'SELECT')
            )
        )
        -- Add "record" key for insert and update
        || case
            when action in ('INSERT', 'UPDATE') then
                jsonb_build_object(
                    'record',
                    (
                        select
                            jsonb_object_agg(
                                -- if unchanged toast, get column name and value from old record
                                coalesce((c).name, (oc).name),
                                case
                                    when (c).name is null then (oc).value
                                    else (c).value
                                end
                            )
                        from
                            unnest(columns) c
                            full outer join unnest(old_columns) oc
                                on (c).name = (oc).name
                        where
                            coalesce((c).is_selectable, (oc).is_selectable)
                            and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                    )
                )
            else '{}'::jsonb
        end
        -- Add "old_record" key for update and delete
        || case
            when action = 'UPDATE' then
                jsonb_build_object(
                        'old_record',
                        (
                            select jsonb_object_agg((c).name, (c).value)
                            from unnest(old_columns) c
                            where
                                (c).is_selectable
                                and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                        )
                    )
            when action = 'DELETE' then
                jsonb_build_object(
                    'old_record',
                    (
                        select jsonb_object_agg((c).name, (c).value)
                        from unnest(old_columns) c
                        where
                            (c).is_selectable
                            and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                            and ( not is_rls_enabled or (c).is_pkey ) -- if RLS enabled, we can't secure deletes so filter to pkey
                    )
                )
            else '{}'::jsonb
        end;

        -- Create the prepared statement
        if is_rls_enabled and action <> 'DELETE' then
            if (select 1 from pg_prepared_statements where name = 'walrus_rls_stmt' limit 1) > 0 then
                deallocate walrus_rls_stmt;
            end if;
            execute realtime.build_prepared_statement_sql('walrus_rls_stmt', entity_, columns);
        end if;

        visible_to_subscription_ids = '{}';

        for subscription_id, claims in (
                select
                    subs.subscription_id,
                    subs.claims
                from
                    unnest(subscriptions) subs
                where
                    subs.entity = entity_
                    and subs.claims_role = working_role
                    and (
                        realtime.is_visible_through_filters(columns, subs.filters)
                        or (
                          action = 'DELETE'
                          and realtime.is_visible_through_filters(old_columns, subs.filters)
                        )
                    )
        ) loop

            if not is_rls_enabled or action = 'DELETE' then
                visible_to_subscription_ids = visible_to_subscription_ids || subscription_id;
            else
                -- Check if RLS allows the role to see the record
                perform
                    -- Trim leading and trailing quotes from working_role because set_config
                    -- doesn't recognize the role as valid if they are included
                    set_config('role', trim(both '"' from working_role::text), true),
                    set_config('request.jwt.claims', claims::text, true);

                execute 'execute walrus_rls_stmt' into subscription_has_access;

                if subscription_has_access then
                    visible_to_subscription_ids = visible_to_subscription_ids || subscription_id;
                end if;
            end if;
        end loop;

        perform set_config('role', null, true);

        return next (
            output,
            is_rls_enabled,
            visible_to_subscription_ids,
            case
                when error_record_exceeds_max_size then array['Error 413: Payload Too Large']
                else '{}'
            end
        )::realtime.wal_rls;

    end if;
end loop;

perform set_config('role', null, true);
end;
$$;


ALTER FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) OWNER TO supabase_admin;

--
-- TOC entry 403 (class 1255 OID 17462)
-- Name: broadcast_changes(text, text, text, text, text, record, record, text); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text DEFAULT 'ROW'::text) RETURNS void
    LANGUAGE plpgsql
    AS $$
DECLARE
    -- Declare a variable to hold the JSONB representation of the row
    row_data jsonb := '{}'::jsonb;
BEGIN
    IF level = 'STATEMENT' THEN
        RAISE EXCEPTION 'function can only be triggered for each row, not for each statement';
    END IF;
    -- Check the operation type and handle accordingly
    IF operation = 'INSERT' OR operation = 'UPDATE' OR operation = 'DELETE' THEN
        row_data := jsonb_build_object('old_record', OLD, 'record', NEW, 'operation', operation, 'table', table_name, 'schema', table_schema);
        PERFORM realtime.send (row_data, event_name, topic_name);
    ELSE
        RAISE EXCEPTION 'Unexpected operation type: %', operation;
    END IF;
EXCEPTION
    WHEN OTHERS THEN
        RAISE EXCEPTION 'Failed to process the row: %', SQLERRM;
END;

$$;


ALTER FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text) OWNER TO supabase_admin;

--
-- TOC entry 493 (class 1255 OID 17395)
-- Name: build_prepared_statement_sql(text, regclass, realtime.wal_column[]); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) RETURNS text
    LANGUAGE sql
    AS $$
      /*
      Builds a sql string that, if executed, creates a prepared statement to
      tests retrive a row from *entity* by its primary key columns.
      Example
          select realtime.build_prepared_statement_sql('public.notes', '{"id"}'::text[], '{"bigint"}'::text[])
      */
          select
      'prepare ' || prepared_statement_name || ' as
          select
              exists(
                  select
                      1
                  from
                      ' || entity || '
                  where
                      ' || string_agg(quote_ident(pkc.name) || '=' || quote_nullable(pkc.value #>> '{}') , ' and ') || '
              )'
          from
              unnest(columns) pkc
          where
              pkc.is_pkey
          group by
              entity
      $$;


ALTER FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) OWNER TO supabase_admin;

--
-- TOC entry 459 (class 1255 OID 17346)
-- Name: cast(text, regtype); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime."cast"(val text, type_ regtype) RETURNS jsonb
    LANGUAGE plpgsql IMMUTABLE
    AS $$
    declare
      res jsonb;
    begin
      execute format('select to_jsonb(%L::'|| type_::text || ')', val)  into res;
      return res;
    end
    $$;


ALTER FUNCTION realtime."cast"(val text, type_ regtype) OWNER TO supabase_admin;

--
-- TOC entry 469 (class 1255 OID 17340)
-- Name: check_equality_op(realtime.equality_op, regtype, text, text); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) RETURNS boolean
    LANGUAGE plpgsql IMMUTABLE
    AS $$
      /*
      Casts *val_1* and *val_2* as type *type_* and check the *op* condition for truthiness
      */
      declare
          op_symbol text = (
              case
                  when op = 'eq' then '='
                  when op = 'neq' then '!='
                  when op = 'lt' then '<'
                  when op = 'lte' then '<='
                  when op = 'gt' then '>'
                  when op = 'gte' then '>='
                  when op = 'in' then '= any'
                  else 'UNKNOWN OP'
              end
          );
          res boolean;
      begin
          execute format(
              'select %L::'|| type_::text || ' ' || op_symbol
              || ' ( %L::'
              || (
                  case
                      when op = 'in' then type_::text || '[]'
                      else type_::text end
              )
              || ')', val_1, val_2) into res;
          return res;
      end;
      $$;


ALTER FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) OWNER TO supabase_admin;

--
-- TOC entry 422 (class 1255 OID 17391)
-- Name: is_visible_through_filters(realtime.wal_column[], realtime.user_defined_filter[]); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) RETURNS boolean
    LANGUAGE sql IMMUTABLE
    AS $_$
    /*
    Should the record be visible (true) or filtered out (false) after *filters* are applied
    */
        select
            -- Default to allowed when no filters present
            $2 is null -- no filters. this should not happen because subscriptions has a default
            or array_length($2, 1) is null -- array length of an empty array is null
            or bool_and(
                coalesce(
                    realtime.check_equality_op(
                        op:=f.op,
                        type_:=coalesce(
                            col.type_oid::regtype, -- null when wal2json version <= 2.4
                            col.type_name::regtype
                        ),
                        -- cast jsonb to text
                        val_1:=col.value #>> '{}',
                        val_2:=f.value
                    ),
                    false -- if null, filter does not match
                )
            )
        from
            unnest(filters) f
            join unnest(columns) col
                on f.column_name = col.name;
    $_$;


ALTER FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) OWNER TO supabase_admin;

--
-- TOC entry 430 (class 1255 OID 17402)
-- Name: list_changes(name, name, integer, integer); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) RETURNS SETOF realtime.wal_rls
    LANGUAGE sql
    SET log_min_messages TO 'fatal'
    AS $$
      with pub as (
        select
          concat_ws(
            ',',
            case when bool_or(pubinsert) then 'insert' else null end,
            case when bool_or(pubupdate) then 'update' else null end,
            case when bool_or(pubdelete) then 'delete' else null end
          ) as w2j_actions,
          coalesce(
            string_agg(
              realtime.quote_wal2json(format('%I.%I', schemaname, tablename)::regclass),
              ','
            ) filter (where ppt.tablename is not null and ppt.tablename not like '% %'),
            ''
          ) w2j_add_tables
        from
          pg_publication pp
          left join pg_publication_tables ppt
            on pp.pubname = ppt.pubname
        where
          pp.pubname = publication
        group by
          pp.pubname
        limit 1
      ),
      w2j as (
        select
          x.*, pub.w2j_add_tables
        from
          pub,
          pg_logical_slot_get_changes(
            slot_name, null, max_changes,
            'include-pk', 'true',
            'include-transaction', 'false',
            'include-timestamp', 'true',
            'include-type-oids', 'true',
            'format-version', '2',
            'actions', pub.w2j_actions,
            'add-tables', pub.w2j_add_tables
          ) x
      )
      select
        xyz.wal,
        xyz.is_rls_enabled,
        xyz.subscription_ids,
        xyz.errors
      from
        w2j,
        realtime.apply_rls(
          wal := w2j.data::jsonb,
          max_record_bytes := max_record_bytes
        ) xyz(wal, is_rls_enabled, subscription_ids, errors)
      where
        w2j.w2j_add_tables <> ''
        and xyz.subscription_ids[1] is not null
    $$;


ALTER FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) OWNER TO supabase_admin;

--
-- TOC entry 523 (class 1255 OID 17339)
-- Name: quote_wal2json(regclass); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.quote_wal2json(entity regclass) RETURNS text
    LANGUAGE sql IMMUTABLE STRICT
    AS $$
      select
        (
          select string_agg('' || ch,'')
          from unnest(string_to_array(nsp.nspname::text, null)) with ordinality x(ch, idx)
          where
            not (x.idx = 1 and x.ch = '"')
            and not (
              x.idx = array_length(string_to_array(nsp.nspname::text, null), 1)
              and x.ch = '"'
            )
        )
        || '.'
        || (
          select string_agg('' || ch,'')
          from unnest(string_to_array(pc.relname::text, null)) with ordinality x(ch, idx)
          where
            not (x.idx = 1 and x.ch = '"')
            and not (
              x.idx = array_length(string_to_array(nsp.nspname::text, null), 1)
              and x.ch = '"'
            )
          )
      from
        pg_class pc
        join pg_namespace nsp
          on pc.relnamespace = nsp.oid
      where
        pc.oid = entity
    $$;


ALTER FUNCTION realtime.quote_wal2json(entity regclass) OWNER TO supabase_admin;

--
-- TOC entry 438 (class 1255 OID 17461)
-- Name: send(jsonb, text, text, boolean); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean DEFAULT true) RETURNS void
    LANGUAGE plpgsql
    AS $$
DECLARE
  generated_id uuid;
  final_payload jsonb;
BEGIN
  BEGIN
    -- Generate a new UUID for the id
    generated_id := gen_random_uuid();

    -- Check if payload has an 'id' key, if not, add the generated UUID
    IF payload ? 'id' THEN
      final_payload := payload;
    ELSE
      final_payload := jsonb_set(payload, '{id}', to_jsonb(generated_id));
    END IF;

    -- Set the topic configuration
    EXECUTE format('SET LOCAL realtime.topic TO %L', topic);

    -- Attempt to insert the message
    INSERT INTO realtime.messages (id, payload, event, topic, private, extension)
    VALUES (generated_id, final_payload, event, topic, private, 'broadcast');
  EXCEPTION
    WHEN OTHERS THEN
      -- Capture and notify the error
      RAISE WARNING 'ErrorSendingBroadcastMessage: %', SQLERRM;
  END;
END;
$$;


ALTER FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean) OWNER TO supabase_admin;

--
-- TOC entry 435 (class 1255 OID 17337)
-- Name: subscription_check_filters(); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.subscription_check_filters() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
    /*
    Validates that the user defined filters for a subscription:
    - refer to valid columns that the claimed role may access
    - values are coercable to the correct column type
    */
    declare
        col_names text[] = coalesce(
                array_agg(c.column_name order by c.ordinal_position),
                '{}'::text[]
            )
            from
                information_schema.columns c
            where
                format('%I.%I', c.table_schema, c.table_name)::regclass = new.entity
                and pg_catalog.has_column_privilege(
                    (new.claims ->> 'role'),
                    format('%I.%I', c.table_schema, c.table_name)::regclass,
                    c.column_name,
                    'SELECT'
                );
        filter realtime.user_defined_filter;
        col_type regtype;

        in_val jsonb;
    begin
        for filter in select * from unnest(new.filters) loop
            -- Filtered column is valid
            if not filter.column_name = any(col_names) then
                raise exception 'invalid column for filter %', filter.column_name;
            end if;

            -- Type is sanitized and safe for string interpolation
            col_type = (
                select atttypid::regtype
                from pg_catalog.pg_attribute
                where attrelid = new.entity
                      and attname = filter.column_name
            );
            if col_type is null then
                raise exception 'failed to lookup type for column %', filter.column_name;
            end if;

            -- Set maximum number of entries for in filter
            if filter.op = 'in'::realtime.equality_op then
                in_val = realtime.cast(filter.value, (col_type::text || '[]')::regtype);
                if coalesce(jsonb_array_length(in_val), 0) > 100 then
                    raise exception 'too many values for `in` filter. Maximum 100';
                end if;
            else
                -- raises an exception if value is not coercable to type
                perform realtime.cast(filter.value, col_type);
            end if;

        end loop;

        -- Apply consistent order to filters so the unique constraint on
        -- (subscription_id, entity, filters) can't be tricked by a different filter order
        new.filters = coalesce(
            array_agg(f order by f.column_name, f.op, f.value),
            '{}'
        ) from unnest(new.filters) f;

        return new;
    end;
    $$;


ALTER FUNCTION realtime.subscription_check_filters() OWNER TO supabase_admin;

--
-- TOC entry 454 (class 1255 OID 17372)
-- Name: to_regrole(text); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.to_regrole(role_name text) RETURNS regrole
    LANGUAGE sql IMMUTABLE
    AS $$ select role_name::regrole $$;


ALTER FUNCTION realtime.to_regrole(role_name text) OWNER TO supabase_admin;

--
-- TOC entry 477 (class 1255 OID 17455)
-- Name: topic(); Type: FUNCTION; Schema: realtime; Owner: supabase_realtime_admin
--

CREATE FUNCTION realtime.topic() RETURNS text
    LANGUAGE sql STABLE
    AS $$
select nullif(current_setting('realtime.topic', true), '')::text;
$$;


ALTER FUNCTION realtime.topic() OWNER TO supabase_realtime_admin;

--
-- TOC entry 465 (class 1255 OID 17219)
-- Name: add_prefixes(text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.add_prefixes(_bucket_id text, _name text) RETURNS void
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    prefixes text[];
BEGIN
    prefixes := "storage"."get_prefixes"("_name");

    IF array_length(prefixes, 1) > 0 THEN
        INSERT INTO storage.prefixes (name, bucket_id)
        SELECT UNNEST(prefixes) as name, "_bucket_id" ON CONFLICT DO NOTHING;
    END IF;
END;
$$;


ALTER FUNCTION storage.add_prefixes(_bucket_id text, _name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 513 (class 1255 OID 17145)
-- Name: can_insert_object(text, text, uuid, jsonb); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.can_insert_object(bucketid text, name text, owner uuid, metadata jsonb) RETURNS void
    LANGUAGE plpgsql
    AS $$
BEGIN
  INSERT INTO "storage"."objects" ("bucket_id", "name", "owner", "metadata") VALUES (bucketid, name, owner, metadata);
  -- hack to rollback the successful insert
  RAISE sqlstate 'PT200' using
  message = 'ROLLBACK',
  detail = 'rollback successful insert';
END
$$;


ALTER FUNCTION storage.can_insert_object(bucketid text, name text, owner uuid, metadata jsonb) OWNER TO supabase_storage_admin;

--
-- TOC entry 452 (class 1255 OID 17259)
-- Name: delete_leaf_prefixes(text[], text[]); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.delete_leaf_prefixes(bucket_ids text[], names text[]) RETURNS void
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    v_rows_deleted integer;
BEGIN
    LOOP
        WITH candidates AS (
            SELECT DISTINCT
                t.bucket_id,
                unnest(storage.get_prefixes(t.name)) AS name
            FROM unnest(bucket_ids, names) AS t(bucket_id, name)
        ),
        uniq AS (
             SELECT
                 bucket_id,
                 name,
                 storage.get_level(name) AS level
             FROM candidates
             WHERE name <> ''
             GROUP BY bucket_id, name
        ),
        leaf AS (
             SELECT
                 p.bucket_id,
                 p.name,
                 p.level
             FROM storage.prefixes AS p
                  JOIN uniq AS u
                       ON u.bucket_id = p.bucket_id
                           AND u.name = p.name
                           AND u.level = p.level
             WHERE NOT EXISTS (
                 SELECT 1
                 FROM storage.objects AS o
                 WHERE o.bucket_id = p.bucket_id
                   AND o.level = p.level + 1
                   AND o.name COLLATE "C" LIKE p.name || '/%'
             )
             AND NOT EXISTS (
                 SELECT 1
                 FROM storage.prefixes AS c
                 WHERE c.bucket_id = p.bucket_id
                   AND c.level = p.level + 1
                   AND c.name COLLATE "C" LIKE p.name || '/%'
             )
        )
        DELETE
        FROM storage.prefixes AS p
            USING leaf AS l
        WHERE p.bucket_id = l.bucket_id
          AND p.name = l.name
          AND p.level = l.level;

        GET DIAGNOSTICS v_rows_deleted = ROW_COUNT;
        EXIT WHEN v_rows_deleted = 0;
    END LOOP;
END;
$$;


ALTER FUNCTION storage.delete_leaf_prefixes(bucket_ids text[], names text[]) OWNER TO supabase_storage_admin;

--
-- TOC entry 411 (class 1255 OID 17220)
-- Name: delete_prefix(text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.delete_prefix(_bucket_id text, _name text) RETURNS boolean
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
BEGIN
    -- Check if we can delete the prefix
    IF EXISTS(
        SELECT FROM "storage"."prefixes"
        WHERE "prefixes"."bucket_id" = "_bucket_id"
          AND level = "storage"."get_level"("_name") + 1
          AND "prefixes"."name" COLLATE "C" LIKE "_name" || '/%'
        LIMIT 1
    )
    OR EXISTS(
        SELECT FROM "storage"."objects"
        WHERE "objects"."bucket_id" = "_bucket_id"
          AND "storage"."get_level"("objects"."name") = "storage"."get_level"("_name") + 1
          AND "objects"."name" COLLATE "C" LIKE "_name" || '/%'
        LIMIT 1
    ) THEN
    -- There are sub-objects, skip deletion
    RETURN false;
    ELSE
        DELETE FROM "storage"."prefixes"
        WHERE "prefixes"."bucket_id" = "_bucket_id"
          AND level = "storage"."get_level"("_name")
          AND "prefixes"."name" = "_name";
        RETURN true;
    END IF;
END;
$$;


ALTER FUNCTION storage.delete_prefix(_bucket_id text, _name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 464 (class 1255 OID 17223)
-- Name: delete_prefix_hierarchy_trigger(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.delete_prefix_hierarchy_trigger() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
    prefix text;
BEGIN
    prefix := "storage"."get_prefix"(OLD."name");

    IF coalesce(prefix, '') != '' THEN
        PERFORM "storage"."delete_prefix"(OLD."bucket_id", prefix);
    END IF;

    RETURN OLD;
END;
$$;


ALTER FUNCTION storage.delete_prefix_hierarchy_trigger() OWNER TO supabase_storage_admin;

--
-- TOC entry 468 (class 1255 OID 17238)
-- Name: enforce_bucket_name_length(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.enforce_bucket_name_length() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
begin
    if length(new.name) > 100 then
        raise exception 'bucket name "%" is too long (% characters). Max is 100.', new.name, length(new.name);
    end if;
    return new;
end;
$$;


ALTER FUNCTION storage.enforce_bucket_name_length() OWNER TO supabase_storage_admin;

--
-- TOC entry 448 (class 1255 OID 17119)
-- Name: extension(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.extension(name text) RETURNS text
    LANGUAGE plpgsql IMMUTABLE
    AS $$
DECLARE
    _parts text[];
    _filename text;
BEGIN
    SELECT string_to_array(name, '/') INTO _parts;
    SELECT _parts[array_length(_parts,1)] INTO _filename;
    RETURN reverse(split_part(reverse(_filename), '.', 1));
END
$$;


ALTER FUNCTION storage.extension(name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 455 (class 1255 OID 17118)
-- Name: filename(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.filename(name text) RETURNS text
    LANGUAGE plpgsql
    AS $$
DECLARE
_parts text[];
BEGIN
	select string_to_array(name, '/') into _parts;
	return _parts[array_length(_parts,1)];
END
$$;


ALTER FUNCTION storage.filename(name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 516 (class 1255 OID 17117)
-- Name: foldername(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.foldername(name text) RETURNS text[]
    LANGUAGE plpgsql IMMUTABLE
    AS $$
DECLARE
    _parts text[];
BEGIN
    -- Split on "/" to get path segments
    SELECT string_to_array(name, '/') INTO _parts;
    -- Return everything except the last segment
    RETURN _parts[1 : array_length(_parts,1) - 1];
END
$$;


ALTER FUNCTION storage.foldername(name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 406 (class 1255 OID 17201)
-- Name: get_level(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.get_level(name text) RETURNS integer
    LANGUAGE sql IMMUTABLE STRICT
    AS $$
SELECT array_length(string_to_array("name", '/'), 1);
$$;


ALTER FUNCTION storage.get_level(name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 457 (class 1255 OID 17217)
-- Name: get_prefix(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.get_prefix(name text) RETURNS text
    LANGUAGE sql IMMUTABLE STRICT
    AS $_$
SELECT
    CASE WHEN strpos("name", '/') > 0 THEN
             regexp_replace("name", '[\/]{1}[^\/]+\/?$', '')
         ELSE
             ''
        END;
$_$;


ALTER FUNCTION storage.get_prefix(name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 450 (class 1255 OID 17218)
-- Name: get_prefixes(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.get_prefixes(name text) RETURNS text[]
    LANGUAGE plpgsql IMMUTABLE STRICT
    AS $$
DECLARE
    parts text[];
    prefixes text[];
    prefix text;
BEGIN
    -- Split the name into parts by '/'
    parts := string_to_array("name", '/');
    prefixes := '{}';

    -- Construct the prefixes, stopping one level below the last part
    FOR i IN 1..array_length(parts, 1) - 1 LOOP
            prefix := array_to_string(parts[1:i], '/');
            prefixes := array_append(prefixes, prefix);
    END LOOP;

    RETURN prefixes;
END;
$$;


ALTER FUNCTION storage.get_prefixes(name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 495 (class 1255 OID 17236)
-- Name: get_size_by_bucket(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.get_size_by_bucket() RETURNS TABLE(size bigint, bucket_id text)
    LANGUAGE plpgsql STABLE
    AS $$
BEGIN
    return query
        select sum((metadata->>'size')::bigint) as size, obj.bucket_id
        from "storage".objects as obj
        group by obj.bucket_id;
END
$$;


ALTER FUNCTION storage.get_size_by_bucket() OWNER TO supabase_storage_admin;

--
-- TOC entry 444 (class 1255 OID 17184)
-- Name: list_multipart_uploads_with_delimiter(text, text, text, integer, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.list_multipart_uploads_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer DEFAULT 100, next_key_token text DEFAULT ''::text, next_upload_token text DEFAULT ''::text) RETURNS TABLE(key text, id text, created_at timestamp with time zone)
    LANGUAGE plpgsql
    AS $_$
BEGIN
    RETURN QUERY EXECUTE
        'SELECT DISTINCT ON(key COLLATE "C") * from (
            SELECT
                CASE
                    WHEN position($2 IN substring(key from length($1) + 1)) > 0 THEN
                        substring(key from 1 for length($1) + position($2 IN substring(key from length($1) + 1)))
                    ELSE
                        key
                END AS key, id, created_at
            FROM
                storage.s3_multipart_uploads
            WHERE
                bucket_id = $5 AND
                key ILIKE $1 || ''%'' AND
                CASE
                    WHEN $4 != '''' AND $6 = '''' THEN
                        CASE
                            WHEN position($2 IN substring(key from length($1) + 1)) > 0 THEN
                                substring(key from 1 for length($1) + position($2 IN substring(key from length($1) + 1))) COLLATE "C" > $4
                            ELSE
                                key COLLATE "C" > $4
                            END
                    ELSE
                        true
                END AND
                CASE
                    WHEN $6 != '''' THEN
                        id COLLATE "C" > $6
                    ELSE
                        true
                    END
            ORDER BY
                key COLLATE "C" ASC, created_at ASC) as e order by key COLLATE "C" LIMIT $3'
        USING prefix_param, delimiter_param, max_keys, next_key_token, bucket_id, next_upload_token;
END;
$_$;


ALTER FUNCTION storage.list_multipart_uploads_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer, next_key_token text, next_upload_token text) OWNER TO supabase_storage_admin;

--
-- TOC entry 467 (class 1255 OID 17147)
-- Name: list_objects_with_delimiter(text, text, text, integer, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.list_objects_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer DEFAULT 100, start_after text DEFAULT ''::text, next_token text DEFAULT ''::text) RETURNS TABLE(name text, id uuid, metadata jsonb, updated_at timestamp with time zone)
    LANGUAGE plpgsql
    AS $_$
BEGIN
    RETURN QUERY EXECUTE
        'SELECT DISTINCT ON(name COLLATE "C") * from (
            SELECT
                CASE
                    WHEN position($2 IN substring(name from length($1) + 1)) > 0 THEN
                        substring(name from 1 for length($1) + position($2 IN substring(name from length($1) + 1)))
                    ELSE
                        name
                END AS name, id, metadata, updated_at
            FROM
                storage.objects
            WHERE
                bucket_id = $5 AND
                name ILIKE $1 || ''%'' AND
                CASE
                    WHEN $6 != '''' THEN
                    name COLLATE "C" > $6
                ELSE true END
                AND CASE
                    WHEN $4 != '''' THEN
                        CASE
                            WHEN position($2 IN substring(name from length($1) + 1)) > 0 THEN
                                substring(name from 1 for length($1) + position($2 IN substring(name from length($1) + 1))) COLLATE "C" > $4
                            ELSE
                                name COLLATE "C" > $4
                            END
                    ELSE
                        true
                END
            ORDER BY
                name COLLATE "C" ASC) as e order by name COLLATE "C" LIMIT $3'
        USING prefix_param, delimiter_param, max_keys, next_token, bucket_id, start_after;
END;
$_$;


ALTER FUNCTION storage.list_objects_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer, start_after text, next_token text) OWNER TO supabase_storage_admin;

--
-- TOC entry 458 (class 1255 OID 17258)
-- Name: lock_top_prefixes(text[], text[]); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.lock_top_prefixes(bucket_ids text[], names text[]) RETURNS void
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    v_bucket text;
    v_top text;
BEGIN
    FOR v_bucket, v_top IN
        SELECT DISTINCT t.bucket_id,
            split_part(t.name, '/', 1) AS top
        FROM unnest(bucket_ids, names) AS t(bucket_id, name)
        WHERE t.name <> ''
        ORDER BY 1, 2
        LOOP
            PERFORM pg_advisory_xact_lock(hashtextextended(v_bucket || '/' || v_top, 0));
        END LOOP;
END;
$$;


ALTER FUNCTION storage.lock_top_prefixes(bucket_ids text[], names text[]) OWNER TO supabase_storage_admin;

--
-- TOC entry 414 (class 1255 OID 17260)
-- Name: objects_delete_cleanup(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.objects_delete_cleanup() RETURNS trigger
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    v_bucket_ids text[];
    v_names      text[];
BEGIN
    IF current_setting('storage.gc.prefixes', true) = '1' THEN
        RETURN NULL;
    END IF;

    PERFORM set_config('storage.gc.prefixes', '1', true);

    SELECT COALESCE(array_agg(d.bucket_id), '{}'),
           COALESCE(array_agg(d.name), '{}')
    INTO v_bucket_ids, v_names
    FROM deleted AS d
    WHERE d.name <> '';

    PERFORM storage.lock_top_prefixes(v_bucket_ids, v_names);
    PERFORM storage.delete_leaf_prefixes(v_bucket_ids, v_names);

    RETURN NULL;
END;
$$;


ALTER FUNCTION storage.objects_delete_cleanup() OWNER TO supabase_storage_admin;

--
-- TOC entry 488 (class 1255 OID 17222)
-- Name: objects_insert_prefix_trigger(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.objects_insert_prefix_trigger() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    PERFORM "storage"."add_prefixes"(NEW."bucket_id", NEW."name");
    NEW.level := "storage"."get_level"(NEW."name");

    RETURN NEW;
END;
$$;


ALTER FUNCTION storage.objects_insert_prefix_trigger() OWNER TO supabase_storage_admin;

--
-- TOC entry 407 (class 1255 OID 17261)
-- Name: objects_update_cleanup(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.objects_update_cleanup() RETURNS trigger
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    -- NEW - OLD (destinations to create prefixes for)
    v_add_bucket_ids text[];
    v_add_names      text[];

    -- OLD - NEW (sources to prune)
    v_src_bucket_ids text[];
    v_src_names      text[];
BEGIN
    IF TG_OP <> 'UPDATE' THEN
        RETURN NULL;
    END IF;

    -- 1) Compute NEWâˆ’OLD (added paths) and OLDâˆ’NEW (moved-away paths)
    WITH added AS (
        SELECT n.bucket_id, n.name
        FROM new_rows n
        WHERE n.name <> '' AND position('/' in n.name) > 0
        EXCEPT
        SELECT o.bucket_id, o.name FROM old_rows o WHERE o.name <> ''
    ),
    moved AS (
         SELECT o.bucket_id, o.name
         FROM old_rows o
         WHERE o.name <> ''
         EXCEPT
         SELECT n.bucket_id, n.name FROM new_rows n WHERE n.name <> ''
    )
    SELECT
        -- arrays for ADDED (dest) in stable order
        COALESCE( (SELECT array_agg(a.bucket_id ORDER BY a.bucket_id, a.name) FROM added a), '{}' ),
        COALESCE( (SELECT array_agg(a.name      ORDER BY a.bucket_id, a.name) FROM added a), '{}' ),
        -- arrays for MOVED (src) in stable order
        COALESCE( (SELECT array_agg(m.bucket_id ORDER BY m.bucket_id, m.name) FROM moved m), '{}' ),
        COALESCE( (SELECT array_agg(m.name      ORDER BY m.bucket_id, m.name) FROM moved m), '{}' )
    INTO v_add_bucket_ids, v_add_names, v_src_bucket_ids, v_src_names;

    -- Nothing to do?
    IF (array_length(v_add_bucket_ids, 1) IS NULL) AND (array_length(v_src_bucket_ids, 1) IS NULL) THEN
        RETURN NULL;
    END IF;

    -- 2) Take per-(bucket, top) locks: ALL prefixes in consistent global order to prevent deadlocks
    DECLARE
        v_all_bucket_ids text[];
        v_all_names text[];
    BEGIN
        -- Combine source and destination arrays for consistent lock ordering
        v_all_bucket_ids := COALESCE(v_src_bucket_ids, '{}') || COALESCE(v_add_bucket_ids, '{}');
        v_all_names := COALESCE(v_src_names, '{}') || COALESCE(v_add_names, '{}');

        -- Single lock call ensures consistent global ordering across all transactions
        IF array_length(v_all_bucket_ids, 1) IS NOT NULL THEN
            PERFORM storage.lock_top_prefixes(v_all_bucket_ids, v_all_names);
        END IF;
    END;

    -- 3) Create destination prefixes (NEWâˆ’OLD) BEFORE pruning sources
    IF array_length(v_add_bucket_ids, 1) IS NOT NULL THEN
        WITH candidates AS (
            SELECT DISTINCT t.bucket_id, unnest(storage.get_prefixes(t.name)) AS name
            FROM unnest(v_add_bucket_ids, v_add_names) AS t(bucket_id, name)
            WHERE name <> ''
        )
        INSERT INTO storage.prefixes (bucket_id, name)
        SELECT c.bucket_id, c.name
        FROM candidates c
        ON CONFLICT DO NOTHING;
    END IF;

    -- 4) Prune source prefixes bottom-up for OLDâˆ’NEW
    IF array_length(v_src_bucket_ids, 1) IS NOT NULL THEN
        -- re-entrancy guard so DELETE on prefixes won't recurse
        IF current_setting('storage.gc.prefixes', true) <> '1' THEN
            PERFORM set_config('storage.gc.prefixes', '1', true);
        END IF;

        PERFORM storage.delete_leaf_prefixes(v_src_bucket_ids, v_src_names);
    END IF;

    RETURN NULL;
END;
$$;


ALTER FUNCTION storage.objects_update_cleanup() OWNER TO supabase_storage_admin;

--
-- TOC entry 502 (class 1255 OID 17266)
-- Name: objects_update_level_trigger(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.objects_update_level_trigger() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    -- Ensure this is an update operation and the name has changed
    IF TG_OP = 'UPDATE' AND (NEW."name" <> OLD."name" OR NEW."bucket_id" <> OLD."bucket_id") THEN
        -- Set the new level
        NEW."level" := "storage"."get_level"(NEW."name");
    END IF;
    RETURN NEW;
END;
$$;


ALTER FUNCTION storage.objects_update_level_trigger() OWNER TO supabase_storage_admin;

--
-- TOC entry 461 (class 1255 OID 17237)
-- Name: objects_update_prefix_trigger(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.objects_update_prefix_trigger() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
    old_prefixes TEXT[];
BEGIN
    -- Ensure this is an update operation and the name has changed
    IF TG_OP = 'UPDATE' AND (NEW."name" <> OLD."name" OR NEW."bucket_id" <> OLD."bucket_id") THEN
        -- Retrieve old prefixes
        old_prefixes := "storage"."get_prefixes"(OLD."name");

        -- Remove old prefixes that are only used by this object
        WITH all_prefixes as (
            SELECT unnest(old_prefixes) as prefix
        ),
        can_delete_prefixes as (
             SELECT prefix
             FROM all_prefixes
             WHERE NOT EXISTS (
                 SELECT 1 FROM "storage"."objects"
                 WHERE "bucket_id" = OLD."bucket_id"
                   AND "name" <> OLD."name"
                   AND "name" LIKE (prefix || '%')
             )
         )
        DELETE FROM "storage"."prefixes" WHERE name IN (SELECT prefix FROM can_delete_prefixes);

        -- Add new prefixes
        PERFORM "storage"."add_prefixes"(NEW."bucket_id", NEW."name");
    END IF;
    -- Set the new level
    NEW."level" := "storage"."get_level"(NEW."name");

    RETURN NEW;
END;
$$;


ALTER FUNCTION storage.objects_update_prefix_trigger() OWNER TO supabase_storage_admin;

--
-- TOC entry 427 (class 1255 OID 17200)
-- Name: operation(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.operation() RETURNS text
    LANGUAGE plpgsql STABLE
    AS $$
BEGIN
    RETURN current_setting('storage.operation', true);
END;
$$;


ALTER FUNCTION storage.operation() OWNER TO supabase_storage_admin;

--
-- TOC entry 472 (class 1255 OID 17262)
-- Name: prefixes_delete_cleanup(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.prefixes_delete_cleanup() RETURNS trigger
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    v_bucket_ids text[];
    v_names      text[];
BEGIN
    IF current_setting('storage.gc.prefixes', true) = '1' THEN
        RETURN NULL;
    END IF;

    PERFORM set_config('storage.gc.prefixes', '1', true);

    SELECT COALESCE(array_agg(d.bucket_id), '{}'),
           COALESCE(array_agg(d.name), '{}')
    INTO v_bucket_ids, v_names
    FROM deleted AS d
    WHERE d.name <> '';

    PERFORM storage.lock_top_prefixes(v_bucket_ids, v_names);
    PERFORM storage.delete_leaf_prefixes(v_bucket_ids, v_names);

    RETURN NULL;
END;
$$;


ALTER FUNCTION storage.prefixes_delete_cleanup() OWNER TO supabase_storage_admin;

--
-- TOC entry 475 (class 1255 OID 17221)
-- Name: prefixes_insert_trigger(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.prefixes_insert_trigger() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    PERFORM "storage"."add_prefixes"(NEW."bucket_id", NEW."name");
    RETURN NEW;
END;
$$;


ALTER FUNCTION storage.prefixes_insert_trigger() OWNER TO supabase_storage_admin;

--
-- TOC entry 480 (class 1255 OID 17134)
-- Name: search(text, text, integer, integer, integer, text, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.search(prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text) RETURNS TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
    LANGUAGE plpgsql
    AS $$
declare
    can_bypass_rls BOOLEAN;
begin
    SELECT rolbypassrls
    INTO can_bypass_rls
    FROM pg_roles
    WHERE rolname = coalesce(nullif(current_setting('role', true), 'none'), current_user);

    IF can_bypass_rls THEN
        RETURN QUERY SELECT * FROM storage.search_v1_optimised(prefix, bucketname, limits, levels, offsets, search, sortcolumn, sortorder);
    ELSE
        RETURN QUERY SELECT * FROM storage.search_legacy_v1(prefix, bucketname, limits, levels, offsets, search, sortcolumn, sortorder);
    END IF;
end;
$$;


ALTER FUNCTION storage.search(prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text) OWNER TO supabase_storage_admin;

--
-- TOC entry 497 (class 1255 OID 17234)
-- Name: search_legacy_v1(text, text, integer, integer, integer, text, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.search_legacy_v1(prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text) RETURNS TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
    LANGUAGE plpgsql STABLE
    AS $_$
declare
    v_order_by text;
    v_sort_order text;
begin
    case
        when sortcolumn = 'name' then
            v_order_by = 'name';
        when sortcolumn = 'updated_at' then
            v_order_by = 'updated_at';
        when sortcolumn = 'created_at' then
            v_order_by = 'created_at';
        when sortcolumn = 'last_accessed_at' then
            v_order_by = 'last_accessed_at';
        else
            v_order_by = 'name';
        end case;

    case
        when sortorder = 'asc' then
            v_sort_order = 'asc';
        when sortorder = 'desc' then
            v_sort_order = 'desc';
        else
            v_sort_order = 'asc';
        end case;

    v_order_by = v_order_by || ' ' || v_sort_order;

    return query execute
        'with folders as (
           select path_tokens[$1] as folder
           from storage.objects
             where objects.name ilike $2 || $3 || ''%''
               and bucket_id = $4
               and array_length(objects.path_tokens, 1) <> $1
           group by folder
           order by folder ' || v_sort_order || '
     )
     (select folder as "name",
            null as id,
            null as updated_at,
            null as created_at,
            null as last_accessed_at,
            null as metadata from folders)
     union all
     (select path_tokens[$1] as "name",
            id,
            updated_at,
            created_at,
            last_accessed_at,
            metadata
     from storage.objects
     where objects.name ilike $2 || $3 || ''%''
       and bucket_id = $4
       and array_length(objects.path_tokens, 1) = $1
     order by ' || v_order_by || ')
     limit $5
     offset $6' using levels, prefix, search, bucketname, limits, offsets;
end;
$_$;


ALTER FUNCTION storage.search_legacy_v1(prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text) OWNER TO supabase_storage_admin;

--
-- TOC entry 431 (class 1255 OID 17233)
-- Name: search_v1_optimised(text, text, integer, integer, integer, text, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.search_v1_optimised(prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text) RETURNS TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
    LANGUAGE plpgsql STABLE
    AS $_$
declare
    v_order_by text;
    v_sort_order text;
begin
    case
        when sortcolumn = 'name' then
            v_order_by = 'name';
        when sortcolumn = 'updated_at' then
            v_order_by = 'updated_at';
        when sortcolumn = 'created_at' then
            v_order_by = 'created_at';
        when sortcolumn = 'last_accessed_at' then
            v_order_by = 'last_accessed_at';
        else
            v_order_by = 'name';
        end case;

    case
        when sortorder = 'asc' then
            v_sort_order = 'asc';
        when sortorder = 'desc' then
            v_sort_order = 'desc';
        else
            v_sort_order = 'asc';
        end case;

    v_order_by = v_order_by || ' ' || v_sort_order;

    return query execute
        'with folders as (
           select (string_to_array(name, ''/''))[level] as name
           from storage.prefixes
             where lower(prefixes.name) like lower($2 || $3) || ''%''
               and bucket_id = $4
               and level = $1
           order by name ' || v_sort_order || '
     )
     (select name,
            null as id,
            null as updated_at,
            null as created_at,
            null as last_accessed_at,
            null as metadata from folders)
     union all
     (select path_tokens[level] as "name",
            id,
            updated_at,
            created_at,
            last_accessed_at,
            metadata
     from storage.objects
     where lower(objects.name) like lower($2 || $3) || ''%''
       and bucket_id = $4
       and level = $1
     order by ' || v_order_by || ')
     limit $5
     offset $6' using levels, prefix, search, bucketname, limits, offsets;
end;
$_$;


ALTER FUNCTION storage.search_v1_optimised(prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text) OWNER TO supabase_storage_admin;

--
-- TOC entry 491 (class 1255 OID 17257)
-- Name: search_v2(text, text, integer, integer, text, text, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.search_v2(prefix text, bucket_name text, limits integer DEFAULT 100, levels integer DEFAULT 1, start_after text DEFAULT ''::text, sort_order text DEFAULT 'asc'::text, sort_column text DEFAULT 'name'::text, sort_column_after text DEFAULT ''::text) RETURNS TABLE(key text, name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
    LANGUAGE plpgsql STABLE
    AS $_$
DECLARE
    sort_col text;
    sort_ord text;
    cursor_op text;
    cursor_expr text;
    sort_expr text;
BEGIN
    -- Validate sort_order
    sort_ord := lower(sort_order);
    IF sort_ord NOT IN ('asc', 'desc') THEN
        sort_ord := 'asc';
    END IF;

    -- Determine cursor comparison operator
    IF sort_ord = 'asc' THEN
        cursor_op := '>';
    ELSE
        cursor_op := '<';
    END IF;
    
    sort_col := lower(sort_column);
    -- Validate sort column  
    IF sort_col IN ('updated_at', 'created_at') THEN
        cursor_expr := format(
            '($5 = '''' OR ROW(date_trunc(''milliseconds'', %I), name COLLATE "C") %s ROW(COALESCE(NULLIF($6, '''')::timestamptz, ''epoch''::timestamptz), $5))',
            sort_col, cursor_op
        );
        sort_expr := format(
            'COALESCE(date_trunc(''milliseconds'', %I), ''epoch''::timestamptz) %s, name COLLATE "C" %s',
            sort_col, sort_ord, sort_ord
        );
    ELSE
        cursor_expr := format('($5 = '''' OR name COLLATE "C" %s $5)', cursor_op);
        sort_expr := format('name COLLATE "C" %s', sort_ord);
    END IF;

    RETURN QUERY EXECUTE format(
        $sql$
        SELECT * FROM (
            (
                SELECT
                    split_part(name, '/', $4) AS key,
                    name,
                    NULL::uuid AS id,
                    updated_at,
                    created_at,
                    NULL::timestamptz AS last_accessed_at,
                    NULL::jsonb AS metadata
                FROM storage.prefixes
                WHERE name COLLATE "C" LIKE $1 || '%%'
                    AND bucket_id = $2
                    AND level = $4
                    AND %s
                ORDER BY %s
                LIMIT $3
            )
            UNION ALL
            (
                SELECT
                    split_part(name, '/', $4) AS key,
                    name,
                    id,
                    updated_at,
                    created_at,
                    last_accessed_at,
                    metadata
                FROM storage.objects
                WHERE name COLLATE "C" LIKE $1 || '%%'
                    AND bucket_id = $2
                    AND level = $4
                    AND %s
                ORDER BY %s
                LIMIT $3
            )
        ) obj
        ORDER BY %s
        LIMIT $3
        $sql$,
        cursor_expr,    -- prefixes WHERE
        sort_expr,      -- prefixes ORDER BY
        cursor_expr,    -- objects WHERE
        sort_expr,      -- objects ORDER BY
        sort_expr       -- final ORDER BY
    )
    USING prefix, bucket_name, limits, levels, start_after, sort_column_after;
END;
$_$;


ALTER FUNCTION storage.search_v2(prefix text, bucket_name text, limits integer, levels integer, start_after text, sort_order text, sort_column text, sort_column_after text) OWNER TO supabase_storage_admin;

--
-- TOC entry 418 (class 1255 OID 17135)
-- Name: update_updated_at_column(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.update_updated_at_column() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    NEW.updated_at = now();
    RETURN NEW; 
END;
$$;


ALTER FUNCTION storage.update_updated_at_column() OWNER TO supabase_storage_admin;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- TOC entry 350 (class 1259 OID 16525)
-- Name: audit_log_entries; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.audit_log_entries (
    instance_id uuid,
    id uuid NOT NULL,
    payload json,
    created_at timestamp with time zone,
    ip_address character varying(64) DEFAULT ''::character varying NOT NULL
);


ALTER TABLE auth.audit_log_entries OWNER TO supabase_auth_admin;

--
-- TOC entry 4447 (class 0 OID 0)
-- Dependencies: 350
-- Name: TABLE audit_log_entries; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.audit_log_entries IS 'Auth: Audit trail for user actions.';


--
-- TOC entry 364 (class 1259 OID 16883)
-- Name: flow_state; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.flow_state (
    id uuid NOT NULL,
    user_id uuid,
    auth_code text NOT NULL,
    code_challenge_method auth.code_challenge_method NOT NULL,
    code_challenge text NOT NULL,
    provider_type text NOT NULL,
    provider_access_token text,
    provider_refresh_token text,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    authentication_method text NOT NULL,
    auth_code_issued_at timestamp with time zone
);


ALTER TABLE auth.flow_state OWNER TO supabase_auth_admin;

--
-- TOC entry 4449 (class 0 OID 0)
-- Dependencies: 364
-- Name: TABLE flow_state; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.flow_state IS 'stores metadata for pkce logins';


--
-- TOC entry 355 (class 1259 OID 16681)
-- Name: identities; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.identities (
    provider_id text NOT NULL,
    user_id uuid NOT NULL,
    identity_data jsonb NOT NULL,
    provider text NOT NULL,
    last_sign_in_at timestamp with time zone,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    email text GENERATED ALWAYS AS (lower((identity_data ->> 'email'::text))) STORED,
    id uuid DEFAULT gen_random_uuid() NOT NULL
);


ALTER TABLE auth.identities OWNER TO supabase_auth_admin;

--
-- TOC entry 4451 (class 0 OID 0)
-- Dependencies: 355
-- Name: TABLE identities; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.identities IS 'Auth: Stores identities associated to a user.';


--
-- TOC entry 4452 (class 0 OID 0)
-- Dependencies: 355
-- Name: COLUMN identities.email; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.identities.email IS 'Auth: Email is a generated column that references the optional email property in the identity_data';


--
-- TOC entry 349 (class 1259 OID 16518)
-- Name: instances; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.instances (
    id uuid NOT NULL,
    uuid uuid,
    raw_base_config text,
    created_at timestamp with time zone,
    updated_at timestamp with time zone
);


ALTER TABLE auth.instances OWNER TO supabase_auth_admin;

--
-- TOC entry 4454 (class 0 OID 0)
-- Dependencies: 349
-- Name: TABLE instances; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.instances IS 'Auth: Manages users across multiple sites.';


--
-- TOC entry 359 (class 1259 OID 16770)
-- Name: mfa_amr_claims; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.mfa_amr_claims (
    session_id uuid NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    authentication_method text NOT NULL,
    id uuid NOT NULL
);


ALTER TABLE auth.mfa_amr_claims OWNER TO supabase_auth_admin;

--
-- TOC entry 4456 (class 0 OID 0)
-- Dependencies: 359
-- Name: TABLE mfa_amr_claims; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.mfa_amr_claims IS 'auth: stores authenticator method reference claims for multi factor authentication';


--
-- TOC entry 358 (class 1259 OID 16758)
-- Name: mfa_challenges; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.mfa_challenges (
    id uuid NOT NULL,
    factor_id uuid NOT NULL,
    created_at timestamp with time zone NOT NULL,
    verified_at timestamp with time zone,
    ip_address inet NOT NULL,
    otp_code text,
    web_authn_session_data jsonb
);


ALTER TABLE auth.mfa_challenges OWNER TO supabase_auth_admin;

--
-- TOC entry 4458 (class 0 OID 0)
-- Dependencies: 358
-- Name: TABLE mfa_challenges; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.mfa_challenges IS 'auth: stores metadata about challenge requests made';


--
-- TOC entry 357 (class 1259 OID 16745)
-- Name: mfa_factors; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.mfa_factors (
    id uuid NOT NULL,
    user_id uuid NOT NULL,
    friendly_name text,
    factor_type auth.factor_type NOT NULL,
    status auth.factor_status NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    secret text,
    phone text,
    last_challenged_at timestamp with time zone,
    web_authn_credential jsonb,
    web_authn_aaguid uuid,
    last_webauthn_challenge_data jsonb
);


ALTER TABLE auth.mfa_factors OWNER TO supabase_auth_admin;

--
-- TOC entry 4460 (class 0 OID 0)
-- Dependencies: 357
-- Name: TABLE mfa_factors; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.mfa_factors IS 'auth: stores metadata about factors';


--
-- TOC entry 4461 (class 0 OID 0)
-- Dependencies: 357
-- Name: COLUMN mfa_factors.last_webauthn_challenge_data; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.mfa_factors.last_webauthn_challenge_data IS 'Stores the latest WebAuthn challenge data including attestation/assertion for customer verification';


--
-- TOC entry 367 (class 1259 OID 16995)
-- Name: oauth_authorizations; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.oauth_authorizations (
    id uuid NOT NULL,
    authorization_id text NOT NULL,
    client_id uuid NOT NULL,
    user_id uuid,
    redirect_uri text NOT NULL,
    scope text NOT NULL,
    state text,
    resource text,
    code_challenge text,
    code_challenge_method auth.code_challenge_method,
    response_type auth.oauth_response_type DEFAULT 'code'::auth.oauth_response_type NOT NULL,
    status auth.oauth_authorization_status DEFAULT 'pending'::auth.oauth_authorization_status NOT NULL,
    authorization_code text,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    expires_at timestamp with time zone DEFAULT (now() + '00:03:00'::interval) NOT NULL,
    approved_at timestamp with time zone,
    nonce text,
    CONSTRAINT oauth_authorizations_authorization_code_length CHECK ((char_length(authorization_code) <= 255)),
    CONSTRAINT oauth_authorizations_code_challenge_length CHECK ((char_length(code_challenge) <= 128)),
    CONSTRAINT oauth_authorizations_expires_at_future CHECK ((expires_at > created_at)),
    CONSTRAINT oauth_authorizations_nonce_length CHECK ((char_length(nonce) <= 255)),
    CONSTRAINT oauth_authorizations_redirect_uri_length CHECK ((char_length(redirect_uri) <= 2048)),
    CONSTRAINT oauth_authorizations_resource_length CHECK ((char_length(resource) <= 2048)),
    CONSTRAINT oauth_authorizations_scope_length CHECK ((char_length(scope) <= 4096)),
    CONSTRAINT oauth_authorizations_state_length CHECK ((char_length(state) <= 4096))
);


ALTER TABLE auth.oauth_authorizations OWNER TO supabase_auth_admin;

--
-- TOC entry 369 (class 1259 OID 17068)
-- Name: oauth_client_states; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.oauth_client_states (
    id uuid NOT NULL,
    provider_type text NOT NULL,
    code_verifier text,
    created_at timestamp with time zone NOT NULL
);


ALTER TABLE auth.oauth_client_states OWNER TO supabase_auth_admin;

--
-- TOC entry 4464 (class 0 OID 0)
-- Dependencies: 369
-- Name: TABLE oauth_client_states; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.oauth_client_states IS 'Stores OAuth states for third-party provider authentication flows where Supabase acts as the OAuth client.';


--
-- TOC entry 366 (class 1259 OID 16965)
-- Name: oauth_clients; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.oauth_clients (
    id uuid NOT NULL,
    client_secret_hash text,
    registration_type auth.oauth_registration_type NOT NULL,
    redirect_uris text NOT NULL,
    grant_types text NOT NULL,
    client_name text,
    client_uri text,
    logo_uri text,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    updated_at timestamp with time zone DEFAULT now() NOT NULL,
    deleted_at timestamp with time zone,
    client_type auth.oauth_client_type DEFAULT 'confidential'::auth.oauth_client_type NOT NULL,
    CONSTRAINT oauth_clients_client_name_length CHECK ((char_length(client_name) <= 1024)),
    CONSTRAINT oauth_clients_client_uri_length CHECK ((char_length(client_uri) <= 2048)),
    CONSTRAINT oauth_clients_logo_uri_length CHECK ((char_length(logo_uri) <= 2048))
);


ALTER TABLE auth.oauth_clients OWNER TO supabase_auth_admin;

--
-- TOC entry 368 (class 1259 OID 17028)
-- Name: oauth_consents; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.oauth_consents (
    id uuid NOT NULL,
    user_id uuid NOT NULL,
    client_id uuid NOT NULL,
    scopes text NOT NULL,
    granted_at timestamp with time zone DEFAULT now() NOT NULL,
    revoked_at timestamp with time zone,
    CONSTRAINT oauth_consents_revoked_after_granted CHECK (((revoked_at IS NULL) OR (revoked_at >= granted_at))),
    CONSTRAINT oauth_consents_scopes_length CHECK ((char_length(scopes) <= 2048)),
    CONSTRAINT oauth_consents_scopes_not_empty CHECK ((char_length(TRIM(BOTH FROM scopes)) > 0))
);


ALTER TABLE auth.oauth_consents OWNER TO supabase_auth_admin;

--
-- TOC entry 365 (class 1259 OID 16933)
-- Name: one_time_tokens; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.one_time_tokens (
    id uuid NOT NULL,
    user_id uuid NOT NULL,
    token_type auth.one_time_token_type NOT NULL,
    token_hash text NOT NULL,
    relates_to text NOT NULL,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone DEFAULT now() NOT NULL,
    CONSTRAINT one_time_tokens_token_hash_check CHECK ((char_length(token_hash) > 0))
);


ALTER TABLE auth.one_time_tokens OWNER TO supabase_auth_admin;

--
-- TOC entry 348 (class 1259 OID 16507)
-- Name: refresh_tokens; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.refresh_tokens (
    instance_id uuid,
    id bigint NOT NULL,
    token character varying(255),
    user_id character varying(255),
    revoked boolean,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    parent character varying(255),
    session_id uuid
);


ALTER TABLE auth.refresh_tokens OWNER TO supabase_auth_admin;

--
-- TOC entry 4469 (class 0 OID 0)
-- Dependencies: 348
-- Name: TABLE refresh_tokens; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.refresh_tokens IS 'Auth: Store of tokens used to refresh JWT tokens once they expire.';


--
-- TOC entry 347 (class 1259 OID 16506)
-- Name: refresh_tokens_id_seq; Type: SEQUENCE; Schema: auth; Owner: supabase_auth_admin
--

CREATE SEQUENCE auth.refresh_tokens_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE auth.refresh_tokens_id_seq OWNER TO supabase_auth_admin;

--
-- TOC entry 4471 (class 0 OID 0)
-- Dependencies: 347
-- Name: refresh_tokens_id_seq; Type: SEQUENCE OWNED BY; Schema: auth; Owner: supabase_auth_admin
--

ALTER SEQUENCE auth.refresh_tokens_id_seq OWNED BY auth.refresh_tokens.id;


--
-- TOC entry 362 (class 1259 OID 16812)
-- Name: saml_providers; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.saml_providers (
    id uuid NOT NULL,
    sso_provider_id uuid NOT NULL,
    entity_id text NOT NULL,
    metadata_xml text NOT NULL,
    metadata_url text,
    attribute_mapping jsonb,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    name_id_format text,
    CONSTRAINT "entity_id not empty" CHECK ((char_length(entity_id) > 0)),
    CONSTRAINT "metadata_url not empty" CHECK (((metadata_url = NULL::text) OR (char_length(metadata_url) > 0))),
    CONSTRAINT "metadata_xml not empty" CHECK ((char_length(metadata_xml) > 0))
);


ALTER TABLE auth.saml_providers OWNER TO supabase_auth_admin;

--
-- TOC entry 4473 (class 0 OID 0)
-- Dependencies: 362
-- Name: TABLE saml_providers; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.saml_providers IS 'Auth: Manages SAML Identity Provider connections.';


--
-- TOC entry 363 (class 1259 OID 16830)
-- Name: saml_relay_states; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.saml_relay_states (
    id uuid NOT NULL,
    sso_provider_id uuid NOT NULL,
    request_id text NOT NULL,
    for_email text,
    redirect_to text,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    flow_state_id uuid,
    CONSTRAINT "request_id not empty" CHECK ((char_length(request_id) > 0))
);


ALTER TABLE auth.saml_relay_states OWNER TO supabase_auth_admin;

--
-- TOC entry 4475 (class 0 OID 0)
-- Dependencies: 363
-- Name: TABLE saml_relay_states; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.saml_relay_states IS 'Auth: Contains SAML Relay State information for each Service Provider initiated login.';


--
-- TOC entry 351 (class 1259 OID 16533)
-- Name: schema_migrations; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.schema_migrations (
    version character varying(255) NOT NULL
);


ALTER TABLE auth.schema_migrations OWNER TO supabase_auth_admin;

--
-- TOC entry 4477 (class 0 OID 0)
-- Dependencies: 351
-- Name: TABLE schema_migrations; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.schema_migrations IS 'Auth: Manages updates to the auth system.';


--
-- TOC entry 356 (class 1259 OID 16711)
-- Name: sessions; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.sessions (
    id uuid NOT NULL,
    user_id uuid NOT NULL,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    factor_id uuid,
    aal auth.aal_level,
    not_after timestamp with time zone,
    refreshed_at timestamp without time zone,
    user_agent text,
    ip inet,
    tag text,
    oauth_client_id uuid,
    refresh_token_hmac_key text,
    refresh_token_counter bigint,
    scopes text,
    CONSTRAINT sessions_scopes_length CHECK ((char_length(scopes) <= 4096))
);


ALTER TABLE auth.sessions OWNER TO supabase_auth_admin;

--
-- TOC entry 4479 (class 0 OID 0)
-- Dependencies: 356
-- Name: TABLE sessions; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.sessions IS 'Auth: Stores session data associated to a user.';


--
-- TOC entry 4480 (class 0 OID 0)
-- Dependencies: 356
-- Name: COLUMN sessions.not_after; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.sessions.not_after IS 'Auth: Not after is a nullable column that contains a timestamp after which the session should be regarded as expired.';


--
-- TOC entry 4481 (class 0 OID 0)
-- Dependencies: 356
-- Name: COLUMN sessions.refresh_token_hmac_key; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.sessions.refresh_token_hmac_key IS 'Holds a HMAC-SHA256 key used to sign refresh tokens for this session.';


--
-- TOC entry 4482 (class 0 OID 0)
-- Dependencies: 356
-- Name: COLUMN sessions.refresh_token_counter; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.sessions.refresh_token_counter IS 'Holds the ID (counter) of the last issued refresh token.';


--
-- TOC entry 361 (class 1259 OID 16797)
-- Name: sso_domains; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.sso_domains (
    id uuid NOT NULL,
    sso_provider_id uuid NOT NULL,
    domain text NOT NULL,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    CONSTRAINT "domain not empty" CHECK ((char_length(domain) > 0))
);


ALTER TABLE auth.sso_domains OWNER TO supabase_auth_admin;

--
-- TOC entry 4484 (class 0 OID 0)
-- Dependencies: 361
-- Name: TABLE sso_domains; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.sso_domains IS 'Auth: Manages SSO email address domain mapping to an SSO Identity Provider.';


--
-- TOC entry 360 (class 1259 OID 16788)
-- Name: sso_providers; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.sso_providers (
    id uuid NOT NULL,
    resource_id text,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    disabled boolean,
    CONSTRAINT "resource_id not empty" CHECK (((resource_id = NULL::text) OR (char_length(resource_id) > 0)))
);


ALTER TABLE auth.sso_providers OWNER TO supabase_auth_admin;

--
-- TOC entry 4486 (class 0 OID 0)
-- Dependencies: 360
-- Name: TABLE sso_providers; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.sso_providers IS 'Auth: Manages SSO identity provider information; see saml_providers for SAML.';


--
-- TOC entry 4487 (class 0 OID 0)
-- Dependencies: 360
-- Name: COLUMN sso_providers.resource_id; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.sso_providers.resource_id IS 'Auth: Uniquely identifies a SSO provider according to a user-chosen resource ID (case insensitive), useful in infrastructure as code.';


--
-- TOC entry 346 (class 1259 OID 16495)
-- Name: users; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.users (
    instance_id uuid,
    id uuid NOT NULL,
    aud character varying(255),
    role character varying(255),
    email character varying(255),
    encrypted_password character varying(255),
    email_confirmed_at timestamp with time zone,
    invited_at timestamp with time zone,
    confirmation_token character varying(255),
    confirmation_sent_at timestamp with time zone,
    recovery_token character varying(255),
    recovery_sent_at timestamp with time zone,
    email_change_token_new character varying(255),
    email_change character varying(255),
    email_change_sent_at timestamp with time zone,
    last_sign_in_at timestamp with time zone,
    raw_app_meta_data jsonb,
    raw_user_meta_data jsonb,
    is_super_admin boolean,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    phone text DEFAULT NULL::character varying,
    phone_confirmed_at timestamp with time zone,
    phone_change text DEFAULT ''::character varying,
    phone_change_token character varying(255) DEFAULT ''::character varying,
    phone_change_sent_at timestamp with time zone,
    confirmed_at timestamp with time zone GENERATED ALWAYS AS (LEAST(email_confirmed_at, phone_confirmed_at)) STORED,
    email_change_token_current character varying(255) DEFAULT ''::character varying,
    email_change_confirm_status smallint DEFAULT 0,
    banned_until timestamp with time zone,
    reauthentication_token character varying(255) DEFAULT ''::character varying,
    reauthentication_sent_at timestamp with time zone,
    is_sso_user boolean DEFAULT false NOT NULL,
    deleted_at timestamp with time zone,
    is_anonymous boolean DEFAULT false NOT NULL,
    CONSTRAINT users_email_change_confirm_status_check CHECK (((email_change_confirm_status >= 0) AND (email_change_confirm_status <= 2)))
);


ALTER TABLE auth.users OWNER TO supabase_auth_admin;

--
-- TOC entry 4489 (class 0 OID 0)
-- Dependencies: 346
-- Name: TABLE users; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.users IS 'Auth: Stores user login data within a secure schema.';


--
-- TOC entry 4490 (class 0 OID 0)
-- Dependencies: 346
-- Name: COLUMN users.is_sso_user; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.users.is_sso_user IS 'Auth: Set this column to true when the account comes from SSO. These accounts can have duplicate emails.';


--
-- TOC entry 390 (class 1259 OID 17524)
-- Name: applications; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.applications (
    id bigint NOT NULL,
    created_at timestamp with time zone DEFAULT now(),
    "jobId" bigint,
    name text,
    email text,
    phone text,
    linkedin text,
    status text DEFAULT 'new'::text,
    "tenantId" uuid,
    form_data jsonb,
    resume_url text,
    evaluation jsonb DEFAULT '{}'::jsonb,
    score_general numeric(5,2) DEFAULT 0,
    is_hired boolean DEFAULT false,
    hired_at timestamp with time zone,
    "candidateId" uuid,
    "formData" jsonb,
    "resumeUrl" text,
    "isHired" boolean DEFAULT false,
    "hiredAt" timestamp with time zone
);


ALTER TABLE public.applications OWNER TO postgres;

--
-- TOC entry 389 (class 1259 OID 17523)
-- Name: applications_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.applications ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.applications_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 395 (class 1259 OID 19435)
-- Name: candidates; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.candidates (
    id uuid DEFAULT extensions.uuid_generate_v4() NOT NULL,
    name text NOT NULL,
    email text NOT NULL,
    phone text,
    city text,
    state text,
    linkedin_profile text,
    github_profile text,
    resume_url text,
    created_at timestamp with time zone DEFAULT now(),
    updated_at timestamp with time zone DEFAULT now()
);


ALTER TABLE public.candidates OWNER TO postgres;

--
-- TOC entry 398 (class 1259 OID 22968)
-- Name: company_departments; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.company_departments (
    id bigint NOT NULL,
    created_at timestamp with time zone DEFAULT timezone('utc'::text, now()) NOT NULL,
    name text NOT NULL,
    "tenantId" uuid
);


ALTER TABLE public.company_departments OWNER TO postgres;

--
-- TOC entry 397 (class 1259 OID 22967)
-- Name: company_departments_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.company_departments ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.company_departments_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 393 (class 1259 OID 17781)
-- Name: evaluation_assignments_v2; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.evaluation_assignments_v2 (
    id uuid DEFAULT extensions.uuid_generate_v4() NOT NULL,
    application_id bigint NOT NULL,
    evaluator_id uuid NOT NULL,
    status text DEFAULT 'pending'::text,
    created_at timestamp with time zone DEFAULT now()
);


ALTER TABLE public.evaluation_assignments_v2 OWNER TO postgres;

--
-- TOC entry 396 (class 1259 OID 22939)
-- Name: evaluations; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.evaluations (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    application_id bigint NOT NULL,
    evaluator_id uuid NOT NULL,
    scores jsonb DEFAULT '{}'::jsonb,
    notes text,
    final_score numeric(5,2),
    created_at timestamp with time zone DEFAULT timezone('utc'::text, now()) NOT NULL
);


ALTER TABLE public.evaluations OWNER TO postgres;

--
-- TOC entry 388 (class 1259 OID 17508)
-- Name: jobs; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.jobs (
    id bigint NOT NULL,
    created_at timestamp with time zone DEFAULT now(),
    title text NOT NULL,
    status text DEFAULT 'active'::text,
    "tenantId" uuid NOT NULL,
    parameters jsonb DEFAULT '{"notas": [], "cultura": [], "tecnico": [], "triagem": []}'::jsonb,
    "createdBy" uuid,
    description text,
    requirements text,
    type text DEFAULT 'CLT'::text,
    location_type text DEFAULT 'HÃ­brido'::text,
    company_department_id bigint
);


ALTER TABLE public.jobs OWNER TO postgres;

--
-- TOC entry 387 (class 1259 OID 17507)
-- Name: jobs_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.jobs ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.jobs_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 394 (class 1259 OID 19187)
-- Name: plans; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.plans (
    id text NOT NULL,
    name text NOT NULL,
    price numeric(10,2) DEFAULT 0,
    user_limit integer DEFAULT 1,
    job_limit integer DEFAULT 1,
    candidate_limit integer DEFAULT 50
);


ALTER TABLE public.plans OWNER TO postgres;

--
-- TOC entry 391 (class 1259 OID 17751)
-- Name: tenants; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tenants (
    id uuid DEFAULT extensions.uuid_generate_v4() NOT NULL,
    "companyName" text NOT NULL,
    cnpj text,
    "planId" text DEFAULT 'freemium'::text,
    created_at timestamp with time zone DEFAULT now()
);


ALTER TABLE public.tenants OWNER TO postgres;

--
-- TOC entry 392 (class 1259 OID 17761)
-- Name: user_profiles; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.user_profiles (
    id uuid NOT NULL,
    "tenantId" uuid,
    name text,
    email text,
    role text DEFAULT 'rh'::text,
    is_admin_system boolean DEFAULT false,
    created_at timestamp with time zone DEFAULT now(),
    active boolean DEFAULT true
);


ALTER TABLE public.user_profiles OWNER TO postgres;

--
-- TOC entry 399 (class 1259 OID 34251)
-- Name: user_tenants; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.user_tenants (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    user_id uuid NOT NULL,
    tenant_id uuid NOT NULL,
    role text DEFAULT 'member'::text,
    created_at timestamp with time zone DEFAULT now()
);


ALTER TABLE public.user_tenants OWNER TO postgres;

--
-- TOC entry 386 (class 1259 OID 17482)
-- Name: users; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.users (
    id uuid NOT NULL,
    email text,
    "tenantId" uuid NOT NULL,
    "isAdmin" boolean DEFAULT false,
    role text DEFAULT 'recruiter'::text,
    status text DEFAULT 'active'::text,
    name text
);


ALTER TABLE public.users OWNER TO postgres;

--
-- TOC entry 385 (class 1259 OID 17465)
-- Name: messages; Type: TABLE; Schema: realtime; Owner: supabase_realtime_admin
--

CREATE TABLE realtime.messages (
    topic text NOT NULL,
    extension text NOT NULL,
    payload jsonb,
    event text,
    private boolean DEFAULT false,
    updated_at timestamp without time zone DEFAULT now() NOT NULL,
    inserted_at timestamp without time zone DEFAULT now() NOT NULL,
    id uuid DEFAULT gen_random_uuid() NOT NULL
)
PARTITION BY RANGE (inserted_at);


ALTER TABLE realtime.messages OWNER TO supabase_realtime_admin;

--
-- TOC entry 370 (class 1259 OID 17076)
-- Name: schema_migrations; Type: TABLE; Schema: realtime; Owner: supabase_admin
--

CREATE TABLE realtime.schema_migrations (
    version bigint NOT NULL,
    inserted_at timestamp(0) without time zone
);


ALTER TABLE realtime.schema_migrations OWNER TO supabase_admin;

--
-- TOC entry 382 (class 1259 OID 17325)
-- Name: subscription; Type: TABLE; Schema: realtime; Owner: supabase_admin
--

CREATE TABLE realtime.subscription (
    id bigint NOT NULL,
    subscription_id uuid NOT NULL,
    entity regclass NOT NULL,
    filters realtime.user_defined_filter[] DEFAULT '{}'::realtime.user_defined_filter[] NOT NULL,
    claims jsonb NOT NULL,
    claims_role regrole GENERATED ALWAYS AS (realtime.to_regrole((claims ->> 'role'::text))) STORED NOT NULL,
    created_at timestamp without time zone DEFAULT timezone('utc'::text, now()) NOT NULL
);


ALTER TABLE realtime.subscription OWNER TO supabase_admin;

--
-- TOC entry 381 (class 1259 OID 17324)
-- Name: subscription_id_seq; Type: SEQUENCE; Schema: realtime; Owner: supabase_admin
--

ALTER TABLE realtime.subscription ALTER COLUMN id ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME realtime.subscription_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 372 (class 1259 OID 17089)
-- Name: buckets; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.buckets (
    id text NOT NULL,
    name text NOT NULL,
    owner uuid,
    created_at timestamp with time zone DEFAULT now(),
    updated_at timestamp with time zone DEFAULT now(),
    public boolean DEFAULT false,
    avif_autodetection boolean DEFAULT false,
    file_size_limit bigint,
    allowed_mime_types text[],
    owner_id text,
    type storage.buckettype DEFAULT 'STANDARD'::storage.buckettype NOT NULL
);


ALTER TABLE storage.buckets OWNER TO supabase_storage_admin;

--
-- TOC entry 4512 (class 0 OID 0)
-- Dependencies: 372
-- Name: COLUMN buckets.owner; Type: COMMENT; Schema: storage; Owner: supabase_storage_admin
--

COMMENT ON COLUMN storage.buckets.owner IS 'Field is deprecated, use owner_id instead';


--
-- TOC entry 377 (class 1259 OID 17246)
-- Name: buckets_analytics; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.buckets_analytics (
    name text NOT NULL,
    type storage.buckettype DEFAULT 'ANALYTICS'::storage.buckettype NOT NULL,
    format text DEFAULT 'ICEBERG'::text NOT NULL,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    updated_at timestamp with time zone DEFAULT now() NOT NULL,
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    deleted_at timestamp with time zone
);


ALTER TABLE storage.buckets_analytics OWNER TO supabase_storage_admin;

--
-- TOC entry 378 (class 1259 OID 17273)
-- Name: buckets_vectors; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.buckets_vectors (
    id text NOT NULL,
    type storage.buckettype DEFAULT 'VECTOR'::storage.buckettype NOT NULL,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    updated_at timestamp with time zone DEFAULT now() NOT NULL
);


ALTER TABLE storage.buckets_vectors OWNER TO supabase_storage_admin;

--
-- TOC entry 371 (class 1259 OID 17081)
-- Name: migrations; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.migrations (
    id integer NOT NULL,
    name character varying(100) NOT NULL,
    hash character varying(40) NOT NULL,
    executed_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE storage.migrations OWNER TO supabase_storage_admin;

--
-- TOC entry 373 (class 1259 OID 17099)
-- Name: objects; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.objects (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    bucket_id text,
    name text,
    owner uuid,
    created_at timestamp with time zone DEFAULT now(),
    updated_at timestamp with time zone DEFAULT now(),
    last_accessed_at timestamp with time zone DEFAULT now(),
    metadata jsonb,
    path_tokens text[] GENERATED ALWAYS AS (string_to_array(name, '/'::text)) STORED,
    version text,
    owner_id text,
    user_metadata jsonb,
    level integer
);


ALTER TABLE storage.objects OWNER TO supabase_storage_admin;

--
-- TOC entry 4516 (class 0 OID 0)
-- Dependencies: 373
-- Name: COLUMN objects.owner; Type: COMMENT; Schema: storage; Owner: supabase_storage_admin
--

COMMENT ON COLUMN storage.objects.owner IS 'Field is deprecated, use owner_id instead';


--
-- TOC entry 376 (class 1259 OID 17202)
-- Name: prefixes; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.prefixes (
    bucket_id text NOT NULL,
    name text NOT NULL COLLATE pg_catalog."C",
    level integer GENERATED ALWAYS AS (storage.get_level(name)) STORED NOT NULL,
    created_at timestamp with time zone DEFAULT now(),
    updated_at timestamp with time zone DEFAULT now()
);


ALTER TABLE storage.prefixes OWNER TO supabase_storage_admin;

--
-- TOC entry 374 (class 1259 OID 17149)
-- Name: s3_multipart_uploads; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.s3_multipart_uploads (
    id text NOT NULL,
    in_progress_size bigint DEFAULT 0 NOT NULL,
    upload_signature text NOT NULL,
    bucket_id text NOT NULL,
    key text NOT NULL COLLATE pg_catalog."C",
    version text NOT NULL,
    owner_id text,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    user_metadata jsonb
);


ALTER TABLE storage.s3_multipart_uploads OWNER TO supabase_storage_admin;

--
-- TOC entry 375 (class 1259 OID 17163)
-- Name: s3_multipart_uploads_parts; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.s3_multipart_uploads_parts (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    upload_id text NOT NULL,
    size bigint DEFAULT 0 NOT NULL,
    part_number integer NOT NULL,
    bucket_id text NOT NULL,
    key text NOT NULL COLLATE pg_catalog."C",
    etag text NOT NULL,
    owner_id text,
    version text NOT NULL,
    created_at timestamp with time zone DEFAULT now() NOT NULL
);


ALTER TABLE storage.s3_multipart_uploads_parts OWNER TO supabase_storage_admin;

--
-- TOC entry 379 (class 1259 OID 17283)
-- Name: vector_indexes; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.vector_indexes (
    id text DEFAULT gen_random_uuid() NOT NULL,
    name text NOT NULL COLLATE pg_catalog."C",
    bucket_id text NOT NULL,
    data_type text NOT NULL,
    dimension integer NOT NULL,
    distance_metric text NOT NULL,
    metadata_configuration jsonb,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    updated_at timestamp with time zone DEFAULT now() NOT NULL
);


ALTER TABLE storage.vector_indexes OWNER TO supabase_storage_admin;

--
-- TOC entry 3731 (class 2604 OID 16510)
-- Name: refresh_tokens id; Type: DEFAULT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.refresh_tokens ALTER COLUMN id SET DEFAULT nextval('auth.refresh_tokens_id_seq'::regclass);


--
-- TOC entry 4299 (class 0 OID 16525)
-- Dependencies: 350
-- Data for Name: audit_log_entries; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4310 (class 0 OID 16883)
-- Dependencies: 364
-- Data for Name: flow_state; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4301 (class 0 OID 16681)
-- Dependencies: 355
-- Data for Name: identities; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.identities (provider_id, user_id, identity_data, provider, last_sign_in_at, created_at, updated_at, id) VALUES ('631e295b-b7e9-4d8a-9d05-79898cef103f', '631e295b-b7e9-4d8a-9d05-79898cef103f', '{"sub": "631e295b-b7e9-4d8a-9d05-79898cef103f", "email": "eider@novvaempresa.com.br", "email_verified": false, "phone_verified": false}', 'email', '2025-12-19 11:53:04.762229+00', '2025-12-19 11:53:04.762296+00', '2025-12-19 11:53:04.762296+00', '65504b38-12f5-4743-9a63-34ee59b94c56');
INSERT INTO auth.identities (provider_id, user_id, identity_data, provider, last_sign_in_at, created_at, updated_at, id) VALUES ('e7dacb55-defb-4eee-b8ec-6d22a7cd67cb', 'e7dacb55-defb-4eee-b8ec-6d22a7cd67cb', '{"sub": "e7dacb55-defb-4eee-b8ec-6d22a7cd67cb", "email": "emilia@serhumanobr.com.br", "email_verified": true, "phone_verified": false}', 'email', '2026-01-02 19:21:22.434404+00', '2026-01-02 19:21:22.435962+00', '2026-01-02 19:21:22.435962+00', '9ae3fd09-0526-40b3-b90e-73b1d78c5080');


--
-- TOC entry 4298 (class 0 OID 16518)
-- Dependencies: 349
-- Data for Name: instances; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4305 (class 0 OID 16770)
-- Dependencies: 359
-- Data for Name: mfa_amr_claims; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.mfa_amr_claims (session_id, created_at, updated_at, authentication_method, id) VALUES ('cd538032-1493-4133-921f-8eac82f5ee45', '2026-01-04 18:28:37.990963+00', '2026-01-04 18:28:37.990963+00', 'password', '915c6600-54ef-49e3-bb32-547baf43fcb3');


--
-- TOC entry 4304 (class 0 OID 16758)
-- Dependencies: 358
-- Data for Name: mfa_challenges; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4303 (class 0 OID 16745)
-- Dependencies: 357
-- Data for Name: mfa_factors; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4313 (class 0 OID 16995)
-- Dependencies: 367
-- Data for Name: oauth_authorizations; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4315 (class 0 OID 17068)
-- Dependencies: 369
-- Data for Name: oauth_client_states; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4312 (class 0 OID 16965)
-- Dependencies: 366
-- Data for Name: oauth_clients; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4314 (class 0 OID 17028)
-- Dependencies: 368
-- Data for Name: oauth_consents; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4311 (class 0 OID 16933)
-- Dependencies: 365
-- Data for Name: one_time_tokens; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.one_time_tokens (id, user_id, token_type, token_hash, relates_to, created_at, updated_at) VALUES ('059a440f-3146-4697-898e-4d04b79e7ee0', '631e295b-b7e9-4d8a-9d05-79898cef103f', 'recovery_token', 'c036d2399be60156fe727c4952a6a1aa119c2c478ebecf8c107fc604', 'eider@novvaempresa.com.br', '2025-12-19 12:13:28.337693', '2025-12-19 12:13:28.337693');


--
-- TOC entry 4297 (class 0 OID 16507)
-- Dependencies: 348
-- Data for Name: refresh_tokens; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.refresh_tokens (instance_id, id, token, user_id, revoked, created_at, updated_at, parent, session_id) VALUES ('00000000-0000-0000-0000-000000000000', 178, '5t7sekj4s4yt', '631e295b-b7e9-4d8a-9d05-79898cef103f', false, '2026-01-04 18:28:37.982108+00', '2026-01-04 18:28:37.982108+00', NULL, 'cd538032-1493-4133-921f-8eac82f5ee45');


--
-- TOC entry 4308 (class 0 OID 16812)
-- Dependencies: 362
-- Data for Name: saml_providers; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4309 (class 0 OID 16830)
-- Dependencies: 363
-- Data for Name: saml_relay_states; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4300 (class 0 OID 16533)
-- Dependencies: 351
-- Data for Name: schema_migrations; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.schema_migrations (version) VALUES ('20171026211738');
INSERT INTO auth.schema_migrations (version) VALUES ('20171026211808');
INSERT INTO auth.schema_migrations (version) VALUES ('20171026211834');
INSERT INTO auth.schema_migrations (version) VALUES ('20180103212743');
INSERT INTO auth.schema_migrations (version) VALUES ('20180108183307');
INSERT INTO auth.schema_migrations (version) VALUES ('20180119214651');
INSERT INTO auth.schema_migrations (version) VALUES ('20180125194653');
INSERT INTO auth.schema_migrations (version) VALUES ('00');
INSERT INTO auth.schema_migrations (version) VALUES ('20210710035447');
INSERT INTO auth.schema_migrations (version) VALUES ('20210722035447');
INSERT INTO auth.schema_migrations (version) VALUES ('20210730183235');
INSERT INTO auth.schema_migrations (version) VALUES ('20210909172000');
INSERT INTO auth.schema_migrations (version) VALUES ('20210927181326');
INSERT INTO auth.schema_migrations (version) VALUES ('20211122151130');
INSERT INTO auth.schema_migrations (version) VALUES ('20211124214934');
INSERT INTO auth.schema_migrations (version) VALUES ('20211202183645');
INSERT INTO auth.schema_migrations (version) VALUES ('20220114185221');
INSERT INTO auth.schema_migrations (version) VALUES ('20220114185340');
INSERT INTO auth.schema_migrations (version) VALUES ('20220224000811');
INSERT INTO auth.schema_migrations (version) VALUES ('20220323170000');
INSERT INTO auth.schema_migrations (version) VALUES ('20220429102000');
INSERT INTO auth.schema_migrations (version) VALUES ('20220531120530');
INSERT INTO auth.schema_migrations (version) VALUES ('20220614074223');
INSERT INTO auth.schema_migrations (version) VALUES ('20220811173540');
INSERT INTO auth.schema_migrations (version) VALUES ('20221003041349');
INSERT INTO auth.schema_migrations (version) VALUES ('20221003041400');
INSERT INTO auth.schema_migrations (version) VALUES ('20221011041400');
INSERT INTO auth.schema_migrations (version) VALUES ('20221020193600');
INSERT INTO auth.schema_migrations (version) VALUES ('20221021073300');
INSERT INTO auth.schema_migrations (version) VALUES ('20221021082433');
INSERT INTO auth.schema_migrations (version) VALUES ('20221027105023');
INSERT INTO auth.schema_migrations (version) VALUES ('20221114143122');
INSERT INTO auth.schema_migrations (version) VALUES ('20221114143410');
INSERT INTO auth.schema_migrations (version) VALUES ('20221125140132');
INSERT INTO auth.schema_migrations (version) VALUES ('20221208132122');
INSERT INTO auth.schema_migrations (version) VALUES ('20221215195500');
INSERT INTO auth.schema_migrations (version) VALUES ('20221215195800');
INSERT INTO auth.schema_migrations (version) VALUES ('20221215195900');
INSERT INTO auth.schema_migrations (version) VALUES ('20230116124310');
INSERT INTO auth.schema_migrations (version) VALUES ('20230116124412');
INSERT INTO auth.schema_migrations (version) VALUES ('20230131181311');
INSERT INTO auth.schema_migrations (version) VALUES ('20230322519590');
INSERT INTO auth.schema_migrations (version) VALUES ('20230402418590');
INSERT INTO auth.schema_migrations (version) VALUES ('20230411005111');
INSERT INTO auth.schema_migrations (version) VALUES ('20230508135423');
INSERT INTO auth.schema_migrations (version) VALUES ('20230523124323');
INSERT INTO auth.schema_migrations (version) VALUES ('20230818113222');
INSERT INTO auth.schema_migrations (version) VALUES ('20230914180801');
INSERT INTO auth.schema_migrations (version) VALUES ('20231027141322');
INSERT INTO auth.schema_migrations (version) VALUES ('20231114161723');
INSERT INTO auth.schema_migrations (version) VALUES ('20231117164230');
INSERT INTO auth.schema_migrations (version) VALUES ('20240115144230');
INSERT INTO auth.schema_migrations (version) VALUES ('20240214120130');
INSERT INTO auth.schema_migrations (version) VALUES ('20240306115329');
INSERT INTO auth.schema_migrations (version) VALUES ('20240314092811');
INSERT INTO auth.schema_migrations (version) VALUES ('20240427152123');
INSERT INTO auth.schema_migrations (version) VALUES ('20240612123726');
INSERT INTO auth.schema_migrations (version) VALUES ('20240729123726');
INSERT INTO auth.schema_migrations (version) VALUES ('20240802193726');
INSERT INTO auth.schema_migrations (version) VALUES ('20240806073726');
INSERT INTO auth.schema_migrations (version) VALUES ('20241009103726');
INSERT INTO auth.schema_migrations (version) VALUES ('20250717082212');
INSERT INTO auth.schema_migrations (version) VALUES ('20250731150234');
INSERT INTO auth.schema_migrations (version) VALUES ('20250804100000');
INSERT INTO auth.schema_migrations (version) VALUES ('20250901200500');
INSERT INTO auth.schema_migrations (version) VALUES ('20250903112500');
INSERT INTO auth.schema_migrations (version) VALUES ('20250904133000');
INSERT INTO auth.schema_migrations (version) VALUES ('20250925093508');
INSERT INTO auth.schema_migrations (version) VALUES ('20251007112900');
INSERT INTO auth.schema_migrations (version) VALUES ('20251104100000');
INSERT INTO auth.schema_migrations (version) VALUES ('20251111201300');
INSERT INTO auth.schema_migrations (version) VALUES ('20251201000000');


--
-- TOC entry 4302 (class 0 OID 16711)
-- Dependencies: 356
-- Data for Name: sessions; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.sessions (id, user_id, created_at, updated_at, factor_id, aal, not_after, refreshed_at, user_agent, ip, tag, oauth_client_id, refresh_token_hmac_key, refresh_token_counter, scopes) VALUES ('cd538032-1493-4133-921f-8eac82f5ee45', '631e295b-b7e9-4d8a-9d05-79898cef103f', '2026-01-04 18:28:37.971517+00', '2026-01-04 18:28:37.971517+00', NULL, 'aal1', NULL, NULL, 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36', '189.37.78.15', NULL, NULL, NULL, NULL, NULL);


--
-- TOC entry 4307 (class 0 OID 16797)
-- Dependencies: 361
-- Data for Name: sso_domains; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4306 (class 0 OID 16788)
-- Dependencies: 360
-- Data for Name: sso_providers; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4295 (class 0 OID 16495)
-- Dependencies: 346
-- Data for Name: users; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.users (instance_id, id, aud, role, email, encrypted_password, email_confirmed_at, invited_at, confirmation_token, confirmation_sent_at, recovery_token, recovery_sent_at, email_change_token_new, email_change, email_change_sent_at, last_sign_in_at, raw_app_meta_data, raw_user_meta_data, is_super_admin, created_at, updated_at, phone, phone_confirmed_at, phone_change, phone_change_token, phone_change_sent_at, email_change_token_current, email_change_confirm_status, banned_until, reauthentication_token, reauthentication_sent_at, is_sso_user, deleted_at, is_anonymous) VALUES ('00000000-0000-0000-0000-000000000000', 'e7dacb55-defb-4eee-b8ec-6d22a7cd67cb', 'authenticated', 'authenticated', 'emilia@serhumanobr.com.br', '$2a$10$pyNFKLOMJ8AoA.g8SROyj.hnsdDpC4v8q8iZ.uCY7EGdUJd2J7vDy', '2026-01-02 19:24:08.336641+00', NULL, '', NULL, '', NULL, '', '', NULL, '2026-01-04 18:20:19.240565+00', '{"provider": "email", "providers": ["email"]}', '{"name": "EmÃ­lia Ferrari", "email_verified": true}', NULL, '2026-01-02 19:21:22.423824+00', '2026-01-04 18:20:19.250144+00', NULL, NULL, '', '', NULL, '', 0, NULL, '', NULL, false, NULL, false);
INSERT INTO auth.users (instance_id, id, aud, role, email, encrypted_password, email_confirmed_at, invited_at, confirmation_token, confirmation_sent_at, recovery_token, recovery_sent_at, email_change_token_new, email_change, email_change_sent_at, last_sign_in_at, raw_app_meta_data, raw_user_meta_data, is_super_admin, created_at, updated_at, phone, phone_confirmed_at, phone_change, phone_change_token, phone_change_sent_at, email_change_token_current, email_change_confirm_status, banned_until, reauthentication_token, reauthentication_sent_at, is_sso_user, deleted_at, is_anonymous) VALUES ('00000000-0000-0000-0000-000000000000', '631e295b-b7e9-4d8a-9d05-79898cef103f', 'authenticated', 'authenticated', 'eider@novvaempresa.com.br', '$2a$10$YIXVVuj213iSuHEKlqGP5.l2hmAsRy4RkmVFGotTGnt0TkXemGX4O', '2025-12-19 11:53:04.790031+00', NULL, '', NULL, 'c036d2399be60156fe727c4952a6a1aa119c2c478ebecf8c107fc604', '2025-12-19 12:13:26.491536+00', '', '', NULL, '2026-01-04 18:28:37.970744+00', '{"provider": "email", "providers": ["email"]}', '{"email_verified": true}', NULL, '2025-12-19 11:53:04.67957+00', '2026-01-04 18:28:37.989534+00', NULL, NULL, '', '', NULL, '', 0, NULL, '', NULL, false, NULL, false);


--
-- TOC entry 4332 (class 0 OID 17524)
-- Dependencies: 390
-- Data for Name: applications; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.applications (id, created_at, "jobId", name, email, phone, linkedin, status, "tenantId", form_data, resume_url, evaluation, score_general, is_hired, hired_at, "candidateId", "formData", "resumeUrl", "isHired", "hiredAt") VALUES (1, '2025-12-19 14:55:29.599431+00', 1, NULL, NULL, NULL, NULL, 'new', NULL, NULL, NULL, '{}', 0.00, false, NULL, '4a96d442-8386-4b68-827d-ce586713171a', '{"city": "UberlÃ¢ndia", "name": "JosÃ© da Silva Souza", "email": "teste@teste.com.br", "jobId": "1", "phone": "34999999999", "state": "MG", "course": "Engenharia", "source": "LinkedIn", "birthDate": "1991-07-10T03:00:00.000Z", "motivation": "gosto da empresa", "institution": "USP", "englishLevel": "fluente", "hasGraduated": "sim", "spanishLevel": "basico", "preferredName": "ZÃ©", "completionYear": "2011"}', 'teste_teste_com_br_1766156128277.pdf', false, NULL);
INSERT INTO public.applications (id, created_at, "jobId", name, email, phone, linkedin, status, "tenantId", form_data, resume_url, evaluation, score_general, is_hired, hired_at, "candidateId", "formData", "resumeUrl", "isHired", "hiredAt") VALUES (2, '2025-12-22 14:34:34.690985+00', 2, NULL, NULL, NULL, NULL, 'new', NULL, NULL, NULL, '{}', 0.00, false, NULL, '72fccae5-ba96-45b6-b6e6-9a022a24f2f4', '{"city": "UberlÃ¢ndia", "name": "Maria Joana Cruz", "email": "eider@novvaempresa.com.br", "jobId": "2", "phone": "34999999999", "state": "MG", "course": "Engenharia", "birthDate": "1991-07-10", "motivation": "Sei lÃ¡", "institution": "USP", "englishLevel": "fluente", "hasGraduated": "sim", "spanishLevel": "basico", "githubProfile": "https://github.com/eiderao", "preferredName": "Maju", "completionYear": "2011", "linkedinProfile": "www.linkedin.com/in/eider-arantes-de-oliveira-11051a2"}', 'eider_novvaempresa_com_br_1766414073143.pdf', false, NULL);
INSERT INTO public.applications (id, created_at, "jobId", name, email, phone, linkedin, status, "tenantId", form_data, resume_url, evaluation, score_general, is_hired, hired_at, "candidateId", "formData", "resumeUrl", "isHired", "hiredAt") VALUES (4, '2025-12-23 16:15:06.327267+00', 9, NULL, NULL, NULL, NULL, 'new', NULL, NULL, NULL, '{}', 0.00, false, NULL, '59abc2e1-edd9-4406-8337-e30cdb3d5cb2', '{"education": {"date": "2009", "level": "superior", "course": "Engenharia", "period": "", "status": "completo", "institution": "UFU"}, "applied_at": "2025-12-23T16:15:05.203Z", "motivation": "Cultura da empresa me atrai"}', NULL, false, NULL);
INSERT INTO public.applications (id, created_at, "jobId", name, email, phone, linkedin, status, "tenantId", form_data, resume_url, evaluation, score_general, is_hired, hired_at, "candidateId", "formData", "resumeUrl", "isHired", "hiredAt") VALUES (3, '2025-12-22 19:14:32.049282+00', 9, NULL, NULL, NULL, NULL, 'new', NULL, NULL, NULL, '{}', 7.77, false, NULL, '4a96d442-8386-4b68-827d-ce586713171a', '{"motivation": "Quero muito essa vaga!"}', NULL, true, '2025-12-25 19:33:46.578+00');
INSERT INTO public.applications (id, created_at, "jobId", name, email, phone, linkedin, status, "tenantId", form_data, resume_url, evaluation, score_general, is_hired, hired_at, "candidateId", "formData", "resumeUrl", "isHired", "hiredAt") VALUES (6, '2026-01-02 20:01:29.910007+00', 10, NULL, NULL, NULL, NULL, 'new', NULL, NULL, NULL, '{}', 0.00, false, NULL, '1aa28238-b81d-4ba2-ae1d-4cad9f03c8b2', '{"education": {"date": "2011", "level": "pos", "course": "Engenharia ElÃ©trica", "period": "", "status": "completo", "institution": "UFU"}, "applied_at": "2026-01-02T20:01:27.481Z", "motivation": "Porque eu me identifico com os valores da empresa"}', NULL, false, NULL);
INSERT INTO public.applications (id, created_at, "jobId", name, email, phone, linkedin, status, "tenantId", form_data, resume_url, evaluation, score_general, is_hired, hired_at, "candidateId", "formData", "resumeUrl", "isHired", "hiredAt") VALUES (5, '2025-12-23 16:19:20.10397+00', 9, NULL, NULL, NULL, NULL, 'new', NULL, NULL, NULL, '{}', 0.00, false, NULL, '432b5301-686e-429a-92c2-517eb221f611', '{"education": {"date": "2012", "level": "pos", "course": "Engenharia de ProduÃ§Ã£o", "period": "", "status": "completo", "institution": "Unicamp"}, "applied_at": "2025-12-23T16:19:19.010Z", "motivation": "Sei nÃ£o"}', NULL, false, NULL);


--
-- TOC entry 4337 (class 0 OID 19435)
-- Dependencies: 395
-- Data for Name: candidates; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.candidates (id, name, email, phone, city, state, linkedin_profile, github_profile, resume_url, created_at, updated_at) VALUES ('4a96d442-8386-4b68-827d-ce586713171a', 'JosÃ© da Silva Souza', 'teste@teste.com.br', NULL, NULL, NULL, NULL, NULL, NULL, '2025-12-19 14:51:01.164798+00', '2025-12-19 14:51:01.164798+00');
INSERT INTO public.candidates (id, name, email, phone, city, state, linkedin_profile, github_profile, resume_url, created_at, updated_at) VALUES ('72fccae5-ba96-45b6-b6e6-9a022a24f2f4', 'Maria Joana Cruz', 'eider@novvaempresa.com.br', NULL, NULL, NULL, NULL, NULL, NULL, '2025-12-22 14:34:34.482581+00', '2025-12-22 14:34:34.482581+00');
INSERT INTO public.candidates (id, name, email, phone, city, state, linkedin_profile, github_profile, resume_url, created_at, updated_at) VALUES ('a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11', 'JoÃ£o da Silva', 'joao@teste.com', NULL, 'SÃ£o Paulo', NULL, NULL, NULL, NULL, '2025-12-22 19:04:29.13381+00', '2025-12-22 19:04:29.13381+00');
INSERT INTO public.candidates (id, name, email, phone, city, state, linkedin_profile, github_profile, resume_url, created_at, updated_at) VALUES ('59abc2e1-edd9-4406-8337-e30cdb3d5cb2', 'Caio A Oliveira', 'caio@gmail.com', '34999999999', 'UberlÃ¢ndia ', 'MG', '', '', 'https://drive.google.com/drive/u/0/folders/0BxnNN9l-rudtbFRqX05YS1RLak0', '2025-12-23 16:15:06.165156+00', '2025-12-23 16:15:04.808+00');
INSERT INTO public.candidates (id, name, email, phone, city, state, linkedin_profile, github_profile, resume_url, created_at, updated_at) VALUES ('432b5301-686e-429a-92c2-517eb221f611', 'Alexandre o Grande', 'alebig@hotmail.com', '11999999999', 'SÃ£o Paulo', 'SP', '', '', 'https://rqffrviggegfmxtktnee.supabase.co/storage/v1/object/public/resumes/1766506758246_z3hjoe4y8.pdf', '2025-12-23 16:19:20.051698+00', '2025-12-23 16:19:18.915+00');
INSERT INTO public.candidates (id, name, email, phone, city, state, linkedin_profile, github_profile, resume_url, created_at, updated_at) VALUES ('1aa28238-b81d-4ba2-ae1d-4cad9f03c8b2', 'JosÃ© da Silva Jr', 'dasilvajr@gmail.com', '11995955959', 'SÃ£o Paulo', 'SP', 'www.linkedin.com/in/eider-arantes-de-oliveira-11051a2', 'https://github.com/eiderao', 'https://rqffrviggegfmxtktnee.supabase.co/storage/v1/object/public/resumes/1767384086358_h64zuz3ko.pdf', '2026-01-02 20:01:29.722569+00', '2026-01-02 20:01:27.197+00');


--
-- TOC entry 4340 (class 0 OID 22968)
-- Dependencies: 398
-- Data for Name: company_departments; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.company_departments (id, created_at, name, "tenantId") VALUES (1, '2025-12-22 18:57:10.916709+00', 'Comercial', '279945a9-f523-4eb0-80f1-cd56c1f8c582');
INSERT INTO public.company_departments (id, created_at, name, "tenantId") VALUES (2, '2025-12-22 19:01:19.715377+00', 'TI', '279945a9-f523-4eb0-80f1-cd56c1f8c582');
INSERT INTO public.company_departments (id, created_at, name, "tenantId") VALUES (3, '2025-12-24 14:44:20.091941+00', 'Marketing', '279945a9-f523-4eb0-80f1-cd56c1f8c582');
INSERT INTO public.company_departments (id, created_at, name, "tenantId") VALUES (4, '2026-01-02 19:29:58.305037+00', 'TI', '673dc932-ed3a-4d32-98c7-6fc621b4e21b');


--
-- TOC entry 4335 (class 0 OID 17781)
-- Dependencies: 393
-- Data for Name: evaluation_assignments_v2; Type: TABLE DATA; Schema: public; Owner: postgres
--



--
-- TOC entry 4338 (class 0 OID 22939)
-- Dependencies: 396
-- Data for Name: evaluations; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.evaluations (id, application_id, evaluator_id, scores, notes, final_score, created_at) VALUES ('158963bb-fb89-4f50-a2c2-4aba0a07dbee', 3, '844decb8-a0f0-4a74-ab02-ab1ba0001c5b', '{"cultura": {}, "tecnico": {"OrganizaÃ§Ã£o e MÃ©todo": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "Capacidade de otimizaÃ§Ã£o": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "CompreensÃ£o do escopo da demanda": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Capacidade de resoluÃ§Ã£o de problemas": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "Capacidade de estruturar dados de forma eficaz": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1"}, "triagem": {}, "updated_at": "2025-12-25T19:30:37.500Z", "pillar_scores": {"total": 9, "cultura": null, "tecnico": 9, "triagem": null, "pillarsEvaluated": 1}, "evaluator_name": "eider.arantes.oliveira@gmail.com", "anotacoes_gerais": "O candidato passou pelo teste tÃ©cnico, mas nÃ£o sabe estruturar dados muito bem."}', 'O candidato passou pelo teste tÃ©cnico, mas nÃ£o sabe estruturar dados muito bem.', 9.00, '2025-12-24 14:40:11.605+00');
INSERT INTO public.evaluations (id, application_id, evaluator_id, scores, notes, final_score, created_at) VALUES ('c7b148a5-9652-46cf-8c2f-ef70258f24d4', 4, '631e295b-b7e9-4d8a-9d05-79898cef103f', '{"cultura": {}, "tecnico": {}, "triagem": {"LÃ­nguas": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "Escolaridade": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Habilidade hard": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "Habilidade soft": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "ExperiÃªncia Geral": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "ExperiÃªncia EspecÃ­fica": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "QualificaÃ§Ã£o exigÃ­vel": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "QualificaÃ§Ã£o desejÃ¡vel": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1"}, "updated_at": "2025-12-26T03:24:37.258Z", "pillar_scores": {"total": 9, "cultura": 0, "tecnico": 0, "triagem": 9}, "evaluator_name": "eider@novvaempresa.com.br", "anotacoes_gerais": ""}', '', 9.00, '2025-12-24 19:38:06.651764+00');
INSERT INTO public.evaluations (id, application_id, evaluator_id, scores, notes, final_score, created_at) VALUES ('cafd5801-798e-4475-ad02-18b26d2f1300', 3, '631e295b-b7e9-4d8a-9d05-79898cef103f', '{"cultura": {"NÃ£o hÃ¡ tempo a perder": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "TransparÃªncia Ã© essencial": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Colaborar mais do que competir": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "A busca pelo melhor nunca termina": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "O Cliente Ã© a nossa razÃ£o de existir": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68"}, "tecnico": {"OrganizaÃ§Ã£o e MÃ©todo": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Capacidade de otimizaÃ§Ã£o": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "CompreensÃ£o do escopo da demanda": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Capacidade de resoluÃ§Ã£o de problemas": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "Capacidade de estruturar dados de forma eficaz": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68"}, "triagem": {"LÃ­nguas": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "Escolaridade": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Habilidade hard": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Habilidade soft": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "ExperiÃªncia Geral": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "ExperiÃªncia EspecÃ­fica": "5140db51-b042-45b2-a5ab-0a99e2982f4b", "QualificaÃ§Ã£o exigÃ­vel": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "QualificaÃ§Ã£o desejÃ¡vel": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1"}, "updated_at": "2026-01-02T17:34:23.306Z", "pillar_scores": {"total": 6.541666666666667, "cultura": 6, "tecnico": 7, "triagem": 6.625}, "evaluator_name": "eider@novvaempresa.com.br", "anotacoes_gerais": "Candidato mediano\nNÃ£o fala muito\nQuer trabalhar remoto\nNÃ£o tem perfil comunicativo"}', 'Candidato mediano
NÃ£o fala muito
Quer trabalhar remoto
NÃ£o tem perfil comunicativo', 6.54, '2025-12-24 14:40:44.473+00');
INSERT INTO public.evaluations (id, application_id, evaluator_id, scores, notes, final_score, created_at) VALUES ('418ea288-a6f0-4ad6-8cd6-8acf5b0ffebb', 6, 'e7dacb55-defb-4eee-b8ec-6d22a7cd67cb', '{"cultura": {"NÃ£o hÃ¡ tempo a perder": "2", "TransparÃªncia Ã© essencial": "2", "Colaborar mais do que competir": "2", "A busca pelo melhor nunca termina": "3", "O Cliente Ã© a nossa razÃ£o de existir (o usuÃ¡rio tambÃ©m)": "2"}, "tecnico": {"CompreensÃ£o do escopo da demanda": "2", "Capacidade de otimizaÃ§Ã£o de cÃ³digo": "3", "Capacidade de resoluÃ§Ã£o de problemas": "2", "Conhecimento de frameworks de back end": "2", "Conhecimento de frameworks de front end": "3"}, "triagem": {"LÃ­nguas": "1", "Escolaridade": "2", "Habilidade Hard": "3", "Habilidade Soft": "3", "ExperiÃªncia Geral": "2", "ExperiÃªncia EspecÃ­fica": "1", "QualificaÃ§Ã£o ExigÃ­vel": "2", "QualificaÃ§Ã£o DesejÃ¡vel": "3"}, "updated_at": "2026-01-03T01:27:59.670Z", "pillar_scores": {"total": 6.041666666666667, "cultura": 6, "tecnico": 7, "triagem": 5.125}, "evaluator_name": "emilia@serhumanobr.com.br", "anotacoes_gerais": "JÃºnior, como gosta de ser chamado, tem boas qualificaÃ§Ãµes desejÃ¡veis, como Java Script, React, Node, LLM e EstatÃ­stica AvanÃ§ada.\nSe adaptaria bem Ã  cultura da empresa e tem um senso de urgÃªncia muito aguÃ§ado. Ã‰ perfeccionista e gosta das coisas bem feitas da primeira vez."}', 'JÃºnior, como gosta de ser chamado, tem boas qualificaÃ§Ãµes desejÃ¡veis, como Java Script, React, Node, LLM e EstatÃ­stica AvanÃ§ada.
Se adaptaria bem Ã  cultura da empresa e tem um senso de urgÃªncia muito aguÃ§ado. Ã‰ perfeccionista e gosta das coisas bem feitas da primeira vez.', 6.04, '2026-01-02 20:17:06.663157+00');


--
-- TOC entry 4330 (class 0 OID 17508)
-- Dependencies: 388
-- Data for Name: jobs; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.jobs (id, created_at, title, status, "tenantId", parameters, "createdBy", description, requirements, type, location_type, company_department_id) VALUES (1, '2025-12-19 14:01:10.217987+00', 'Desenvolvedor Full Stack', 'active', '279945a9-f523-4eb0-80f1-cd56c1f8c582', '{"notas": [], "cultura": [{"name": "O Cliente Ã© nossa razÃ£o de existir", "weight": 20}, {"name": "TransparÃªncia Ã© essencial", "weight": 20}, {"name": "Colaborar Ã© celebrar junto", "weight": 20}, {"name": "A busca pelo melhor nunca termina", "weight": 20}, {"name": "NÃ£o hÃ¡ tempo a perder", "weight": 20}], "tecnico": [], "triagem": [{"name": "Escolaridade", "weight": 10}, {"name": "QualificaÃ§Ã£o Exigida", "weight": 10}, {"name": "QualificaÃ§Ã£o DesejÃ¡vel", "weight": 10}, {"name": "ExperiÃªncia Geral", "weight": 10}, {"name": "ExperiÃªncia EspecÃ­fica", "weight": 10}, {"name": "Habilidade Hard", "weight": 10}, {"name": "Habilidade Soft", "weight": 10}, {"name": "LÃ­nguas", "weight": 30}], "tÃ©cnico": [{"name": "Entendimento da demanda", "weight": 20}, {"name": "Capacidade de resoluÃ§Ã£o de problemas", "weight": 20}, {"name": "OrganizaÃ§Ã£o e MÃ©todo", "weight": 20}, {"name": "Capacidade de estruturar dados de forma clara e eficaz", "weight": 20}, {"name": "Habilidade de otimizaÃ§Ã£o", "weight": 20}]}', NULL, NULL, NULL, 'CLT', 'HÃ­brido', NULL);
INSERT INTO public.jobs (id, created_at, title, status, "tenantId", parameters, "createdBy", description, requirements, type, location_type, company_department_id) VALUES (2, '2025-12-22 13:59:55.830367+00', 'Analista de Marketing Sr. - Vaga Teste', 'active', '279945a9-f523-4eb0-80f1-cd56c1f8c582', '{"cultura": [], "tecnico": [], "triagem": [{"id": "0fac2a90-37aa-46dd-ae9d-4e4eaabff1f7", "text": "QualificaÃ§Ã£o", "weight": 1}]}', NULL, '', '', 'CLT', 'HÃ­brido', NULL);
INSERT INTO public.jobs (id, created_at, title, status, "tenantId", parameters, "createdBy", description, requirements, type, location_type, company_department_id) VALUES (9, '2025-12-22 19:02:41.84766+00', 'Cientista de Dados', 'active', '279945a9-f523-4eb0-80f1-cd56c1f8c582', '{"notas": [{"id": "5140db51-b042-45b2-a5ab-0a99e2982f4b", "nome": "Abaixo", "valor": 0}, {"id": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "nome": "Atende", "valor": "5"}, {"id": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "nome": "Supera", "valor": "10"}], "cultura": [{"name": "O Cliente Ã© a nossa razÃ£o de existir", "weight": "20"}, {"name": "TransparÃªncia Ã© essencial", "weight": "20"}, {"name": "Colaborar mais do que competir", "weight": "20"}, {"name": "A busca pelo melhor nunca termina", "weight": "20"}, {"name": "NÃ£o hÃ¡ tempo a perder", "weight": "20"}], "tecnico": [{"name": "CompreensÃ£o do escopo da demanda", "weight": "20"}, {"name": "Capacidade de resoluÃ§Ã£o de problemas", "weight": "20"}, {"name": "OrganizaÃ§Ã£o e MÃ©todo", "weight": "20"}, {"name": "Capacidade de estruturar dados de forma eficaz", "weight": "20"}, {"name": "Capacidade de otimizaÃ§Ã£o", "weight": "20"}], "triagem": [{"name": "Escolaridade", "weight": "10"}, {"name": "QualificaÃ§Ã£o exigÃ­vel", "weight": "12.5"}, {"name": "QualificaÃ§Ã£o desejÃ¡vel", "weight": "10"}, {"name": "ExperiÃªncia Geral", "weight": "20"}, {"name": "ExperiÃªncia EspecÃ­fica", "weight": "12.5"}, {"name": "Habilidade hard", "weight": "10"}, {"name": "Habilidade soft", "weight": "10"}, {"name": "LÃ­nguas", "weight": "15"}]}', NULL, 'Profissional com capacidade para desenvolver sistemas utilizando machine learning e manipular grandes bases de dados (bigdata)', 'EstatÃ­stico
Desenvolvedor Python', 'PJ', 'Remoto', 2);
INSERT INTO public.jobs (id, created_at, title, status, "tenantId", parameters, "createdBy", description, requirements, type, location_type, company_department_id) VALUES (8, '2025-12-22 18:58:32.518032+00', 'Executivo de Contas', 'inactive', '279945a9-f523-4eb0-80f1-cd56c1f8c582', '{"notas": [], "cultura": [], "tecnico": [], "triagem": []}', NULL, 'Profissional para atender a clientes B2B de Alto Valor e Alto Potencial na Matriz de SegmentaÃ§Ã£o.', 'Senioridade na Ã¡rea comercial 
Habilidades de relacionamento com clientes', 'CLT', 'HÃ­brido', 1);
INSERT INTO public.jobs (id, created_at, title, status, "tenantId", parameters, "createdBy", description, requirements, type, location_type, company_department_id) VALUES (10, '2026-01-02 19:30:00.747243+00', 'Vaga Teste - Desenvolvedor Full Stack Sr.', 'active', '673dc932-ed3a-4d32-98c7-6fc621b4e21b', '{"notas": [{"id": "1", "nome": "Abaixo", "valor": 0}, {"id": "2", "nome": "Atende", "valor": 5}, {"id": "3", "nome": "Supera", "valor": 10}], "cultura": [{"name": "O Cliente Ã© a nossa razÃ£o de existir (o usuÃ¡rio tambÃ©m)", "weight": 20}, {"name": "TransparÃªncia Ã© essencial", "weight": 20}, {"name": "Colaborar mais do que competir", "weight": 20}, {"name": "A busca pelo melhor nunca termina", "weight": 20}, {"name": "NÃ£o hÃ¡ tempo a perder", "weight": 20}], "tecnico": [{"name": "CompreensÃ£o do escopo da demanda", "weight": 10}, {"name": "Capacidade de resoluÃ§Ã£o de problemas", "weight": 20}, {"name": "Conhecimento de frameworks de front end", "weight": 30}, {"name": "Conhecimento de frameworks de back end", "weight": 30}, {"name": "Capacidade de otimizaÃ§Ã£o de cÃ³digo", "weight": 10}], "triagem": [{"name": "Escolaridade", "weight": 10}, {"name": "QualificaÃ§Ã£o ExigÃ­vel", "weight": 12.5}, {"name": "QualificaÃ§Ã£o DesejÃ¡vel", "weight": 10}, {"name": "ExperiÃªncia Geral", "weight": 20}, {"name": "ExperiÃªncia EspecÃ­fica", "weight": 12.5}, {"name": "Habilidade Hard", "weight": 10}, {"name": "Habilidade Soft", "weight": 10}, {"name": "LÃ­nguas", "weight": 15}]}', NULL, 'Vaga de um Desenvolvedor Full Stack Sr. para a Ã¡rea de TI, inserida para servir de base didÃ¡tica', 'Conhecimento e principalmente experiÃªncia tÃ©cnica em desenvolvimento de front e back end de sistemas para web (SaaS) multi-usuÃ¡rios e multi-tenant', 'CLT', 'Remoto', 4);


--
-- TOC entry 4336 (class 0 OID 19187)
-- Dependencies: 394
-- Data for Name: plans; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.plans (id, name, price, user_limit, job_limit, candidate_limit) VALUES ('basico', 'Plano BÃ¡sico', 99.00, 1, 10, 10);
INSERT INTO public.plans (id, name, price, user_limit, job_limit, candidate_limit) VALUES ('freemium', 'Plano Freemium', 0.00, 1, 5, 3);
INSERT INTO public.plans (id, name, price, user_limit, job_limit, candidate_limit) VALUES ('intermediario', 'Plano IntermediÃ¡rio', 149.00, 5, 30, -1);
INSERT INTO public.plans (id, name, price, user_limit, job_limit, candidate_limit) VALUES ('premium', 'Plano Premium', 229.00, -1, -1, -1);


--
-- TOC entry 4333 (class 0 OID 17751)
-- Dependencies: 391
-- Data for Name: tenants; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.tenants (id, "companyName", cnpj, "planId", created_at) VALUES ('279945a9-f523-4eb0-80f1-cd56c1f8c582', 'Novva - Desenvolvimento Empresarial', '26.424.282/0001-48', 'premium', '2025-12-19 13:07:51.150663+00');
INSERT INTO public.tenants (id, "companyName", cnpj, "planId", created_at) VALUES ('673dc932-ed3a-4d32-98c7-6fc621b4e21b', 'Ser Humano Consult', '17.515.566/0001-59', 'freemium', '2026-01-02 19:21:22.118098+00');


--
-- TOC entry 4334 (class 0 OID 17761)
-- Dependencies: 392
-- Data for Name: user_profiles; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.user_profiles (id, "tenantId", name, email, role, is_admin_system, created_at, active) VALUES ('e7dacb55-defb-4eee-b8ec-6d22a7cd67cb', '673dc932-ed3a-4d32-98c7-6fc621b4e21b', 'EmÃ­lia Ferrari', 'emilia@serhumanobr.com.br', 'admin', false, '2026-01-02 19:21:22.891906+00', true);
INSERT INTO public.user_profiles (id, "tenantId", name, email, role, is_admin_system, created_at, active) VALUES ('631e295b-b7e9-4d8a-9d05-79898cef103f', '279945a9-f523-4eb0-80f1-cd56c1f8c582', 'eider.arantes.oliveira', 'eider@novvaempresa.com.br', 'rh', true, '2025-12-22 19:18:59.355871+00', true);


--
-- TOC entry 4341 (class 0 OID 34251)
-- Dependencies: 399
-- Data for Name: user_tenants; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.user_tenants (id, user_id, tenant_id, role, created_at) VALUES ('30f302d9-3b42-45df-aa3a-23f2cc437d12', '631e295b-b7e9-4d8a-9d05-79898cef103f', '279945a9-f523-4eb0-80f1-cd56c1f8c582', 'rh', '2026-01-04 13:12:50.222378+00');
INSERT INTO public.user_tenants (id, user_id, tenant_id, role, created_at) VALUES ('00385d76-f256-4764-a3d6-7a9b9af6ce4c', 'e7dacb55-defb-4eee-b8ec-6d22a7cd67cb', '279945a9-f523-4eb0-80f1-cd56c1f8c582', 'Consultora de RH', '2026-01-04 18:29:19.656088+00');


--
-- TOC entry 4328 (class 0 OID 17482)
-- Dependencies: 386
-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.users (id, email, "tenantId", "isAdmin", role, status, name) VALUES ('631e295b-b7e9-4d8a-9d05-79898cef103f', 'eider@novvaempresa.com.br', '279945a9-f523-4eb0-80f1-cd56c1f8c582', true, 'recruiter', 'active', 'UsuÃ¡rio teste 1 (eider@novvaempresa)');


--
-- TOC entry 4316 (class 0 OID 17076)
-- Dependencies: 370
-- Data for Name: schema_migrations; Type: TABLE DATA; Schema: realtime; Owner: supabase_admin
--

INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211116024918, '2025-12-18 17:54:09');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211116045059, '2025-12-18 17:54:14');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211116050929, '2025-12-18 17:54:18');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211116051442, '2025-12-18 17:54:21');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211116212300, '2025-12-18 17:54:25');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211116213355, '2025-12-18 17:54:29');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211116213934, '2025-12-18 17:54:32');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211116214523, '2025-12-18 17:54:37');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211122062447, '2025-12-18 17:54:40');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211124070109, '2025-12-18 17:54:43');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211202204204, '2025-12-18 17:54:47');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211202204605, '2025-12-18 17:54:50');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211210212804, '2025-12-18 17:55:01');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20211228014915, '2025-12-18 17:55:04');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20220107221237, '2025-12-18 17:55:08');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20220228202821, '2025-12-18 17:55:11');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20220312004840, '2025-12-18 17:55:15');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20220603231003, '2025-12-18 17:55:20');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20220603232444, '2025-12-18 17:55:23');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20220615214548, '2025-12-18 17:55:27');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20220712093339, '2025-12-18 17:55:31');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20220908172859, '2025-12-18 17:55:34');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20220916233421, '2025-12-18 17:55:38');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20230119133233, '2025-12-18 17:55:41');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20230128025114, '2025-12-18 17:55:46');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20230128025212, '2025-12-18 17:55:49');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20230227211149, '2025-12-18 17:55:53');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20230228184745, '2025-12-18 17:55:56');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20230308225145, '2025-12-18 17:55:59');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20230328144023, '2025-12-18 17:56:03');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20231018144023, '2025-12-18 17:56:07');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20231204144023, '2025-12-18 17:56:12');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20231204144024, '2025-12-18 17:56:16');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20231204144025, '2025-12-18 17:56:19');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240108234812, '2025-12-18 17:56:23');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240109165339, '2025-12-18 17:56:26');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240227174441, '2025-12-18 17:56:32');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240311171622, '2025-12-18 17:56:37');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240321100241, '2025-12-18 17:56:44');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240401105812, '2025-12-18 17:56:54');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240418121054, '2025-12-18 17:56:59');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240523004032, '2025-12-18 17:57:11');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240618124746, '2025-12-18 17:57:14');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240801235015, '2025-12-18 17:57:18');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240805133720, '2025-12-18 17:57:21');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240827160934, '2025-12-18 17:57:24');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240919163303, '2025-12-18 17:57:29');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20240919163305, '2025-12-18 17:57:32');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20241019105805, '2025-12-18 17:57:36');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20241030150047, '2025-12-18 17:57:48');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20241108114728, '2025-12-18 17:57:53');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20241121104152, '2025-12-18 17:57:56');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20241130184212, '2025-12-18 17:58:00');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20241220035512, '2025-12-18 17:58:04');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20241220123912, '2025-12-18 17:58:07');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20241224161212, '2025-12-18 17:58:10');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20250107150512, '2025-12-18 17:58:14');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20250110162412, '2025-12-18 17:58:17');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20250123174212, '2025-12-18 17:58:20');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20250128220012, '2025-12-18 17:58:24');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20250506224012, '2025-12-18 17:58:27');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20250523164012, '2025-12-18 17:58:30');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20250714121412, '2025-12-18 17:58:34');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20250905041441, '2025-12-18 17:58:37');
INSERT INTO realtime.schema_migrations (version, inserted_at) VALUES (20251103001201, '2025-12-18 17:58:40');


--
-- TOC entry 4327 (class 0 OID 17325)
-- Dependencies: 382
-- Data for Name: subscription; Type: TABLE DATA; Schema: realtime; Owner: supabase_admin
--



--
-- TOC entry 4318 (class 0 OID 17089)
-- Dependencies: 372
-- Data for Name: buckets; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--

INSERT INTO storage.buckets (id, name, owner, created_at, updated_at, public, avif_autodetection, file_size_limit, allowed_mime_types, owner_id, type) VALUES ('resumes', 'resumes', NULL, '2025-12-19 14:37:52.698031+00', '2025-12-19 14:37:52.698031+00', true, false, NULL, NULL, NULL, 'STANDARD');


--
-- TOC entry 4323 (class 0 OID 17246)
-- Dependencies: 377
-- Data for Name: buckets_analytics; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--



--
-- TOC entry 4324 (class 0 OID 17273)
-- Dependencies: 378
-- Data for Name: buckets_vectors; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--



--
-- TOC entry 4317 (class 0 OID 17081)
-- Dependencies: 371
-- Data for Name: migrations; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--

INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (0, 'create-migrations-table', 'e18db593bcde2aca2a408c4d1100f6abba2195df', '2025-12-18 17:54:04.682167');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (1, 'initialmigration', '6ab16121fbaa08bbd11b712d05f358f9b555d777', '2025-12-18 17:54:04.703664');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (2, 'storage-schema', '5c7968fd083fcea04050c1b7f6253c9771b99011', '2025-12-18 17:54:04.718953');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (3, 'pathtoken-column', '2cb1b0004b817b29d5b0a971af16bafeede4b70d', '2025-12-18 17:54:04.752545');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (4, 'add-migrations-rls', '427c5b63fe1c5937495d9c635c263ee7a5905058', '2025-12-18 17:54:04.815833');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (5, 'add-size-functions', '79e081a1455b63666c1294a440f8ad4b1e6a7f84', '2025-12-18 17:54:04.827918');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (6, 'change-column-name-in-get-size', 'f93f62afdf6613ee5e7e815b30d02dc990201044', '2025-12-18 17:54:04.848369');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (7, 'add-rls-to-buckets', 'e7e7f86adbc51049f341dfe8d30256c1abca17aa', '2025-12-18 17:54:04.865985');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (8, 'add-public-to-buckets', 'fd670db39ed65f9d08b01db09d6202503ca2bab3', '2025-12-18 17:54:04.882889');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (9, 'fix-search-function', '3a0af29f42e35a4d101c259ed955b67e1bee6825', '2025-12-18 17:54:04.904158');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (10, 'search-files-search-function', '68dc14822daad0ffac3746a502234f486182ef6e', '2025-12-18 17:54:04.917237');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (11, 'add-trigger-to-auto-update-updated_at-column', '7425bdb14366d1739fa8a18c83100636d74dcaa2', '2025-12-18 17:54:04.939311');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (12, 'add-automatic-avif-detection-flag', '8e92e1266eb29518b6a4c5313ab8f29dd0d08df9', '2025-12-18 17:54:04.955776');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (13, 'add-bucket-custom-limits', 'cce962054138135cd9a8c4bcd531598684b25e7d', '2025-12-18 17:54:05.01623');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (14, 'use-bytes-for-max-size', '941c41b346f9802b411f06f30e972ad4744dad27', '2025-12-18 17:54:05.094651');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (15, 'add-can-insert-object-function', '934146bc38ead475f4ef4b555c524ee5d66799e5', '2025-12-18 17:54:05.121283');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (16, 'add-version', '76debf38d3fd07dcfc747ca49096457d95b1221b', '2025-12-18 17:54:05.131454');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (17, 'drop-owner-foreign-key', 'f1cbb288f1b7a4c1eb8c38504b80ae2a0153d101', '2025-12-18 17:54:05.143621');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (18, 'add_owner_id_column_deprecate_owner', 'e7a511b379110b08e2f214be852c35414749fe66', '2025-12-18 17:54:05.173811');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (19, 'alter-default-value-objects-id', '02e5e22a78626187e00d173dc45f58fa66a4f043', '2025-12-18 17:54:05.186561');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (20, 'list-objects-with-delimiter', 'cd694ae708e51ba82bf012bba00caf4f3b6393b7', '2025-12-18 17:54:05.204635');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (21, 's3-multipart-uploads', '8c804d4a566c40cd1e4cc5b3725a664a9303657f', '2025-12-18 17:54:05.216415');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (22, 's3-multipart-uploads-big-ints', '9737dc258d2397953c9953d9b86920b8be0cdb73', '2025-12-18 17:54:05.235414');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (23, 'optimize-search-function', '9d7e604cddc4b56a5422dc68c9313f4a1b6f132c', '2025-12-18 17:54:05.256745');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (24, 'operation-function', '8312e37c2bf9e76bbe841aa5fda889206d2bf8aa', '2025-12-18 17:54:05.268844');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (25, 'custom-metadata', 'd974c6057c3db1c1f847afa0e291e6165693b990', '2025-12-18 17:54:05.294059');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (26, 'objects-prefixes', 'ef3f7871121cdc47a65308e6702519e853422ae2', '2025-12-18 17:54:05.303806');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (27, 'search-v2', '33b8f2a7ae53105f028e13e9fcda9dc4f356b4a2', '2025-12-18 17:54:05.356947');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (28, 'object-bucket-name-sorting', 'ba85ec41b62c6a30a3f136788227ee47f311c436', '2025-12-18 17:54:05.415378');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (29, 'create-prefixes', 'a7b1a22c0dc3ab630e3055bfec7ce7d2045c5b7b', '2025-12-18 17:54:05.422696');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (30, 'update-object-levels', '6c6f6cc9430d570f26284a24cf7b210599032db7', '2025-12-18 17:54:05.432877');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (31, 'objects-level-index', '33f1fef7ec7fea08bb892222f4f0f5d79bab5eb8', '2025-12-18 17:54:05.52018');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (32, 'backward-compatible-index-on-objects', '2d51eeb437a96868b36fcdfb1ddefdf13bef1647', '2025-12-18 17:54:05.529763');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (33, 'backward-compatible-index-on-prefixes', 'fe473390e1b8c407434c0e470655945b110507bf', '2025-12-18 17:54:05.54217');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (34, 'optimize-search-function-v1', '82b0e469a00e8ebce495e29bfa70a0797f7ebd2c', '2025-12-18 17:54:05.545097');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (35, 'add-insert-trigger-prefixes', '63bb9fd05deb3dc5e9fa66c83e82b152f0caf589', '2025-12-18 17:54:05.558531');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (36, 'optimise-existing-functions', '81cf92eb0c36612865a18016a38496c530443899', '2025-12-18 17:54:05.572947');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (37, 'add-bucket-name-length-trigger', '3944135b4e3e8b22d6d4cbb568fe3b0b51df15c1', '2025-12-18 17:54:05.591375');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (38, 'iceberg-catalog-flag-on-buckets', '19a8bd89d5dfa69af7f222a46c726b7c41e462c5', '2025-12-18 17:54:05.601404');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (39, 'add-search-v2-sort-support', '39cf7d1e6bf515f4b02e41237aba845a7b492853', '2025-12-18 17:54:05.616957');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (40, 'fix-prefix-race-conditions-optimized', 'fd02297e1c67df25a9fc110bf8c8a9af7fb06d1f', '2025-12-18 17:54:05.633276');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (41, 'add-object-level-update-trigger', '44c22478bf01744b2129efc480cd2edc9a7d60e9', '2025-12-18 17:54:05.649687');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (42, 'rollback-prefix-triggers', 'f2ab4f526ab7f979541082992593938c05ee4b47', '2025-12-18 17:54:05.669149');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (43, 'fix-object-level', 'ab837ad8f1c7d00cc0b7310e989a23388ff29fc6', '2025-12-18 17:54:05.680581');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (44, 'vector-bucket-type', '99c20c0ffd52bb1ff1f32fb992f3b351e3ef8fb3', '2025-12-18 17:54:05.691574');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (45, 'vector-buckets', '049e27196d77a7cb76497a85afae669d8b230953', '2025-12-18 17:54:05.708885');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (46, 'buckets-objects-grants', 'fedeb96d60fefd8e02ab3ded9fbde05632f84aed', '2025-12-18 17:54:05.727158');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (47, 'iceberg-table-metadata', '649df56855c24d8b36dd4cc1aeb8251aa9ad42c2', '2025-12-18 17:54:05.738011');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (48, 'iceberg-catalog-ids', '2666dff93346e5d04e0a878416be1d5fec345d6f', '2025-12-18 17:54:05.748994');
INSERT INTO storage.migrations (id, name, hash, executed_at) VALUES (49, 'buckets-objects-grants-postgres', '072b1195d0d5a2f888af6b2302a1938dd94b8b3d', '2025-12-19 11:39:57.704824');


--
-- TOC entry 4319 (class 0 OID 17099)
-- Dependencies: 373
-- Data for Name: objects; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--

INSERT INTO storage.objects (id, bucket_id, name, owner, created_at, updated_at, last_accessed_at, metadata, version, owner_id, user_metadata, level) VALUES ('f3ff287d-c45d-4099-a1e4-c86eceba1e64', 'resumes', 'teste_teste_com_br_1766155240539.pdf', NULL, '2025-12-19 14:40:41.209505+00', '2025-12-19 14:40:41.209505+00', '2025-12-19 14:40:41.209505+00', '{"eTag": "\"f2c5ce99696626aece13b50f5f857bb8\"", "size": 368155, "mimetype": "application/pdf", "cacheControl": "max-age=3600", "lastModified": "2025-12-19T14:40:42.000Z", "contentLength": 368155, "httpStatusCode": 200}', '13012aa2-7f95-46f0-b0ab-3dcf67f9a5f3', NULL, '{}', 1);
INSERT INTO storage.objects (id, bucket_id, name, owner, created_at, updated_at, last_accessed_at, metadata, version, owner_id, user_metadata, level) VALUES ('9ef5c925-4c14-403a-84e9-6bd852f1adc6', 'resumes', 'teste_teste_com_br_1766155860050.pdf', NULL, '2025-12-19 14:51:00.758037+00', '2025-12-19 14:51:00.758037+00', '2025-12-19 14:51:00.758037+00', '{"eTag": "\"f2c5ce99696626aece13b50f5f857bb8\"", "size": 368155, "mimetype": "application/pdf", "cacheControl": "max-age=3600", "lastModified": "2025-12-19T14:51:01.000Z", "contentLength": 368155, "httpStatusCode": 200}', '5dad6d6a-9a53-43d1-9eaa-447b088b8e3d', NULL, '{}', 1);
INSERT INTO storage.objects (id, bucket_id, name, owner, created_at, updated_at, last_accessed_at, metadata, version, owner_id, user_metadata, level) VALUES ('2f95b50a-3208-4dfb-9c93-b402e861a7a8', 'resumes', 'teste_teste_com_br_1766155945615.pdf', NULL, '2025-12-19 14:52:26.363347+00', '2025-12-19 14:52:26.363347+00', '2025-12-19 14:52:26.363347+00', '{"eTag": "\"f2c5ce99696626aece13b50f5f857bb8\"", "size": 368155, "mimetype": "application/pdf", "cacheControl": "max-age=3600", "lastModified": "2025-12-19T14:52:27.000Z", "contentLength": 368155, "httpStatusCode": 200}', '9927b3d6-4ef5-4248-b538-079a63cce8bd', NULL, '{}', 1);
INSERT INTO storage.objects (id, bucket_id, name, owner, created_at, updated_at, last_accessed_at, metadata, version, owner_id, user_metadata, level) VALUES ('0a160c0f-ad05-41a6-aab7-a16e8b2b84d1', 'resumes', 'teste_teste_com_br_1766156128277.pdf', NULL, '2025-12-19 14:55:29.198336+00', '2025-12-19 14:55:29.198336+00', '2025-12-19 14:55:29.198336+00', '{"eTag": "\"f2c5ce99696626aece13b50f5f857bb8\"", "size": 368155, "mimetype": "application/pdf", "cacheControl": "max-age=3600", "lastModified": "2025-12-19T14:55:30.000Z", "contentLength": 368155, "httpStatusCode": 200}', 'f392a57f-0003-4775-a3f8-671a9588c014', NULL, '{}', 1);
INSERT INTO storage.objects (id, bucket_id, name, owner, created_at, updated_at, last_accessed_at, metadata, version, owner_id, user_metadata, level) VALUES ('b5ff3313-af89-458d-b881-b15ecd668961', 'resumes', 'eider_novvaempresa_com_br_1766414073143.pdf', NULL, '2025-12-22 14:34:34.119649+00', '2025-12-22 14:34:34.119649+00', '2025-12-22 14:34:34.119649+00', '{"eTag": "\"f2c5ce99696626aece13b50f5f857bb8\"", "size": 368155, "mimetype": "application/pdf", "cacheControl": "max-age=3600", "lastModified": "2025-12-22T14:34:35.000Z", "contentLength": 368155, "httpStatusCode": 200}', '2ca9c6ac-442f-4302-a2d5-b4270d799e5e', NULL, '{}', 1);
INSERT INTO storage.objects (id, bucket_id, name, owner, created_at, updated_at, last_accessed_at, metadata, version, owner_id, user_metadata, level) VALUES ('be75d55d-975c-4ad7-80d6-947210344c4f', 'resumes', '1766506758246_z3hjoe4y8.pdf', '631e295b-b7e9-4d8a-9d05-79898cef103f', '2025-12-23 16:19:19.925318+00', '2025-12-23 16:19:19.925318+00', '2025-12-23 16:19:19.925318+00', '{"eTag": "\"f2c5ce99696626aece13b50f5f857bb8\"", "size": 368155, "mimetype": "application/pdf", "cacheControl": "max-age=3600", "lastModified": "2025-12-23T16:19:20.000Z", "contentLength": 368155, "httpStatusCode": 200}', '3e05b649-796c-4c89-9089-6a8136d3e900', '631e295b-b7e9-4d8a-9d05-79898cef103f', '{}', 1);
INSERT INTO storage.objects (id, bucket_id, name, owner, created_at, updated_at, last_accessed_at, metadata, version, owner_id, user_metadata, level) VALUES ('8e375699-bbfd-4ed9-8428-e613e4f093cd', 'resumes', '1767384086358_h64zuz3ko.pdf', 'e7dacb55-defb-4eee-b8ec-6d22a7cd67cb', '2026-01-02 20:01:29.447288+00', '2026-01-02 20:01:29.447288+00', '2026-01-02 20:01:29.447288+00', '{"eTag": "\"f2c5ce99696626aece13b50f5f857bb8\"", "size": 368155, "mimetype": "application/pdf", "cacheControl": "max-age=3600", "lastModified": "2026-01-02T20:01:30.000Z", "contentLength": 368155, "httpStatusCode": 200}', 'db10a1b3-7818-437b-b0d0-0056299b50b2', 'e7dacb55-defb-4eee-b8ec-6d22a7cd67cb', '{}', 1);


--
-- TOC entry 4322 (class 0 OID 17202)
-- Dependencies: 376
-- Data for Name: prefixes; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--



--
-- TOC entry 4320 (class 0 OID 17149)
-- Dependencies: 374
-- Data for Name: s3_multipart_uploads; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--



--
-- TOC entry 4321 (class 0 OID 17163)
-- Dependencies: 375
-- Data for Name: s3_multipart_uploads_parts; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--



--
-- TOC entry 4325 (class 0 OID 17283)
-- Dependencies: 379
-- Data for Name: vector_indexes; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--



--
-- TOC entry 3721 (class 0 OID 16608)
-- Dependencies: 352
-- Data for Name: secrets; Type: TABLE DATA; Schema: vault; Owner: supabase_admin
--



--
-- TOC entry 4524 (class 0 OID 0)
-- Dependencies: 347
-- Name: refresh_tokens_id_seq; Type: SEQUENCE SET; Schema: auth; Owner: supabase_auth_admin
--

SELECT pg_catalog.setval('auth.refresh_tokens_id_seq', 178, true);


--
-- TOC entry 4525 (class 0 OID 0)
-- Dependencies: 389
-- Name: applications_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.applications_id_seq', 6, true);


--
-- TOC entry 4526 (class 0 OID 0)
-- Dependencies: 397
-- Name: company_departments_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.company_departments_id_seq', 4, true);


--
-- TOC entry 4527 (class 0 OID 0)
-- Dependencies: 387
-- Name: jobs_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.jobs_id_seq', 10, true);


--
-- TOC entry 4528 (class 0 OID 0)
-- Dependencies: 381
-- Name: subscription_id_seq; Type: SEQUENCE SET; Schema: realtime; Owner: supabase_admin
--

SELECT pg_catalog.setval('realtime.subscription_id_seq', 1, false);


--
-- TOC entry 3904 (class 2606 OID 16783)
-- Name: mfa_amr_claims amr_id_pk; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_amr_claims
    ADD CONSTRAINT amr_id_pk PRIMARY KEY (id);


--
-- TOC entry 3873 (class 2606 OID 16531)
-- Name: audit_log_entries audit_log_entries_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.audit_log_entries
    ADD CONSTRAINT audit_log_entries_pkey PRIMARY KEY (id);


--
-- TOC entry 3927 (class 2606 OID 16889)
-- Name: flow_state flow_state_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.flow_state
    ADD CONSTRAINT flow_state_pkey PRIMARY KEY (id);


--
-- TOC entry 3882 (class 2606 OID 16907)
-- Name: identities identities_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.identities
    ADD CONSTRAINT identities_pkey PRIMARY KEY (id);


--
-- TOC entry 3884 (class 2606 OID 16917)
-- Name: identities identities_provider_id_provider_unique; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.identities
    ADD CONSTRAINT identities_provider_id_provider_unique UNIQUE (provider_id, provider);


--
-- TOC entry 3871 (class 2606 OID 16524)
-- Name: instances instances_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.instances
    ADD CONSTRAINT instances_pkey PRIMARY KEY (id);


--
-- TOC entry 3906 (class 2606 OID 16776)
-- Name: mfa_amr_claims mfa_amr_claims_session_id_authentication_method_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_amr_claims
    ADD CONSTRAINT mfa_amr_claims_session_id_authentication_method_pkey UNIQUE (session_id, authentication_method);


--
-- TOC entry 3902 (class 2606 OID 16764)
-- Name: mfa_challenges mfa_challenges_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_challenges
    ADD CONSTRAINT mfa_challenges_pkey PRIMARY KEY (id);


--
-- TOC entry 3894 (class 2606 OID 16957)
-- Name: mfa_factors mfa_factors_last_challenged_at_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_factors
    ADD CONSTRAINT mfa_factors_last_challenged_at_key UNIQUE (last_challenged_at);


--
-- TOC entry 3896 (class 2606 OID 16751)
-- Name: mfa_factors mfa_factors_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_factors
    ADD CONSTRAINT mfa_factors_pkey PRIMARY KEY (id);


--
-- TOC entry 3940 (class 2606 OID 17016)
-- Name: oauth_authorizations oauth_authorizations_authorization_code_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_authorizations
    ADD CONSTRAINT oauth_authorizations_authorization_code_key UNIQUE (authorization_code);


--
-- TOC entry 3942 (class 2606 OID 17014)
-- Name: oauth_authorizations oauth_authorizations_authorization_id_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_authorizations
    ADD CONSTRAINT oauth_authorizations_authorization_id_key UNIQUE (authorization_id);


--
-- TOC entry 3944 (class 2606 OID 17012)
-- Name: oauth_authorizations oauth_authorizations_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_authorizations
    ADD CONSTRAINT oauth_authorizations_pkey PRIMARY KEY (id);


--
-- TOC entry 3954 (class 2606 OID 17074)
-- Name: oauth_client_states oauth_client_states_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_client_states
    ADD CONSTRAINT oauth_client_states_pkey PRIMARY KEY (id);


--
-- TOC entry 3937 (class 2606 OID 16976)
-- Name: oauth_clients oauth_clients_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_clients
    ADD CONSTRAINT oauth_clients_pkey PRIMARY KEY (id);


--
-- TOC entry 3948 (class 2606 OID 17038)
-- Name: oauth_consents oauth_consents_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_consents
    ADD CONSTRAINT oauth_consents_pkey PRIMARY KEY (id);


--
-- TOC entry 3950 (class 2606 OID 17040)
-- Name: oauth_consents oauth_consents_user_client_unique; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_consents
    ADD CONSTRAINT oauth_consents_user_client_unique UNIQUE (user_id, client_id);


--
-- TOC entry 3931 (class 2606 OID 16942)
-- Name: one_time_tokens one_time_tokens_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.one_time_tokens
    ADD CONSTRAINT one_time_tokens_pkey PRIMARY KEY (id);


--
-- TOC entry 3865 (class 2606 OID 16514)
-- Name: refresh_tokens refresh_tokens_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.refresh_tokens
    ADD CONSTRAINT refresh_tokens_pkey PRIMARY KEY (id);


--
-- TOC entry 3868 (class 2606 OID 16694)
-- Name: refresh_tokens refresh_tokens_token_unique; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.refresh_tokens
    ADD CONSTRAINT refresh_tokens_token_unique UNIQUE (token);


--
-- TOC entry 3916 (class 2606 OID 16823)
-- Name: saml_providers saml_providers_entity_id_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_providers
    ADD CONSTRAINT saml_providers_entity_id_key UNIQUE (entity_id);


--
-- TOC entry 3918 (class 2606 OID 16821)
-- Name: saml_providers saml_providers_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_providers
    ADD CONSTRAINT saml_providers_pkey PRIMARY KEY (id);


--
-- TOC entry 3923 (class 2606 OID 16837)
-- Name: saml_relay_states saml_relay_states_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_relay_states
    ADD CONSTRAINT saml_relay_states_pkey PRIMARY KEY (id);


--
-- TOC entry 3876 (class 2606 OID 16537)
-- Name: schema_migrations schema_migrations_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.schema_migrations
    ADD CONSTRAINT schema_migrations_pkey PRIMARY KEY (version);


--
-- TOC entry 3889 (class 2606 OID 16715)
-- Name: sessions sessions_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sessions
    ADD CONSTRAINT sessions_pkey PRIMARY KEY (id);


--
-- TOC entry 3913 (class 2606 OID 16804)
-- Name: sso_domains sso_domains_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sso_domains
    ADD CONSTRAINT sso_domains_pkey PRIMARY KEY (id);


--
-- TOC entry 3908 (class 2606 OID 16795)
-- Name: sso_providers sso_providers_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sso_providers
    ADD CONSTRAINT sso_providers_pkey PRIMARY KEY (id);


--
-- TOC entry 3858 (class 2606 OID 16877)
-- Name: users users_phone_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.users
    ADD CONSTRAINT users_phone_key UNIQUE (phone);


--
-- TOC entry 3860 (class 2606 OID 16501)
-- Name: users users_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- TOC entry 4002 (class 2606 OID 17532)
-- Name: applications applications_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.applications
    ADD CONSTRAINT applications_pkey PRIMARY KEY (id);


--
-- TOC entry 4014 (class 2606 OID 22999)
-- Name: candidates candidates_email_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.candidates
    ADD CONSTRAINT candidates_email_key UNIQUE (email);


--
-- TOC entry 4016 (class 2606 OID 19444)
-- Name: candidates candidates_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.candidates
    ADD CONSTRAINT candidates_pkey PRIMARY KEY (id);


--
-- TOC entry 4023 (class 2606 OID 22975)
-- Name: company_departments company_departments_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.company_departments
    ADD CONSTRAINT company_departments_pkey PRIMARY KEY (id);


--
-- TOC entry 4008 (class 2606 OID 17792)
-- Name: evaluation_assignments_v2 evaluation_assignments_v2_application_id_evaluator_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.evaluation_assignments_v2
    ADD CONSTRAINT evaluation_assignments_v2_application_id_evaluator_id_key UNIQUE (application_id, evaluator_id);


--
-- TOC entry 4010 (class 2606 OID 17790)
-- Name: evaluation_assignments_v2 evaluation_assignments_v2_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.evaluation_assignments_v2
    ADD CONSTRAINT evaluation_assignments_v2_pkey PRIMARY KEY (id);


--
-- TOC entry 4019 (class 2606 OID 22950)
-- Name: evaluations evaluations_application_id_evaluator_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.evaluations
    ADD CONSTRAINT evaluations_application_id_evaluator_id_key UNIQUE (application_id, evaluator_id);


--
-- TOC entry 4021 (class 2606 OID 22948)
-- Name: evaluations evaluations_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.evaluations
    ADD CONSTRAINT evaluations_pkey PRIMARY KEY (id);


--
-- TOC entry 4000 (class 2606 OID 17516)
-- Name: jobs jobs_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.jobs
    ADD CONSTRAINT jobs_pkey PRIMARY KEY (id);


--
-- TOC entry 4012 (class 2606 OID 19197)
-- Name: plans plans_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.plans
    ADD CONSTRAINT plans_pkey PRIMARY KEY (id);


--
-- TOC entry 4004 (class 2606 OID 17760)
-- Name: tenants tenants_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tenants
    ADD CONSTRAINT tenants_pkey PRIMARY KEY (id);


--
-- TOC entry 4006 (class 2606 OID 17770)
-- Name: user_profiles user_profiles_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_profiles
    ADD CONSTRAINT user_profiles_pkey PRIMARY KEY (id);


--
-- TOC entry 4025 (class 2606 OID 34260)
-- Name: user_tenants user_tenants_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_tenants
    ADD CONSTRAINT user_tenants_pkey PRIMARY KEY (id);


--
-- TOC entry 4027 (class 2606 OID 34262)
-- Name: user_tenants user_tenants_user_id_tenant_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_tenants
    ADD CONSTRAINT user_tenants_user_id_tenant_id_key UNIQUE (user_id, tenant_id);


--
-- TOC entry 3996 (class 2606 OID 17489)
-- Name: users users_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- TOC entry 3994 (class 2606 OID 17479)
-- Name: messages messages_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_realtime_admin
--

ALTER TABLE ONLY realtime.messages
    ADD CONSTRAINT messages_pkey PRIMARY KEY (id, inserted_at);


--
-- TOC entry 3990 (class 2606 OID 17333)
-- Name: subscription pk_subscription; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
--

ALTER TABLE ONLY realtime.subscription
    ADD CONSTRAINT pk_subscription PRIMARY KEY (id);


--
-- TOC entry 3956 (class 2606 OID 17080)
-- Name: schema_migrations schema_migrations_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
--

ALTER TABLE ONLY realtime.schema_migrations
    ADD CONSTRAINT schema_migrations_pkey PRIMARY KEY (version);


--
-- TOC entry 3981 (class 2606 OID 17306)
-- Name: buckets_analytics buckets_analytics_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.buckets_analytics
    ADD CONSTRAINT buckets_analytics_pkey PRIMARY KEY (id);


--
-- TOC entry 3963 (class 2606 OID 17097)
-- Name: buckets buckets_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.buckets
    ADD CONSTRAINT buckets_pkey PRIMARY KEY (id);


--
-- TOC entry 3984 (class 2606 OID 17282)
-- Name: buckets_vectors buckets_vectors_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.buckets_vectors
    ADD CONSTRAINT buckets_vectors_pkey PRIMARY KEY (id);


--
-- TOC entry 3958 (class 2606 OID 17088)
-- Name: migrations migrations_name_key; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.migrations
    ADD CONSTRAINT migrations_name_key UNIQUE (name);


--
-- TOC entry 3960 (class 2606 OID 17086)
-- Name: migrations migrations_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.migrations
    ADD CONSTRAINT migrations_pkey PRIMARY KEY (id);


--
-- TOC entry 3971 (class 2606 OID 17109)
-- Name: objects objects_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.objects
    ADD CONSTRAINT objects_pkey PRIMARY KEY (id);


--
-- TOC entry 3979 (class 2606 OID 17211)
-- Name: prefixes prefixes_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.prefixes
    ADD CONSTRAINT prefixes_pkey PRIMARY KEY (bucket_id, level, name);


--
-- TOC entry 3976 (class 2606 OID 17172)
-- Name: s3_multipart_uploads_parts s3_multipart_uploads_parts_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads_parts
    ADD CONSTRAINT s3_multipart_uploads_parts_pkey PRIMARY KEY (id);


--
-- TOC entry 3974 (class 2606 OID 17157)
-- Name: s3_multipart_uploads s3_multipart_uploads_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads
    ADD CONSTRAINT s3_multipart_uploads_pkey PRIMARY KEY (id);


--
-- TOC entry 3987 (class 2606 OID 17292)
-- Name: vector_indexes vector_indexes_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.vector_indexes
    ADD CONSTRAINT vector_indexes_pkey PRIMARY KEY (id);


--
-- TOC entry 3874 (class 1259 OID 16532)
-- Name: audit_logs_instance_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX audit_logs_instance_id_idx ON auth.audit_log_entries USING btree (instance_id);


--
-- TOC entry 3848 (class 1259 OID 16704)
-- Name: confirmation_token_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX confirmation_token_idx ON auth.users USING btree (confirmation_token) WHERE ((confirmation_token)::text !~ '^[0-9 ]*$'::text);


--
-- TOC entry 3849 (class 1259 OID 16706)
-- Name: email_change_token_current_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX email_change_token_current_idx ON auth.users USING btree (email_change_token_current) WHERE ((email_change_token_current)::text !~ '^[0-9 ]*$'::text);


--
-- TOC entry 3850 (class 1259 OID 16707)
-- Name: email_change_token_new_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX email_change_token_new_idx ON auth.users USING btree (email_change_token_new) WHERE ((email_change_token_new)::text !~ '^[0-9 ]*$'::text);


--
-- TOC entry 3892 (class 1259 OID 16785)
-- Name: factor_id_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX factor_id_created_at_idx ON auth.mfa_factors USING btree (user_id, created_at);


--
-- TOC entry 3925 (class 1259 OID 16893)
-- Name: flow_state_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX flow_state_created_at_idx ON auth.flow_state USING btree (created_at DESC);


--
-- TOC entry 3880 (class 1259 OID 16873)
-- Name: identities_email_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX identities_email_idx ON auth.identities USING btree (email text_pattern_ops);


--
-- TOC entry 4529 (class 0 OID 0)
-- Dependencies: 3880
-- Name: INDEX identities_email_idx; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON INDEX auth.identities_email_idx IS 'Auth: Ensures indexed queries on the email column';


--
-- TOC entry 3885 (class 1259 OID 16701)
-- Name: identities_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX identities_user_id_idx ON auth.identities USING btree (user_id);


--
-- TOC entry 3928 (class 1259 OID 16890)
-- Name: idx_auth_code; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX idx_auth_code ON auth.flow_state USING btree (auth_code);


--
-- TOC entry 3952 (class 1259 OID 17075)
-- Name: idx_oauth_client_states_created_at; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX idx_oauth_client_states_created_at ON auth.oauth_client_states USING btree (created_at);


--
-- TOC entry 3929 (class 1259 OID 16891)
-- Name: idx_user_id_auth_method; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX idx_user_id_auth_method ON auth.flow_state USING btree (user_id, authentication_method);


--
-- TOC entry 3900 (class 1259 OID 16896)
-- Name: mfa_challenge_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX mfa_challenge_created_at_idx ON auth.mfa_challenges USING btree (created_at DESC);


--
-- TOC entry 3897 (class 1259 OID 16757)
-- Name: mfa_factors_user_friendly_name_unique; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX mfa_factors_user_friendly_name_unique ON auth.mfa_factors USING btree (friendly_name, user_id) WHERE (TRIM(BOTH FROM friendly_name) <> ''::text);


--
-- TOC entry 3898 (class 1259 OID 16902)
-- Name: mfa_factors_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX mfa_factors_user_id_idx ON auth.mfa_factors USING btree (user_id);


--
-- TOC entry 3938 (class 1259 OID 17027)
-- Name: oauth_auth_pending_exp_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX oauth_auth_pending_exp_idx ON auth.oauth_authorizations USING btree (expires_at) WHERE (status = 'pending'::auth.oauth_authorization_status);


--
-- TOC entry 3935 (class 1259 OID 16980)
-- Name: oauth_clients_deleted_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX oauth_clients_deleted_at_idx ON auth.oauth_clients USING btree (deleted_at);


--
-- TOC entry 3945 (class 1259 OID 17053)
-- Name: oauth_consents_active_client_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX oauth_consents_active_client_idx ON auth.oauth_consents USING btree (client_id) WHERE (revoked_at IS NULL);


--
-- TOC entry 3946 (class 1259 OID 17051)
-- Name: oauth_consents_active_user_client_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX oauth_consents_active_user_client_idx ON auth.oauth_consents USING btree (user_id, client_id) WHERE (revoked_at IS NULL);


--
-- TOC entry 3951 (class 1259 OID 17052)
-- Name: oauth_consents_user_order_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX oauth_consents_user_order_idx ON auth.oauth_consents USING btree (user_id, granted_at DESC);


--
-- TOC entry 3932 (class 1259 OID 16949)
-- Name: one_time_tokens_relates_to_hash_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX one_time_tokens_relates_to_hash_idx ON auth.one_time_tokens USING hash (relates_to);


--
-- TOC entry 3933 (class 1259 OID 16948)
-- Name: one_time_tokens_token_hash_hash_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX one_time_tokens_token_hash_hash_idx ON auth.one_time_tokens USING hash (token_hash);


--
-- TOC entry 3934 (class 1259 OID 16950)
-- Name: one_time_tokens_user_id_token_type_key; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX one_time_tokens_user_id_token_type_key ON auth.one_time_tokens USING btree (user_id, token_type);


--
-- TOC entry 3851 (class 1259 OID 16708)
-- Name: reauthentication_token_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX reauthentication_token_idx ON auth.users USING btree (reauthentication_token) WHERE ((reauthentication_token)::text !~ '^[0-9 ]*$'::text);


--
-- TOC entry 3852 (class 1259 OID 16705)
-- Name: recovery_token_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX recovery_token_idx ON auth.users USING btree (recovery_token) WHERE ((recovery_token)::text !~ '^[0-9 ]*$'::text);


--
-- TOC entry 3861 (class 1259 OID 16515)
-- Name: refresh_tokens_instance_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_instance_id_idx ON auth.refresh_tokens USING btree (instance_id);


--
-- TOC entry 3862 (class 1259 OID 16516)
-- Name: refresh_tokens_instance_id_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_instance_id_user_id_idx ON auth.refresh_tokens USING btree (instance_id, user_id);


--
-- TOC entry 3863 (class 1259 OID 16700)
-- Name: refresh_tokens_parent_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_parent_idx ON auth.refresh_tokens USING btree (parent);


--
-- TOC entry 3866 (class 1259 OID 16787)
-- Name: refresh_tokens_session_id_revoked_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_session_id_revoked_idx ON auth.refresh_tokens USING btree (session_id, revoked);


--
-- TOC entry 3869 (class 1259 OID 16892)
-- Name: refresh_tokens_updated_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_updated_at_idx ON auth.refresh_tokens USING btree (updated_at DESC);


--
-- TOC entry 3919 (class 1259 OID 16829)
-- Name: saml_providers_sso_provider_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX saml_providers_sso_provider_id_idx ON auth.saml_providers USING btree (sso_provider_id);


--
-- TOC entry 3920 (class 1259 OID 16894)
-- Name: saml_relay_states_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX saml_relay_states_created_at_idx ON auth.saml_relay_states USING btree (created_at DESC);


--
-- TOC entry 3921 (class 1259 OID 16844)
-- Name: saml_relay_states_for_email_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX saml_relay_states_for_email_idx ON auth.saml_relay_states USING btree (for_email);


--
-- TOC entry 3924 (class 1259 OID 16843)
-- Name: saml_relay_states_sso_provider_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX saml_relay_states_sso_provider_id_idx ON auth.saml_relay_states USING btree (sso_provider_id);


--
-- TOC entry 3886 (class 1259 OID 16895)
-- Name: sessions_not_after_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX sessions_not_after_idx ON auth.sessions USING btree (not_after DESC);


--
-- TOC entry 3887 (class 1259 OID 17065)
-- Name: sessions_oauth_client_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX sessions_oauth_client_id_idx ON auth.sessions USING btree (oauth_client_id);


--
-- TOC entry 3890 (class 1259 OID 16786)
-- Name: sessions_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX sessions_user_id_idx ON auth.sessions USING btree (user_id);


--
-- TOC entry 3911 (class 1259 OID 16811)
-- Name: sso_domains_domain_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX sso_domains_domain_idx ON auth.sso_domains USING btree (lower(domain));


--
-- TOC entry 3914 (class 1259 OID 16810)
-- Name: sso_domains_sso_provider_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX sso_domains_sso_provider_id_idx ON auth.sso_domains USING btree (sso_provider_id);


--
-- TOC entry 3909 (class 1259 OID 16796)
-- Name: sso_providers_resource_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX sso_providers_resource_id_idx ON auth.sso_providers USING btree (lower(resource_id));


--
-- TOC entry 3910 (class 1259 OID 16958)
-- Name: sso_providers_resource_id_pattern_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX sso_providers_resource_id_pattern_idx ON auth.sso_providers USING btree (resource_id text_pattern_ops);


--
-- TOC entry 3899 (class 1259 OID 16955)
-- Name: unique_phone_factor_per_user; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX unique_phone_factor_per_user ON auth.mfa_factors USING btree (user_id, phone);


--
-- TOC entry 3891 (class 1259 OID 16784)
-- Name: user_id_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX user_id_created_at_idx ON auth.sessions USING btree (user_id, created_at);


--
-- TOC entry 3853 (class 1259 OID 16864)
-- Name: users_email_partial_key; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX users_email_partial_key ON auth.users USING btree (email) WHERE (is_sso_user = false);


--
-- TOC entry 4530 (class 0 OID 0)
-- Dependencies: 3853
-- Name: INDEX users_email_partial_key; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON INDEX auth.users_email_partial_key IS 'Auth: A partial unique index that applies only when is_sso_user is false';


--
-- TOC entry 3854 (class 1259 OID 16702)
-- Name: users_instance_id_email_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX users_instance_id_email_idx ON auth.users USING btree (instance_id, lower((email)::text));


--
-- TOC entry 3855 (class 1259 OID 16505)
-- Name: users_instance_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX users_instance_id_idx ON auth.users USING btree (instance_id);


--
-- TOC entry 3856 (class 1259 OID 16919)
-- Name: users_is_anonymous_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX users_is_anonymous_idx ON auth.users USING btree (is_anonymous);


--
-- TOC entry 4017 (class 1259 OID 19445)
-- Name: idx_candidates_email; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_candidates_email ON public.candidates USING btree (email);


--
-- TOC entry 3997 (class 1259 OID 22851)
-- Name: idx_jobs_status; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_jobs_status ON public.jobs USING btree (status);


--
-- TOC entry 3998 (class 1259 OID 19152)
-- Name: idx_jobs_tenant; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_jobs_tenant ON public.jobs USING btree ("tenantId");


--
-- TOC entry 3988 (class 1259 OID 17480)
-- Name: ix_realtime_subscription_entity; Type: INDEX; Schema: realtime; Owner: supabase_admin
--

CREATE INDEX ix_realtime_subscription_entity ON realtime.subscription USING btree (entity);


--
-- TOC entry 3992 (class 1259 OID 17481)
-- Name: messages_inserted_at_topic_index; Type: INDEX; Schema: realtime; Owner: supabase_realtime_admin
--

CREATE INDEX messages_inserted_at_topic_index ON ONLY realtime.messages USING btree (inserted_at DESC, topic) WHERE ((extension = 'broadcast'::text) AND (private IS TRUE));


--
-- TOC entry 3991 (class 1259 OID 17382)
-- Name: subscription_subscription_id_entity_filters_key; Type: INDEX; Schema: realtime; Owner: supabase_admin
--

CREATE UNIQUE INDEX subscription_subscription_id_entity_filters_key ON realtime.subscription USING btree (subscription_id, entity, filters);


--
-- TOC entry 3961 (class 1259 OID 17098)
-- Name: bname; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX bname ON storage.buckets USING btree (name);


--
-- TOC entry 3964 (class 1259 OID 17115)
-- Name: bucketid_objname; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX bucketid_objname ON storage.objects USING btree (bucket_id, name);


--
-- TOC entry 3982 (class 1259 OID 17307)
-- Name: buckets_analytics_unique_name_idx; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX buckets_analytics_unique_name_idx ON storage.buckets_analytics USING btree (name) WHERE (deleted_at IS NULL);


--
-- TOC entry 3972 (class 1259 OID 17183)
-- Name: idx_multipart_uploads_list; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX idx_multipart_uploads_list ON storage.s3_multipart_uploads USING btree (bucket_id, key, created_at);


--
-- TOC entry 3965 (class 1259 OID 17229)
-- Name: idx_name_bucket_level_unique; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX idx_name_bucket_level_unique ON storage.objects USING btree (name COLLATE "C", bucket_id, level);


--
-- TOC entry 3966 (class 1259 OID 17148)
-- Name: idx_objects_bucket_id_name; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX idx_objects_bucket_id_name ON storage.objects USING btree (bucket_id, name COLLATE "C");


--
-- TOC entry 3967 (class 1259 OID 17231)
-- Name: idx_objects_lower_name; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX idx_objects_lower_name ON storage.objects USING btree ((path_tokens[level]), lower(name) text_pattern_ops, bucket_id, level);


--
-- TOC entry 3977 (class 1259 OID 17232)
-- Name: idx_prefixes_lower_name; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX idx_prefixes_lower_name ON storage.prefixes USING btree (bucket_id, level, ((string_to_array(name, '/'::text))[level]), lower(name) text_pattern_ops);


--
-- TOC entry 3968 (class 1259 OID 17116)
-- Name: name_prefix_search; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX name_prefix_search ON storage.objects USING btree (name text_pattern_ops);


--
-- TOC entry 3969 (class 1259 OID 17230)
-- Name: objects_bucket_id_level_idx; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX objects_bucket_id_level_idx ON storage.objects USING btree (bucket_id, level, name COLLATE "C");


--
-- TOC entry 3985 (class 1259 OID 17298)
-- Name: vector_indexes_name_bucket_id_idx; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX vector_indexes_name_bucket_id_idx ON storage.vector_indexes USING btree (name, bucket_id);


--
-- TOC entry 4072 (class 2620 OID 17338)
-- Name: subscription tr_check_filters; Type: TRIGGER; Schema: realtime; Owner: supabase_admin
--

CREATE TRIGGER tr_check_filters BEFORE INSERT OR UPDATE ON realtime.subscription FOR EACH ROW EXECUTE FUNCTION realtime.subscription_check_filters();


--
-- TOC entry 4065 (class 2620 OID 17239)
-- Name: buckets enforce_bucket_name_length_trigger; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER enforce_bucket_name_length_trigger BEFORE INSERT OR UPDATE OF name ON storage.buckets FOR EACH ROW EXECUTE FUNCTION storage.enforce_bucket_name_length();


--
-- TOC entry 4066 (class 2620 OID 17269)
-- Name: objects objects_delete_delete_prefix; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER objects_delete_delete_prefix AFTER DELETE ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.delete_prefix_hierarchy_trigger();


--
-- TOC entry 4067 (class 2620 OID 17225)
-- Name: objects objects_insert_create_prefix; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER objects_insert_create_prefix BEFORE INSERT ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.objects_insert_prefix_trigger();


--
-- TOC entry 4068 (class 2620 OID 17268)
-- Name: objects objects_update_create_prefix; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER objects_update_create_prefix BEFORE UPDATE ON storage.objects FOR EACH ROW WHEN (((new.name <> old.name) OR (new.bucket_id <> old.bucket_id))) EXECUTE FUNCTION storage.objects_update_prefix_trigger();


--
-- TOC entry 4070 (class 2620 OID 17235)
-- Name: prefixes prefixes_create_hierarchy; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER prefixes_create_hierarchy BEFORE INSERT ON storage.prefixes FOR EACH ROW WHEN ((pg_trigger_depth() < 1)) EXECUTE FUNCTION storage.prefixes_insert_trigger();


--
-- TOC entry 4071 (class 2620 OID 17270)
-- Name: prefixes prefixes_delete_hierarchy; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER prefixes_delete_hierarchy AFTER DELETE ON storage.prefixes FOR EACH ROW EXECUTE FUNCTION storage.delete_prefix_hierarchy_trigger();


--
-- TOC entry 4069 (class 2620 OID 17136)
-- Name: objects update_objects_updated_at; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER update_objects_updated_at BEFORE UPDATE ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.update_updated_at_column();


--
-- TOC entry 4029 (class 2606 OID 16688)
-- Name: identities identities_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.identities
    ADD CONSTRAINT identities_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4034 (class 2606 OID 16777)
-- Name: mfa_amr_claims mfa_amr_claims_session_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_amr_claims
    ADD CONSTRAINT mfa_amr_claims_session_id_fkey FOREIGN KEY (session_id) REFERENCES auth.sessions(id) ON DELETE CASCADE;


--
-- TOC entry 4033 (class 2606 OID 16765)
-- Name: mfa_challenges mfa_challenges_auth_factor_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_challenges
    ADD CONSTRAINT mfa_challenges_auth_factor_id_fkey FOREIGN KEY (factor_id) REFERENCES auth.mfa_factors(id) ON DELETE CASCADE;


--
-- TOC entry 4032 (class 2606 OID 16752)
-- Name: mfa_factors mfa_factors_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_factors
    ADD CONSTRAINT mfa_factors_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4040 (class 2606 OID 17017)
-- Name: oauth_authorizations oauth_authorizations_client_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_authorizations
    ADD CONSTRAINT oauth_authorizations_client_id_fkey FOREIGN KEY (client_id) REFERENCES auth.oauth_clients(id) ON DELETE CASCADE;


--
-- TOC entry 4041 (class 2606 OID 17022)
-- Name: oauth_authorizations oauth_authorizations_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_authorizations
    ADD CONSTRAINT oauth_authorizations_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4042 (class 2606 OID 17046)
-- Name: oauth_consents oauth_consents_client_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_consents
    ADD CONSTRAINT oauth_consents_client_id_fkey FOREIGN KEY (client_id) REFERENCES auth.oauth_clients(id) ON DELETE CASCADE;


--
-- TOC entry 4043 (class 2606 OID 17041)
-- Name: oauth_consents oauth_consents_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_consents
    ADD CONSTRAINT oauth_consents_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4039 (class 2606 OID 16943)
-- Name: one_time_tokens one_time_tokens_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.one_time_tokens
    ADD CONSTRAINT one_time_tokens_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4028 (class 2606 OID 16721)
-- Name: refresh_tokens refresh_tokens_session_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.refresh_tokens
    ADD CONSTRAINT refresh_tokens_session_id_fkey FOREIGN KEY (session_id) REFERENCES auth.sessions(id) ON DELETE CASCADE;


--
-- TOC entry 4036 (class 2606 OID 16824)
-- Name: saml_providers saml_providers_sso_provider_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_providers
    ADD CONSTRAINT saml_providers_sso_provider_id_fkey FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers(id) ON DELETE CASCADE;


--
-- TOC entry 4037 (class 2606 OID 16897)
-- Name: saml_relay_states saml_relay_states_flow_state_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_relay_states
    ADD CONSTRAINT saml_relay_states_flow_state_id_fkey FOREIGN KEY (flow_state_id) REFERENCES auth.flow_state(id) ON DELETE CASCADE;


--
-- TOC entry 4038 (class 2606 OID 16838)
-- Name: saml_relay_states saml_relay_states_sso_provider_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_relay_states
    ADD CONSTRAINT saml_relay_states_sso_provider_id_fkey FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers(id) ON DELETE CASCADE;


--
-- TOC entry 4030 (class 2606 OID 17060)
-- Name: sessions sessions_oauth_client_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sessions
    ADD CONSTRAINT sessions_oauth_client_id_fkey FOREIGN KEY (oauth_client_id) REFERENCES auth.oauth_clients(id) ON DELETE CASCADE;


--
-- TOC entry 4031 (class 2606 OID 16716)
-- Name: sessions sessions_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sessions
    ADD CONSTRAINT sessions_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4035 (class 2606 OID 16805)
-- Name: sso_domains sso_domains_sso_provider_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sso_domains
    ADD CONSTRAINT sso_domains_sso_provider_id_fkey FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers(id) ON DELETE CASCADE;


--
-- TOC entry 4054 (class 2606 OID 23020)
-- Name: applications applications_candidate_link; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.applications
    ADD CONSTRAINT applications_candidate_link FOREIGN KEY ("candidateId") REFERENCES public.candidates(id) ON DELETE CASCADE;


--
-- TOC entry 4055 (class 2606 OID 23015)
-- Name: applications applications_job_link; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.applications
    ADD CONSTRAINT applications_job_link FOREIGN KEY ("jobId") REFERENCES public.jobs(id) ON DELETE CASCADE;


--
-- TOC entry 4056 (class 2606 OID 19147)
-- Name: applications applications_tenantId_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.applications
    ADD CONSTRAINT "applications_tenantId_fkey" FOREIGN KEY ("tenantId") REFERENCES public.tenants(id);


--
-- TOC entry 4062 (class 2606 OID 22976)
-- Name: company_departments company_departments_tenantId_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.company_departments
    ADD CONSTRAINT "company_departments_tenantId_fkey" FOREIGN KEY ("tenantId") REFERENCES public.tenants(id);


--
-- TOC entry 4060 (class 2606 OID 17793)
-- Name: evaluation_assignments_v2 evaluation_assignments_v2_application_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.evaluation_assignments_v2
    ADD CONSTRAINT evaluation_assignments_v2_application_id_fkey FOREIGN KEY (application_id) REFERENCES public.applications(id) ON DELETE CASCADE;


--
-- TOC entry 4061 (class 2606 OID 17798)
-- Name: evaluation_assignments_v2 evaluation_assignments_v2_evaluator_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.evaluation_assignments_v2
    ADD CONSTRAINT evaluation_assignments_v2_evaluator_id_fkey FOREIGN KEY (evaluator_id) REFERENCES public.user_profiles(id) ON DELETE CASCADE;


--
-- TOC entry 4052 (class 2606 OID 19139)
-- Name: jobs jobs_createdBy_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.jobs
    ADD CONSTRAINT "jobs_createdBy_fkey" FOREIGN KEY ("createdBy") REFERENCES public.user_profiles(id);


--
-- TOC entry 4053 (class 2606 OID 19160)
-- Name: jobs jobs_tenantid_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.jobs
    ADD CONSTRAINT jobs_tenantid_fkey FOREIGN KEY ("tenantId") REFERENCES public.tenants(id);


--
-- TOC entry 4057 (class 2606 OID 19199)
-- Name: tenants tenants_planId_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tenants
    ADD CONSTRAINT "tenants_planId_fkey" FOREIGN KEY ("planId") REFERENCES public.plans(id);


--
-- TOC entry 4058 (class 2606 OID 34317)
-- Name: user_profiles user_profiles_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_profiles
    ADD CONSTRAINT user_profiles_id_fkey FOREIGN KEY (id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4059 (class 2606 OID 19354)
-- Name: user_profiles user_profiles_tenant_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_profiles
    ADD CONSTRAINT user_profiles_tenant_id_fkey FOREIGN KEY ("tenantId") REFERENCES public.tenants(id);


--
-- TOC entry 4063 (class 2606 OID 34268)
-- Name: user_tenants user_tenants_tenant_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_tenants
    ADD CONSTRAINT user_tenants_tenant_id_fkey FOREIGN KEY (tenant_id) REFERENCES public.tenants(id) ON DELETE CASCADE;


--
-- TOC entry 4064 (class 2606 OID 34327)
-- Name: user_tenants user_tenants_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_tenants
    ADD CONSTRAINT user_tenants_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4050 (class 2606 OID 34322)
-- Name: users users_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_id_fkey FOREIGN KEY (id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4051 (class 2606 OID 19349)
-- Name: users users_tenantid_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_tenantid_fkey FOREIGN KEY ("tenantId") REFERENCES public.tenants(id);


--
-- TOC entry 4044 (class 2606 OID 17110)
-- Name: objects objects_bucketId_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.objects
    ADD CONSTRAINT "objects_bucketId_fkey" FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id);


--
-- TOC entry 4048 (class 2606 OID 17212)
-- Name: prefixes prefixes_bucketId_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.prefixes
    ADD CONSTRAINT "prefixes_bucketId_fkey" FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id);


--
-- TOC entry 4045 (class 2606 OID 17158)
-- Name: s3_multipart_uploads s3_multipart_uploads_bucket_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads
    ADD CONSTRAINT s3_multipart_uploads_bucket_id_fkey FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id);


--
-- TOC entry 4046 (class 2606 OID 17178)
-- Name: s3_multipart_uploads_parts s3_multipart_uploads_parts_bucket_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads_parts
    ADD CONSTRAINT s3_multipart_uploads_parts_bucket_id_fkey FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id);


--
-- TOC entry 4047 (class 2606 OID 17173)
-- Name: s3_multipart_uploads_parts s3_multipart_uploads_parts_upload_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads_parts
    ADD CONSTRAINT s3_multipart_uploads_parts_upload_id_fkey FOREIGN KEY (upload_id) REFERENCES storage.s3_multipart_uploads(id) ON DELETE CASCADE;


--
-- TOC entry 4049 (class 2606 OID 17293)
-- Name: vector_indexes vector_indexes_bucket_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.vector_indexes
    ADD CONSTRAINT vector_indexes_bucket_id_fkey FOREIGN KEY (bucket_id) REFERENCES storage.buckets_vectors(id);


--
-- TOC entry 4224 (class 0 OID 16525)
-- Dependencies: 350
-- Name: audit_log_entries; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.audit_log_entries ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4235 (class 0 OID 16883)
-- Dependencies: 364
-- Name: flow_state; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.flow_state ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4226 (class 0 OID 16681)
-- Dependencies: 355
-- Name: identities; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.identities ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4223 (class 0 OID 16518)
-- Dependencies: 349
-- Name: instances; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.instances ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4230 (class 0 OID 16770)
-- Dependencies: 359
-- Name: mfa_amr_claims; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.mfa_amr_claims ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4229 (class 0 OID 16758)
-- Dependencies: 358
-- Name: mfa_challenges; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.mfa_challenges ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4228 (class 0 OID 16745)
-- Dependencies: 357
-- Name: mfa_factors; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.mfa_factors ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4236 (class 0 OID 16933)
-- Dependencies: 365
-- Name: one_time_tokens; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.one_time_tokens ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4222 (class 0 OID 16507)
-- Dependencies: 348
-- Name: refresh_tokens; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.refresh_tokens ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4233 (class 0 OID 16812)
-- Dependencies: 362
-- Name: saml_providers; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.saml_providers ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4234 (class 0 OID 16830)
-- Dependencies: 363
-- Name: saml_relay_states; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.saml_relay_states ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4225 (class 0 OID 16533)
-- Dependencies: 351
-- Name: schema_migrations; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.schema_migrations ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4227 (class 0 OID 16711)
-- Dependencies: 356
-- Name: sessions; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.sessions ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4232 (class 0 OID 16797)
-- Dependencies: 361
-- Name: sso_domains; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.sso_domains ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4231 (class 0 OID 16788)
-- Dependencies: 360
-- Name: sso_providers; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.sso_providers ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4221 (class 0 OID 16495)
-- Dependencies: 346
-- Name: users; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.users ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4279 (class 3256 OID 22959)
-- Name: jobs Acesso total a jobs; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total a jobs" ON public.jobs USING (true) WITH CHECK (true);


--
-- TOC entry 4271 (class 3256 OID 22928)
-- Name: jobs Acesso total a jobs do tenant; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total a jobs do tenant" ON public.jobs USING (("tenantId" IN ( SELECT user_profiles."tenantId"
   FROM public.user_profiles
  WHERE (user_profiles.id = auth.uid()))));


--
-- TOC entry 4278 (class 3256 OID 22958)
-- Name: user_profiles Acesso total a perfis; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total a perfis" ON public.user_profiles USING (true) WITH CHECK (true);


--
-- TOC entry 4277 (class 3256 OID 22957)
-- Name: tenants Acesso total a tenants; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total a tenants" ON public.tenants USING (true) WITH CHECK (true);


--
-- TOC entry 4284 (class 3256 OID 22985)
-- Name: applications Acesso total applications; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total applications" ON public.applications USING ((auth.role() = 'authenticated'::text));


--
-- TOC entry 4283 (class 3256 OID 22984)
-- Name: candidates Acesso total candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total candidates" ON public.candidates USING ((auth.role() = 'authenticated'::text));


--
-- TOC entry 4281 (class 3256 OID 22982)
-- Name: company_departments Acesso total departamentos; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total departamentos" ON public.company_departments USING ((auth.role() = 'authenticated'::text));


--
-- TOC entry 4282 (class 3256 OID 22983)
-- Name: jobs Acesso total jobs; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total jobs" ON public.jobs USING ((auth.role() = 'authenticated'::text));


--
-- TOC entry 4280 (class 3256 OID 22981)
-- Name: tenants Acesso total tenants; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total tenants" ON public.tenants USING ((auth.role() = 'authenticated'::text));


--
-- TOC entry 4291 (class 3256 OID 24181)
-- Name: users Admins can update team members; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Admins can update team members" ON public.users FOR UPDATE USING (((auth.uid() IN ( SELECT users_1.id
   FROM public.users users_1
  WHERE (users_1."isAdmin" = true))) AND ("tenantId" = ( SELECT users_1."tenantId"
   FROM public.users users_1
  WHERE (users_1.id = auth.uid())))));


--
-- TOC entry 4290 (class 3256 OID 24180)
-- Name: users Admins can view team members; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Admins can view team members" ON public.users FOR SELECT USING (((auth.uid() IN ( SELECT users_1.id
   FROM public.users users_1
  WHERE (users_1."isAdmin" = true))) AND ("tenantId" = ( SELECT users_1."tenantId"
   FROM public.users users_1
  WHERE (users_1.id = auth.uid())))));


--
-- TOC entry 4255 (class 3256 OID 19230)
-- Name: plans Anyone can read plans; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Anyone can read plans" ON public.plans FOR SELECT USING (true);


--
-- TOC entry 4259 (class 3256 OID 19447)
-- Name: candidates Auth Read Candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Auth Read Candidates" ON public.candidates FOR SELECT TO authenticated USING (true);


--
-- TOC entry 4292 (class 3256 OID 24211)
-- Name: plans Authenticated can read plans; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Authenticated can read plans" ON public.plans FOR SELECT TO authenticated USING (true);


--
-- TOC entry 4270 (class 3256 OID 22923)
-- Name: jobs Criar jobs no tenant; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Criar jobs no tenant" ON public.jobs FOR INSERT WITH CHECK (("tenantId" IN ( SELECT user_profiles."tenantId"
   FROM public.user_profiles
  WHERE (user_profiles.id = auth.uid()))));


--
-- TOC entry 4288 (class 3256 OID 22992)
-- Name: evaluations Editar minha avaliacao; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Editar minha avaliacao" ON public.evaluations FOR UPDATE USING ((evaluator_id = auth.uid())) WITH CHECK ((evaluator_id = auth.uid()));


--
-- TOC entry 4276 (class 3256 OID 22954)
-- Name: evaluations Escrever avaliacoes; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Escrever avaliacoes" ON public.evaluations FOR INSERT WITH CHECK ((auth.uid() IS NOT NULL));


--
-- TOC entry 4275 (class 3256 OID 22952)
-- Name: jobs Escrever jobs; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Escrever jobs" ON public.jobs FOR INSERT WITH CHECK ((auth.uid() IS NOT NULL));


--
-- TOC entry 4287 (class 3256 OID 22991)
-- Name: evaluations Inserir minha avaliacao; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Inserir minha avaliacao" ON public.evaluations FOR INSERT WITH CHECK ((evaluator_id = auth.uid()));


--
-- TOC entry 4286 (class 3256 OID 22990)
-- Name: evaluations Ler avaliacoes; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Ler avaliacoes" ON public.evaluations FOR SELECT USING ((auth.role() = 'authenticated'::text));


--
-- TOC entry 4274 (class 3256 OID 22951)
-- Name: jobs Ler jobs; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Ler jobs" ON public.jobs FOR SELECT USING (true);


--
-- TOC entry 4260 (class 3256 OID 22919)
-- Name: jobs Ler jobs do tenant; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Ler jobs do tenant" ON public.jobs FOR SELECT USING (("tenantId" IN ( SELECT user_profiles."tenantId"
   FROM public.user_profiles
  WHERE (user_profiles.id = auth.uid()))));


--
-- TOC entry 4285 (class 3256 OID 22989)
-- Name: plans Ler planos; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Ler planos" ON public.plans FOR SELECT USING (true);


--
-- TOC entry 4269 (class 3256 OID 22922)
-- Name: user_profiles Ler proprio perfil; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Ler proprio perfil" ON public.user_profiles FOR SELECT USING ((id = auth.uid()));


--
-- TOC entry 4268 (class 3256 OID 22921)
-- Name: tenants Ler tenants vinculados; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Ler tenants vinculados" ON public.tenants FOR SELECT USING ((id IN ( SELECT user_profiles."tenantId"
   FROM public.user_profiles
  WHERE (user_profiles.id = auth.uid()))));


--
-- TOC entry 4258 (class 3256 OID 19446)
-- Name: candidates Public Insert Candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Public Insert Candidates" ON public.candidates FOR INSERT TO authenticated, anon WITH CHECK (true);


--
-- TOC entry 4264 (class 3256 OID 22997)
-- Name: applications Public insert applications; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Public insert applications" ON public.applications FOR INSERT TO anon WITH CHECK (true);


--
-- TOC entry 4261 (class 3256 OID 22994)
-- Name: candidates Public insert candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Public insert candidates" ON public.candidates FOR INSERT TO anon WITH CHECK (true);


--
-- TOC entry 4289 (class 3256 OID 22993)
-- Name: jobs Public read jobs; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Public read jobs" ON public.jobs FOR SELECT TO anon USING (true);


--
-- TOC entry 4262 (class 3256 OID 22995)
-- Name: candidates Public select candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Public select candidates" ON public.candidates FOR SELECT TO anon USING (true);


--
-- TOC entry 4263 (class 3256 OID 22996)
-- Name: candidates Public update candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Public update candidates" ON public.candidates FOR UPDATE TO anon USING (true);


--
-- TOC entry 4266 (class 3256 OID 23003)
-- Name: applications Recruiters read applications; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Recruiters read applications" ON public.applications FOR SELECT TO authenticated USING (true);


--
-- TOC entry 4265 (class 3256 OID 23002)
-- Name: candidates Recruiters read candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Recruiters read candidates" ON public.candidates FOR SELECT TO authenticated USING (true);


--
-- TOC entry 4293 (class 3256 OID 34273)
-- Name: user_tenants Users can view their own tenants; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Users can view their own tenants" ON public.user_tenants FOR SELECT USING ((auth.uid() = user_id));


--
-- TOC entry 4254 (class 3256 OID 17803)
-- Name: evaluation_assignments_v2 Users manage own assignments; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Users manage own assignments" ON public.evaluation_assignments_v2 USING ((evaluator_id = auth.uid()));


--
-- TOC entry 4248 (class 0 OID 17524)
-- Dependencies: 390
-- Name: applications; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.applications ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4250 (class 0 OID 19435)
-- Dependencies: 395
-- Name: candidates; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.candidates ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4252 (class 0 OID 22968)
-- Dependencies: 398
-- Name: company_departments; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.company_departments ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4249 (class 0 OID 17781)
-- Dependencies: 393
-- Name: evaluation_assignments_v2; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.evaluation_assignments_v2 ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4251 (class 0 OID 22939)
-- Dependencies: 396
-- Name: evaluations; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.evaluations ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4247 (class 0 OID 17508)
-- Dependencies: 388
-- Name: jobs; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.jobs ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4253 (class 0 OID 34251)
-- Dependencies: 399
-- Name: user_tenants; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.user_tenants ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4246 (class 0 OID 17465)
-- Dependencies: 385
-- Name: messages; Type: ROW SECURITY; Schema: realtime; Owner: supabase_realtime_admin
--

ALTER TABLE realtime.messages ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4257 (class 3256 OID 19388)
-- Name: objects Authenticated Users Read Resumes; Type: POLICY; Schema: storage; Owner: supabase_storage_admin
--

CREATE POLICY "Authenticated Users Read Resumes" ON storage.objects FOR SELECT TO authenticated USING ((bucket_id = 'resumes'::text));


--
-- TOC entry 4273 (class 3256 OID 23001)
-- Name: objects Public Select Resume; Type: POLICY; Schema: storage; Owner: supabase_storage_admin
--

CREATE POLICY "Public Select Resume" ON storage.objects FOR SELECT TO anon USING ((bucket_id = 'resumes'::text));


--
-- TOC entry 4272 (class 3256 OID 23000)
-- Name: objects Public Upload Resume; Type: POLICY; Schema: storage; Owner: supabase_storage_admin
--

CREATE POLICY "Public Upload Resume" ON storage.objects FOR INSERT TO anon WITH CHECK ((bucket_id = 'resumes'::text));


--
-- TOC entry 4256 (class 3256 OID 19387)
-- Name: objects Public Upload Resumes; Type: POLICY; Schema: storage; Owner: supabase_storage_admin
--

CREATE POLICY "Public Upload Resumes" ON storage.objects FOR INSERT WITH CHECK ((bucket_id = 'resumes'::text));


--
-- TOC entry 4267 (class 3256 OID 23004)
-- Name: objects Recruiters read resumes; Type: POLICY; Schema: storage; Owner: supabase_storage_admin
--

CREATE POLICY "Recruiters read resumes" ON storage.objects FOR SELECT TO authenticated USING ((bucket_id = 'resumes'::text));


--
-- TOC entry 4238 (class 0 OID 17089)
-- Dependencies: 372
-- Name: buckets; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.buckets ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4243 (class 0 OID 17246)
-- Dependencies: 377
-- Name: buckets_analytics; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.buckets_analytics ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4244 (class 0 OID 17273)
-- Dependencies: 378
-- Name: buckets_vectors; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.buckets_vectors ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4237 (class 0 OID 17081)
-- Dependencies: 371
-- Name: migrations; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.migrations ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4239 (class 0 OID 17099)
-- Dependencies: 373
-- Name: objects; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.objects ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4242 (class 0 OID 17202)
-- Dependencies: 376
-- Name: prefixes; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.prefixes ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4240 (class 0 OID 17149)
-- Dependencies: 374
-- Name: s3_multipart_uploads; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.s3_multipart_uploads ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4241 (class 0 OID 17163)
-- Dependencies: 375
-- Name: s3_multipart_uploads_parts; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.s3_multipart_uploads_parts ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4245 (class 0 OID 17283)
-- Dependencies: 379
-- Name: vector_indexes; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.vector_indexes ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4294 (class 6104 OID 16426)
-- Name: supabase_realtime; Type: PUBLICATION; Schema: -; Owner: postgres
--

CREATE PUBLICATION supabase_realtime WITH (publish = 'insert, update, delete, truncate');


ALTER PUBLICATION supabase_realtime OWNER TO postgres;

--
-- TOC entry 4347 (class 0 OID 0)
-- Dependencies: 37
-- Name: SCHEMA auth; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT USAGE ON SCHEMA auth TO anon;
GRANT USAGE ON SCHEMA auth TO authenticated;
GRANT USAGE ON SCHEMA auth TO service_role;
GRANT ALL ON SCHEMA auth TO supabase_auth_admin;
GRANT ALL ON SCHEMA auth TO dashboard_user;
GRANT USAGE ON SCHEMA auth TO postgres;


--
-- TOC entry 4348 (class 0 OID 0)
-- Dependencies: 23
-- Name: SCHEMA extensions; Type: ACL; Schema: -; Owner: postgres
--

GRANT USAGE ON SCHEMA extensions TO anon;
GRANT USAGE ON SCHEMA extensions TO authenticated;
GRANT USAGE ON SCHEMA extensions TO service_role;
GRANT ALL ON SCHEMA extensions TO dashboard_user;


--
-- TOC entry 4349 (class 0 OID 0)
-- Dependencies: 39
-- Name: SCHEMA public; Type: ACL; Schema: -; Owner: pg_database_owner
--

GRANT USAGE ON SCHEMA public TO postgres;
GRANT USAGE ON SCHEMA public TO anon;
GRANT USAGE ON SCHEMA public TO authenticated;
GRANT USAGE ON SCHEMA public TO service_role;


--
-- TOC entry 4350 (class 0 OID 0)
-- Dependencies: 13
-- Name: SCHEMA realtime; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT USAGE ON SCHEMA realtime TO postgres;
GRANT USAGE ON SCHEMA realtime TO anon;
GRANT USAGE ON SCHEMA realtime TO authenticated;
GRANT USAGE ON SCHEMA realtime TO service_role;
GRANT ALL ON SCHEMA realtime TO supabase_realtime_admin;


--
-- TOC entry 4351 (class 0 OID 0)
-- Dependencies: 38
-- Name: SCHEMA storage; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT USAGE ON SCHEMA storage TO postgres WITH GRANT OPTION;
GRANT USAGE ON SCHEMA storage TO anon;
GRANT USAGE ON SCHEMA storage TO authenticated;
GRANT USAGE ON SCHEMA storage TO service_role;
GRANT ALL ON SCHEMA storage TO supabase_storage_admin WITH GRANT OPTION;
GRANT ALL ON SCHEMA storage TO dashboard_user;


--
-- TOC entry 4352 (class 0 OID 0)
-- Dependencies: 32
-- Name: SCHEMA vault; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT USAGE ON SCHEMA vault TO postgres WITH GRANT OPTION;
GRANT USAGE ON SCHEMA vault TO service_role;


--
-- TOC entry 4359 (class 0 OID 0)
-- Dependencies: 441
-- Name: FUNCTION email(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON FUNCTION auth.email() TO dashboard_user;


--
-- TOC entry 4360 (class 0 OID 0)
-- Dependencies: 515
-- Name: FUNCTION jwt(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON FUNCTION auth.jwt() TO postgres;
GRANT ALL ON FUNCTION auth.jwt() TO dashboard_user;


--
-- TOC entry 4362 (class 0 OID 0)
-- Dependencies: 408
-- Name: FUNCTION role(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON FUNCTION auth.role() TO dashboard_user;


--
-- TOC entry 4364 (class 0 OID 0)
-- Dependencies: 420
-- Name: FUNCTION uid(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON FUNCTION auth.uid() TO dashboard_user;


--
-- TOC entry 4365 (class 0 OID 0)
-- Dependencies: 451
-- Name: FUNCTION armor(bytea); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.armor(bytea) FROM postgres;
GRANT ALL ON FUNCTION extensions.armor(bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.armor(bytea) TO dashboard_user;


--
-- TOC entry 4366 (class 0 OID 0)
-- Dependencies: 484
-- Name: FUNCTION armor(bytea, text[], text[]); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.armor(bytea, text[], text[]) FROM postgres;
GRANT ALL ON FUNCTION extensions.armor(bytea, text[], text[]) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.armor(bytea, text[], text[]) TO dashboard_user;


--
-- TOC entry 4367 (class 0 OID 0)
-- Dependencies: 474
-- Name: FUNCTION crypt(text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.crypt(text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.crypt(text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.crypt(text, text) TO dashboard_user;


--
-- TOC entry 4368 (class 0 OID 0)
-- Dependencies: 460
-- Name: FUNCTION dearmor(text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.dearmor(text) FROM postgres;
GRANT ALL ON FUNCTION extensions.dearmor(text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.dearmor(text) TO dashboard_user;


--
-- TOC entry 4369 (class 0 OID 0)
-- Dependencies: 462
-- Name: FUNCTION decrypt(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.decrypt(bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.decrypt(bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.decrypt(bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4370 (class 0 OID 0)
-- Dependencies: 432
-- Name: FUNCTION decrypt_iv(bytea, bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.decrypt_iv(bytea, bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.decrypt_iv(bytea, bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.decrypt_iv(bytea, bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4371 (class 0 OID 0)
-- Dependencies: 498
-- Name: FUNCTION digest(bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.digest(bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.digest(bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.digest(bytea, text) TO dashboard_user;


--
-- TOC entry 4372 (class 0 OID 0)
-- Dependencies: 479
-- Name: FUNCTION digest(text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.digest(text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.digest(text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.digest(text, text) TO dashboard_user;


--
-- TOC entry 4373 (class 0 OID 0)
-- Dependencies: 426
-- Name: FUNCTION encrypt(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.encrypt(bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.encrypt(bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.encrypt(bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4374 (class 0 OID 0)
-- Dependencies: 413
-- Name: FUNCTION encrypt_iv(bytea, bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.encrypt_iv(bytea, bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.encrypt_iv(bytea, bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.encrypt_iv(bytea, bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4375 (class 0 OID 0)
-- Dependencies: 482
-- Name: FUNCTION gen_random_bytes(integer); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.gen_random_bytes(integer) FROM postgres;
GRANT ALL ON FUNCTION extensions.gen_random_bytes(integer) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.gen_random_bytes(integer) TO dashboard_user;


--
-- TOC entry 4376 (class 0 OID 0)
-- Dependencies: 409
-- Name: FUNCTION gen_random_uuid(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.gen_random_uuid() FROM postgres;
GRANT ALL ON FUNCTION extensions.gen_random_uuid() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.gen_random_uuid() TO dashboard_user;


--
-- TOC entry 4377 (class 0 OID 0)
-- Dependencies: 529
-- Name: FUNCTION gen_salt(text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.gen_salt(text) FROM postgres;
GRANT ALL ON FUNCTION extensions.gen_salt(text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.gen_salt(text) TO dashboard_user;


--
-- TOC entry 4378 (class 0 OID 0)
-- Dependencies: 525
-- Name: FUNCTION gen_salt(text, integer); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.gen_salt(text, integer) FROM postgres;
GRANT ALL ON FUNCTION extensions.gen_salt(text, integer) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.gen_salt(text, integer) TO dashboard_user;


--
-- TOC entry 4380 (class 0 OID 0)
-- Dependencies: 437
-- Name: FUNCTION grant_pg_cron_access(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

REVOKE ALL ON FUNCTION extensions.grant_pg_cron_access() FROM supabase_admin;
GRANT ALL ON FUNCTION extensions.grant_pg_cron_access() TO supabase_admin WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.grant_pg_cron_access() TO dashboard_user;


--
-- TOC entry 4382 (class 0 OID 0)
-- Dependencies: 505
-- Name: FUNCTION grant_pg_graphql_access(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.grant_pg_graphql_access() TO postgres WITH GRANT OPTION;


--
-- TOC entry 4384 (class 0 OID 0)
-- Dependencies: 400
-- Name: FUNCTION grant_pg_net_access(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

REVOKE ALL ON FUNCTION extensions.grant_pg_net_access() FROM supabase_admin;
GRANT ALL ON FUNCTION extensions.grant_pg_net_access() TO supabase_admin WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.grant_pg_net_access() TO dashboard_user;


--
-- TOC entry 4385 (class 0 OID 0)
-- Dependencies: 412
-- Name: FUNCTION hmac(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.hmac(bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.hmac(bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.hmac(bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4386 (class 0 OID 0)
-- Dependencies: 512
-- Name: FUNCTION hmac(text, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.hmac(text, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.hmac(text, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.hmac(text, text, text) TO dashboard_user;


--
-- TOC entry 4387 (class 0 OID 0)
-- Dependencies: 487
-- Name: FUNCTION pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone) FROM postgres;
GRANT ALL ON FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone) TO dashboard_user;


--
-- TOC entry 4388 (class 0 OID 0)
-- Dependencies: 521
-- Name: FUNCTION pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone) FROM postgres;
GRANT ALL ON FUNCTION extensions.pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone) TO dashboard_user;


--
-- TOC entry 4389 (class 0 OID 0)
-- Dependencies: 481
-- Name: FUNCTION pg_stat_statements_reset(userid oid, dbid oid, queryid bigint, minmax_only boolean); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pg_stat_statements_reset(userid oid, dbid oid, queryid bigint, minmax_only boolean) FROM postgres;
GRANT ALL ON FUNCTION extensions.pg_stat_statements_reset(userid oid, dbid oid, queryid bigint, minmax_only boolean) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pg_stat_statements_reset(userid oid, dbid oid, queryid bigint, minmax_only boolean) TO dashboard_user;


--
-- TOC entry 4390 (class 0 OID 0)
-- Dependencies: 439
-- Name: FUNCTION pgp_armor_headers(text, OUT key text, OUT value text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_armor_headers(text, OUT key text, OUT value text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_armor_headers(text, OUT key text, OUT value text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_armor_headers(text, OUT key text, OUT value text) TO dashboard_user;


--
-- TOC entry 4391 (class 0 OID 0)
-- Dependencies: 434
-- Name: FUNCTION pgp_key_id(bytea); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_key_id(bytea) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_key_id(bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_key_id(bytea) TO dashboard_user;


--
-- TOC entry 4392 (class 0 OID 0)
-- Dependencies: 506
-- Name: FUNCTION pgp_pub_decrypt(bytea, bytea); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea) TO dashboard_user;


--
-- TOC entry 4393 (class 0 OID 0)
-- Dependencies: 404
-- Name: FUNCTION pgp_pub_decrypt(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4394 (class 0 OID 0)
-- Dependencies: 508
-- Name: FUNCTION pgp_pub_decrypt(bytea, bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text, text) TO dashboard_user;


--
-- TOC entry 4395 (class 0 OID 0)
-- Dependencies: 416
-- Name: FUNCTION pgp_pub_decrypt_bytea(bytea, bytea); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea) TO dashboard_user;


--
-- TOC entry 4396 (class 0 OID 0)
-- Dependencies: 518
-- Name: FUNCTION pgp_pub_decrypt_bytea(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4397 (class 0 OID 0)
-- Dependencies: 514
-- Name: FUNCTION pgp_pub_decrypt_bytea(bytea, bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text, text) TO dashboard_user;


--
-- TOC entry 4398 (class 0 OID 0)
-- Dependencies: 445
-- Name: FUNCTION pgp_pub_encrypt(text, bytea); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea) TO dashboard_user;


--
-- TOC entry 4399 (class 0 OID 0)
-- Dependencies: 440
-- Name: FUNCTION pgp_pub_encrypt(text, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea, text) TO dashboard_user;


--
-- TOC entry 4400 (class 0 OID 0)
-- Dependencies: 424
-- Name: FUNCTION pgp_pub_encrypt_bytea(bytea, bytea); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea) TO dashboard_user;


--
-- TOC entry 4401 (class 0 OID 0)
-- Dependencies: 501
-- Name: FUNCTION pgp_pub_encrypt_bytea(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4402 (class 0 OID 0)
-- Dependencies: 504
-- Name: FUNCTION pgp_sym_decrypt(bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text) TO dashboard_user;


--
-- TOC entry 4403 (class 0 OID 0)
-- Dependencies: 442
-- Name: FUNCTION pgp_sym_decrypt(bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text, text) TO dashboard_user;


--
-- TOC entry 4404 (class 0 OID 0)
-- Dependencies: 507
-- Name: FUNCTION pgp_sym_decrypt_bytea(bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text) TO dashboard_user;


--
-- TOC entry 4405 (class 0 OID 0)
-- Dependencies: 503
-- Name: FUNCTION pgp_sym_decrypt_bytea(bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text, text) TO dashboard_user;


--
-- TOC entry 4406 (class 0 OID 0)
-- Dependencies: 528
-- Name: FUNCTION pgp_sym_encrypt(text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text) TO dashboard_user;


--
-- TOC entry 4407 (class 0 OID 0)
-- Dependencies: 456
-- Name: FUNCTION pgp_sym_encrypt(text, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text, text) TO dashboard_user;


--
-- TOC entry 4408 (class 0 OID 0)
-- Dependencies: 419
-- Name: FUNCTION pgp_sym_encrypt_bytea(bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text) TO dashboard_user;


--
-- TOC entry 4409 (class 0 OID 0)
-- Dependencies: 509
-- Name: FUNCTION pgp_sym_encrypt_bytea(bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text, text) TO dashboard_user;


--
-- TOC entry 4410 (class 0 OID 0)
-- Dependencies: 524
-- Name: FUNCTION pgrst_ddl_watch(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgrst_ddl_watch() TO postgres WITH GRANT OPTION;


--
-- TOC entry 4411 (class 0 OID 0)
-- Dependencies: 517
-- Name: FUNCTION pgrst_drop_watch(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgrst_drop_watch() TO postgres WITH GRANT OPTION;


--
-- TOC entry 4413 (class 0 OID 0)
-- Dependencies: 499
-- Name: FUNCTION set_graphql_placeholder(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.set_graphql_placeholder() TO postgres WITH GRANT OPTION;


--
-- TOC entry 4414 (class 0 OID 0)
-- Dependencies: 447
-- Name: FUNCTION uuid_generate_v1(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_generate_v1() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_generate_v1() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_generate_v1() TO dashboard_user;


--
-- TOC entry 4415 (class 0 OID 0)
-- Dependencies: 490
-- Name: FUNCTION uuid_generate_v1mc(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_generate_v1mc() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_generate_v1mc() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_generate_v1mc() TO dashboard_user;


--
-- TOC entry 4416 (class 0 OID 0)
-- Dependencies: 402
-- Name: FUNCTION uuid_generate_v3(namespace uuid, name text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_generate_v3(namespace uuid, name text) FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_generate_v3(namespace uuid, name text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_generate_v3(namespace uuid, name text) TO dashboard_user;


--
-- TOC entry 4417 (class 0 OID 0)
-- Dependencies: 417
-- Name: FUNCTION uuid_generate_v4(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_generate_v4() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_generate_v4() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_generate_v4() TO dashboard_user;


--
-- TOC entry 4418 (class 0 OID 0)
-- Dependencies: 423
-- Name: FUNCTION uuid_generate_v5(namespace uuid, name text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_generate_v5(namespace uuid, name text) FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_generate_v5(namespace uuid, name text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_generate_v5(namespace uuid, name text) TO dashboard_user;


--
-- TOC entry 4419 (class 0 OID 0)
-- Dependencies: 476
-- Name: FUNCTION uuid_nil(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_nil() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_nil() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_nil() TO dashboard_user;


--
-- TOC entry 4420 (class 0 OID 0)
-- Dependencies: 425
-- Name: FUNCTION uuid_ns_dns(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_ns_dns() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_ns_dns() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_ns_dns() TO dashboard_user;


--
-- TOC entry 4421 (class 0 OID 0)
-- Dependencies: 510
-- Name: FUNCTION uuid_ns_oid(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_ns_oid() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_ns_oid() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_ns_oid() TO dashboard_user;


--
-- TOC entry 4422 (class 0 OID 0)
-- Dependencies: 466
-- Name: FUNCTION uuid_ns_url(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_ns_url() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_ns_url() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_ns_url() TO dashboard_user;


--
-- TOC entry 4423 (class 0 OID 0)
-- Dependencies: 478
-- Name: FUNCTION uuid_ns_x500(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_ns_x500() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_ns_x500() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_ns_x500() TO dashboard_user;


--
-- TOC entry 4424 (class 0 OID 0)
-- Dependencies: 511
-- Name: FUNCTION graphql("operationName" text, query text, variables jsonb, extensions jsonb); Type: ACL; Schema: graphql_public; Owner: supabase_admin
--

GRANT ALL ON FUNCTION graphql_public.graphql("operationName" text, query text, variables jsonb, extensions jsonb) TO postgres;
GRANT ALL ON FUNCTION graphql_public.graphql("operationName" text, query text, variables jsonb, extensions jsonb) TO anon;
GRANT ALL ON FUNCTION graphql_public.graphql("operationName" text, query text, variables jsonb, extensions jsonb) TO authenticated;
GRANT ALL ON FUNCTION graphql_public.graphql("operationName" text, query text, variables jsonb, extensions jsonb) TO service_role;


--
-- TOC entry 4425 (class 0 OID 0)
-- Dependencies: 415
-- Name: FUNCTION pg_reload_conf(); Type: ACL; Schema: pg_catalog; Owner: supabase_admin
--

GRANT ALL ON FUNCTION pg_catalog.pg_reload_conf() TO postgres WITH GRANT OPTION;


--
-- TOC entry 4426 (class 0 OID 0)
-- Dependencies: 443
-- Name: FUNCTION get_auth(p_usename text); Type: ACL; Schema: pgbouncer; Owner: supabase_admin
--

REVOKE ALL ON FUNCTION pgbouncer.get_auth(p_usename text) FROM PUBLIC;
GRANT ALL ON FUNCTION pgbouncer.get_auth(p_usename text) TO pgbouncer;


--
-- TOC entry 4427 (class 0 OID 0)
-- Dependencies: 520
-- Name: FUNCTION check_plan_limit(target_tenant_id uuid); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.check_plan_limit(target_tenant_id uuid) TO anon;
GRANT ALL ON FUNCTION public.check_plan_limit(target_tenant_id uuid) TO authenticated;
GRANT ALL ON FUNCTION public.check_plan_limit(target_tenant_id uuid) TO service_role;


--
-- TOC entry 4428 (class 0 OID 0)
-- Dependencies: 489
-- Name: FUNCTION get_candidate_summary_v2(target_app_id bigint); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.get_candidate_summary_v2(target_app_id bigint) TO anon;
GRANT ALL ON FUNCTION public.get_candidate_summary_v2(target_app_id bigint) TO authenticated;
GRANT ALL ON FUNCTION public.get_candidate_summary_v2(target_app_id bigint) TO service_role;


--
-- TOC entry 4429 (class 0 OID 0)
-- Dependencies: 496
-- Name: FUNCTION initialize_job_criteria_v2(target_job_id bigint); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.initialize_job_criteria_v2(target_job_id bigint) TO anon;
GRANT ALL ON FUNCTION public.initialize_job_criteria_v2(target_job_id bigint) TO authenticated;
GRANT ALL ON FUNCTION public.initialize_job_criteria_v2(target_job_id bigint) TO service_role;


--
-- TOC entry 4430 (class 0 OID 0)
-- Dependencies: 433
-- Name: FUNCTION update_application_general_score(); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.update_application_general_score() TO anon;
GRANT ALL ON FUNCTION public.update_application_general_score() TO authenticated;
GRANT ALL ON FUNCTION public.update_application_general_score() TO service_role;


--
-- TOC entry 4431 (class 0 OID 0)
-- Dependencies: 453
-- Name: FUNCTION update_general_score(); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.update_general_score() TO anon;
GRANT ALL ON FUNCTION public.update_general_score() TO authenticated;
GRANT ALL ON FUNCTION public.update_general_score() TO service_role;


--
-- TOC entry 4432 (class 0 OID 0)
-- Dependencies: 463
-- Name: FUNCTION apply_rls(wal jsonb, max_record_bytes integer); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO postgres;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO anon;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO authenticated;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO service_role;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO supabase_realtime_admin;


--
-- TOC entry 4433 (class 0 OID 0)
-- Dependencies: 403
-- Name: FUNCTION broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text) TO postgres;
GRANT ALL ON FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text) TO dashboard_user;


--
-- TOC entry 4434 (class 0 OID 0)
-- Dependencies: 493
-- Name: FUNCTION build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO postgres;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO anon;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO authenticated;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO service_role;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO supabase_realtime_admin;


--
-- TOC entry 4435 (class 0 OID 0)
-- Dependencies: 459
-- Name: FUNCTION "cast"(val text, type_ regtype); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO postgres;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO dashboard_user;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO anon;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO authenticated;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO service_role;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO supabase_realtime_admin;


--
-- TOC entry 4436 (class 0 OID 0)
-- Dependencies: 469
-- Name: FUNCTION check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO postgres;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO anon;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO authenticated;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO service_role;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO supabase_realtime_admin;


--
-- TOC entry 4437 (class 0 OID 0)
-- Dependencies: 422
-- Name: FUNCTION is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO postgres;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO anon;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO authenticated;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO service_role;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO supabase_realtime_admin;


--
-- TOC entry 4438 (class 0 OID 0)
-- Dependencies: 430
-- Name: FUNCTION list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO postgres;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO anon;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO authenticated;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO service_role;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO supabase_realtime_admin;


--
-- TOC entry 4439 (class 0 OID 0)
-- Dependencies: 523
-- Name: FUNCTION quote_wal2json(entity regclass); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO postgres;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO anon;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO authenticated;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO service_role;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO supabase_realtime_admin;


--
-- TOC entry 4440 (class 0 OID 0)
-- Dependencies: 438
-- Name: FUNCTION send(payload jsonb, event text, topic text, private boolean); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean) TO postgres;
GRANT ALL ON FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean) TO dashboard_user;


--
-- TOC entry 4441 (class 0 OID 0)
-- Dependencies: 435
-- Name: FUNCTION subscription_check_filters(); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO postgres;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO dashboard_user;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO anon;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO authenticated;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO service_role;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO supabase_realtime_admin;


--
-- TOC entry 4442 (class 0 OID 0)
-- Dependencies: 454
-- Name: FUNCTION to_regrole(role_name text); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO postgres;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO anon;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO authenticated;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO service_role;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO supabase_realtime_admin;


--
-- TOC entry 4443 (class 0 OID 0)
-- Dependencies: 477
-- Name: FUNCTION topic(); Type: ACL; Schema: realtime; Owner: supabase_realtime_admin
--

GRANT ALL ON FUNCTION realtime.topic() TO postgres;
GRANT ALL ON FUNCTION realtime.topic() TO dashboard_user;


--
-- TOC entry 4444 (class 0 OID 0)
-- Dependencies: 449
-- Name: FUNCTION _crypto_aead_det_decrypt(message bytea, additional bytea, key_id bigint, context bytea, nonce bytea); Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT ALL ON FUNCTION vault._crypto_aead_det_decrypt(message bytea, additional bytea, key_id bigint, context bytea, nonce bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION vault._crypto_aead_det_decrypt(message bytea, additional bytea, key_id bigint, context bytea, nonce bytea) TO service_role;


--
-- TOC entry 4445 (class 0 OID 0)
-- Dependencies: 471
-- Name: FUNCTION create_secret(new_secret text, new_name text, new_description text, new_key_id uuid); Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT ALL ON FUNCTION vault.create_secret(new_secret text, new_name text, new_description text, new_key_id uuid) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION vault.create_secret(new_secret text, new_name text, new_description text, new_key_id uuid) TO service_role;


--
-- TOC entry 4446 (class 0 OID 0)
-- Dependencies: 401
-- Name: FUNCTION update_secret(secret_id uuid, new_secret text, new_name text, new_description text, new_key_id uuid); Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT ALL ON FUNCTION vault.update_secret(secret_id uuid, new_secret text, new_name text, new_description text, new_key_id uuid) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION vault.update_secret(secret_id uuid, new_secret text, new_name text, new_description text, new_key_id uuid) TO service_role;


--
-- TOC entry 4448 (class 0 OID 0)
-- Dependencies: 350
-- Name: TABLE audit_log_entries; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.audit_log_entries TO dashboard_user;
GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.audit_log_entries TO postgres;
GRANT SELECT ON TABLE auth.audit_log_entries TO postgres WITH GRANT OPTION;


--
-- TOC entry 4450 (class 0 OID 0)
-- Dependencies: 364
-- Name: TABLE flow_state; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.flow_state TO postgres;
GRANT SELECT ON TABLE auth.flow_state TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.flow_state TO dashboard_user;


--
-- TOC entry 4453 (class 0 OID 0)
-- Dependencies: 355
-- Name: TABLE identities; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.identities TO postgres;
GRANT SELECT ON TABLE auth.identities TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.identities TO dashboard_user;


--
-- TOC entry 4455 (class 0 OID 0)
-- Dependencies: 349
-- Name: TABLE instances; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.instances TO dashboard_user;
GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.instances TO postgres;
GRANT SELECT ON TABLE auth.instances TO postgres WITH GRANT OPTION;


--
-- TOC entry 4457 (class 0 OID 0)
-- Dependencies: 359
-- Name: TABLE mfa_amr_claims; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.mfa_amr_claims TO postgres;
GRANT SELECT ON TABLE auth.mfa_amr_claims TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.mfa_amr_claims TO dashboard_user;


--
-- TOC entry 4459 (class 0 OID 0)
-- Dependencies: 358
-- Name: TABLE mfa_challenges; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.mfa_challenges TO postgres;
GRANT SELECT ON TABLE auth.mfa_challenges TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.mfa_challenges TO dashboard_user;


--
-- TOC entry 4462 (class 0 OID 0)
-- Dependencies: 357
-- Name: TABLE mfa_factors; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.mfa_factors TO postgres;
GRANT SELECT ON TABLE auth.mfa_factors TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.mfa_factors TO dashboard_user;


--
-- TOC entry 4463 (class 0 OID 0)
-- Dependencies: 367
-- Name: TABLE oauth_authorizations; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.oauth_authorizations TO postgres;
GRANT ALL ON TABLE auth.oauth_authorizations TO dashboard_user;


--
-- TOC entry 4465 (class 0 OID 0)
-- Dependencies: 369
-- Name: TABLE oauth_client_states; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.oauth_client_states TO postgres;
GRANT ALL ON TABLE auth.oauth_client_states TO dashboard_user;


--
-- TOC entry 4466 (class 0 OID 0)
-- Dependencies: 366
-- Name: TABLE oauth_clients; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.oauth_clients TO postgres;
GRANT ALL ON TABLE auth.oauth_clients TO dashboard_user;


--
-- TOC entry 4467 (class 0 OID 0)
-- Dependencies: 368
-- Name: TABLE oauth_consents; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.oauth_consents TO postgres;
GRANT ALL ON TABLE auth.oauth_consents TO dashboard_user;


--
-- TOC entry 4468 (class 0 OID 0)
-- Dependencies: 365
-- Name: TABLE one_time_tokens; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.one_time_tokens TO postgres;
GRANT SELECT ON TABLE auth.one_time_tokens TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.one_time_tokens TO dashboard_user;


--
-- TOC entry 4470 (class 0 OID 0)
-- Dependencies: 348
-- Name: TABLE refresh_tokens; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.refresh_tokens TO dashboard_user;
GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.refresh_tokens TO postgres;
GRANT SELECT ON TABLE auth.refresh_tokens TO postgres WITH GRANT OPTION;


--
-- TOC entry 4472 (class 0 OID 0)
-- Dependencies: 347
-- Name: SEQUENCE refresh_tokens_id_seq; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON SEQUENCE auth.refresh_tokens_id_seq TO dashboard_user;
GRANT ALL ON SEQUENCE auth.refresh_tokens_id_seq TO postgres;


--
-- TOC entry 4474 (class 0 OID 0)
-- Dependencies: 362
-- Name: TABLE saml_providers; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.saml_providers TO postgres;
GRANT SELECT ON TABLE auth.saml_providers TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.saml_providers TO dashboard_user;


--
-- TOC entry 4476 (class 0 OID 0)
-- Dependencies: 363
-- Name: TABLE saml_relay_states; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.saml_relay_states TO postgres;
GRANT SELECT ON TABLE auth.saml_relay_states TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.saml_relay_states TO dashboard_user;


--
-- TOC entry 4478 (class 0 OID 0)
-- Dependencies: 351
-- Name: TABLE schema_migrations; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT SELECT ON TABLE auth.schema_migrations TO postgres WITH GRANT OPTION;


--
-- TOC entry 4483 (class 0 OID 0)
-- Dependencies: 356
-- Name: TABLE sessions; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.sessions TO postgres;
GRANT SELECT ON TABLE auth.sessions TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.sessions TO dashboard_user;


--
-- TOC entry 4485 (class 0 OID 0)
-- Dependencies: 361
-- Name: TABLE sso_domains; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.sso_domains TO postgres;
GRANT SELECT ON TABLE auth.sso_domains TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.sso_domains TO dashboard_user;


--
-- TOC entry 4488 (class 0 OID 0)
-- Dependencies: 360
-- Name: TABLE sso_providers; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.sso_providers TO postgres;
GRANT SELECT ON TABLE auth.sso_providers TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.sso_providers TO dashboard_user;


--
-- TOC entry 4491 (class 0 OID 0)
-- Dependencies: 346
-- Name: TABLE users; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.users TO dashboard_user;
GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.users TO postgres;
GRANT SELECT ON TABLE auth.users TO postgres WITH GRANT OPTION;


--
-- TOC entry 4492 (class 0 OID 0)
-- Dependencies: 345
-- Name: TABLE pg_stat_statements; Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON TABLE extensions.pg_stat_statements FROM postgres;
GRANT ALL ON TABLE extensions.pg_stat_statements TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE extensions.pg_stat_statements TO dashboard_user;


--
-- TOC entry 4493 (class 0 OID 0)
-- Dependencies: 344
-- Name: TABLE pg_stat_statements_info; Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON TABLE extensions.pg_stat_statements_info FROM postgres;
GRANT ALL ON TABLE extensions.pg_stat_statements_info TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE extensions.pg_stat_statements_info TO dashboard_user;


--
-- TOC entry 4494 (class 0 OID 0)
-- Dependencies: 390
-- Name: TABLE applications; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.applications TO anon;
GRANT ALL ON TABLE public.applications TO authenticated;
GRANT ALL ON TABLE public.applications TO service_role;


--
-- TOC entry 4495 (class 0 OID 0)
-- Dependencies: 389
-- Name: SEQUENCE applications_id_seq; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON SEQUENCE public.applications_id_seq TO anon;
GRANT ALL ON SEQUENCE public.applications_id_seq TO authenticated;
GRANT ALL ON SEQUENCE public.applications_id_seq TO service_role;


--
-- TOC entry 4496 (class 0 OID 0)
-- Dependencies: 395
-- Name: TABLE candidates; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.candidates TO anon;
GRANT ALL ON TABLE public.candidates TO authenticated;
GRANT ALL ON TABLE public.candidates TO service_role;


--
-- TOC entry 4497 (class 0 OID 0)
-- Dependencies: 398
-- Name: TABLE company_departments; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.company_departments TO anon;
GRANT ALL ON TABLE public.company_departments TO authenticated;
GRANT ALL ON TABLE public.company_departments TO service_role;


--
-- TOC entry 4498 (class 0 OID 0)
-- Dependencies: 397
-- Name: SEQUENCE company_departments_id_seq; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON SEQUENCE public.company_departments_id_seq TO anon;
GRANT ALL ON SEQUENCE public.company_departments_id_seq TO authenticated;
GRANT ALL ON SEQUENCE public.company_departments_id_seq TO service_role;


--
-- TOC entry 4499 (class 0 OID 0)
-- Dependencies: 393
-- Name: TABLE evaluation_assignments_v2; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.evaluation_assignments_v2 TO anon;
GRANT ALL ON TABLE public.evaluation_assignments_v2 TO authenticated;
GRANT ALL ON TABLE public.evaluation_assignments_v2 TO service_role;


--
-- TOC entry 4500 (class 0 OID 0)
-- Dependencies: 396
-- Name: TABLE evaluations; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.evaluations TO anon;
GRANT ALL ON TABLE public.evaluations TO authenticated;
GRANT ALL ON TABLE public.evaluations TO service_role;


--
-- TOC entry 4501 (class 0 OID 0)
-- Dependencies: 388
-- Name: TABLE jobs; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.jobs TO anon;
GRANT ALL ON TABLE public.jobs TO authenticated;
GRANT ALL ON TABLE public.jobs TO service_role;


--
-- TOC entry 4502 (class 0 OID 0)
-- Dependencies: 387
-- Name: SEQUENCE jobs_id_seq; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON SEQUENCE public.jobs_id_seq TO anon;
GRANT ALL ON SEQUENCE public.jobs_id_seq TO authenticated;
GRANT ALL ON SEQUENCE public.jobs_id_seq TO service_role;


--
-- TOC entry 4503 (class 0 OID 0)
-- Dependencies: 394
-- Name: TABLE plans; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.plans TO anon;
GRANT ALL ON TABLE public.plans TO authenticated;
GRANT ALL ON TABLE public.plans TO service_role;


--
-- TOC entry 4504 (class 0 OID 0)
-- Dependencies: 391
-- Name: TABLE tenants; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.tenants TO anon;
GRANT ALL ON TABLE public.tenants TO authenticated;
GRANT ALL ON TABLE public.tenants TO service_role;


--
-- TOC entry 4505 (class 0 OID 0)
-- Dependencies: 392
-- Name: TABLE user_profiles; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.user_profiles TO anon;
GRANT ALL ON TABLE public.user_profiles TO authenticated;
GRANT ALL ON TABLE public.user_profiles TO service_role;


--
-- TOC entry 4506 (class 0 OID 0)
-- Dependencies: 399
-- Name: TABLE user_tenants; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.user_tenants TO anon;
GRANT ALL ON TABLE public.user_tenants TO authenticated;
GRANT ALL ON TABLE public.user_tenants TO service_role;


--
-- TOC entry 4507 (class 0 OID 0)
-- Dependencies: 386
-- Name: TABLE users; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.users TO anon;
GRANT ALL ON TABLE public.users TO authenticated;
GRANT ALL ON TABLE public.users TO service_role;


--
-- TOC entry 4508 (class 0 OID 0)
-- Dependencies: 385
-- Name: TABLE messages; Type: ACL; Schema: realtime; Owner: supabase_realtime_admin
--

GRANT ALL ON TABLE realtime.messages TO postgres;
GRANT ALL ON TABLE realtime.messages TO dashboard_user;
GRANT SELECT,INSERT,UPDATE ON TABLE realtime.messages TO anon;
GRANT SELECT,INSERT,UPDATE ON TABLE realtime.messages TO authenticated;
GRANT SELECT,INSERT,UPDATE ON TABLE realtime.messages TO service_role;


--
-- TOC entry 4509 (class 0 OID 0)
-- Dependencies: 370
-- Name: TABLE schema_migrations; Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON TABLE realtime.schema_migrations TO postgres;
GRANT ALL ON TABLE realtime.schema_migrations TO dashboard_user;
GRANT SELECT ON TABLE realtime.schema_migrations TO anon;
GRANT SELECT ON TABLE realtime.schema_migrations TO authenticated;
GRANT SELECT ON TABLE realtime.schema_migrations TO service_role;
GRANT ALL ON TABLE realtime.schema_migrations TO supabase_realtime_admin;


--
-- TOC entry 4510 (class 0 OID 0)
-- Dependencies: 382
-- Name: TABLE subscription; Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON TABLE realtime.subscription TO postgres;
GRANT ALL ON TABLE realtime.subscription TO dashboard_user;
GRANT SELECT ON TABLE realtime.subscription TO anon;
GRANT SELECT ON TABLE realtime.subscription TO authenticated;
GRANT SELECT ON TABLE realtime.subscription TO service_role;
GRANT ALL ON TABLE realtime.subscription TO supabase_realtime_admin;


--
-- TOC entry 4511 (class 0 OID 0)
-- Dependencies: 381
-- Name: SEQUENCE subscription_id_seq; Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON SEQUENCE realtime.subscription_id_seq TO postgres;
GRANT ALL ON SEQUENCE realtime.subscription_id_seq TO dashboard_user;
GRANT USAGE ON SEQUENCE realtime.subscription_id_seq TO anon;
GRANT USAGE ON SEQUENCE realtime.subscription_id_seq TO authenticated;
GRANT USAGE ON SEQUENCE realtime.subscription_id_seq TO service_role;
GRANT ALL ON SEQUENCE realtime.subscription_id_seq TO supabase_realtime_admin;


--
-- TOC entry 4513 (class 0 OID 0)
-- Dependencies: 372
-- Name: TABLE buckets; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

REVOKE ALL ON TABLE storage.buckets FROM supabase_storage_admin;
GRANT ALL ON TABLE storage.buckets TO supabase_storage_admin WITH GRANT OPTION;
GRANT ALL ON TABLE storage.buckets TO service_role;
GRANT ALL ON TABLE storage.buckets TO authenticated;
GRANT ALL ON TABLE storage.buckets TO anon;
GRANT ALL ON TABLE storage.buckets TO postgres WITH GRANT OPTION;


--
-- TOC entry 4514 (class 0 OID 0)
-- Dependencies: 377
-- Name: TABLE buckets_analytics; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.buckets_analytics TO service_role;
GRANT ALL ON TABLE storage.buckets_analytics TO authenticated;
GRANT ALL ON TABLE storage.buckets_analytics TO anon;


--
-- TOC entry 4515 (class 0 OID 0)
-- Dependencies: 378
-- Name: TABLE buckets_vectors; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT SELECT ON TABLE storage.buckets_vectors TO service_role;
GRANT SELECT ON TABLE storage.buckets_vectors TO authenticated;
GRANT SELECT ON TABLE storage.buckets_vectors TO anon;


--
-- TOC entry 4517 (class 0 OID 0)
-- Dependencies: 373
-- Name: TABLE objects; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

REVOKE ALL ON TABLE storage.objects FROM supabase_storage_admin;
GRANT ALL ON TABLE storage.objects TO supabase_storage_admin WITH GRANT OPTION;
GRANT ALL ON TABLE storage.objects TO service_role;
GRANT ALL ON TABLE storage.objects TO authenticated;
GRANT ALL ON TABLE storage.objects TO anon;
GRANT ALL ON TABLE storage.objects TO postgres WITH GRANT OPTION;


--
-- TOC entry 4518 (class 0 OID 0)
-- Dependencies: 376
-- Name: TABLE prefixes; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.prefixes TO service_role;
GRANT ALL ON TABLE storage.prefixes TO authenticated;
GRANT ALL ON TABLE storage.prefixes TO anon;


--
-- TOC entry 4519 (class 0 OID 0)
-- Dependencies: 374
-- Name: TABLE s3_multipart_uploads; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.s3_multipart_uploads TO service_role;
GRANT SELECT ON TABLE storage.s3_multipart_uploads TO authenticated;
GRANT SELECT ON TABLE storage.s3_multipart_uploads TO anon;


--
-- TOC entry 4520 (class 0 OID 0)
-- Dependencies: 375
-- Name: TABLE s3_multipart_uploads_parts; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.s3_multipart_uploads_parts TO service_role;
GRANT SELECT ON TABLE storage.s3_multipart_uploads_parts TO authenticated;
GRANT SELECT ON TABLE storage.s3_multipart_uploads_parts TO anon;


--
-- TOC entry 4521 (class 0 OID 0)
-- Dependencies: 379
-- Name: TABLE vector_indexes; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT SELECT ON TABLE storage.vector_indexes TO service_role;
GRANT SELECT ON TABLE storage.vector_indexes TO authenticated;
GRANT SELECT ON TABLE storage.vector_indexes TO anon;


--
-- TOC entry 4522 (class 0 OID 0)
-- Dependencies: 352
-- Name: TABLE secrets; Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT SELECT,REFERENCES,DELETE,TRUNCATE ON TABLE vault.secrets TO postgres WITH GRANT OPTION;
GRANT SELECT,DELETE ON TABLE vault.secrets TO service_role;


--
-- TOC entry 4523 (class 0 OID 0)
-- Dependencies: 353
-- Name: TABLE decrypted_secrets; Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT SELECT,REFERENCES,DELETE,TRUNCATE ON TABLE vault.decrypted_secrets TO postgres WITH GRANT OPTION;
GRANT SELECT,DELETE ON TABLE vault.decrypted_secrets TO service_role;


--
-- TOC entry 2533 (class 826 OID 16553)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: auth; Owner: supabase_auth_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON SEQUENCES TO dashboard_user;


--
-- TOC entry 2534 (class 826 OID 16554)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: auth; Owner: supabase_auth_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON FUNCTIONS TO dashboard_user;


--
-- TOC entry 2532 (class 826 OID 16552)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: auth; Owner: supabase_auth_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON TABLES TO dashboard_user;


--
-- TOC entry 2543 (class 826 OID 16632)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: extensions; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA extensions GRANT ALL ON SEQUENCES TO postgres WITH GRANT OPTION;


--
-- TOC entry 2542 (class 826 OID 16631)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: extensions; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA extensions GRANT ALL ON FUNCTIONS TO postgres WITH GRANT OPTION;


--
-- TOC entry 2541 (class 826 OID 16630)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: extensions; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA extensions GRANT ALL ON TABLES TO postgres WITH GRANT OPTION;


--
-- TOC entry 2546 (class 826 OID 16587)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: graphql; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON SEQUENCES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON SEQUENCES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON SEQUENCES TO service_role;


--
-- TOC entry 2545 (class 826 OID 16586)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: graphql; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON FUNCTIONS TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON FUNCTIONS TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON FUNCTIONS TO service_role;


--
-- TOC entry 2544 (class 826 OID 16585)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: graphql; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES TO service_role;


--
-- TOC entry 2538 (class 826 OID 16567)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: graphql_public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON SEQUENCES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON SEQUENCES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON SEQUENCES TO service_role;


--
-- TOC entry 2540 (class 826 OID 16566)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: graphql_public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON FUNCTIONS TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON FUNCTIONS TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON FUNCTIONS TO service_role;


--
-- TOC entry 2539 (class 826 OID 16565)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: graphql_public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES TO service_role;


--
-- TOC entry 2525 (class 826 OID 16490)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: public; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON SEQUENCES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON SEQUENCES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON SEQUENCES TO service_role;


--
-- TOC entry 2526 (class 826 OID 16491)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON SEQUENCES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON SEQUENCES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON SEQUENCES TO service_role;


--
-- TOC entry 2524 (class 826 OID 16489)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: public; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON FUNCTIONS TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON FUNCTIONS TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON FUNCTIONS TO service_role;


--
-- TOC entry 2528 (class 826 OID 16493)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON FUNCTIONS TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON FUNCTIONS TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON FUNCTIONS TO service_role;


--
-- TOC entry 2523 (class 826 OID 16488)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: public; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES TO service_role;


--
-- TOC entry 2527 (class 826 OID 16492)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES TO service_role;


--
-- TOC entry 2536 (class 826 OID 16557)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: realtime; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON SEQUENCES TO dashboard_user;


--
-- TOC entry 2537 (class 826 OID 16558)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: realtime; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON FUNCTIONS TO dashboard_user;


--
-- TOC entry 2535 (class 826 OID 16556)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: realtime; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON TABLES TO dashboard_user;


--
-- TOC entry 2531 (class 826 OID 16546)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: storage; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON SEQUENCES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON SEQUENCES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON SEQUENCES TO service_role;


--
-- TOC entry 2530 (class 826 OID 16545)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: storage; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON FUNCTIONS TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON FUNCTIONS TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON FUNCTIONS TO service_role;


--
-- TOC entry 2529 (class 826 OID 16544)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: storage; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES TO service_role;


--
-- TOC entry 3714 (class 3466 OID 16571)
-- Name: issue_graphql_placeholder; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER issue_graphql_placeholder ON sql_drop
         WHEN TAG IN ('DROP EXTENSION')
   EXECUTE FUNCTION extensions.set_graphql_placeholder();


ALTER EVENT TRIGGER issue_graphql_placeholder OWNER TO supabase_admin;

--
-- TOC entry 3719 (class 3466 OID 16650)
-- Name: issue_pg_cron_access; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER issue_pg_cron_access ON ddl_command_end
         WHEN TAG IN ('CREATE EXTENSION')
   EXECUTE FUNCTION extensions.grant_pg_cron_access();


ALTER EVENT TRIGGER issue_pg_cron_access OWNER TO supabase_admin;

--
-- TOC entry 3713 (class 3466 OID 16569)
-- Name: issue_pg_graphql_access; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER issue_pg_graphql_access ON ddl_command_end
         WHEN TAG IN ('CREATE FUNCTION')
   EXECUTE FUNCTION extensions.grant_pg_graphql_access();


ALTER EVENT TRIGGER issue_pg_graphql_access OWNER TO supabase_admin;

--
-- TOC entry 3720 (class 3466 OID 16653)
-- Name: issue_pg_net_access; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER issue_pg_net_access ON ddl_command_end
         WHEN TAG IN ('CREATE EXTENSION')
   EXECUTE FUNCTION extensions.grant_pg_net_access();


ALTER EVENT TRIGGER issue_pg_net_access OWNER TO supabase_admin;

--
-- TOC entry 3715 (class 3466 OID 16572)
-- Name: pgrst_ddl_watch; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER pgrst_ddl_watch ON ddl_command_end
   EXECUTE FUNCTION extensions.pgrst_ddl_watch();


ALTER EVENT TRIGGER pgrst_ddl_watch OWNER TO supabase_admin;

--
-- TOC entry 3716 (class 3466 OID 16573)
-- Name: pgrst_drop_watch; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER pgrst_drop_watch ON sql_drop
   EXECUTE FUNCTION extensions.pgrst_drop_watch();


ALTER EVENT TRIGGER pgrst_drop_watch OWNER TO supabase_admin;

-- Completed on 2026-01-04 15:44:58

--
-- PostgreSQL database dump complete
--

\unrestrict 9n85L6dW6CYA0zN91g5DgpNWB16yl0Ug3hdeEQyLJTss6qG0iM2naCOKCBNYcGw



==================================================
ARQUIVO: database\Backup-novva-rs-saas-2_0.sql
==================================================
--
-- PostgreSQL database dump
--

\restrict SnG6n6rFCxlzFOAs6HcFTd9omcHAejOdhbJ7DNglS7NHVN310DEMsx6dVbjWX2X

-- Dumped from database version 17.6
-- Dumped by pg_dump version 18.0

-- Started on 2026-01-02 09:55:56

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET transaction_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

DROP EVENT TRIGGER pgrst_drop_watch;
DROP EVENT TRIGGER pgrst_ddl_watch;
DROP EVENT TRIGGER issue_pg_net_access;
DROP EVENT TRIGGER issue_pg_graphql_access;
DROP EVENT TRIGGER issue_pg_cron_access;
DROP EVENT TRIGGER issue_graphql_placeholder;
DROP PUBLICATION supabase_realtime;
DROP POLICY "Recruiters read resumes" ON storage.objects;
DROP POLICY "Public Upload Resumes" ON storage.objects;
DROP POLICY "Public Upload Resume" ON storage.objects;
DROP POLICY "Public Select Resume" ON storage.objects;
DROP POLICY "Authenticated Users Read Resumes" ON storage.objects;
DROP POLICY "Users manage own assignments" ON public.evaluation_assignments_v2;
DROP POLICY "Recruiters read candidates" ON public.candidates;
DROP POLICY "Recruiters read applications" ON public.applications;
DROP POLICY "Public update candidates" ON public.candidates;
DROP POLICY "Public select candidates" ON public.candidates;
DROP POLICY "Public read jobs" ON public.jobs;
DROP POLICY "Public insert candidates" ON public.candidates;
DROP POLICY "Public insert applications" ON public.applications;
DROP POLICY "Public Insert Candidates" ON public.candidates;
DROP POLICY "Ler tenants vinculados" ON public.tenants;
DROP POLICY "Ler proprio perfil" ON public.user_profiles;
DROP POLICY "Ler planos" ON public.plans;
DROP POLICY "Ler jobs do tenant" ON public.jobs;
DROP POLICY "Ler jobs" ON public.jobs;
DROP POLICY "Ler avaliacoes" ON public.evaluations;
DROP POLICY "Inserir minha avaliacao" ON public.evaluations;
DROP POLICY "Escrever jobs" ON public.jobs;
DROP POLICY "Escrever avaliacoes" ON public.evaluations;
DROP POLICY "Editar minha avaliacao" ON public.evaluations;
DROP POLICY "Criar jobs no tenant" ON public.jobs;
DROP POLICY "Authenticated can read plans" ON public.plans;
DROP POLICY "Auth Read Candidates" ON public.candidates;
DROP POLICY "Anyone can read plans" ON public.plans;
DROP POLICY "Admins can view team members" ON public.users;
DROP POLICY "Admins can update team members" ON public.users;
DROP POLICY "Acesso total tenants" ON public.tenants;
DROP POLICY "Acesso total jobs" ON public.jobs;
DROP POLICY "Acesso total departamentos" ON public.company_departments;
DROP POLICY "Acesso total candidates" ON public.candidates;
DROP POLICY "Acesso total applications" ON public.applications;
DROP POLICY "Acesso total a tenants" ON public.tenants;
DROP POLICY "Acesso total a perfis" ON public.user_profiles;
DROP POLICY "Acesso total a jobs do tenant" ON public.jobs;
DROP POLICY "Acesso total a jobs" ON public.jobs;
ALTER TABLE ONLY storage.vector_indexes DROP CONSTRAINT vector_indexes_bucket_id_fkey;
ALTER TABLE ONLY storage.s3_multipart_uploads_parts DROP CONSTRAINT s3_multipart_uploads_parts_upload_id_fkey;
ALTER TABLE ONLY storage.s3_multipart_uploads_parts DROP CONSTRAINT s3_multipart_uploads_parts_bucket_id_fkey;
ALTER TABLE ONLY storage.s3_multipart_uploads DROP CONSTRAINT s3_multipart_uploads_bucket_id_fkey;
ALTER TABLE ONLY storage.prefixes DROP CONSTRAINT "prefixes_bucketId_fkey";
ALTER TABLE ONLY storage.objects DROP CONSTRAINT "objects_bucketId_fkey";
ALTER TABLE ONLY public.users DROP CONSTRAINT users_tenantid_fkey;
ALTER TABLE ONLY public.users DROP CONSTRAINT users_id_fkey;
ALTER TABLE ONLY public.user_profiles DROP CONSTRAINT user_profiles_tenant_id_fkey;
ALTER TABLE ONLY public.user_profiles DROP CONSTRAINT user_profiles_id_fkey;
ALTER TABLE ONLY public.tenants DROP CONSTRAINT "tenants_planId_fkey";
ALTER TABLE ONLY public.jobs DROP CONSTRAINT jobs_tenantid_fkey;
ALTER TABLE ONLY public.jobs DROP CONSTRAINT "jobs_createdBy_fkey";
ALTER TABLE ONLY public.evaluation_assignments_v2 DROP CONSTRAINT evaluation_assignments_v2_evaluator_id_fkey;
ALTER TABLE ONLY public.evaluation_assignments_v2 DROP CONSTRAINT evaluation_assignments_v2_application_id_fkey;
ALTER TABLE ONLY public.company_departments DROP CONSTRAINT "company_departments_tenantId_fkey";
ALTER TABLE ONLY public.applications DROP CONSTRAINT "applications_tenantId_fkey";
ALTER TABLE ONLY public.applications DROP CONSTRAINT applications_job_link;
ALTER TABLE ONLY public.applications DROP CONSTRAINT applications_candidate_link;
ALTER TABLE ONLY auth.sso_domains DROP CONSTRAINT sso_domains_sso_provider_id_fkey;
ALTER TABLE ONLY auth.sessions DROP CONSTRAINT sessions_user_id_fkey;
ALTER TABLE ONLY auth.sessions DROP CONSTRAINT sessions_oauth_client_id_fkey;
ALTER TABLE ONLY auth.saml_relay_states DROP CONSTRAINT saml_relay_states_sso_provider_id_fkey;
ALTER TABLE ONLY auth.saml_relay_states DROP CONSTRAINT saml_relay_states_flow_state_id_fkey;
ALTER TABLE ONLY auth.saml_providers DROP CONSTRAINT saml_providers_sso_provider_id_fkey;
ALTER TABLE ONLY auth.refresh_tokens DROP CONSTRAINT refresh_tokens_session_id_fkey;
ALTER TABLE ONLY auth.one_time_tokens DROP CONSTRAINT one_time_tokens_user_id_fkey;
ALTER TABLE ONLY auth.oauth_consents DROP CONSTRAINT oauth_consents_user_id_fkey;
ALTER TABLE ONLY auth.oauth_consents DROP CONSTRAINT oauth_consents_client_id_fkey;
ALTER TABLE ONLY auth.oauth_authorizations DROP CONSTRAINT oauth_authorizations_user_id_fkey;
ALTER TABLE ONLY auth.oauth_authorizations DROP CONSTRAINT oauth_authorizations_client_id_fkey;
ALTER TABLE ONLY auth.mfa_factors DROP CONSTRAINT mfa_factors_user_id_fkey;
ALTER TABLE ONLY auth.mfa_challenges DROP CONSTRAINT mfa_challenges_auth_factor_id_fkey;
ALTER TABLE ONLY auth.mfa_amr_claims DROP CONSTRAINT mfa_amr_claims_session_id_fkey;
ALTER TABLE ONLY auth.identities DROP CONSTRAINT identities_user_id_fkey;
DROP TRIGGER update_objects_updated_at ON storage.objects;
DROP TRIGGER prefixes_delete_hierarchy ON storage.prefixes;
DROP TRIGGER prefixes_create_hierarchy ON storage.prefixes;
DROP TRIGGER objects_update_create_prefix ON storage.objects;
DROP TRIGGER objects_insert_create_prefix ON storage.objects;
DROP TRIGGER objects_delete_delete_prefix ON storage.objects;
DROP TRIGGER enforce_bucket_name_length_trigger ON storage.buckets;
DROP TRIGGER tr_check_filters ON realtime.subscription;
DROP TRIGGER on_auth_user_created ON auth.users;
DROP INDEX storage.vector_indexes_name_bucket_id_idx;
DROP INDEX storage.objects_bucket_id_level_idx;
DROP INDEX storage.name_prefix_search;
DROP INDEX storage.idx_prefixes_lower_name;
DROP INDEX storage.idx_objects_lower_name;
DROP INDEX storage.idx_objects_bucket_id_name;
DROP INDEX storage.idx_name_bucket_level_unique;
DROP INDEX storage.idx_multipart_uploads_list;
DROP INDEX storage.buckets_analytics_unique_name_idx;
DROP INDEX storage.bucketid_objname;
DROP INDEX storage.bname;
DROP INDEX realtime.subscription_subscription_id_entity_filters_key;
DROP INDEX realtime.messages_inserted_at_topic_index;
DROP INDEX realtime.ix_realtime_subscription_entity;
DROP INDEX public.idx_jobs_tenant;
DROP INDEX public.idx_jobs_status;
DROP INDEX public.idx_candidates_email;
DROP INDEX auth.users_is_anonymous_idx;
DROP INDEX auth.users_instance_id_idx;
DROP INDEX auth.users_instance_id_email_idx;
DROP INDEX auth.users_email_partial_key;
DROP INDEX auth.user_id_created_at_idx;
DROP INDEX auth.unique_phone_factor_per_user;
DROP INDEX auth.sso_providers_resource_id_pattern_idx;
DROP INDEX auth.sso_providers_resource_id_idx;
DROP INDEX auth.sso_domains_sso_provider_id_idx;
DROP INDEX auth.sso_domains_domain_idx;
DROP INDEX auth.sessions_user_id_idx;
DROP INDEX auth.sessions_oauth_client_id_idx;
DROP INDEX auth.sessions_not_after_idx;
DROP INDEX auth.saml_relay_states_sso_provider_id_idx;
DROP INDEX auth.saml_relay_states_for_email_idx;
DROP INDEX auth.saml_relay_states_created_at_idx;
DROP INDEX auth.saml_providers_sso_provider_id_idx;
DROP INDEX auth.refresh_tokens_updated_at_idx;
DROP INDEX auth.refresh_tokens_session_id_revoked_idx;
DROP INDEX auth.refresh_tokens_parent_idx;
DROP INDEX auth.refresh_tokens_instance_id_user_id_idx;
DROP INDEX auth.refresh_tokens_instance_id_idx;
DROP INDEX auth.recovery_token_idx;
DROP INDEX auth.reauthentication_token_idx;
DROP INDEX auth.one_time_tokens_user_id_token_type_key;
DROP INDEX auth.one_time_tokens_token_hash_hash_idx;
DROP INDEX auth.one_time_tokens_relates_to_hash_idx;
DROP INDEX auth.oauth_consents_user_order_idx;
DROP INDEX auth.oauth_consents_active_user_client_idx;
DROP INDEX auth.oauth_consents_active_client_idx;
DROP INDEX auth.oauth_clients_deleted_at_idx;
DROP INDEX auth.oauth_auth_pending_exp_idx;
DROP INDEX auth.mfa_factors_user_id_idx;
DROP INDEX auth.mfa_factors_user_friendly_name_unique;
DROP INDEX auth.mfa_challenge_created_at_idx;
DROP INDEX auth.idx_user_id_auth_method;
DROP INDEX auth.idx_oauth_client_states_created_at;
DROP INDEX auth.idx_auth_code;
DROP INDEX auth.identities_user_id_idx;
DROP INDEX auth.identities_email_idx;
DROP INDEX auth.flow_state_created_at_idx;
DROP INDEX auth.factor_id_created_at_idx;
DROP INDEX auth.email_change_token_new_idx;
DROP INDEX auth.email_change_token_current_idx;
DROP INDEX auth.confirmation_token_idx;
DROP INDEX auth.audit_logs_instance_id_idx;
ALTER TABLE ONLY storage.vector_indexes DROP CONSTRAINT vector_indexes_pkey;
ALTER TABLE ONLY storage.s3_multipart_uploads DROP CONSTRAINT s3_multipart_uploads_pkey;
ALTER TABLE ONLY storage.s3_multipart_uploads_parts DROP CONSTRAINT s3_multipart_uploads_parts_pkey;
ALTER TABLE ONLY storage.prefixes DROP CONSTRAINT prefixes_pkey;
ALTER TABLE ONLY storage.objects DROP CONSTRAINT objects_pkey;
ALTER TABLE ONLY storage.migrations DROP CONSTRAINT migrations_pkey;
ALTER TABLE ONLY storage.migrations DROP CONSTRAINT migrations_name_key;
ALTER TABLE ONLY storage.buckets_vectors DROP CONSTRAINT buckets_vectors_pkey;
ALTER TABLE ONLY storage.buckets DROP CONSTRAINT buckets_pkey;
ALTER TABLE ONLY storage.buckets_analytics DROP CONSTRAINT buckets_analytics_pkey;
ALTER TABLE ONLY realtime.schema_migrations DROP CONSTRAINT schema_migrations_pkey;
ALTER TABLE ONLY realtime.subscription DROP CONSTRAINT pk_subscription;
ALTER TABLE ONLY realtime.messages DROP CONSTRAINT messages_pkey;
ALTER TABLE ONLY public.users DROP CONSTRAINT users_pkey;
ALTER TABLE ONLY public.user_profiles DROP CONSTRAINT user_profiles_pkey;
ALTER TABLE ONLY public.tenants DROP CONSTRAINT tenants_pkey;
ALTER TABLE ONLY public.plans DROP CONSTRAINT plans_pkey;
ALTER TABLE ONLY public.jobs DROP CONSTRAINT jobs_pkey;
ALTER TABLE ONLY public.evaluations DROP CONSTRAINT evaluations_pkey;
ALTER TABLE ONLY public.evaluations DROP CONSTRAINT evaluations_application_id_evaluator_id_key;
ALTER TABLE ONLY public.evaluation_assignments_v2 DROP CONSTRAINT evaluation_assignments_v2_pkey;
ALTER TABLE ONLY public.evaluation_assignments_v2 DROP CONSTRAINT evaluation_assignments_v2_application_id_evaluator_id_key;
ALTER TABLE ONLY public.company_departments DROP CONSTRAINT company_departments_pkey;
ALTER TABLE ONLY public.candidates DROP CONSTRAINT candidates_pkey;
ALTER TABLE ONLY public.candidates DROP CONSTRAINT candidates_email_key;
ALTER TABLE ONLY public.applications DROP CONSTRAINT applications_pkey;
ALTER TABLE ONLY auth.users DROP CONSTRAINT users_pkey;
ALTER TABLE ONLY auth.users DROP CONSTRAINT users_phone_key;
ALTER TABLE ONLY auth.sso_providers DROP CONSTRAINT sso_providers_pkey;
ALTER TABLE ONLY auth.sso_domains DROP CONSTRAINT sso_domains_pkey;
ALTER TABLE ONLY auth.sessions DROP CONSTRAINT sessions_pkey;
ALTER TABLE ONLY auth.schema_migrations DROP CONSTRAINT schema_migrations_pkey;
ALTER TABLE ONLY auth.saml_relay_states DROP CONSTRAINT saml_relay_states_pkey;
ALTER TABLE ONLY auth.saml_providers DROP CONSTRAINT saml_providers_pkey;
ALTER TABLE ONLY auth.saml_providers DROP CONSTRAINT saml_providers_entity_id_key;
ALTER TABLE ONLY auth.refresh_tokens DROP CONSTRAINT refresh_tokens_token_unique;
ALTER TABLE ONLY auth.refresh_tokens DROP CONSTRAINT refresh_tokens_pkey;
ALTER TABLE ONLY auth.one_time_tokens DROP CONSTRAINT one_time_tokens_pkey;
ALTER TABLE ONLY auth.oauth_consents DROP CONSTRAINT oauth_consents_user_client_unique;
ALTER TABLE ONLY auth.oauth_consents DROP CONSTRAINT oauth_consents_pkey;
ALTER TABLE ONLY auth.oauth_clients DROP CONSTRAINT oauth_clients_pkey;
ALTER TABLE ONLY auth.oauth_client_states DROP CONSTRAINT oauth_client_states_pkey;
ALTER TABLE ONLY auth.oauth_authorizations DROP CONSTRAINT oauth_authorizations_pkey;
ALTER TABLE ONLY auth.oauth_authorizations DROP CONSTRAINT oauth_authorizations_authorization_id_key;
ALTER TABLE ONLY auth.oauth_authorizations DROP CONSTRAINT oauth_authorizations_authorization_code_key;
ALTER TABLE ONLY auth.mfa_factors DROP CONSTRAINT mfa_factors_pkey;
ALTER TABLE ONLY auth.mfa_factors DROP CONSTRAINT mfa_factors_last_challenged_at_key;
ALTER TABLE ONLY auth.mfa_challenges DROP CONSTRAINT mfa_challenges_pkey;
ALTER TABLE ONLY auth.mfa_amr_claims DROP CONSTRAINT mfa_amr_claims_session_id_authentication_method_pkey;
ALTER TABLE ONLY auth.instances DROP CONSTRAINT instances_pkey;
ALTER TABLE ONLY auth.identities DROP CONSTRAINT identities_provider_id_provider_unique;
ALTER TABLE ONLY auth.identities DROP CONSTRAINT identities_pkey;
ALTER TABLE ONLY auth.flow_state DROP CONSTRAINT flow_state_pkey;
ALTER TABLE ONLY auth.audit_log_entries DROP CONSTRAINT audit_log_entries_pkey;
ALTER TABLE ONLY auth.mfa_amr_claims DROP CONSTRAINT amr_id_pk;
ALTER TABLE auth.refresh_tokens ALTER COLUMN id DROP DEFAULT;
DROP TABLE storage.vector_indexes;
DROP TABLE storage.s3_multipart_uploads_parts;
DROP TABLE storage.s3_multipart_uploads;
DROP TABLE storage.prefixes;
DROP TABLE storage.objects;
DROP TABLE storage.migrations;
DROP TABLE storage.buckets_vectors;
DROP TABLE storage.buckets_analytics;
DROP TABLE storage.buckets;
DROP TABLE realtime.subscription;
DROP TABLE realtime.schema_migrations;
DROP TABLE realtime.messages;
DROP TABLE public.users;
DROP TABLE public.user_profiles;
DROP TABLE public.tenants;
DROP TABLE public.plans;
DROP TABLE public.jobs;
DROP TABLE public.evaluations;
DROP TABLE public.evaluation_assignments_v2;
DROP TABLE public.company_departments;
DROP TABLE public.candidates;
DROP TABLE public.applications;
DROP TABLE auth.users;
DROP TABLE auth.sso_providers;
DROP TABLE auth.sso_domains;
DROP TABLE auth.sessions;
DROP TABLE auth.schema_migrations;
DROP TABLE auth.saml_relay_states;
DROP TABLE auth.saml_providers;
DROP SEQUENCE auth.refresh_tokens_id_seq;
DROP TABLE auth.refresh_tokens;
DROP TABLE auth.one_time_tokens;
DROP TABLE auth.oauth_consents;
DROP TABLE auth.oauth_clients;
DROP TABLE auth.oauth_client_states;
DROP TABLE auth.oauth_authorizations;
DROP TABLE auth.mfa_factors;
DROP TABLE auth.mfa_challenges;
DROP TABLE auth.mfa_amr_claims;
DROP TABLE auth.instances;
DROP TABLE auth.identities;
DROP TABLE auth.flow_state;
DROP TABLE auth.audit_log_entries;
DROP FUNCTION storage.update_updated_at_column();
DROP FUNCTION storage.search_v2(prefix text, bucket_name text, limits integer, levels integer, start_after text, sort_order text, sort_column text, sort_column_after text);
DROP FUNCTION storage.search_v1_optimised(prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text);
DROP FUNCTION storage.search_legacy_v1(prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text);
DROP FUNCTION storage.search(prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text);
DROP FUNCTION storage.prefixes_insert_trigger();
DROP FUNCTION storage.prefixes_delete_cleanup();
DROP FUNCTION storage.operation();
DROP FUNCTION storage.objects_update_prefix_trigger();
DROP FUNCTION storage.objects_update_level_trigger();
DROP FUNCTION storage.objects_update_cleanup();
DROP FUNCTION storage.objects_insert_prefix_trigger();
DROP FUNCTION storage.objects_delete_cleanup();
DROP FUNCTION storage.lock_top_prefixes(bucket_ids text[], names text[]);
DROP FUNCTION storage.list_objects_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer, start_after text, next_token text);
DROP FUNCTION storage.list_multipart_uploads_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer, next_key_token text, next_upload_token text);
DROP FUNCTION storage.get_size_by_bucket();
DROP FUNCTION storage.get_prefixes(name text);
DROP FUNCTION storage.get_prefix(name text);
DROP FUNCTION storage.get_level(name text);
DROP FUNCTION storage.foldername(name text);
DROP FUNCTION storage.filename(name text);
DROP FUNCTION storage.extension(name text);
DROP FUNCTION storage.enforce_bucket_name_length();
DROP FUNCTION storage.delete_prefix_hierarchy_trigger();
DROP FUNCTION storage.delete_prefix(_bucket_id text, _name text);
DROP FUNCTION storage.delete_leaf_prefixes(bucket_ids text[], names text[]);
DROP FUNCTION storage.can_insert_object(bucketid text, name text, owner uuid, metadata jsonb);
DROP FUNCTION storage.add_prefixes(_bucket_id text, _name text);
DROP FUNCTION realtime.topic();
DROP FUNCTION realtime.to_regrole(role_name text);
DROP FUNCTION realtime.subscription_check_filters();
DROP FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean);
DROP FUNCTION realtime.quote_wal2json(entity regclass);
DROP FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer);
DROP FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]);
DROP FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text);
DROP FUNCTION realtime."cast"(val text, type_ regtype);
DROP FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]);
DROP FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text);
DROP FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer);
DROP FUNCTION public.update_general_score();
DROP FUNCTION public.update_application_general_score();
DROP FUNCTION public.initialize_job_criteria_v2(target_job_id bigint);
DROP FUNCTION public.handle_new_user();
DROP FUNCTION public.get_candidate_summary_v2(target_app_id bigint);
DROP FUNCTION public.check_plan_limit(target_tenant_id uuid);
DROP FUNCTION pgbouncer.get_auth(p_usename text);
DROP FUNCTION extensions.set_graphql_placeholder();
DROP FUNCTION extensions.pgrst_drop_watch();
DROP FUNCTION extensions.pgrst_ddl_watch();
DROP FUNCTION extensions.grant_pg_net_access();
DROP FUNCTION extensions.grant_pg_graphql_access();
DROP FUNCTION extensions.grant_pg_cron_access();
DROP FUNCTION auth.uid();
DROP FUNCTION auth.role();
DROP FUNCTION auth.jwt();
DROP FUNCTION auth.email();
DROP TYPE storage.buckettype;
DROP TYPE realtime.wal_rls;
DROP TYPE realtime.wal_column;
DROP TYPE realtime.user_defined_filter;
DROP TYPE realtime.equality_op;
DROP TYPE realtime.action;
DROP TYPE auth.one_time_token_type;
DROP TYPE auth.oauth_response_type;
DROP TYPE auth.oauth_registration_type;
DROP TYPE auth.oauth_client_type;
DROP TYPE auth.oauth_authorization_status;
DROP TYPE auth.factor_type;
DROP TYPE auth.factor_status;
DROP TYPE auth.code_challenge_method;
DROP TYPE auth.aal_level;
DROP EXTENSION "uuid-ossp";
DROP EXTENSION supabase_vault;
DROP EXTENSION pgcrypto;
DROP EXTENSION pg_stat_statements;
DROP EXTENSION pg_graphql;
DROP SCHEMA vault;
DROP SCHEMA storage;
DROP SCHEMA realtime;
DROP SCHEMA pgbouncer;
DROP SCHEMA graphql_public;
DROP SCHEMA graphql;
DROP SCHEMA extensions;
DROP SCHEMA auth;
--
-- TOC entry 37 (class 2615 OID 16494)
-- Name: auth; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA auth;


ALTER SCHEMA auth OWNER TO supabase_admin;

--
-- TOC entry 23 (class 2615 OID 16388)
-- Name: extensions; Type: SCHEMA; Schema: -; Owner: postgres
--

CREATE SCHEMA extensions;


ALTER SCHEMA extensions OWNER TO postgres;

--
-- TOC entry 35 (class 2615 OID 16574)
-- Name: graphql; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA graphql;


ALTER SCHEMA graphql OWNER TO supabase_admin;

--
-- TOC entry 34 (class 2615 OID 16563)
-- Name: graphql_public; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA graphql_public;


ALTER SCHEMA graphql_public OWNER TO supabase_admin;

--
-- TOC entry 12 (class 2615 OID 16386)
-- Name: pgbouncer; Type: SCHEMA; Schema: -; Owner: pgbouncer
--

CREATE SCHEMA pgbouncer;


ALTER SCHEMA pgbouncer OWNER TO pgbouncer;

--
-- TOC entry 13 (class 2615 OID 16555)
-- Name: realtime; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA realtime;


ALTER SCHEMA realtime OWNER TO supabase_admin;

--
-- TOC entry 38 (class 2615 OID 16542)
-- Name: storage; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA storage;


ALTER SCHEMA storage OWNER TO supabase_admin;

--
-- TOC entry 32 (class 2615 OID 16603)
-- Name: vault; Type: SCHEMA; Schema: -; Owner: supabase_admin
--

CREATE SCHEMA vault;


ALTER SCHEMA vault OWNER TO supabase_admin;

--
-- TOC entry 6 (class 3079 OID 16639)
-- Name: pg_graphql; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS pg_graphql WITH SCHEMA graphql;


--
-- TOC entry 4339 (class 0 OID 0)
-- Dependencies: 6
-- Name: EXTENSION pg_graphql; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION pg_graphql IS 'pg_graphql: GraphQL support';


--
-- TOC entry 2 (class 3079 OID 16389)
-- Name: pg_stat_statements; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS pg_stat_statements WITH SCHEMA extensions;


--
-- TOC entry 4340 (class 0 OID 0)
-- Dependencies: 2
-- Name: EXTENSION pg_stat_statements; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION pg_stat_statements IS 'track planning and execution statistics of all SQL statements executed';


--
-- TOC entry 4 (class 3079 OID 16443)
-- Name: pgcrypto; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS pgcrypto WITH SCHEMA extensions;


--
-- TOC entry 4341 (class 0 OID 0)
-- Dependencies: 4
-- Name: EXTENSION pgcrypto; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION pgcrypto IS 'cryptographic functions';


--
-- TOC entry 5 (class 3079 OID 16604)
-- Name: supabase_vault; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS supabase_vault WITH SCHEMA vault;


--
-- TOC entry 4342 (class 0 OID 0)
-- Dependencies: 5
-- Name: EXTENSION supabase_vault; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION supabase_vault IS 'Supabase Vault Extension';


--
-- TOC entry 3 (class 3079 OID 16432)
-- Name: uuid-ossp; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS "uuid-ossp" WITH SCHEMA extensions;


--
-- TOC entry 4343 (class 0 OID 0)
-- Dependencies: 3
-- Name: EXTENSION "uuid-ossp"; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION "uuid-ossp" IS 'generate universally unique identifiers (UUIDs)';


--
-- TOC entry 1180 (class 1247 OID 16738)
-- Name: aal_level; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.aal_level AS ENUM (
    'aal1',
    'aal2',
    'aal3'
);


ALTER TYPE auth.aal_level OWNER TO supabase_auth_admin;

--
-- TOC entry 1204 (class 1247 OID 16879)
-- Name: code_challenge_method; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.code_challenge_method AS ENUM (
    's256',
    'plain'
);


ALTER TYPE auth.code_challenge_method OWNER TO supabase_auth_admin;

--
-- TOC entry 1177 (class 1247 OID 16732)
-- Name: factor_status; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.factor_status AS ENUM (
    'unverified',
    'verified'
);


ALTER TYPE auth.factor_status OWNER TO supabase_auth_admin;

--
-- TOC entry 1174 (class 1247 OID 16727)
-- Name: factor_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.factor_type AS ENUM (
    'totp',
    'webauthn',
    'phone'
);


ALTER TYPE auth.factor_type OWNER TO supabase_auth_admin;

--
-- TOC entry 1222 (class 1247 OID 16982)
-- Name: oauth_authorization_status; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.oauth_authorization_status AS ENUM (
    'pending',
    'approved',
    'denied',
    'expired'
);


ALTER TYPE auth.oauth_authorization_status OWNER TO supabase_auth_admin;

--
-- TOC entry 1234 (class 1247 OID 17055)
-- Name: oauth_client_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.oauth_client_type AS ENUM (
    'public',
    'confidential'
);


ALTER TYPE auth.oauth_client_type OWNER TO supabase_auth_admin;

--
-- TOC entry 1216 (class 1247 OID 16960)
-- Name: oauth_registration_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.oauth_registration_type AS ENUM (
    'dynamic',
    'manual'
);


ALTER TYPE auth.oauth_registration_type OWNER TO supabase_auth_admin;

--
-- TOC entry 1225 (class 1247 OID 16992)
-- Name: oauth_response_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.oauth_response_type AS ENUM (
    'code'
);


ALTER TYPE auth.oauth_response_type OWNER TO supabase_auth_admin;

--
-- TOC entry 1210 (class 1247 OID 16921)
-- Name: one_time_token_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TYPE auth.one_time_token_type AS ENUM (
    'confirmation_token',
    'reauthentication_token',
    'recovery_token',
    'email_change_token_new',
    'email_change_token_current',
    'phone_change_token'
);


ALTER TYPE auth.one_time_token_type OWNER TO supabase_auth_admin;

--
-- TOC entry 1282 (class 1247 OID 17349)
-- Name: action; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.action AS ENUM (
    'INSERT',
    'UPDATE',
    'DELETE',
    'TRUNCATE',
    'ERROR'
);


ALTER TYPE realtime.action OWNER TO supabase_admin;

--
-- TOC entry 1273 (class 1247 OID 17309)
-- Name: equality_op; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.equality_op AS ENUM (
    'eq',
    'neq',
    'lt',
    'lte',
    'gt',
    'gte',
    'in'
);


ALTER TYPE realtime.equality_op OWNER TO supabase_admin;

--
-- TOC entry 1276 (class 1247 OID 17323)
-- Name: user_defined_filter; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.user_defined_filter AS (
	column_name text,
	op realtime.equality_op,
	value text
);


ALTER TYPE realtime.user_defined_filter OWNER TO supabase_admin;

--
-- TOC entry 1288 (class 1247 OID 17390)
-- Name: wal_column; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.wal_column AS (
	name text,
	type_name text,
	type_oid oid,
	value jsonb,
	is_pkey boolean,
	is_selectable boolean
);


ALTER TYPE realtime.wal_column OWNER TO supabase_admin;

--
-- TOC entry 1285 (class 1247 OID 17361)
-- Name: wal_rls; Type: TYPE; Schema: realtime; Owner: supabase_admin
--

CREATE TYPE realtime.wal_rls AS (
	wal jsonb,
	is_rls_enabled boolean,
	subscription_ids uuid[],
	errors text[]
);


ALTER TYPE realtime.wal_rls OWNER TO supabase_admin;

--
-- TOC entry 1261 (class 1247 OID 17241)
-- Name: buckettype; Type: TYPE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TYPE storage.buckettype AS ENUM (
    'STANDARD',
    'ANALYTICS',
    'VECTOR'
);


ALTER TYPE storage.buckettype OWNER TO supabase_storage_admin;

--
-- TOC entry 439 (class 1255 OID 16540)
-- Name: email(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
--

CREATE FUNCTION auth.email() RETURNS text
    LANGUAGE sql STABLE
    AS $$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.email', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'email')
  )::text
$$;


ALTER FUNCTION auth.email() OWNER TO supabase_auth_admin;

--
-- TOC entry 4344 (class 0 OID 0)
-- Dependencies: 439
-- Name: FUNCTION email(); Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON FUNCTION auth.email() IS 'Deprecated. Use auth.jwt() -> ''email'' instead.';


--
-- TOC entry 513 (class 1255 OID 16709)
-- Name: jwt(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
--

CREATE FUNCTION auth.jwt() RETURNS jsonb
    LANGUAGE sql STABLE
    AS $$
  select 
    coalesce(
        nullif(current_setting('request.jwt.claim', true), ''),
        nullif(current_setting('request.jwt.claims', true), '')
    )::jsonb
$$;


ALTER FUNCTION auth.jwt() OWNER TO supabase_auth_admin;

--
-- TOC entry 405 (class 1255 OID 16539)
-- Name: role(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
--

CREATE FUNCTION auth.role() RETURNS text
    LANGUAGE sql STABLE
    AS $$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.role', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'role')
  )::text
$$;


ALTER FUNCTION auth.role() OWNER TO supabase_auth_admin;

--
-- TOC entry 4347 (class 0 OID 0)
-- Dependencies: 405
-- Name: FUNCTION role(); Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON FUNCTION auth.role() IS 'Deprecated. Use auth.jwt() -> ''role'' instead.';


--
-- TOC entry 418 (class 1255 OID 16538)
-- Name: uid(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
--

CREATE FUNCTION auth.uid() RETURNS uuid
    LANGUAGE sql STABLE
    AS $$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.sub', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'sub')
  )::uuid
$$;


ALTER FUNCTION auth.uid() OWNER TO supabase_auth_admin;

--
-- TOC entry 4349 (class 0 OID 0)
-- Dependencies: 418
-- Name: FUNCTION uid(); Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON FUNCTION auth.uid() IS 'Deprecated. Use auth.jwt() -> ''sub'' instead.';


--
-- TOC entry 435 (class 1255 OID 16547)
-- Name: grant_pg_cron_access(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.grant_pg_cron_access() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  IF EXISTS (
    SELECT
    FROM pg_event_trigger_ddl_commands() AS ev
    JOIN pg_extension AS ext
    ON ev.objid = ext.oid
    WHERE ext.extname = 'pg_cron'
  )
  THEN
    grant usage on schema cron to postgres with grant option;

    alter default privileges in schema cron grant all on tables to postgres with grant option;
    alter default privileges in schema cron grant all on functions to postgres with grant option;
    alter default privileges in schema cron grant all on sequences to postgres with grant option;

    alter default privileges for user supabase_admin in schema cron grant all
        on sequences to postgres with grant option;
    alter default privileges for user supabase_admin in schema cron grant all
        on tables to postgres with grant option;
    alter default privileges for user supabase_admin in schema cron grant all
        on functions to postgres with grant option;

    grant all privileges on all tables in schema cron to postgres with grant option;
    revoke all on table cron.job from postgres;
    grant select on table cron.job to postgres with grant option;
  END IF;
END;
$$;


ALTER FUNCTION extensions.grant_pg_cron_access() OWNER TO supabase_admin;

--
-- TOC entry 4365 (class 0 OID 0)
-- Dependencies: 435
-- Name: FUNCTION grant_pg_cron_access(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
--

COMMENT ON FUNCTION extensions.grant_pg_cron_access() IS 'Grants access to pg_cron';


--
-- TOC entry 503 (class 1255 OID 16568)
-- Name: grant_pg_graphql_access(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.grant_pg_graphql_access() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $_$
DECLARE
    func_is_graphql_resolve bool;
BEGIN
    func_is_graphql_resolve = (
        SELECT n.proname = 'resolve'
        FROM pg_event_trigger_ddl_commands() AS ev
        LEFT JOIN pg_catalog.pg_proc AS n
        ON ev.objid = n.oid
    );

    IF func_is_graphql_resolve
    THEN
        -- Update public wrapper to pass all arguments through to the pg_graphql resolve func
        DROP FUNCTION IF EXISTS graphql_public.graphql;
        create or replace function graphql_public.graphql(
            "operationName" text default null,
            query text default null,
            variables jsonb default null,
            extensions jsonb default null
        )
            returns jsonb
            language sql
        as $$
            select graphql.resolve(
                query := query,
                variables := coalesce(variables, '{}'),
                "operationName" := "operationName",
                extensions := extensions
            );
        $$;

        -- This hook executes when `graphql.resolve` is created. That is not necessarily the last
        -- function in the extension so we need to grant permissions on existing entities AND
        -- update default permissions to any others that are created after `graphql.resolve`
        grant usage on schema graphql to postgres, anon, authenticated, service_role;
        grant select on all tables in schema graphql to postgres, anon, authenticated, service_role;
        grant execute on all functions in schema graphql to postgres, anon, authenticated, service_role;
        grant all on all sequences in schema graphql to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on tables to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on functions to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on sequences to postgres, anon, authenticated, service_role;

        -- Allow postgres role to allow granting usage on graphql and graphql_public schemas to custom roles
        grant usage on schema graphql_public to postgres with grant option;
        grant usage on schema graphql to postgres with grant option;
    END IF;

END;
$_$;


ALTER FUNCTION extensions.grant_pg_graphql_access() OWNER TO supabase_admin;

--
-- TOC entry 4367 (class 0 OID 0)
-- Dependencies: 503
-- Name: FUNCTION grant_pg_graphql_access(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
--

COMMENT ON FUNCTION extensions.grant_pg_graphql_access() IS 'Grants access to pg_graphql';


--
-- TOC entry 397 (class 1255 OID 16549)
-- Name: grant_pg_net_access(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.grant_pg_net_access() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  IF EXISTS (
    SELECT 1
    FROM pg_event_trigger_ddl_commands() AS ev
    JOIN pg_extension AS ext
    ON ev.objid = ext.oid
    WHERE ext.extname = 'pg_net'
  )
  THEN
    IF NOT EXISTS (
      SELECT 1
      FROM pg_roles
      WHERE rolname = 'supabase_functions_admin'
    )
    THEN
      CREATE USER supabase_functions_admin NOINHERIT CREATEROLE LOGIN NOREPLICATION;
    END IF;

    GRANT USAGE ON SCHEMA net TO supabase_functions_admin, postgres, anon, authenticated, service_role;

    IF EXISTS (
      SELECT FROM pg_extension
      WHERE extname = 'pg_net'
      -- all versions in use on existing projects as of 2025-02-20
      -- version 0.12.0 onwards don't need these applied
      AND extversion IN ('0.2', '0.6', '0.7', '0.7.1', '0.8', '0.10.0', '0.11.0')
    ) THEN
      ALTER function net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) SECURITY DEFINER;
      ALTER function net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) SECURITY DEFINER;

      ALTER function net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) SET search_path = net;
      ALTER function net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) SET search_path = net;

      REVOKE ALL ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;
      REVOKE ALL ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;

      GRANT EXECUTE ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin, postgres, anon, authenticated, service_role;
      GRANT EXECUTE ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin, postgres, anon, authenticated, service_role;
    END IF;
  END IF;
END;
$$;


ALTER FUNCTION extensions.grant_pg_net_access() OWNER TO supabase_admin;

--
-- TOC entry 4369 (class 0 OID 0)
-- Dependencies: 397
-- Name: FUNCTION grant_pg_net_access(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
--

COMMENT ON FUNCTION extensions.grant_pg_net_access() IS 'Grants access to pg_net';


--
-- TOC entry 522 (class 1255 OID 16559)
-- Name: pgrst_ddl_watch(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.pgrst_ddl_watch() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  cmd record;
BEGIN
  FOR cmd IN SELECT * FROM pg_event_trigger_ddl_commands()
  LOOP
    IF cmd.command_tag IN (
      'CREATE SCHEMA', 'ALTER SCHEMA'
    , 'CREATE TABLE', 'CREATE TABLE AS', 'SELECT INTO', 'ALTER TABLE'
    , 'CREATE FOREIGN TABLE', 'ALTER FOREIGN TABLE'
    , 'CREATE VIEW', 'ALTER VIEW'
    , 'CREATE MATERIALIZED VIEW', 'ALTER MATERIALIZED VIEW'
    , 'CREATE FUNCTION', 'ALTER FUNCTION'
    , 'CREATE TRIGGER'
    , 'CREATE TYPE', 'ALTER TYPE'
    , 'CREATE RULE'
    , 'COMMENT'
    )
    -- don't notify in case of CREATE TEMP table or other objects created on pg_temp
    AND cmd.schema_name is distinct from 'pg_temp'
    THEN
      NOTIFY pgrst, 'reload schema';
    END IF;
  END LOOP;
END; $$;


ALTER FUNCTION extensions.pgrst_ddl_watch() OWNER TO supabase_admin;

--
-- TOC entry 515 (class 1255 OID 16560)
-- Name: pgrst_drop_watch(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.pgrst_drop_watch() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  obj record;
BEGIN
  FOR obj IN SELECT * FROM pg_event_trigger_dropped_objects()
  LOOP
    IF obj.object_type IN (
      'schema'
    , 'table'
    , 'foreign table'
    , 'view'
    , 'materialized view'
    , 'function'
    , 'trigger'
    , 'type'
    , 'rule'
    )
    AND obj.is_temporary IS false -- no pg_temp objects
    THEN
      NOTIFY pgrst, 'reload schema';
    END IF;
  END LOOP;
END; $$;


ALTER FUNCTION extensions.pgrst_drop_watch() OWNER TO supabase_admin;

--
-- TOC entry 497 (class 1255 OID 16570)
-- Name: set_graphql_placeholder(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
--

CREATE FUNCTION extensions.set_graphql_placeholder() RETURNS event_trigger
    LANGUAGE plpgsql
    AS $_$
    DECLARE
    graphql_is_dropped bool;
    BEGIN
    graphql_is_dropped = (
        SELECT ev.schema_name = 'graphql_public'
        FROM pg_event_trigger_dropped_objects() AS ev
        WHERE ev.schema_name = 'graphql_public'
    );

    IF graphql_is_dropped
    THEN
        create or replace function graphql_public.graphql(
            "operationName" text default null,
            query text default null,
            variables jsonb default null,
            extensions jsonb default null
        )
            returns jsonb
            language plpgsql
        as $$
            DECLARE
                server_version float;
            BEGIN
                server_version = (SELECT (SPLIT_PART((select version()), ' ', 2))::float);

                IF server_version >= 14 THEN
                    RETURN jsonb_build_object(
                        'errors', jsonb_build_array(
                            jsonb_build_object(
                                'message', 'pg_graphql extension is not enabled.'
                            )
                        )
                    );
                ELSE
                    RETURN jsonb_build_object(
                        'errors', jsonb_build_array(
                            jsonb_build_object(
                                'message', 'pg_graphql is only available on projects running Postgres 14 onwards.'
                            )
                        )
                    );
                END IF;
            END;
        $$;
    END IF;

    END;
$_$;


ALTER FUNCTION extensions.set_graphql_placeholder() OWNER TO supabase_admin;

--
-- TOC entry 4398 (class 0 OID 0)
-- Dependencies: 497
-- Name: FUNCTION set_graphql_placeholder(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
--

COMMENT ON FUNCTION extensions.set_graphql_placeholder() IS 'Reintroduces placeholder function for graphql_public.graphql';


--
-- TOC entry 441 (class 1255 OID 16387)
-- Name: get_auth(text); Type: FUNCTION; Schema: pgbouncer; Owner: supabase_admin
--

CREATE FUNCTION pgbouncer.get_auth(p_usename text) RETURNS TABLE(username text, password text)
    LANGUAGE plpgsql SECURITY DEFINER
    SET search_path TO ''
    AS $_$
  BEGIN
      RAISE DEBUG 'PgBouncer auth request: %', p_usename;

      RETURN QUERY
      SELECT
          rolname::text,
          CASE WHEN rolvaliduntil < now()
              THEN null
              ELSE rolpassword::text
          END
      FROM pg_authid
      WHERE rolname=$1 and rolcanlogin;
  END;
  $_$;


ALTER FUNCTION pgbouncer.get_auth(p_usename text) OWNER TO supabase_admin;

--
-- TOC entry 518 (class 1255 OID 23031)
-- Name: check_plan_limit(uuid); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.check_plan_limit(target_tenant_id uuid) RETURNS boolean
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    active_users int;
    max_users int;
    plan_tier text;
BEGIN
    SELECT plan INTO plan_tier FROM public.tenants WHERE id = target_tenant_id;
    
    IF plan_tier = 'enterprise' THEN max_users := 999;
    ELSIF plan_tier = 'pro' THEN max_users := 5;
    ELSE max_users := 1; 
    END IF;

    SELECT count(*) INTO active_users FROM public.users 
    WHERE "tenantId" = target_tenant_id AND status = 'active';

    RETURN active_users < max_users;
END;
$$;


ALTER FUNCTION public.check_plan_limit(target_tenant_id uuid) OWNER TO postgres;

--
-- TOC entry 487 (class 1255 OID 17805)
-- Name: get_candidate_summary_v2(bigint); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.get_candidate_summary_v2(target_app_id bigint) RETURNS jsonb
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
  app_record record;
BEGIN
  -- Seleciona colunas essenciais
  SELECT evaluation, score_general, status, is_hired 
  INTO app_record 
  FROM public.applications 
  WHERE id = target_app_id;
  
  IF app_record IS NULL THEN
    RETURN jsonb_build_object('error', 'Candidatura nÃ£o encontrada');
  END IF;

  RETURN jsonb_build_object(
    'evaluation', app_record.evaluation,
    'score_general', app_record.score_general,
    'status', app_record.status,
    'hired', app_record.is_hired
  );
END;
$$;


ALTER FUNCTION public.get_candidate_summary_v2(target_app_id bigint) OWNER TO postgres;

--
-- TOC entry 413 (class 1255 OID 17538)
-- Name: handle_new_user(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.handle_new_user() RETURNS trigger
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
begin
  insert into public.users (id, email, "tenantId")
  values (
    new.id, 
    new.email, 
    -- Gera um ID de empresa aleatÃ³rio (ex: tenant-a1b2c3d4)
    'tenant-' || substr(md5(random()::text), 1, 8) 
  );
  return new;
end;
$$;


ALTER FUNCTION public.handle_new_user() OWNER TO postgres;

--
-- TOC entry 494 (class 1255 OID 17804)
-- Name: initialize_job_criteria_v2(bigint); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.initialize_job_criteria_v2(target_job_id bigint) RETURNS jsonb
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
  current_params jsonb;
  default_params jsonb := '{"triagem": [], "cultura": [], "tecnico": [], "notas": []}'::jsonb;
BEGIN
  -- Seleciona a coluna parameters da tabela jobs
  SELECT parameters INTO current_params FROM public.jobs WHERE id = target_job_id;
  
  IF current_params IS NULL OR current_params = '{}'::jsonb THEN
    UPDATE public.jobs SET parameters = default_params WHERE id = target_job_id;
    RETURN default_params;
  END IF;
  
  RETURN current_params;
END;
$$;


ALTER FUNCTION public.initialize_job_criteria_v2(target_job_id bigint) OWNER TO postgres;

--
-- TOC entry 431 (class 1255 OID 22868)
-- Name: update_application_general_score(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.update_application_general_score() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    UPDATE public.applications
    SET evaluation = jsonb_set(
        COALESCE(evaluation, '{}'::jsonb),
        '{general_score}', 
        to_jsonb((SELECT COALESCE(AVG(final_score), 0) FROM public.evaluations WHERE application_id = NEW.application_id))
    )
    WHERE id = NEW.application_id;
    RETURN NEW;
END;
$$;


ALTER FUNCTION public.update_application_general_score() OWNER TO postgres;

--
-- TOC entry 451 (class 1255 OID 22926)
-- Name: update_general_score(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.update_general_score() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    UPDATE public.applications
    SET evaluation = jsonb_set(
        COALESCE(evaluation, '{}'::jsonb),
        '{general_score}', 
        to_jsonb((
            SELECT COALESCE(AVG(final_score), 0) 
            FROM public.evaluations 
            WHERE application_id = NEW.application_id
        ))
    )
    WHERE id = NEW.application_id;
    RETURN NEW;
END;
$$;


ALTER FUNCTION public.update_general_score() OWNER TO postgres;

--
-- TOC entry 461 (class 1255 OID 17383)
-- Name: apply_rls(jsonb, integer); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer DEFAULT (1024 * 1024)) RETURNS SETOF realtime.wal_rls
    LANGUAGE plpgsql
    AS $$
declare
-- Regclass of the table e.g. public.notes
entity_ regclass = (quote_ident(wal ->> 'schema') || '.' || quote_ident(wal ->> 'table'))::regclass;

-- I, U, D, T: insert, update ...
action realtime.action = (
    case wal ->> 'action'
        when 'I' then 'INSERT'
        when 'U' then 'UPDATE'
        when 'D' then 'DELETE'
        else 'ERROR'
    end
);

-- Is row level security enabled for the table
is_rls_enabled bool = relrowsecurity from pg_class where oid = entity_;

subscriptions realtime.subscription[] = array_agg(subs)
    from
        realtime.subscription subs
    where
        subs.entity = entity_;

-- Subscription vars
roles regrole[] = array_agg(distinct us.claims_role::text)
    from
        unnest(subscriptions) us;

working_role regrole;
claimed_role regrole;
claims jsonb;

subscription_id uuid;
subscription_has_access bool;
visible_to_subscription_ids uuid[] = '{}';

-- structured info for wal's columns
columns realtime.wal_column[];
-- previous identity values for update/delete
old_columns realtime.wal_column[];

error_record_exceeds_max_size boolean = octet_length(wal::text) > max_record_bytes;

-- Primary jsonb output for record
output jsonb;

begin
perform set_config('role', null, true);

columns =
    array_agg(
        (
            x->>'name',
            x->>'type',
            x->>'typeoid',
            realtime.cast(
                (x->'value') #>> '{}',
                coalesce(
                    (x->>'typeoid')::regtype, -- null when wal2json version <= 2.4
                    (x->>'type')::regtype
                )
            ),
            (pks ->> 'name') is not null,
            true
        )::realtime.wal_column
    )
    from
        jsonb_array_elements(wal -> 'columns') x
        left join jsonb_array_elements(wal -> 'pk') pks
            on (x ->> 'name') = (pks ->> 'name');

old_columns =
    array_agg(
        (
            x->>'name',
            x->>'type',
            x->>'typeoid',
            realtime.cast(
                (x->'value') #>> '{}',
                coalesce(
                    (x->>'typeoid')::regtype, -- null when wal2json version <= 2.4
                    (x->>'type')::regtype
                )
            ),
            (pks ->> 'name') is not null,
            true
        )::realtime.wal_column
    )
    from
        jsonb_array_elements(wal -> 'identity') x
        left join jsonb_array_elements(wal -> 'pk') pks
            on (x ->> 'name') = (pks ->> 'name');

for working_role in select * from unnest(roles) loop

    -- Update `is_selectable` for columns and old_columns
    columns =
        array_agg(
            (
                c.name,
                c.type_name,
                c.type_oid,
                c.value,
                c.is_pkey,
                pg_catalog.has_column_privilege(working_role, entity_, c.name, 'SELECT')
            )::realtime.wal_column
        )
        from
            unnest(columns) c;

    old_columns =
            array_agg(
                (
                    c.name,
                    c.type_name,
                    c.type_oid,
                    c.value,
                    c.is_pkey,
                    pg_catalog.has_column_privilege(working_role, entity_, c.name, 'SELECT')
                )::realtime.wal_column
            )
            from
                unnest(old_columns) c;

    if action <> 'DELETE' and count(1) = 0 from unnest(columns) c where c.is_pkey then
        return next (
            jsonb_build_object(
                'schema', wal ->> 'schema',
                'table', wal ->> 'table',
                'type', action
            ),
            is_rls_enabled,
            -- subscriptions is already filtered by entity
            (select array_agg(s.subscription_id) from unnest(subscriptions) as s where claims_role = working_role),
            array['Error 400: Bad Request, no primary key']
        )::realtime.wal_rls;

    -- The claims role does not have SELECT permission to the primary key of entity
    elsif action <> 'DELETE' and sum(c.is_selectable::int) <> count(1) from unnest(columns) c where c.is_pkey then
        return next (
            jsonb_build_object(
                'schema', wal ->> 'schema',
                'table', wal ->> 'table',
                'type', action
            ),
            is_rls_enabled,
            (select array_agg(s.subscription_id) from unnest(subscriptions) as s where claims_role = working_role),
            array['Error 401: Unauthorized']
        )::realtime.wal_rls;

    else
        output = jsonb_build_object(
            'schema', wal ->> 'schema',
            'table', wal ->> 'table',
            'type', action,
            'commit_timestamp', to_char(
                ((wal ->> 'timestamp')::timestamptz at time zone 'utc'),
                'YYYY-MM-DD"T"HH24:MI:SS.MS"Z"'
            ),
            'columns', (
                select
                    jsonb_agg(
                        jsonb_build_object(
                            'name', pa.attname,
                            'type', pt.typname
                        )
                        order by pa.attnum asc
                    )
                from
                    pg_attribute pa
                    join pg_type pt
                        on pa.atttypid = pt.oid
                where
                    attrelid = entity_
                    and attnum > 0
                    and pg_catalog.has_column_privilege(working_role, entity_, pa.attname, 'SELECT')
            )
        )
        -- Add "record" key for insert and update
        || case
            when action in ('INSERT', 'UPDATE') then
                jsonb_build_object(
                    'record',
                    (
                        select
                            jsonb_object_agg(
                                -- if unchanged toast, get column name and value from old record
                                coalesce((c).name, (oc).name),
                                case
                                    when (c).name is null then (oc).value
                                    else (c).value
                                end
                            )
                        from
                            unnest(columns) c
                            full outer join unnest(old_columns) oc
                                on (c).name = (oc).name
                        where
                            coalesce((c).is_selectable, (oc).is_selectable)
                            and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                    )
                )
            else '{}'::jsonb
        end
        -- Add "old_record" key for update and delete
        || case
            when action = 'UPDATE' then
                jsonb_build_object(
                        'old_record',
                        (
                            select jsonb_object_agg((c).name, (c).value)
                            from unnest(old_columns) c
                            where
                                (c).is_selectable
                                and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                        )
                    )
            when action = 'DELETE' then
                jsonb_build_object(
                    'old_record',
                    (
                        select jsonb_object_agg((c).name, (c).value)
                        from unnest(old_columns) c
                        where
                            (c).is_selectable
                            and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                            and ( not is_rls_enabled or (c).is_pkey ) -- if RLS enabled, we can't secure deletes so filter to pkey
                    )
                )
            else '{}'::jsonb
        end;

        -- Create the prepared statement
        if is_rls_enabled and action <> 'DELETE' then
            if (select 1 from pg_prepared_statements where name = 'walrus_rls_stmt' limit 1) > 0 then
                deallocate walrus_rls_stmt;
            end if;
            execute realtime.build_prepared_statement_sql('walrus_rls_stmt', entity_, columns);
        end if;

        visible_to_subscription_ids = '{}';

        for subscription_id, claims in (
                select
                    subs.subscription_id,
                    subs.claims
                from
                    unnest(subscriptions) subs
                where
                    subs.entity = entity_
                    and subs.claims_role = working_role
                    and (
                        realtime.is_visible_through_filters(columns, subs.filters)
                        or (
                          action = 'DELETE'
                          and realtime.is_visible_through_filters(old_columns, subs.filters)
                        )
                    )
        ) loop

            if not is_rls_enabled or action = 'DELETE' then
                visible_to_subscription_ids = visible_to_subscription_ids || subscription_id;
            else
                -- Check if RLS allows the role to see the record
                perform
                    -- Trim leading and trailing quotes from working_role because set_config
                    -- doesn't recognize the role as valid if they are included
                    set_config('role', trim(both '"' from working_role::text), true),
                    set_config('request.jwt.claims', claims::text, true);

                execute 'execute walrus_rls_stmt' into subscription_has_access;

                if subscription_has_access then
                    visible_to_subscription_ids = visible_to_subscription_ids || subscription_id;
                end if;
            end if;
        end loop;

        perform set_config('role', null, true);

        return next (
            output,
            is_rls_enabled,
            visible_to_subscription_ids,
            case
                when error_record_exceeds_max_size then array['Error 413: Payload Too Large']
                else '{}'
            end
        )::realtime.wal_rls;

    end if;
end loop;

perform set_config('role', null, true);
end;
$$;


ALTER FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) OWNER TO supabase_admin;

--
-- TOC entry 400 (class 1255 OID 17462)
-- Name: broadcast_changes(text, text, text, text, text, record, record, text); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text DEFAULT 'ROW'::text) RETURNS void
    LANGUAGE plpgsql
    AS $$
DECLARE
    -- Declare a variable to hold the JSONB representation of the row
    row_data jsonb := '{}'::jsonb;
BEGIN
    IF level = 'STATEMENT' THEN
        RAISE EXCEPTION 'function can only be triggered for each row, not for each statement';
    END IF;
    -- Check the operation type and handle accordingly
    IF operation = 'INSERT' OR operation = 'UPDATE' OR operation = 'DELETE' THEN
        row_data := jsonb_build_object('old_record', OLD, 'record', NEW, 'operation', operation, 'table', table_name, 'schema', table_schema);
        PERFORM realtime.send (row_data, event_name, topic_name);
    ELSE
        RAISE EXCEPTION 'Unexpected operation type: %', operation;
    END IF;
EXCEPTION
    WHEN OTHERS THEN
        RAISE EXCEPTION 'Failed to process the row: %', SQLERRM;
END;

$$;


ALTER FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text) OWNER TO supabase_admin;

--
-- TOC entry 491 (class 1255 OID 17395)
-- Name: build_prepared_statement_sql(text, regclass, realtime.wal_column[]); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) RETURNS text
    LANGUAGE sql
    AS $$
      /*
      Builds a sql string that, if executed, creates a prepared statement to
      tests retrive a row from *entity* by its primary key columns.
      Example
          select realtime.build_prepared_statement_sql('public.notes', '{"id"}'::text[], '{"bigint"}'::text[])
      */
          select
      'prepare ' || prepared_statement_name || ' as
          select
              exists(
                  select
                      1
                  from
                      ' || entity || '
                  where
                      ' || string_agg(quote_ident(pkc.name) || '=' || quote_nullable(pkc.value #>> '{}') , ' and ') || '
              )'
          from
              unnest(columns) pkc
          where
              pkc.is_pkey
          group by
              entity
      $$;


ALTER FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) OWNER TO supabase_admin;

--
-- TOC entry 457 (class 1255 OID 17346)
-- Name: cast(text, regtype); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime."cast"(val text, type_ regtype) RETURNS jsonb
    LANGUAGE plpgsql IMMUTABLE
    AS $$
    declare
      res jsonb;
    begin
      execute format('select to_jsonb(%L::'|| type_::text || ')', val)  into res;
      return res;
    end
    $$;


ALTER FUNCTION realtime."cast"(val text, type_ regtype) OWNER TO supabase_admin;

--
-- TOC entry 467 (class 1255 OID 17340)
-- Name: check_equality_op(realtime.equality_op, regtype, text, text); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) RETURNS boolean
    LANGUAGE plpgsql IMMUTABLE
    AS $$
      /*
      Casts *val_1* and *val_2* as type *type_* and check the *op* condition for truthiness
      */
      declare
          op_symbol text = (
              case
                  when op = 'eq' then '='
                  when op = 'neq' then '!='
                  when op = 'lt' then '<'
                  when op = 'lte' then '<='
                  when op = 'gt' then '>'
                  when op = 'gte' then '>='
                  when op = 'in' then '= any'
                  else 'UNKNOWN OP'
              end
          );
          res boolean;
      begin
          execute format(
              'select %L::'|| type_::text || ' ' || op_symbol
              || ' ( %L::'
              || (
                  case
                      when op = 'in' then type_::text || '[]'
                      else type_::text end
              )
              || ')', val_1, val_2) into res;
          return res;
      end;
      $$;


ALTER FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) OWNER TO supabase_admin;

--
-- TOC entry 420 (class 1255 OID 17391)
-- Name: is_visible_through_filters(realtime.wal_column[], realtime.user_defined_filter[]); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) RETURNS boolean
    LANGUAGE sql IMMUTABLE
    AS $_$
    /*
    Should the record be visible (true) or filtered out (false) after *filters* are applied
    */
        select
            -- Default to allowed when no filters present
            $2 is null -- no filters. this should not happen because subscriptions has a default
            or array_length($2, 1) is null -- array length of an empty array is null
            or bool_and(
                coalesce(
                    realtime.check_equality_op(
                        op:=f.op,
                        type_:=coalesce(
                            col.type_oid::regtype, -- null when wal2json version <= 2.4
                            col.type_name::regtype
                        ),
                        -- cast jsonb to text
                        val_1:=col.value #>> '{}',
                        val_2:=f.value
                    ),
                    false -- if null, filter does not match
                )
            )
        from
            unnest(filters) f
            join unnest(columns) col
                on f.column_name = col.name;
    $_$;


ALTER FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) OWNER TO supabase_admin;

--
-- TOC entry 428 (class 1255 OID 17402)
-- Name: list_changes(name, name, integer, integer); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) RETURNS SETOF realtime.wal_rls
    LANGUAGE sql
    SET log_min_messages TO 'fatal'
    AS $$
      with pub as (
        select
          concat_ws(
            ',',
            case when bool_or(pubinsert) then 'insert' else null end,
            case when bool_or(pubupdate) then 'update' else null end,
            case when bool_or(pubdelete) then 'delete' else null end
          ) as w2j_actions,
          coalesce(
            string_agg(
              realtime.quote_wal2json(format('%I.%I', schemaname, tablename)::regclass),
              ','
            ) filter (where ppt.tablename is not null and ppt.tablename not like '% %'),
            ''
          ) w2j_add_tables
        from
          pg_publication pp
          left join pg_publication_tables ppt
            on pp.pubname = ppt.pubname
        where
          pp.pubname = publication
        group by
          pp.pubname
        limit 1
      ),
      w2j as (
        select
          x.*, pub.w2j_add_tables
        from
          pub,
          pg_logical_slot_get_changes(
            slot_name, null, max_changes,
            'include-pk', 'true',
            'include-transaction', 'false',
            'include-timestamp', 'true',
            'include-type-oids', 'true',
            'format-version', '2',
            'actions', pub.w2j_actions,
            'add-tables', pub.w2j_add_tables
          ) x
      )
      select
        xyz.wal,
        xyz.is_rls_enabled,
        xyz.subscription_ids,
        xyz.errors
      from
        w2j,
        realtime.apply_rls(
          wal := w2j.data::jsonb,
          max_record_bytes := max_record_bytes
        ) xyz(wal, is_rls_enabled, subscription_ids, errors)
      where
        w2j.w2j_add_tables <> ''
        and xyz.subscription_ids[1] is not null
    $$;


ALTER FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) OWNER TO supabase_admin;

--
-- TOC entry 521 (class 1255 OID 17339)
-- Name: quote_wal2json(regclass); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.quote_wal2json(entity regclass) RETURNS text
    LANGUAGE sql IMMUTABLE STRICT
    AS $$
      select
        (
          select string_agg('' || ch,'')
          from unnest(string_to_array(nsp.nspname::text, null)) with ordinality x(ch, idx)
          where
            not (x.idx = 1 and x.ch = '"')
            and not (
              x.idx = array_length(string_to_array(nsp.nspname::text, null), 1)
              and x.ch = '"'
            )
        )
        || '.'
        || (
          select string_agg('' || ch,'')
          from unnest(string_to_array(pc.relname::text, null)) with ordinality x(ch, idx)
          where
            not (x.idx = 1 and x.ch = '"')
            and not (
              x.idx = array_length(string_to_array(nsp.nspname::text, null), 1)
              and x.ch = '"'
            )
          )
      from
        pg_class pc
        join pg_namespace nsp
          on pc.relnamespace = nsp.oid
      where
        pc.oid = entity
    $$;


ALTER FUNCTION realtime.quote_wal2json(entity regclass) OWNER TO supabase_admin;

--
-- TOC entry 436 (class 1255 OID 17461)
-- Name: send(jsonb, text, text, boolean); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean DEFAULT true) RETURNS void
    LANGUAGE plpgsql
    AS $$
DECLARE
  generated_id uuid;
  final_payload jsonb;
BEGIN
  BEGIN
    -- Generate a new UUID for the id
    generated_id := gen_random_uuid();

    -- Check if payload has an 'id' key, if not, add the generated UUID
    IF payload ? 'id' THEN
      final_payload := payload;
    ELSE
      final_payload := jsonb_set(payload, '{id}', to_jsonb(generated_id));
    END IF;

    -- Set the topic configuration
    EXECUTE format('SET LOCAL realtime.topic TO %L', topic);

    -- Attempt to insert the message
    INSERT INTO realtime.messages (id, payload, event, topic, private, extension)
    VALUES (generated_id, final_payload, event, topic, private, 'broadcast');
  EXCEPTION
    WHEN OTHERS THEN
      -- Capture and notify the error
      RAISE WARNING 'ErrorSendingBroadcastMessage: %', SQLERRM;
  END;
END;
$$;


ALTER FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean) OWNER TO supabase_admin;

--
-- TOC entry 433 (class 1255 OID 17337)
-- Name: subscription_check_filters(); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.subscription_check_filters() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
    /*
    Validates that the user defined filters for a subscription:
    - refer to valid columns that the claimed role may access
    - values are coercable to the correct column type
    */
    declare
        col_names text[] = coalesce(
                array_agg(c.column_name order by c.ordinal_position),
                '{}'::text[]
            )
            from
                information_schema.columns c
            where
                format('%I.%I', c.table_schema, c.table_name)::regclass = new.entity
                and pg_catalog.has_column_privilege(
                    (new.claims ->> 'role'),
                    format('%I.%I', c.table_schema, c.table_name)::regclass,
                    c.column_name,
                    'SELECT'
                );
        filter realtime.user_defined_filter;
        col_type regtype;

        in_val jsonb;
    begin
        for filter in select * from unnest(new.filters) loop
            -- Filtered column is valid
            if not filter.column_name = any(col_names) then
                raise exception 'invalid column for filter %', filter.column_name;
            end if;

            -- Type is sanitized and safe for string interpolation
            col_type = (
                select atttypid::regtype
                from pg_catalog.pg_attribute
                where attrelid = new.entity
                      and attname = filter.column_name
            );
            if col_type is null then
                raise exception 'failed to lookup type for column %', filter.column_name;
            end if;

            -- Set maximum number of entries for in filter
            if filter.op = 'in'::realtime.equality_op then
                in_val = realtime.cast(filter.value, (col_type::text || '[]')::regtype);
                if coalesce(jsonb_array_length(in_val), 0) > 100 then
                    raise exception 'too many values for `in` filter. Maximum 100';
                end if;
            else
                -- raises an exception if value is not coercable to type
                perform realtime.cast(filter.value, col_type);
            end if;

        end loop;

        -- Apply consistent order to filters so the unique constraint on
        -- (subscription_id, entity, filters) can't be tricked by a different filter order
        new.filters = coalesce(
            array_agg(f order by f.column_name, f.op, f.value),
            '{}'
        ) from unnest(new.filters) f;

        return new;
    end;
    $$;


ALTER FUNCTION realtime.subscription_check_filters() OWNER TO supabase_admin;

--
-- TOC entry 452 (class 1255 OID 17372)
-- Name: to_regrole(text); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
--

CREATE FUNCTION realtime.to_regrole(role_name text) RETURNS regrole
    LANGUAGE sql IMMUTABLE
    AS $$ select role_name::regrole $$;


ALTER FUNCTION realtime.to_regrole(role_name text) OWNER TO supabase_admin;

--
-- TOC entry 475 (class 1255 OID 17455)
-- Name: topic(); Type: FUNCTION; Schema: realtime; Owner: supabase_realtime_admin
--

CREATE FUNCTION realtime.topic() RETURNS text
    LANGUAGE sql STABLE
    AS $$
select nullif(current_setting('realtime.topic', true), '')::text;
$$;


ALTER FUNCTION realtime.topic() OWNER TO supabase_realtime_admin;

--
-- TOC entry 463 (class 1255 OID 17219)
-- Name: add_prefixes(text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.add_prefixes(_bucket_id text, _name text) RETURNS void
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    prefixes text[];
BEGIN
    prefixes := "storage"."get_prefixes"("_name");

    IF array_length(prefixes, 1) > 0 THEN
        INSERT INTO storage.prefixes (name, bucket_id)
        SELECT UNNEST(prefixes) as name, "_bucket_id" ON CONFLICT DO NOTHING;
    END IF;
END;
$$;


ALTER FUNCTION storage.add_prefixes(_bucket_id text, _name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 511 (class 1255 OID 17145)
-- Name: can_insert_object(text, text, uuid, jsonb); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.can_insert_object(bucketid text, name text, owner uuid, metadata jsonb) RETURNS void
    LANGUAGE plpgsql
    AS $$
BEGIN
  INSERT INTO "storage"."objects" ("bucket_id", "name", "owner", "metadata") VALUES (bucketid, name, owner, metadata);
  -- hack to rollback the successful insert
  RAISE sqlstate 'PT200' using
  message = 'ROLLBACK',
  detail = 'rollback successful insert';
END
$$;


ALTER FUNCTION storage.can_insert_object(bucketid text, name text, owner uuid, metadata jsonb) OWNER TO supabase_storage_admin;

--
-- TOC entry 450 (class 1255 OID 17259)
-- Name: delete_leaf_prefixes(text[], text[]); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.delete_leaf_prefixes(bucket_ids text[], names text[]) RETURNS void
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    v_rows_deleted integer;
BEGIN
    LOOP
        WITH candidates AS (
            SELECT DISTINCT
                t.bucket_id,
                unnest(storage.get_prefixes(t.name)) AS name
            FROM unnest(bucket_ids, names) AS t(bucket_id, name)
        ),
        uniq AS (
             SELECT
                 bucket_id,
                 name,
                 storage.get_level(name) AS level
             FROM candidates
             WHERE name <> ''
             GROUP BY bucket_id, name
        ),
        leaf AS (
             SELECT
                 p.bucket_id,
                 p.name,
                 p.level
             FROM storage.prefixes AS p
                  JOIN uniq AS u
                       ON u.bucket_id = p.bucket_id
                           AND u.name = p.name
                           AND u.level = p.level
             WHERE NOT EXISTS (
                 SELECT 1
                 FROM storage.objects AS o
                 WHERE o.bucket_id = p.bucket_id
                   AND o.level = p.level + 1
                   AND o.name COLLATE "C" LIKE p.name || '/%'
             )
             AND NOT EXISTS (
                 SELECT 1
                 FROM storage.prefixes AS c
                 WHERE c.bucket_id = p.bucket_id
                   AND c.level = p.level + 1
                   AND c.name COLLATE "C" LIKE p.name || '/%'
             )
        )
        DELETE
        FROM storage.prefixes AS p
            USING leaf AS l
        WHERE p.bucket_id = l.bucket_id
          AND p.name = l.name
          AND p.level = l.level;

        GET DIAGNOSTICS v_rows_deleted = ROW_COUNT;
        EXIT WHEN v_rows_deleted = 0;
    END LOOP;
END;
$$;


ALTER FUNCTION storage.delete_leaf_prefixes(bucket_ids text[], names text[]) OWNER TO supabase_storage_admin;

--
-- TOC entry 408 (class 1255 OID 17220)
-- Name: delete_prefix(text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.delete_prefix(_bucket_id text, _name text) RETURNS boolean
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
BEGIN
    -- Check if we can delete the prefix
    IF EXISTS(
        SELECT FROM "storage"."prefixes"
        WHERE "prefixes"."bucket_id" = "_bucket_id"
          AND level = "storage"."get_level"("_name") + 1
          AND "prefixes"."name" COLLATE "C" LIKE "_name" || '/%'
        LIMIT 1
    )
    OR EXISTS(
        SELECT FROM "storage"."objects"
        WHERE "objects"."bucket_id" = "_bucket_id"
          AND "storage"."get_level"("objects"."name") = "storage"."get_level"("_name") + 1
          AND "objects"."name" COLLATE "C" LIKE "_name" || '/%'
        LIMIT 1
    ) THEN
    -- There are sub-objects, skip deletion
    RETURN false;
    ELSE
        DELETE FROM "storage"."prefixes"
        WHERE "prefixes"."bucket_id" = "_bucket_id"
          AND level = "storage"."get_level"("_name")
          AND "prefixes"."name" = "_name";
        RETURN true;
    END IF;
END;
$$;


ALTER FUNCTION storage.delete_prefix(_bucket_id text, _name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 462 (class 1255 OID 17223)
-- Name: delete_prefix_hierarchy_trigger(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.delete_prefix_hierarchy_trigger() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
    prefix text;
BEGIN
    prefix := "storage"."get_prefix"(OLD."name");

    IF coalesce(prefix, '') != '' THEN
        PERFORM "storage"."delete_prefix"(OLD."bucket_id", prefix);
    END IF;

    RETURN OLD;
END;
$$;


ALTER FUNCTION storage.delete_prefix_hierarchy_trigger() OWNER TO supabase_storage_admin;

--
-- TOC entry 466 (class 1255 OID 17238)
-- Name: enforce_bucket_name_length(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.enforce_bucket_name_length() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
begin
    if length(new.name) > 100 then
        raise exception 'bucket name "%" is too long (% characters). Max is 100.', new.name, length(new.name);
    end if;
    return new;
end;
$$;


ALTER FUNCTION storage.enforce_bucket_name_length() OWNER TO supabase_storage_admin;

--
-- TOC entry 446 (class 1255 OID 17119)
-- Name: extension(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.extension(name text) RETURNS text
    LANGUAGE plpgsql IMMUTABLE
    AS $$
DECLARE
    _parts text[];
    _filename text;
BEGIN
    SELECT string_to_array(name, '/') INTO _parts;
    SELECT _parts[array_length(_parts,1)] INTO _filename;
    RETURN reverse(split_part(reverse(_filename), '.', 1));
END
$$;


ALTER FUNCTION storage.extension(name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 453 (class 1255 OID 17118)
-- Name: filename(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.filename(name text) RETURNS text
    LANGUAGE plpgsql
    AS $$
DECLARE
_parts text[];
BEGIN
	select string_to_array(name, '/') into _parts;
	return _parts[array_length(_parts,1)];
END
$$;


ALTER FUNCTION storage.filename(name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 514 (class 1255 OID 17117)
-- Name: foldername(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.foldername(name text) RETURNS text[]
    LANGUAGE plpgsql IMMUTABLE
    AS $$
DECLARE
    _parts text[];
BEGIN
    -- Split on "/" to get path segments
    SELECT string_to_array(name, '/') INTO _parts;
    -- Return everything except the last segment
    RETURN _parts[1 : array_length(_parts,1) - 1];
END
$$;


ALTER FUNCTION storage.foldername(name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 403 (class 1255 OID 17201)
-- Name: get_level(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.get_level(name text) RETURNS integer
    LANGUAGE sql IMMUTABLE STRICT
    AS $$
SELECT array_length(string_to_array("name", '/'), 1);
$$;


ALTER FUNCTION storage.get_level(name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 455 (class 1255 OID 17217)
-- Name: get_prefix(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.get_prefix(name text) RETURNS text
    LANGUAGE sql IMMUTABLE STRICT
    AS $_$
SELECT
    CASE WHEN strpos("name", '/') > 0 THEN
             regexp_replace("name", '[\/]{1}[^\/]+\/?$', '')
         ELSE
             ''
        END;
$_$;


ALTER FUNCTION storage.get_prefix(name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 448 (class 1255 OID 17218)
-- Name: get_prefixes(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.get_prefixes(name text) RETURNS text[]
    LANGUAGE plpgsql IMMUTABLE STRICT
    AS $$
DECLARE
    parts text[];
    prefixes text[];
    prefix text;
BEGIN
    -- Split the name into parts by '/'
    parts := string_to_array("name", '/');
    prefixes := '{}';

    -- Construct the prefixes, stopping one level below the last part
    FOR i IN 1..array_length(parts, 1) - 1 LOOP
            prefix := array_to_string(parts[1:i], '/');
            prefixes := array_append(prefixes, prefix);
    END LOOP;

    RETURN prefixes;
END;
$$;


ALTER FUNCTION storage.get_prefixes(name text) OWNER TO supabase_storage_admin;

--
-- TOC entry 493 (class 1255 OID 17236)
-- Name: get_size_by_bucket(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.get_size_by_bucket() RETURNS TABLE(size bigint, bucket_id text)
    LANGUAGE plpgsql STABLE
    AS $$
BEGIN
    return query
        select sum((metadata->>'size')::bigint) as size, obj.bucket_id
        from "storage".objects as obj
        group by obj.bucket_id;
END
$$;


ALTER FUNCTION storage.get_size_by_bucket() OWNER TO supabase_storage_admin;

--
-- TOC entry 442 (class 1255 OID 17184)
-- Name: list_multipart_uploads_with_delimiter(text, text, text, integer, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.list_multipart_uploads_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer DEFAULT 100, next_key_token text DEFAULT ''::text, next_upload_token text DEFAULT ''::text) RETURNS TABLE(key text, id text, created_at timestamp with time zone)
    LANGUAGE plpgsql
    AS $_$
BEGIN
    RETURN QUERY EXECUTE
        'SELECT DISTINCT ON(key COLLATE "C") * from (
            SELECT
                CASE
                    WHEN position($2 IN substring(key from length($1) + 1)) > 0 THEN
                        substring(key from 1 for length($1) + position($2 IN substring(key from length($1) + 1)))
                    ELSE
                        key
                END AS key, id, created_at
            FROM
                storage.s3_multipart_uploads
            WHERE
                bucket_id = $5 AND
                key ILIKE $1 || ''%'' AND
                CASE
                    WHEN $4 != '''' AND $6 = '''' THEN
                        CASE
                            WHEN position($2 IN substring(key from length($1) + 1)) > 0 THEN
                                substring(key from 1 for length($1) + position($2 IN substring(key from length($1) + 1))) COLLATE "C" > $4
                            ELSE
                                key COLLATE "C" > $4
                            END
                    ELSE
                        true
                END AND
                CASE
                    WHEN $6 != '''' THEN
                        id COLLATE "C" > $6
                    ELSE
                        true
                    END
            ORDER BY
                key COLLATE "C" ASC, created_at ASC) as e order by key COLLATE "C" LIMIT $3'
        USING prefix_param, delimiter_param, max_keys, next_key_token, bucket_id, next_upload_token;
END;
$_$;


ALTER FUNCTION storage.list_multipart_uploads_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer, next_key_token text, next_upload_token text) OWNER TO supabase_storage_admin;

--
-- TOC entry 465 (class 1255 OID 17147)
-- Name: list_objects_with_delimiter(text, text, text, integer, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.list_objects_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer DEFAULT 100, start_after text DEFAULT ''::text, next_token text DEFAULT ''::text) RETURNS TABLE(name text, id uuid, metadata jsonb, updated_at timestamp with time zone)
    LANGUAGE plpgsql
    AS $_$
BEGIN
    RETURN QUERY EXECUTE
        'SELECT DISTINCT ON(name COLLATE "C") * from (
            SELECT
                CASE
                    WHEN position($2 IN substring(name from length($1) + 1)) > 0 THEN
                        substring(name from 1 for length($1) + position($2 IN substring(name from length($1) + 1)))
                    ELSE
                        name
                END AS name, id, metadata, updated_at
            FROM
                storage.objects
            WHERE
                bucket_id = $5 AND
                name ILIKE $1 || ''%'' AND
                CASE
                    WHEN $6 != '''' THEN
                    name COLLATE "C" > $6
                ELSE true END
                AND CASE
                    WHEN $4 != '''' THEN
                        CASE
                            WHEN position($2 IN substring(name from length($1) + 1)) > 0 THEN
                                substring(name from 1 for length($1) + position($2 IN substring(name from length($1) + 1))) COLLATE "C" > $4
                            ELSE
                                name COLLATE "C" > $4
                            END
                    ELSE
                        true
                END
            ORDER BY
                name COLLATE "C" ASC) as e order by name COLLATE "C" LIMIT $3'
        USING prefix_param, delimiter_param, max_keys, next_token, bucket_id, start_after;
END;
$_$;


ALTER FUNCTION storage.list_objects_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer, start_after text, next_token text) OWNER TO supabase_storage_admin;

--
-- TOC entry 456 (class 1255 OID 17258)
-- Name: lock_top_prefixes(text[], text[]); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.lock_top_prefixes(bucket_ids text[], names text[]) RETURNS void
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    v_bucket text;
    v_top text;
BEGIN
    FOR v_bucket, v_top IN
        SELECT DISTINCT t.bucket_id,
            split_part(t.name, '/', 1) AS top
        FROM unnest(bucket_ids, names) AS t(bucket_id, name)
        WHERE t.name <> ''
        ORDER BY 1, 2
        LOOP
            PERFORM pg_advisory_xact_lock(hashtextextended(v_bucket || '/' || v_top, 0));
        END LOOP;
END;
$$;


ALTER FUNCTION storage.lock_top_prefixes(bucket_ids text[], names text[]) OWNER TO supabase_storage_admin;

--
-- TOC entry 411 (class 1255 OID 17260)
-- Name: objects_delete_cleanup(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.objects_delete_cleanup() RETURNS trigger
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    v_bucket_ids text[];
    v_names      text[];
BEGIN
    IF current_setting('storage.gc.prefixes', true) = '1' THEN
        RETURN NULL;
    END IF;

    PERFORM set_config('storage.gc.prefixes', '1', true);

    SELECT COALESCE(array_agg(d.bucket_id), '{}'),
           COALESCE(array_agg(d.name), '{}')
    INTO v_bucket_ids, v_names
    FROM deleted AS d
    WHERE d.name <> '';

    PERFORM storage.lock_top_prefixes(v_bucket_ids, v_names);
    PERFORM storage.delete_leaf_prefixes(v_bucket_ids, v_names);

    RETURN NULL;
END;
$$;


ALTER FUNCTION storage.objects_delete_cleanup() OWNER TO supabase_storage_admin;

--
-- TOC entry 486 (class 1255 OID 17222)
-- Name: objects_insert_prefix_trigger(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.objects_insert_prefix_trigger() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    PERFORM "storage"."add_prefixes"(NEW."bucket_id", NEW."name");
    NEW.level := "storage"."get_level"(NEW."name");

    RETURN NEW;
END;
$$;


ALTER FUNCTION storage.objects_insert_prefix_trigger() OWNER TO supabase_storage_admin;

--
-- TOC entry 404 (class 1255 OID 17261)
-- Name: objects_update_cleanup(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.objects_update_cleanup() RETURNS trigger
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    -- NEW - OLD (destinations to create prefixes for)
    v_add_bucket_ids text[];
    v_add_names      text[];

    -- OLD - NEW (sources to prune)
    v_src_bucket_ids text[];
    v_src_names      text[];
BEGIN
    IF TG_OP <> 'UPDATE' THEN
        RETURN NULL;
    END IF;

    -- 1) Compute NEWâˆ’OLD (added paths) and OLDâˆ’NEW (moved-away paths)
    WITH added AS (
        SELECT n.bucket_id, n.name
        FROM new_rows n
        WHERE n.name <> '' AND position('/' in n.name) > 0
        EXCEPT
        SELECT o.bucket_id, o.name FROM old_rows o WHERE o.name <> ''
    ),
    moved AS (
         SELECT o.bucket_id, o.name
         FROM old_rows o
         WHERE o.name <> ''
         EXCEPT
         SELECT n.bucket_id, n.name FROM new_rows n WHERE n.name <> ''
    )
    SELECT
        -- arrays for ADDED (dest) in stable order
        COALESCE( (SELECT array_agg(a.bucket_id ORDER BY a.bucket_id, a.name) FROM added a), '{}' ),
        COALESCE( (SELECT array_agg(a.name      ORDER BY a.bucket_id, a.name) FROM added a), '{}' ),
        -- arrays for MOVED (src) in stable order
        COALESCE( (SELECT array_agg(m.bucket_id ORDER BY m.bucket_id, m.name) FROM moved m), '{}' ),
        COALESCE( (SELECT array_agg(m.name      ORDER BY m.bucket_id, m.name) FROM moved m), '{}' )
    INTO v_add_bucket_ids, v_add_names, v_src_bucket_ids, v_src_names;

    -- Nothing to do?
    IF (array_length(v_add_bucket_ids, 1) IS NULL) AND (array_length(v_src_bucket_ids, 1) IS NULL) THEN
        RETURN NULL;
    END IF;

    -- 2) Take per-(bucket, top) locks: ALL prefixes in consistent global order to prevent deadlocks
    DECLARE
        v_all_bucket_ids text[];
        v_all_names text[];
    BEGIN
        -- Combine source and destination arrays for consistent lock ordering
        v_all_bucket_ids := COALESCE(v_src_bucket_ids, '{}') || COALESCE(v_add_bucket_ids, '{}');
        v_all_names := COALESCE(v_src_names, '{}') || COALESCE(v_add_names, '{}');

        -- Single lock call ensures consistent global ordering across all transactions
        IF array_length(v_all_bucket_ids, 1) IS NOT NULL THEN
            PERFORM storage.lock_top_prefixes(v_all_bucket_ids, v_all_names);
        END IF;
    END;

    -- 3) Create destination prefixes (NEWâˆ’OLD) BEFORE pruning sources
    IF array_length(v_add_bucket_ids, 1) IS NOT NULL THEN
        WITH candidates AS (
            SELECT DISTINCT t.bucket_id, unnest(storage.get_prefixes(t.name)) AS name
            FROM unnest(v_add_bucket_ids, v_add_names) AS t(bucket_id, name)
            WHERE name <> ''
        )
        INSERT INTO storage.prefixes (bucket_id, name)
        SELECT c.bucket_id, c.name
        FROM candidates c
        ON CONFLICT DO NOTHING;
    END IF;

    -- 4) Prune source prefixes bottom-up for OLDâˆ’NEW
    IF array_length(v_src_bucket_ids, 1) IS NOT NULL THEN
        -- re-entrancy guard so DELETE on prefixes won't recurse
        IF current_setting('storage.gc.prefixes', true) <> '1' THEN
            PERFORM set_config('storage.gc.prefixes', '1', true);
        END IF;

        PERFORM storage.delete_leaf_prefixes(v_src_bucket_ids, v_src_names);
    END IF;

    RETURN NULL;
END;
$$;


ALTER FUNCTION storage.objects_update_cleanup() OWNER TO supabase_storage_admin;

--
-- TOC entry 500 (class 1255 OID 17266)
-- Name: objects_update_level_trigger(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.objects_update_level_trigger() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    -- Ensure this is an update operation and the name has changed
    IF TG_OP = 'UPDATE' AND (NEW."name" <> OLD."name" OR NEW."bucket_id" <> OLD."bucket_id") THEN
        -- Set the new level
        NEW."level" := "storage"."get_level"(NEW."name");
    END IF;
    RETURN NEW;
END;
$$;


ALTER FUNCTION storage.objects_update_level_trigger() OWNER TO supabase_storage_admin;

--
-- TOC entry 459 (class 1255 OID 17237)
-- Name: objects_update_prefix_trigger(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.objects_update_prefix_trigger() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
    old_prefixes TEXT[];
BEGIN
    -- Ensure this is an update operation and the name has changed
    IF TG_OP = 'UPDATE' AND (NEW."name" <> OLD."name" OR NEW."bucket_id" <> OLD."bucket_id") THEN
        -- Retrieve old prefixes
        old_prefixes := "storage"."get_prefixes"(OLD."name");

        -- Remove old prefixes that are only used by this object
        WITH all_prefixes as (
            SELECT unnest(old_prefixes) as prefix
        ),
        can_delete_prefixes as (
             SELECT prefix
             FROM all_prefixes
             WHERE NOT EXISTS (
                 SELECT 1 FROM "storage"."objects"
                 WHERE "bucket_id" = OLD."bucket_id"
                   AND "name" <> OLD."name"
                   AND "name" LIKE (prefix || '%')
             )
         )
        DELETE FROM "storage"."prefixes" WHERE name IN (SELECT prefix FROM can_delete_prefixes);

        -- Add new prefixes
        PERFORM "storage"."add_prefixes"(NEW."bucket_id", NEW."name");
    END IF;
    -- Set the new level
    NEW."level" := "storage"."get_level"(NEW."name");

    RETURN NEW;
END;
$$;


ALTER FUNCTION storage.objects_update_prefix_trigger() OWNER TO supabase_storage_admin;

--
-- TOC entry 425 (class 1255 OID 17200)
-- Name: operation(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.operation() RETURNS text
    LANGUAGE plpgsql STABLE
    AS $$
BEGIN
    RETURN current_setting('storage.operation', true);
END;
$$;


ALTER FUNCTION storage.operation() OWNER TO supabase_storage_admin;

--
-- TOC entry 470 (class 1255 OID 17262)
-- Name: prefixes_delete_cleanup(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.prefixes_delete_cleanup() RETURNS trigger
    LANGUAGE plpgsql SECURITY DEFINER
    AS $$
DECLARE
    v_bucket_ids text[];
    v_names      text[];
BEGIN
    IF current_setting('storage.gc.prefixes', true) = '1' THEN
        RETURN NULL;
    END IF;

    PERFORM set_config('storage.gc.prefixes', '1', true);

    SELECT COALESCE(array_agg(d.bucket_id), '{}'),
           COALESCE(array_agg(d.name), '{}')
    INTO v_bucket_ids, v_names
    FROM deleted AS d
    WHERE d.name <> '';

    PERFORM storage.lock_top_prefixes(v_bucket_ids, v_names);
    PERFORM storage.delete_leaf_prefixes(v_bucket_ids, v_names);

    RETURN NULL;
END;
$$;


ALTER FUNCTION storage.prefixes_delete_cleanup() OWNER TO supabase_storage_admin;

--
-- TOC entry 473 (class 1255 OID 17221)
-- Name: prefixes_insert_trigger(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.prefixes_insert_trigger() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    PERFORM "storage"."add_prefixes"(NEW."bucket_id", NEW."name");
    RETURN NEW;
END;
$$;


ALTER FUNCTION storage.prefixes_insert_trigger() OWNER TO supabase_storage_admin;

--
-- TOC entry 478 (class 1255 OID 17134)
-- Name: search(text, text, integer, integer, integer, text, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.search(prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text) RETURNS TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
    LANGUAGE plpgsql
    AS $$
declare
    can_bypass_rls BOOLEAN;
begin
    SELECT rolbypassrls
    INTO can_bypass_rls
    FROM pg_roles
    WHERE rolname = coalesce(nullif(current_setting('role', true), 'none'), current_user);

    IF can_bypass_rls THEN
        RETURN QUERY SELECT * FROM storage.search_v1_optimised(prefix, bucketname, limits, levels, offsets, search, sortcolumn, sortorder);
    ELSE
        RETURN QUERY SELECT * FROM storage.search_legacy_v1(prefix, bucketname, limits, levels, offsets, search, sortcolumn, sortorder);
    END IF;
end;
$$;


ALTER FUNCTION storage.search(prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text) OWNER TO supabase_storage_admin;

--
-- TOC entry 495 (class 1255 OID 17234)
-- Name: search_legacy_v1(text, text, integer, integer, integer, text, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.search_legacy_v1(prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text) RETURNS TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
    LANGUAGE plpgsql STABLE
    AS $_$
declare
    v_order_by text;
    v_sort_order text;
begin
    case
        when sortcolumn = 'name' then
            v_order_by = 'name';
        when sortcolumn = 'updated_at' then
            v_order_by = 'updated_at';
        when sortcolumn = 'created_at' then
            v_order_by = 'created_at';
        when sortcolumn = 'last_accessed_at' then
            v_order_by = 'last_accessed_at';
        else
            v_order_by = 'name';
        end case;

    case
        when sortorder = 'asc' then
            v_sort_order = 'asc';
        when sortorder = 'desc' then
            v_sort_order = 'desc';
        else
            v_sort_order = 'asc';
        end case;

    v_order_by = v_order_by || ' ' || v_sort_order;

    return query execute
        'with folders as (
           select path_tokens[$1] as folder
           from storage.objects
             where objects.name ilike $2 || $3 || ''%''
               and bucket_id = $4
               and array_length(objects.path_tokens, 1) <> $1
           group by folder
           order by folder ' || v_sort_order || '
     )
     (select folder as "name",
            null as id,
            null as updated_at,
            null as created_at,
            null as last_accessed_at,
            null as metadata from folders)
     union all
     (select path_tokens[$1] as "name",
            id,
            updated_at,
            created_at,
            last_accessed_at,
            metadata
     from storage.objects
     where objects.name ilike $2 || $3 || ''%''
       and bucket_id = $4
       and array_length(objects.path_tokens, 1) = $1
     order by ' || v_order_by || ')
     limit $5
     offset $6' using levels, prefix, search, bucketname, limits, offsets;
end;
$_$;


ALTER FUNCTION storage.search_legacy_v1(prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text) OWNER TO supabase_storage_admin;

--
-- TOC entry 429 (class 1255 OID 17233)
-- Name: search_v1_optimised(text, text, integer, integer, integer, text, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.search_v1_optimised(prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text) RETURNS TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
    LANGUAGE plpgsql STABLE
    AS $_$
declare
    v_order_by text;
    v_sort_order text;
begin
    case
        when sortcolumn = 'name' then
            v_order_by = 'name';
        when sortcolumn = 'updated_at' then
            v_order_by = 'updated_at';
        when sortcolumn = 'created_at' then
            v_order_by = 'created_at';
        when sortcolumn = 'last_accessed_at' then
            v_order_by = 'last_accessed_at';
        else
            v_order_by = 'name';
        end case;

    case
        when sortorder = 'asc' then
            v_sort_order = 'asc';
        when sortorder = 'desc' then
            v_sort_order = 'desc';
        else
            v_sort_order = 'asc';
        end case;

    v_order_by = v_order_by || ' ' || v_sort_order;

    return query execute
        'with folders as (
           select (string_to_array(name, ''/''))[level] as name
           from storage.prefixes
             where lower(prefixes.name) like lower($2 || $3) || ''%''
               and bucket_id = $4
               and level = $1
           order by name ' || v_sort_order || '
     )
     (select name,
            null as id,
            null as updated_at,
            null as created_at,
            null as last_accessed_at,
            null as metadata from folders)
     union all
     (select path_tokens[level] as "name",
            id,
            updated_at,
            created_at,
            last_accessed_at,
            metadata
     from storage.objects
     where lower(objects.name) like lower($2 || $3) || ''%''
       and bucket_id = $4
       and level = $1
     order by ' || v_order_by || ')
     limit $5
     offset $6' using levels, prefix, search, bucketname, limits, offsets;
end;
$_$;


ALTER FUNCTION storage.search_v1_optimised(prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text) OWNER TO supabase_storage_admin;

--
-- TOC entry 489 (class 1255 OID 17257)
-- Name: search_v2(text, text, integer, integer, text, text, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.search_v2(prefix text, bucket_name text, limits integer DEFAULT 100, levels integer DEFAULT 1, start_after text DEFAULT ''::text, sort_order text DEFAULT 'asc'::text, sort_column text DEFAULT 'name'::text, sort_column_after text DEFAULT ''::text) RETURNS TABLE(key text, name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
    LANGUAGE plpgsql STABLE
    AS $_$
DECLARE
    sort_col text;
    sort_ord text;
    cursor_op text;
    cursor_expr text;
    sort_expr text;
BEGIN
    -- Validate sort_order
    sort_ord := lower(sort_order);
    IF sort_ord NOT IN ('asc', 'desc') THEN
        sort_ord := 'asc';
    END IF;

    -- Determine cursor comparison operator
    IF sort_ord = 'asc' THEN
        cursor_op := '>';
    ELSE
        cursor_op := '<';
    END IF;
    
    sort_col := lower(sort_column);
    -- Validate sort column  
    IF sort_col IN ('updated_at', 'created_at') THEN
        cursor_expr := format(
            '($5 = '''' OR ROW(date_trunc(''milliseconds'', %I), name COLLATE "C") %s ROW(COALESCE(NULLIF($6, '''')::timestamptz, ''epoch''::timestamptz), $5))',
            sort_col, cursor_op
        );
        sort_expr := format(
            'COALESCE(date_trunc(''milliseconds'', %I), ''epoch''::timestamptz) %s, name COLLATE "C" %s',
            sort_col, sort_ord, sort_ord
        );
    ELSE
        cursor_expr := format('($5 = '''' OR name COLLATE "C" %s $5)', cursor_op);
        sort_expr := format('name COLLATE "C" %s', sort_ord);
    END IF;

    RETURN QUERY EXECUTE format(
        $sql$
        SELECT * FROM (
            (
                SELECT
                    split_part(name, '/', $4) AS key,
                    name,
                    NULL::uuid AS id,
                    updated_at,
                    created_at,
                    NULL::timestamptz AS last_accessed_at,
                    NULL::jsonb AS metadata
                FROM storage.prefixes
                WHERE name COLLATE "C" LIKE $1 || '%%'
                    AND bucket_id = $2
                    AND level = $4
                    AND %s
                ORDER BY %s
                LIMIT $3
            )
            UNION ALL
            (
                SELECT
                    split_part(name, '/', $4) AS key,
                    name,
                    id,
                    updated_at,
                    created_at,
                    last_accessed_at,
                    metadata
                FROM storage.objects
                WHERE name COLLATE "C" LIKE $1 || '%%'
                    AND bucket_id = $2
                    AND level = $4
                    AND %s
                ORDER BY %s
                LIMIT $3
            )
        ) obj
        ORDER BY %s
        LIMIT $3
        $sql$,
        cursor_expr,    -- prefixes WHERE
        sort_expr,      -- prefixes ORDER BY
        cursor_expr,    -- objects WHERE
        sort_expr,      -- objects ORDER BY
        sort_expr       -- final ORDER BY
    )
    USING prefix, bucket_name, limits, levels, start_after, sort_column_after;
END;
$_$;


ALTER FUNCTION storage.search_v2(prefix text, bucket_name text, limits integer, levels integer, start_after text, sort_order text, sort_column text, sort_column_after text) OWNER TO supabase_storage_admin;

--
-- TOC entry 416 (class 1255 OID 17135)
-- Name: update_updated_at_column(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
--

CREATE FUNCTION storage.update_updated_at_column() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    NEW.updated_at = now();
    RETURN NEW; 
END;
$$;


ALTER FUNCTION storage.update_updated_at_column() OWNER TO supabase_storage_admin;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- TOC entry 348 (class 1259 OID 16525)
-- Name: audit_log_entries; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.audit_log_entries (
    instance_id uuid,
    id uuid NOT NULL,
    payload json,
    created_at timestamp with time zone,
    ip_address character varying(64) DEFAULT ''::character varying NOT NULL
);


ALTER TABLE auth.audit_log_entries OWNER TO supabase_auth_admin;

--
-- TOC entry 4434 (class 0 OID 0)
-- Dependencies: 348
-- Name: TABLE audit_log_entries; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.audit_log_entries IS 'Auth: Audit trail for user actions.';


--
-- TOC entry 362 (class 1259 OID 16883)
-- Name: flow_state; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.flow_state (
    id uuid NOT NULL,
    user_id uuid,
    auth_code text NOT NULL,
    code_challenge_method auth.code_challenge_method NOT NULL,
    code_challenge text NOT NULL,
    provider_type text NOT NULL,
    provider_access_token text,
    provider_refresh_token text,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    authentication_method text NOT NULL,
    auth_code_issued_at timestamp with time zone
);


ALTER TABLE auth.flow_state OWNER TO supabase_auth_admin;

--
-- TOC entry 4436 (class 0 OID 0)
-- Dependencies: 362
-- Name: TABLE flow_state; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.flow_state IS 'stores metadata for pkce logins';


--
-- TOC entry 353 (class 1259 OID 16681)
-- Name: identities; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.identities (
    provider_id text NOT NULL,
    user_id uuid NOT NULL,
    identity_data jsonb NOT NULL,
    provider text NOT NULL,
    last_sign_in_at timestamp with time zone,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    email text GENERATED ALWAYS AS (lower((identity_data ->> 'email'::text))) STORED,
    id uuid DEFAULT gen_random_uuid() NOT NULL
);


ALTER TABLE auth.identities OWNER TO supabase_auth_admin;

--
-- TOC entry 4438 (class 0 OID 0)
-- Dependencies: 353
-- Name: TABLE identities; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.identities IS 'Auth: Stores identities associated to a user.';


--
-- TOC entry 4439 (class 0 OID 0)
-- Dependencies: 353
-- Name: COLUMN identities.email; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.identities.email IS 'Auth: Email is a generated column that references the optional email property in the identity_data';


--
-- TOC entry 347 (class 1259 OID 16518)
-- Name: instances; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.instances (
    id uuid NOT NULL,
    uuid uuid,
    raw_base_config text,
    created_at timestamp with time zone,
    updated_at timestamp with time zone
);


ALTER TABLE auth.instances OWNER TO supabase_auth_admin;

--
-- TOC entry 4441 (class 0 OID 0)
-- Dependencies: 347
-- Name: TABLE instances; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.instances IS 'Auth: Manages users across multiple sites.';


--
-- TOC entry 357 (class 1259 OID 16770)
-- Name: mfa_amr_claims; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.mfa_amr_claims (
    session_id uuid NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    authentication_method text NOT NULL,
    id uuid NOT NULL
);


ALTER TABLE auth.mfa_amr_claims OWNER TO supabase_auth_admin;

--
-- TOC entry 4443 (class 0 OID 0)
-- Dependencies: 357
-- Name: TABLE mfa_amr_claims; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.mfa_amr_claims IS 'auth: stores authenticator method reference claims for multi factor authentication';


--
-- TOC entry 356 (class 1259 OID 16758)
-- Name: mfa_challenges; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.mfa_challenges (
    id uuid NOT NULL,
    factor_id uuid NOT NULL,
    created_at timestamp with time zone NOT NULL,
    verified_at timestamp with time zone,
    ip_address inet NOT NULL,
    otp_code text,
    web_authn_session_data jsonb
);


ALTER TABLE auth.mfa_challenges OWNER TO supabase_auth_admin;

--
-- TOC entry 4445 (class 0 OID 0)
-- Dependencies: 356
-- Name: TABLE mfa_challenges; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.mfa_challenges IS 'auth: stores metadata about challenge requests made';


--
-- TOC entry 355 (class 1259 OID 16745)
-- Name: mfa_factors; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.mfa_factors (
    id uuid NOT NULL,
    user_id uuid NOT NULL,
    friendly_name text,
    factor_type auth.factor_type NOT NULL,
    status auth.factor_status NOT NULL,
    created_at timestamp with time zone NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    secret text,
    phone text,
    last_challenged_at timestamp with time zone,
    web_authn_credential jsonb,
    web_authn_aaguid uuid,
    last_webauthn_challenge_data jsonb
);


ALTER TABLE auth.mfa_factors OWNER TO supabase_auth_admin;

--
-- TOC entry 4447 (class 0 OID 0)
-- Dependencies: 355
-- Name: TABLE mfa_factors; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.mfa_factors IS 'auth: stores metadata about factors';


--
-- TOC entry 4448 (class 0 OID 0)
-- Dependencies: 355
-- Name: COLUMN mfa_factors.last_webauthn_challenge_data; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.mfa_factors.last_webauthn_challenge_data IS 'Stores the latest WebAuthn challenge data including attestation/assertion for customer verification';


--
-- TOC entry 365 (class 1259 OID 16995)
-- Name: oauth_authorizations; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.oauth_authorizations (
    id uuid NOT NULL,
    authorization_id text NOT NULL,
    client_id uuid NOT NULL,
    user_id uuid,
    redirect_uri text NOT NULL,
    scope text NOT NULL,
    state text,
    resource text,
    code_challenge text,
    code_challenge_method auth.code_challenge_method,
    response_type auth.oauth_response_type DEFAULT 'code'::auth.oauth_response_type NOT NULL,
    status auth.oauth_authorization_status DEFAULT 'pending'::auth.oauth_authorization_status NOT NULL,
    authorization_code text,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    expires_at timestamp with time zone DEFAULT (now() + '00:03:00'::interval) NOT NULL,
    approved_at timestamp with time zone,
    nonce text,
    CONSTRAINT oauth_authorizations_authorization_code_length CHECK ((char_length(authorization_code) <= 255)),
    CONSTRAINT oauth_authorizations_code_challenge_length CHECK ((char_length(code_challenge) <= 128)),
    CONSTRAINT oauth_authorizations_expires_at_future CHECK ((expires_at > created_at)),
    CONSTRAINT oauth_authorizations_nonce_length CHECK ((char_length(nonce) <= 255)),
    CONSTRAINT oauth_authorizations_redirect_uri_length CHECK ((char_length(redirect_uri) <= 2048)),
    CONSTRAINT oauth_authorizations_resource_length CHECK ((char_length(resource) <= 2048)),
    CONSTRAINT oauth_authorizations_scope_length CHECK ((char_length(scope) <= 4096)),
    CONSTRAINT oauth_authorizations_state_length CHECK ((char_length(state) <= 4096))
);


ALTER TABLE auth.oauth_authorizations OWNER TO supabase_auth_admin;

--
-- TOC entry 367 (class 1259 OID 17068)
-- Name: oauth_client_states; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.oauth_client_states (
    id uuid NOT NULL,
    provider_type text NOT NULL,
    code_verifier text,
    created_at timestamp with time zone NOT NULL
);


ALTER TABLE auth.oauth_client_states OWNER TO supabase_auth_admin;

--
-- TOC entry 4451 (class 0 OID 0)
-- Dependencies: 367
-- Name: TABLE oauth_client_states; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.oauth_client_states IS 'Stores OAuth states for third-party provider authentication flows where Supabase acts as the OAuth client.';


--
-- TOC entry 364 (class 1259 OID 16965)
-- Name: oauth_clients; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.oauth_clients (
    id uuid NOT NULL,
    client_secret_hash text,
    registration_type auth.oauth_registration_type NOT NULL,
    redirect_uris text NOT NULL,
    grant_types text NOT NULL,
    client_name text,
    client_uri text,
    logo_uri text,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    updated_at timestamp with time zone DEFAULT now() NOT NULL,
    deleted_at timestamp with time zone,
    client_type auth.oauth_client_type DEFAULT 'confidential'::auth.oauth_client_type NOT NULL,
    CONSTRAINT oauth_clients_client_name_length CHECK ((char_length(client_name) <= 1024)),
    CONSTRAINT oauth_clients_client_uri_length CHECK ((char_length(client_uri) <= 2048)),
    CONSTRAINT oauth_clients_logo_uri_length CHECK ((char_length(logo_uri) <= 2048))
);


ALTER TABLE auth.oauth_clients OWNER TO supabase_auth_admin;

--
-- TOC entry 366 (class 1259 OID 17028)
-- Name: oauth_consents; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.oauth_consents (
    id uuid NOT NULL,
    user_id uuid NOT NULL,
    client_id uuid NOT NULL,
    scopes text NOT NULL,
    granted_at timestamp with time zone DEFAULT now() NOT NULL,
    revoked_at timestamp with time zone,
    CONSTRAINT oauth_consents_revoked_after_granted CHECK (((revoked_at IS NULL) OR (revoked_at >= granted_at))),
    CONSTRAINT oauth_consents_scopes_length CHECK ((char_length(scopes) <= 2048)),
    CONSTRAINT oauth_consents_scopes_not_empty CHECK ((char_length(TRIM(BOTH FROM scopes)) > 0))
);


ALTER TABLE auth.oauth_consents OWNER TO supabase_auth_admin;

--
-- TOC entry 363 (class 1259 OID 16933)
-- Name: one_time_tokens; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.one_time_tokens (
    id uuid NOT NULL,
    user_id uuid NOT NULL,
    token_type auth.one_time_token_type NOT NULL,
    token_hash text NOT NULL,
    relates_to text NOT NULL,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone DEFAULT now() NOT NULL,
    CONSTRAINT one_time_tokens_token_hash_check CHECK ((char_length(token_hash) > 0))
);


ALTER TABLE auth.one_time_tokens OWNER TO supabase_auth_admin;

--
-- TOC entry 346 (class 1259 OID 16507)
-- Name: refresh_tokens; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.refresh_tokens (
    instance_id uuid,
    id bigint NOT NULL,
    token character varying(255),
    user_id character varying(255),
    revoked boolean,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    parent character varying(255),
    session_id uuid
);


ALTER TABLE auth.refresh_tokens OWNER TO supabase_auth_admin;

--
-- TOC entry 4456 (class 0 OID 0)
-- Dependencies: 346
-- Name: TABLE refresh_tokens; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.refresh_tokens IS 'Auth: Store of tokens used to refresh JWT tokens once they expire.';


--
-- TOC entry 345 (class 1259 OID 16506)
-- Name: refresh_tokens_id_seq; Type: SEQUENCE; Schema: auth; Owner: supabase_auth_admin
--

CREATE SEQUENCE auth.refresh_tokens_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE auth.refresh_tokens_id_seq OWNER TO supabase_auth_admin;

--
-- TOC entry 4458 (class 0 OID 0)
-- Dependencies: 345
-- Name: refresh_tokens_id_seq; Type: SEQUENCE OWNED BY; Schema: auth; Owner: supabase_auth_admin
--

ALTER SEQUENCE auth.refresh_tokens_id_seq OWNED BY auth.refresh_tokens.id;


--
-- TOC entry 360 (class 1259 OID 16812)
-- Name: saml_providers; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.saml_providers (
    id uuid NOT NULL,
    sso_provider_id uuid NOT NULL,
    entity_id text NOT NULL,
    metadata_xml text NOT NULL,
    metadata_url text,
    attribute_mapping jsonb,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    name_id_format text,
    CONSTRAINT "entity_id not empty" CHECK ((char_length(entity_id) > 0)),
    CONSTRAINT "metadata_url not empty" CHECK (((metadata_url = NULL::text) OR (char_length(metadata_url) > 0))),
    CONSTRAINT "metadata_xml not empty" CHECK ((char_length(metadata_xml) > 0))
);


ALTER TABLE auth.saml_providers OWNER TO supabase_auth_admin;

--
-- TOC entry 4460 (class 0 OID 0)
-- Dependencies: 360
-- Name: TABLE saml_providers; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.saml_providers IS 'Auth: Manages SAML Identity Provider connections.';


--
-- TOC entry 361 (class 1259 OID 16830)
-- Name: saml_relay_states; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.saml_relay_states (
    id uuid NOT NULL,
    sso_provider_id uuid NOT NULL,
    request_id text NOT NULL,
    for_email text,
    redirect_to text,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    flow_state_id uuid,
    CONSTRAINT "request_id not empty" CHECK ((char_length(request_id) > 0))
);


ALTER TABLE auth.saml_relay_states OWNER TO supabase_auth_admin;

--
-- TOC entry 4462 (class 0 OID 0)
-- Dependencies: 361
-- Name: TABLE saml_relay_states; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.saml_relay_states IS 'Auth: Contains SAML Relay State information for each Service Provider initiated login.';


--
-- TOC entry 349 (class 1259 OID 16533)
-- Name: schema_migrations; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.schema_migrations (
    version character varying(255) NOT NULL
);


ALTER TABLE auth.schema_migrations OWNER TO supabase_auth_admin;

--
-- TOC entry 4464 (class 0 OID 0)
-- Dependencies: 349
-- Name: TABLE schema_migrations; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.schema_migrations IS 'Auth: Manages updates to the auth system.';


--
-- TOC entry 354 (class 1259 OID 16711)
-- Name: sessions; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.sessions (
    id uuid NOT NULL,
    user_id uuid NOT NULL,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    factor_id uuid,
    aal auth.aal_level,
    not_after timestamp with time zone,
    refreshed_at timestamp without time zone,
    user_agent text,
    ip inet,
    tag text,
    oauth_client_id uuid,
    refresh_token_hmac_key text,
    refresh_token_counter bigint,
    scopes text,
    CONSTRAINT sessions_scopes_length CHECK ((char_length(scopes) <= 4096))
);


ALTER TABLE auth.sessions OWNER TO supabase_auth_admin;

--
-- TOC entry 4466 (class 0 OID 0)
-- Dependencies: 354
-- Name: TABLE sessions; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.sessions IS 'Auth: Stores session data associated to a user.';


--
-- TOC entry 4467 (class 0 OID 0)
-- Dependencies: 354
-- Name: COLUMN sessions.not_after; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.sessions.not_after IS 'Auth: Not after is a nullable column that contains a timestamp after which the session should be regarded as expired.';


--
-- TOC entry 4468 (class 0 OID 0)
-- Dependencies: 354
-- Name: COLUMN sessions.refresh_token_hmac_key; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.sessions.refresh_token_hmac_key IS 'Holds a HMAC-SHA256 key used to sign refresh tokens for this session.';


--
-- TOC entry 4469 (class 0 OID 0)
-- Dependencies: 354
-- Name: COLUMN sessions.refresh_token_counter; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.sessions.refresh_token_counter IS 'Holds the ID (counter) of the last issued refresh token.';


--
-- TOC entry 359 (class 1259 OID 16797)
-- Name: sso_domains; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.sso_domains (
    id uuid NOT NULL,
    sso_provider_id uuid NOT NULL,
    domain text NOT NULL,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    CONSTRAINT "domain not empty" CHECK ((char_length(domain) > 0))
);


ALTER TABLE auth.sso_domains OWNER TO supabase_auth_admin;

--
-- TOC entry 4471 (class 0 OID 0)
-- Dependencies: 359
-- Name: TABLE sso_domains; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.sso_domains IS 'Auth: Manages SSO email address domain mapping to an SSO Identity Provider.';


--
-- TOC entry 358 (class 1259 OID 16788)
-- Name: sso_providers; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.sso_providers (
    id uuid NOT NULL,
    resource_id text,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    disabled boolean,
    CONSTRAINT "resource_id not empty" CHECK (((resource_id = NULL::text) OR (char_length(resource_id) > 0)))
);


ALTER TABLE auth.sso_providers OWNER TO supabase_auth_admin;

--
-- TOC entry 4473 (class 0 OID 0)
-- Dependencies: 358
-- Name: TABLE sso_providers; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.sso_providers IS 'Auth: Manages SSO identity provider information; see saml_providers for SAML.';


--
-- TOC entry 4474 (class 0 OID 0)
-- Dependencies: 358
-- Name: COLUMN sso_providers.resource_id; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.sso_providers.resource_id IS 'Auth: Uniquely identifies a SSO provider according to a user-chosen resource ID (case insensitive), useful in infrastructure as code.';


--
-- TOC entry 344 (class 1259 OID 16495)
-- Name: users; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
--

CREATE TABLE auth.users (
    instance_id uuid,
    id uuid NOT NULL,
    aud character varying(255),
    role character varying(255),
    email character varying(255),
    encrypted_password character varying(255),
    email_confirmed_at timestamp with time zone,
    invited_at timestamp with time zone,
    confirmation_token character varying(255),
    confirmation_sent_at timestamp with time zone,
    recovery_token character varying(255),
    recovery_sent_at timestamp with time zone,
    email_change_token_new character varying(255),
    email_change character varying(255),
    email_change_sent_at timestamp with time zone,
    last_sign_in_at timestamp with time zone,
    raw_app_meta_data jsonb,
    raw_user_meta_data jsonb,
    is_super_admin boolean,
    created_at timestamp with time zone,
    updated_at timestamp with time zone,
    phone text DEFAULT NULL::character varying,
    phone_confirmed_at timestamp with time zone,
    phone_change text DEFAULT ''::character varying,
    phone_change_token character varying(255) DEFAULT ''::character varying,
    phone_change_sent_at timestamp with time zone,
    confirmed_at timestamp with time zone GENERATED ALWAYS AS (LEAST(email_confirmed_at, phone_confirmed_at)) STORED,
    email_change_token_current character varying(255) DEFAULT ''::character varying,
    email_change_confirm_status smallint DEFAULT 0,
    banned_until timestamp with time zone,
    reauthentication_token character varying(255) DEFAULT ''::character varying,
    reauthentication_sent_at timestamp with time zone,
    is_sso_user boolean DEFAULT false NOT NULL,
    deleted_at timestamp with time zone,
    is_anonymous boolean DEFAULT false NOT NULL,
    CONSTRAINT users_email_change_confirm_status_check CHECK (((email_change_confirm_status >= 0) AND (email_change_confirm_status <= 2)))
);


ALTER TABLE auth.users OWNER TO supabase_auth_admin;

--
-- TOC entry 4476 (class 0 OID 0)
-- Dependencies: 344
-- Name: TABLE users; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON TABLE auth.users IS 'Auth: Stores user login data within a secure schema.';


--
-- TOC entry 4477 (class 0 OID 0)
-- Dependencies: 344
-- Name: COLUMN users.is_sso_user; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON COLUMN auth.users.is_sso_user IS 'Auth: Set this column to true when the account comes from SSO. These accounts can have duplicate emails.';


--
-- TOC entry 388 (class 1259 OID 17524)
-- Name: applications; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.applications (
    id bigint NOT NULL,
    created_at timestamp with time zone DEFAULT now(),
    "jobId" bigint,
    name text,
    email text,
    phone text,
    linkedin text,
    status text DEFAULT 'new'::text,
    "tenantId" uuid,
    form_data jsonb,
    resume_url text,
    evaluation jsonb DEFAULT '{}'::jsonb,
    score_general numeric(5,2) DEFAULT 0,
    is_hired boolean DEFAULT false,
    hired_at timestamp with time zone,
    "candidateId" uuid,
    "formData" jsonb,
    "resumeUrl" text,
    "isHired" boolean DEFAULT false,
    "hiredAt" timestamp with time zone
);


ALTER TABLE public.applications OWNER TO postgres;

--
-- TOC entry 387 (class 1259 OID 17523)
-- Name: applications_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.applications ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.applications_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 393 (class 1259 OID 19435)
-- Name: candidates; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.candidates (
    id uuid DEFAULT extensions.uuid_generate_v4() NOT NULL,
    name text NOT NULL,
    email text NOT NULL,
    phone text,
    city text,
    state text,
    linkedin_profile text,
    github_profile text,
    resume_url text,
    created_at timestamp with time zone DEFAULT now(),
    updated_at timestamp with time zone DEFAULT now()
);


ALTER TABLE public.candidates OWNER TO postgres;

--
-- TOC entry 396 (class 1259 OID 22968)
-- Name: company_departments; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.company_departments (
    id bigint NOT NULL,
    created_at timestamp with time zone DEFAULT timezone('utc'::text, now()) NOT NULL,
    name text NOT NULL,
    "tenantId" uuid
);


ALTER TABLE public.company_departments OWNER TO postgres;

--
-- TOC entry 395 (class 1259 OID 22967)
-- Name: company_departments_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.company_departments ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.company_departments_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 391 (class 1259 OID 17781)
-- Name: evaluation_assignments_v2; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.evaluation_assignments_v2 (
    id uuid DEFAULT extensions.uuid_generate_v4() NOT NULL,
    application_id bigint NOT NULL,
    evaluator_id uuid NOT NULL,
    status text DEFAULT 'pending'::text,
    created_at timestamp with time zone DEFAULT now()
);


ALTER TABLE public.evaluation_assignments_v2 OWNER TO postgres;

--
-- TOC entry 394 (class 1259 OID 22939)
-- Name: evaluations; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.evaluations (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    application_id bigint NOT NULL,
    evaluator_id uuid NOT NULL,
    scores jsonb DEFAULT '{}'::jsonb,
    notes text,
    final_score numeric(5,2),
    created_at timestamp with time zone DEFAULT timezone('utc'::text, now()) NOT NULL
);


ALTER TABLE public.evaluations OWNER TO postgres;

--
-- TOC entry 386 (class 1259 OID 17508)
-- Name: jobs; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.jobs (
    id bigint NOT NULL,
    created_at timestamp with time zone DEFAULT now(),
    title text NOT NULL,
    status text DEFAULT 'active'::text,
    "tenantId" uuid NOT NULL,
    parameters jsonb DEFAULT '{"notas": [], "cultura": [], "tecnico": [], "triagem": []}'::jsonb,
    "createdBy" uuid,
    description text,
    requirements text,
    type text DEFAULT 'CLT'::text,
    location_type text DEFAULT 'HÃ­brido'::text,
    company_department_id bigint
);


ALTER TABLE public.jobs OWNER TO postgres;

--
-- TOC entry 385 (class 1259 OID 17507)
-- Name: jobs_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.jobs ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.jobs_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 392 (class 1259 OID 19187)
-- Name: plans; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.plans (
    id text NOT NULL,
    name text NOT NULL,
    price numeric(10,2) DEFAULT 0,
    user_limit integer DEFAULT 1,
    job_limit integer DEFAULT 1,
    candidate_limit integer DEFAULT 50
);


ALTER TABLE public.plans OWNER TO postgres;

--
-- TOC entry 389 (class 1259 OID 17751)
-- Name: tenants; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tenants (
    id uuid DEFAULT extensions.uuid_generate_v4() NOT NULL,
    "companyName" text NOT NULL,
    cnpj text,
    "planId" text DEFAULT 'freemium'::text,
    created_at timestamp with time zone DEFAULT now()
);


ALTER TABLE public.tenants OWNER TO postgres;

--
-- TOC entry 390 (class 1259 OID 17761)
-- Name: user_profiles; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.user_profiles (
    id uuid NOT NULL,
    "tenantId" uuid,
    name text,
    email text,
    role text DEFAULT 'rh'::text,
    is_admin_system boolean DEFAULT false,
    created_at timestamp with time zone DEFAULT now(),
    active boolean DEFAULT true
);


ALTER TABLE public.user_profiles OWNER TO postgres;

--
-- TOC entry 384 (class 1259 OID 17482)
-- Name: users; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.users (
    id uuid NOT NULL,
    email text,
    "tenantId" uuid NOT NULL,
    "isAdmin" boolean DEFAULT false,
    role text DEFAULT 'recruiter'::text,
    status text DEFAULT 'active'::text,
    name text
);


ALTER TABLE public.users OWNER TO postgres;

--
-- TOC entry 383 (class 1259 OID 17465)
-- Name: messages; Type: TABLE; Schema: realtime; Owner: supabase_realtime_admin
--

CREATE TABLE realtime.messages (
    topic text NOT NULL,
    extension text NOT NULL,
    payload jsonb,
    event text,
    private boolean DEFAULT false,
    updated_at timestamp without time zone DEFAULT now() NOT NULL,
    inserted_at timestamp without time zone DEFAULT now() NOT NULL,
    id uuid DEFAULT gen_random_uuid() NOT NULL
)
PARTITION BY RANGE (inserted_at);


ALTER TABLE realtime.messages OWNER TO supabase_realtime_admin;

--
-- TOC entry 368 (class 1259 OID 17076)
-- Name: schema_migrations; Type: TABLE; Schema: realtime; Owner: supabase_admin
--

CREATE TABLE realtime.schema_migrations (
    version bigint NOT NULL,
    inserted_at timestamp(0) without time zone
);


ALTER TABLE realtime.schema_migrations OWNER TO supabase_admin;

--
-- TOC entry 380 (class 1259 OID 17325)
-- Name: subscription; Type: TABLE; Schema: realtime; Owner: supabase_admin
--

CREATE TABLE realtime.subscription (
    id bigint NOT NULL,
    subscription_id uuid NOT NULL,
    entity regclass NOT NULL,
    filters realtime.user_defined_filter[] DEFAULT '{}'::realtime.user_defined_filter[] NOT NULL,
    claims jsonb NOT NULL,
    claims_role regrole GENERATED ALWAYS AS (realtime.to_regrole((claims ->> 'role'::text))) STORED NOT NULL,
    created_at timestamp without time zone DEFAULT timezone('utc'::text, now()) NOT NULL
);


ALTER TABLE realtime.subscription OWNER TO supabase_admin;

--
-- TOC entry 379 (class 1259 OID 17324)
-- Name: subscription_id_seq; Type: SEQUENCE; Schema: realtime; Owner: supabase_admin
--

ALTER TABLE realtime.subscription ALTER COLUMN id ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME realtime.subscription_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 370 (class 1259 OID 17089)
-- Name: buckets; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.buckets (
    id text NOT NULL,
    name text NOT NULL,
    owner uuid,
    created_at timestamp with time zone DEFAULT now(),
    updated_at timestamp with time zone DEFAULT now(),
    public boolean DEFAULT false,
    avif_autodetection boolean DEFAULT false,
    file_size_limit bigint,
    allowed_mime_types text[],
    owner_id text,
    type storage.buckettype DEFAULT 'STANDARD'::storage.buckettype NOT NULL
);


ALTER TABLE storage.buckets OWNER TO supabase_storage_admin;

--
-- TOC entry 4498 (class 0 OID 0)
-- Dependencies: 370
-- Name: COLUMN buckets.owner; Type: COMMENT; Schema: storage; Owner: supabase_storage_admin
--

COMMENT ON COLUMN storage.buckets.owner IS 'Field is deprecated, use owner_id instead';


--
-- TOC entry 375 (class 1259 OID 17246)
-- Name: buckets_analytics; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.buckets_analytics (
    name text NOT NULL,
    type storage.buckettype DEFAULT 'ANALYTICS'::storage.buckettype NOT NULL,
    format text DEFAULT 'ICEBERG'::text NOT NULL,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    updated_at timestamp with time zone DEFAULT now() NOT NULL,
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    deleted_at timestamp with time zone
);


ALTER TABLE storage.buckets_analytics OWNER TO supabase_storage_admin;

--
-- TOC entry 376 (class 1259 OID 17273)
-- Name: buckets_vectors; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.buckets_vectors (
    id text NOT NULL,
    type storage.buckettype DEFAULT 'VECTOR'::storage.buckettype NOT NULL,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    updated_at timestamp with time zone DEFAULT now() NOT NULL
);


ALTER TABLE storage.buckets_vectors OWNER TO supabase_storage_admin;

--
-- TOC entry 369 (class 1259 OID 17081)
-- Name: migrations; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.migrations (
    id integer NOT NULL,
    name character varying(100) NOT NULL,
    hash character varying(40) NOT NULL,
    executed_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE storage.migrations OWNER TO supabase_storage_admin;

--
-- TOC entry 371 (class 1259 OID 17099)
-- Name: objects; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.objects (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    bucket_id text,
    name text,
    owner uuid,
    created_at timestamp with time zone DEFAULT now(),
    updated_at timestamp with time zone DEFAULT now(),
    last_accessed_at timestamp with time zone DEFAULT now(),
    metadata jsonb,
    path_tokens text[] GENERATED ALWAYS AS (string_to_array(name, '/'::text)) STORED,
    version text,
    owner_id text,
    user_metadata jsonb,
    level integer
);


ALTER TABLE storage.objects OWNER TO supabase_storage_admin;

--
-- TOC entry 4502 (class 0 OID 0)
-- Dependencies: 371
-- Name: COLUMN objects.owner; Type: COMMENT; Schema: storage; Owner: supabase_storage_admin
--

COMMENT ON COLUMN storage.objects.owner IS 'Field is deprecated, use owner_id instead';


--
-- TOC entry 374 (class 1259 OID 17202)
-- Name: prefixes; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.prefixes (
    bucket_id text NOT NULL,
    name text NOT NULL COLLATE pg_catalog."C",
    level integer GENERATED ALWAYS AS (storage.get_level(name)) STORED NOT NULL,
    created_at timestamp with time zone DEFAULT now(),
    updated_at timestamp with time zone DEFAULT now()
);


ALTER TABLE storage.prefixes OWNER TO supabase_storage_admin;

--
-- TOC entry 372 (class 1259 OID 17149)
-- Name: s3_multipart_uploads; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.s3_multipart_uploads (
    id text NOT NULL,
    in_progress_size bigint DEFAULT 0 NOT NULL,
    upload_signature text NOT NULL,
    bucket_id text NOT NULL,
    key text NOT NULL COLLATE pg_catalog."C",
    version text NOT NULL,
    owner_id text,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    user_metadata jsonb
);


ALTER TABLE storage.s3_multipart_uploads OWNER TO supabase_storage_admin;

--
-- TOC entry 373 (class 1259 OID 17163)
-- Name: s3_multipart_uploads_parts; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.s3_multipart_uploads_parts (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    upload_id text NOT NULL,
    size bigint DEFAULT 0 NOT NULL,
    part_number integer NOT NULL,
    bucket_id text NOT NULL,
    key text NOT NULL COLLATE pg_catalog."C",
    etag text NOT NULL,
    owner_id text,
    version text NOT NULL,
    created_at timestamp with time zone DEFAULT now() NOT NULL
);


ALTER TABLE storage.s3_multipart_uploads_parts OWNER TO supabase_storage_admin;

--
-- TOC entry 377 (class 1259 OID 17283)
-- Name: vector_indexes; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
--

CREATE TABLE storage.vector_indexes (
    id text DEFAULT gen_random_uuid() NOT NULL,
    name text NOT NULL COLLATE pg_catalog."C",
    bucket_id text NOT NULL,
    data_type text NOT NULL,
    dimension integer NOT NULL,
    distance_metric text NOT NULL,
    metadata_configuration jsonb,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    updated_at timestamp with time zone DEFAULT now() NOT NULL
);


ALTER TABLE storage.vector_indexes OWNER TO supabase_storage_admin;

--
-- TOC entry 3726 (class 2604 OID 16510)
-- Name: refresh_tokens id; Type: DEFAULT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.refresh_tokens ALTER COLUMN id SET DEFAULT nextval('auth.refresh_tokens_id_seq'::regclass);


--
-- TOC entry 4286 (class 0 OID 16525)
-- Dependencies: 348
-- Data for Name: audit_log_entries; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4297 (class 0 OID 16883)
-- Dependencies: 362
-- Data for Name: flow_state; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4288 (class 0 OID 16681)
-- Dependencies: 353
-- Data for Name: identities; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.identities VALUES ('631e295b-b7e9-4d8a-9d05-79898cef103f', '631e295b-b7e9-4d8a-9d05-79898cef103f', '{"sub": "631e295b-b7e9-4d8a-9d05-79898cef103f", "email": "eider@novvaempresa.com.br", "email_verified": false, "phone_verified": false}', 'email', '2025-12-19 11:53:04.762229+00', '2025-12-19 11:53:04.762296+00', '2025-12-19 11:53:04.762296+00', DEFAULT, '65504b38-12f5-4743-9a63-34ee59b94c56');
INSERT INTO auth.identities VALUES ('844decb8-a0f0-4a74-ab02-ab1ba0001c5b', '844decb8-a0f0-4a74-ab02-ab1ba0001c5b', '{"sub": "844decb8-a0f0-4a74-ab02-ab1ba0001c5b", "email": "eider.arantes.oliveira@gmail.com", "email_verified": false, "phone_verified": false}', 'email', '2025-12-19 11:53:29.830876+00', '2025-12-19 11:53:29.830949+00', '2025-12-19 11:53:29.830949+00', DEFAULT, '599274b9-5bbb-466f-91b4-43f593917d99');


--
-- TOC entry 4285 (class 0 OID 16518)
-- Dependencies: 347
-- Data for Name: instances; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4292 (class 0 OID 16770)
-- Dependencies: 357
-- Data for Name: mfa_amr_claims; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.mfa_amr_claims VALUES ('facee80a-bb7e-4282-b280-a198e556ab64', '2025-12-29 21:16:51.826026+00', '2025-12-29 21:16:51.826026+00', 'password', 'd48b05a1-93fb-4069-8ced-b53ad00ca279');
INSERT INTO auth.mfa_amr_claims VALUES ('513b105e-72d7-46d3-8513-23c358444771', '2025-12-30 18:12:02.891244+00', '2025-12-30 18:12:02.891244+00', 'password', '6221c3bc-5f1c-4411-84b0-ab7469ebf427');


--
-- TOC entry 4291 (class 0 OID 16758)
-- Dependencies: 356
-- Data for Name: mfa_challenges; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4290 (class 0 OID 16745)
-- Dependencies: 355
-- Data for Name: mfa_factors; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4300 (class 0 OID 16995)
-- Dependencies: 365
-- Data for Name: oauth_authorizations; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4302 (class 0 OID 17068)
-- Dependencies: 367
-- Data for Name: oauth_client_states; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4299 (class 0 OID 16965)
-- Dependencies: 364
-- Data for Name: oauth_clients; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4301 (class 0 OID 17028)
-- Dependencies: 366
-- Data for Name: oauth_consents; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4298 (class 0 OID 16933)
-- Dependencies: 363
-- Data for Name: one_time_tokens; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.one_time_tokens VALUES ('059a440f-3146-4697-898e-4d04b79e7ee0', '631e295b-b7e9-4d8a-9d05-79898cef103f', 'recovery_token', 'c036d2399be60156fe727c4952a6a1aa119c2c478ebecf8c107fc604', 'eider@novvaempresa.com.br', '2025-12-19 12:13:28.337693', '2025-12-19 12:13:28.337693');


--
-- TOC entry 4284 (class 0 OID 16507)
-- Dependencies: 346
-- Data for Name: refresh_tokens; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.refresh_tokens VALUES ('00000000-0000-0000-0000-000000000000', 117, '2swyfssz2tzj', '844decb8-a0f0-4a74-ab02-ab1ba0001c5b', true, '2025-12-29 21:16:51.823611+00', '2025-12-31 02:06:15.431054+00', NULL, 'facee80a-bb7e-4282-b280-a198e556ab64');
INSERT INTO auth.refresh_tokens VALUES ('00000000-0000-0000-0000-000000000000', 120, 'amgufigty7i2', '844decb8-a0f0-4a74-ab02-ab1ba0001c5b', true, '2025-12-31 02:06:15.456498+00', '2025-12-31 03:18:59.221165+00', '2swyfssz2tzj', 'facee80a-bb7e-4282-b280-a198e556ab64');
INSERT INTO auth.refresh_tokens VALUES ('00000000-0000-0000-0000-000000000000', 121, 'wj3pqvdanq6o', '844decb8-a0f0-4a74-ab02-ab1ba0001c5b', false, '2025-12-31 03:18:59.246179+00', '2025-12-31 03:18:59.246179+00', 'amgufigty7i2', 'facee80a-bb7e-4282-b280-a198e556ab64');
INSERT INTO auth.refresh_tokens VALUES ('00000000-0000-0000-0000-000000000000', 119, 'd6yniore6g7y', '844decb8-a0f0-4a74-ab02-ab1ba0001c5b', true, '2025-12-30 18:12:02.889189+00', '2026-01-01 11:51:19.885857+00', NULL, '513b105e-72d7-46d3-8513-23c358444771');
INSERT INTO auth.refresh_tokens VALUES ('00000000-0000-0000-0000-000000000000', 122, 'rpd75ndehp5l', '844decb8-a0f0-4a74-ab02-ab1ba0001c5b', true, '2026-01-01 11:51:19.917577+00', '2026-01-01 13:10:33.83151+00', 'd6yniore6g7y', '513b105e-72d7-46d3-8513-23c358444771');
INSERT INTO auth.refresh_tokens VALUES ('00000000-0000-0000-0000-000000000000', 123, 'yfa4ny6ahnon', '844decb8-a0f0-4a74-ab02-ab1ba0001c5b', true, '2026-01-01 13:10:33.855615+00', '2026-01-02 12:01:41.344905+00', 'rpd75ndehp5l', '513b105e-72d7-46d3-8513-23c358444771');
INSERT INTO auth.refresh_tokens VALUES ('00000000-0000-0000-0000-000000000000', 124, '3blfaz7pjowc', '844decb8-a0f0-4a74-ab02-ab1ba0001c5b', false, '2026-01-02 12:01:41.362878+00', '2026-01-02 12:01:41.362878+00', 'yfa4ny6ahnon', '513b105e-72d7-46d3-8513-23c358444771');


--
-- TOC entry 4295 (class 0 OID 16812)
-- Dependencies: 360
-- Data for Name: saml_providers; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4296 (class 0 OID 16830)
-- Dependencies: 361
-- Data for Name: saml_relay_states; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4287 (class 0 OID 16533)
-- Dependencies: 349
-- Data for Name: schema_migrations; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.schema_migrations VALUES ('20171026211738');
INSERT INTO auth.schema_migrations VALUES ('20171026211808');
INSERT INTO auth.schema_migrations VALUES ('20171026211834');
INSERT INTO auth.schema_migrations VALUES ('20180103212743');
INSERT INTO auth.schema_migrations VALUES ('20180108183307');
INSERT INTO auth.schema_migrations VALUES ('20180119214651');
INSERT INTO auth.schema_migrations VALUES ('20180125194653');
INSERT INTO auth.schema_migrations VALUES ('00');
INSERT INTO auth.schema_migrations VALUES ('20210710035447');
INSERT INTO auth.schema_migrations VALUES ('20210722035447');
INSERT INTO auth.schema_migrations VALUES ('20210730183235');
INSERT INTO auth.schema_migrations VALUES ('20210909172000');
INSERT INTO auth.schema_migrations VALUES ('20210927181326');
INSERT INTO auth.schema_migrations VALUES ('20211122151130');
INSERT INTO auth.schema_migrations VALUES ('20211124214934');
INSERT INTO auth.schema_migrations VALUES ('20211202183645');
INSERT INTO auth.schema_migrations VALUES ('20220114185221');
INSERT INTO auth.schema_migrations VALUES ('20220114185340');
INSERT INTO auth.schema_migrations VALUES ('20220224000811');
INSERT INTO auth.schema_migrations VALUES ('20220323170000');
INSERT INTO auth.schema_migrations VALUES ('20220429102000');
INSERT INTO auth.schema_migrations VALUES ('20220531120530');
INSERT INTO auth.schema_migrations VALUES ('20220614074223');
INSERT INTO auth.schema_migrations VALUES ('20220811173540');
INSERT INTO auth.schema_migrations VALUES ('20221003041349');
INSERT INTO auth.schema_migrations VALUES ('20221003041400');
INSERT INTO auth.schema_migrations VALUES ('20221011041400');
INSERT INTO auth.schema_migrations VALUES ('20221020193600');
INSERT INTO auth.schema_migrations VALUES ('20221021073300');
INSERT INTO auth.schema_migrations VALUES ('20221021082433');
INSERT INTO auth.schema_migrations VALUES ('20221027105023');
INSERT INTO auth.schema_migrations VALUES ('20221114143122');
INSERT INTO auth.schema_migrations VALUES ('20221114143410');
INSERT INTO auth.schema_migrations VALUES ('20221125140132');
INSERT INTO auth.schema_migrations VALUES ('20221208132122');
INSERT INTO auth.schema_migrations VALUES ('20221215195500');
INSERT INTO auth.schema_migrations VALUES ('20221215195800');
INSERT INTO auth.schema_migrations VALUES ('20221215195900');
INSERT INTO auth.schema_migrations VALUES ('20230116124310');
INSERT INTO auth.schema_migrations VALUES ('20230116124412');
INSERT INTO auth.schema_migrations VALUES ('20230131181311');
INSERT INTO auth.schema_migrations VALUES ('20230322519590');
INSERT INTO auth.schema_migrations VALUES ('20230402418590');
INSERT INTO auth.schema_migrations VALUES ('20230411005111');
INSERT INTO auth.schema_migrations VALUES ('20230508135423');
INSERT INTO auth.schema_migrations VALUES ('20230523124323');
INSERT INTO auth.schema_migrations VALUES ('20230818113222');
INSERT INTO auth.schema_migrations VALUES ('20230914180801');
INSERT INTO auth.schema_migrations VALUES ('20231027141322');
INSERT INTO auth.schema_migrations VALUES ('20231114161723');
INSERT INTO auth.schema_migrations VALUES ('20231117164230');
INSERT INTO auth.schema_migrations VALUES ('20240115144230');
INSERT INTO auth.schema_migrations VALUES ('20240214120130');
INSERT INTO auth.schema_migrations VALUES ('20240306115329');
INSERT INTO auth.schema_migrations VALUES ('20240314092811');
INSERT INTO auth.schema_migrations VALUES ('20240427152123');
INSERT INTO auth.schema_migrations VALUES ('20240612123726');
INSERT INTO auth.schema_migrations VALUES ('20240729123726');
INSERT INTO auth.schema_migrations VALUES ('20240802193726');
INSERT INTO auth.schema_migrations VALUES ('20240806073726');
INSERT INTO auth.schema_migrations VALUES ('20241009103726');
INSERT INTO auth.schema_migrations VALUES ('20250717082212');
INSERT INTO auth.schema_migrations VALUES ('20250731150234');
INSERT INTO auth.schema_migrations VALUES ('20250804100000');
INSERT INTO auth.schema_migrations VALUES ('20250901200500');
INSERT INTO auth.schema_migrations VALUES ('20250903112500');
INSERT INTO auth.schema_migrations VALUES ('20250904133000');
INSERT INTO auth.schema_migrations VALUES ('20250925093508');
INSERT INTO auth.schema_migrations VALUES ('20251007112900');
INSERT INTO auth.schema_migrations VALUES ('20251104100000');
INSERT INTO auth.schema_migrations VALUES ('20251111201300');
INSERT INTO auth.schema_migrations VALUES ('20251201000000');


--
-- TOC entry 4289 (class 0 OID 16711)
-- Dependencies: 354
-- Data for Name: sessions; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.sessions VALUES ('facee80a-bb7e-4282-b280-a198e556ab64', '844decb8-a0f0-4a74-ab02-ab1ba0001c5b', '2025-12-29 21:16:51.82223+00', '2025-12-31 03:18:59.269022+00', NULL, 'aal1', NULL, '2025-12-31 03:18:59.267768', 'Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Mobile Safari/537.36', '189.37.77.255', NULL, NULL, NULL, NULL, NULL);
INSERT INTO auth.sessions VALUES ('513b105e-72d7-46d3-8513-23c358444771', '844decb8-a0f0-4a74-ab02-ab1ba0001c5b', '2025-12-30 18:12:02.887491+00', '2026-01-02 12:01:41.381867+00', NULL, 'aal1', NULL, '2026-01-02 12:01:41.381183', 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36', '189.37.78.71', NULL, NULL, NULL, NULL, NULL);


--
-- TOC entry 4294 (class 0 OID 16797)
-- Dependencies: 359
-- Data for Name: sso_domains; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4293 (class 0 OID 16788)
-- Dependencies: 358
-- Data for Name: sso_providers; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--



--
-- TOC entry 4282 (class 0 OID 16495)
-- Dependencies: 344
-- Data for Name: users; Type: TABLE DATA; Schema: auth; Owner: supabase_auth_admin
--

INSERT INTO auth.users VALUES ('00000000-0000-0000-0000-000000000000', '631e295b-b7e9-4d8a-9d05-79898cef103f', 'authenticated', 'authenticated', 'eider@novvaempresa.com.br', '$2a$10$YIXVVuj213iSuHEKlqGP5.l2hmAsRy4RkmVFGotTGnt0TkXemGX4O', '2025-12-19 11:53:04.790031+00', NULL, '', NULL, 'c036d2399be60156fe727c4952a6a1aa119c2c478ebecf8c107fc604', '2025-12-19 12:13:26.491536+00', '', '', NULL, '2025-12-30 18:11:35.658003+00', '{"provider": "email", "providers": ["email"]}', '{"email_verified": true}', NULL, '2025-12-19 11:53:04.67957+00', '2025-12-30 18:11:35.74301+00', NULL, NULL, '', '', NULL, DEFAULT, '', 0, NULL, '', NULL, false, NULL, false);
INSERT INTO auth.users VALUES ('00000000-0000-0000-0000-000000000000', '844decb8-a0f0-4a74-ab02-ab1ba0001c5b', 'authenticated', 'authenticated', 'eider.arantes.oliveira@gmail.com', '$2a$10$7VXkRqEYRkcnNlULQzfepusDOtKCfz2r5D9KH9U4qdHZOuNXYKbWK', '2025-12-19 11:53:29.836814+00', NULL, '', NULL, '', NULL, '', '', NULL, '2025-12-30 18:12:02.887381+00', '{"provider": "email", "providers": ["email"]}', '{"email_verified": true}', NULL, '2025-12-19 11:53:29.825701+00', '2026-01-02 12:01:41.373048+00', NULL, NULL, '', '', NULL, DEFAULT, '', 0, NULL, '', NULL, false, NULL, false);


--
-- TOC entry 4319 (class 0 OID 17524)
-- Dependencies: 388
-- Data for Name: applications; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.applications VALUES (1, '2025-12-19 14:55:29.599431+00', 1, NULL, NULL, NULL, NULL, 'new', NULL, NULL, NULL, '{}', 0.00, false, NULL, '4a96d442-8386-4b68-827d-ce586713171a', '{"city": "UberlÃ¢ndia", "name": "JosÃ© da Silva Souza", "email": "teste@teste.com.br", "jobId": "1", "phone": "34999999999", "state": "MG", "course": "Engenharia", "source": "LinkedIn", "birthDate": "1991-07-10T03:00:00.000Z", "motivation": "gosto da empresa", "institution": "USP", "englishLevel": "fluente", "hasGraduated": "sim", "spanishLevel": "basico", "preferredName": "ZÃ©", "completionYear": "2011"}', 'teste_teste_com_br_1766156128277.pdf', false, NULL);
INSERT INTO public.applications VALUES (2, '2025-12-22 14:34:34.690985+00', 2, NULL, NULL, NULL, NULL, 'new', NULL, NULL, NULL, '{}', 0.00, false, NULL, '72fccae5-ba96-45b6-b6e6-9a022a24f2f4', '{"city": "UberlÃ¢ndia", "name": "Maria Joana Cruz", "email": "eider@novvaempresa.com.br", "jobId": "2", "phone": "34999999999", "state": "MG", "course": "Engenharia", "birthDate": "1991-07-10", "motivation": "Sei lÃ¡", "institution": "USP", "englishLevel": "fluente", "hasGraduated": "sim", "spanishLevel": "basico", "githubProfile": "https://github.com/eiderao", "preferredName": "Maju", "completionYear": "2011", "linkedinProfile": "www.linkedin.com/in/eider-arantes-de-oliveira-11051a2"}', 'eider_novvaempresa_com_br_1766414073143.pdf', false, NULL);
INSERT INTO public.applications VALUES (4, '2025-12-23 16:15:06.327267+00', 9, NULL, NULL, NULL, NULL, 'new', NULL, NULL, NULL, '{}', 0.00, false, NULL, '59abc2e1-edd9-4406-8337-e30cdb3d5cb2', '{"education": {"date": "2009", "level": "superior", "course": "Engenharia", "period": "", "status": "completo", "institution": "UFU"}, "applied_at": "2025-12-23T16:15:05.203Z", "motivation": "Cultura da empresa me atrai"}', NULL, false, NULL);
INSERT INTO public.applications VALUES (3, '2025-12-22 19:14:32.049282+00', 9, NULL, NULL, NULL, NULL, 'new', NULL, NULL, NULL, '{}', 7.77, false, NULL, '4a96d442-8386-4b68-827d-ce586713171a', '{"motivation": "Quero muito essa vaga!"}', NULL, false, '2025-12-25 19:33:46.578+00');
INSERT INTO public.applications VALUES (5, '2025-12-23 16:19:20.10397+00', 9, NULL, NULL, NULL, NULL, 'new', NULL, NULL, NULL, '{}', 0.00, false, NULL, '432b5301-686e-429a-92c2-517eb221f611', '{"education": {"date": "2012", "level": "pos", "course": "Engenharia de ProduÃ§Ã£o", "period": "", "status": "completo", "institution": "Unicamp"}, "applied_at": "2025-12-23T16:19:19.010Z", "motivation": "Sei nÃ£o"}', NULL, false, NULL);


--
-- TOC entry 4324 (class 0 OID 19435)
-- Dependencies: 393
-- Data for Name: candidates; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.candidates VALUES ('4a96d442-8386-4b68-827d-ce586713171a', 'JosÃ© da Silva Souza', 'teste@teste.com.br', NULL, NULL, NULL, NULL, NULL, NULL, '2025-12-19 14:51:01.164798+00', '2025-12-19 14:51:01.164798+00');
INSERT INTO public.candidates VALUES ('72fccae5-ba96-45b6-b6e6-9a022a24f2f4', 'Maria Joana Cruz', 'eider@novvaempresa.com.br', NULL, NULL, NULL, NULL, NULL, NULL, '2025-12-22 14:34:34.482581+00', '2025-12-22 14:34:34.482581+00');
INSERT INTO public.candidates VALUES ('a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11', 'JoÃ£o da Silva', 'joao@teste.com', NULL, 'SÃ£o Paulo', NULL, NULL, NULL, NULL, '2025-12-22 19:04:29.13381+00', '2025-12-22 19:04:29.13381+00');
INSERT INTO public.candidates VALUES ('59abc2e1-edd9-4406-8337-e30cdb3d5cb2', 'Caio A Oliveira', 'caio@gmail.com', '34999999999', 'UberlÃ¢ndia ', 'MG', '', '', 'https://drive.google.com/drive/u/0/folders/0BxnNN9l-rudtbFRqX05YS1RLak0', '2025-12-23 16:15:06.165156+00', '2025-12-23 16:15:04.808+00');
INSERT INTO public.candidates VALUES ('432b5301-686e-429a-92c2-517eb221f611', 'Alexandre o Grande', 'alebig@hotmail.com', '11999999999', 'SÃ£o Paulo', 'SP', '', '', 'https://rqffrviggegfmxtktnee.supabase.co/storage/v1/object/public/resumes/1766506758246_z3hjoe4y8.pdf', '2025-12-23 16:19:20.051698+00', '2025-12-23 16:19:18.915+00');


--
-- TOC entry 4327 (class 0 OID 22968)
-- Dependencies: 396
-- Data for Name: company_departments; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.company_departments VALUES (1, '2025-12-22 18:57:10.916709+00', 'Comercial', '279945a9-f523-4eb0-80f1-cd56c1f8c582');
INSERT INTO public.company_departments VALUES (2, '2025-12-22 19:01:19.715377+00', 'TI', '279945a9-f523-4eb0-80f1-cd56c1f8c582');
INSERT INTO public.company_departments VALUES (3, '2025-12-24 14:44:20.091941+00', 'Marketing', '279945a9-f523-4eb0-80f1-cd56c1f8c582');


--
-- TOC entry 4322 (class 0 OID 17781)
-- Dependencies: 391
-- Data for Name: evaluation_assignments_v2; Type: TABLE DATA; Schema: public; Owner: postgres
--



--
-- TOC entry 4325 (class 0 OID 22939)
-- Dependencies: 394
-- Data for Name: evaluations; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.evaluations VALUES ('158963bb-fb89-4f50-a2c2-4aba0a07dbee', 3, '844decb8-a0f0-4a74-ab02-ab1ba0001c5b', '{"cultura": {}, "tecnico": {"OrganizaÃ§Ã£o e MÃ©todo": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "Capacidade de otimizaÃ§Ã£o": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "CompreensÃ£o do escopo da demanda": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Capacidade de resoluÃ§Ã£o de problemas": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "Capacidade de estruturar dados de forma eficaz": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1"}, "triagem": {}, "updated_at": "2025-12-25T19:30:37.500Z", "pillar_scores": {"total": 9, "cultura": null, "tecnico": 9, "triagem": null, "pillarsEvaluated": 1}, "evaluator_name": "eider.arantes.oliveira@gmail.com", "anotacoes_gerais": "O candidato passou pelo teste tÃ©cnico, mas nÃ£o sabe estruturar dados muito bem."}', 'O candidato passou pelo teste tÃ©cnico, mas nÃ£o sabe estruturar dados muito bem.', 9.00, '2025-12-24 14:40:11.605+00');
INSERT INTO public.evaluations VALUES ('cafd5801-798e-4475-ad02-18b26d2f1300', 3, '631e295b-b7e9-4d8a-9d05-79898cef103f', '{"cultura": {"NÃ£o hÃ¡ tempo a perder": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "TransparÃªncia Ã© essencial": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Colaborar mais do que competir": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "A busca pelo melhor nunca termina": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "O Cliente Ã© a nossa razÃ£o de existir": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68"}, "tecnico": {"OrganizaÃ§Ã£o e MÃ©todo": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Capacidade de otimizaÃ§Ã£o": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "CompreensÃ£o do escopo da demanda": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Capacidade de resoluÃ§Ã£o de problemas": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "Capacidade de estruturar dados de forma eficaz": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68"}, "triagem": {"LÃ­nguas": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "Escolaridade": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Habilidade hard": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Habilidade soft": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "ExperiÃªncia Geral": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "ExperiÃªncia EspecÃ­fica": "5140db51-b042-45b2-a5ab-0a99e2982f4b", "QualificaÃ§Ã£o exigÃ­vel": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "QualificaÃ§Ã£o desejÃ¡vel": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1"}, "updated_at": "2025-12-25T19:32:17.134Z", "pillar_scores": {"total": 6.54, "cultura": 6, "tecnico": 7, "triagem": 6.63, "pillarsEvaluated": 3}, "evaluator_name": "eider@novvaempresa.com.br", "anotacoes_gerais": "Candidato mediano"}', 'Candidato mediano', 6.54, '2025-12-24 14:40:44.473+00');
INSERT INTO public.evaluations VALUES ('c7b148a5-9652-46cf-8c2f-ef70258f24d4', 4, '631e295b-b7e9-4d8a-9d05-79898cef103f', '{"cultura": {}, "tecnico": {}, "triagem": {"LÃ­nguas": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "Escolaridade": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "Habilidade hard": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "Habilidade soft": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "ExperiÃªncia Geral": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "ExperiÃªncia EspecÃ­fica": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "QualificaÃ§Ã£o exigÃ­vel": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "QualificaÃ§Ã£o desejÃ¡vel": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1"}, "updated_at": "2025-12-26T03:24:37.258Z", "pillar_scores": {"total": 9, "cultura": 0, "tecnico": 0, "triagem": 9}, "evaluator_name": "eider@novvaempresa.com.br", "anotacoes_gerais": ""}', '', 9.00, '2025-12-24 19:38:06.651764+00');


--
-- TOC entry 4317 (class 0 OID 17508)
-- Dependencies: 386
-- Data for Name: jobs; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.jobs VALUES (1, '2025-12-19 14:01:10.217987+00', 'Desenvolvedor Full Stack', 'active', '279945a9-f523-4eb0-80f1-cd56c1f8c582', '{"notas": [], "cultura": [{"name": "O Cliente Ã© nossa razÃ£o de existir", "weight": 20}, {"name": "TransparÃªncia Ã© essencial", "weight": 20}, {"name": "Colaborar Ã© celebrar junto", "weight": 20}, {"name": "A busca pelo melhor nunca termina", "weight": 20}, {"name": "NÃ£o hÃ¡ tempo a perder", "weight": 20}], "tecnico": [], "triagem": [{"name": "Escolaridade", "weight": 10}, {"name": "QualificaÃ§Ã£o Exigida", "weight": 10}, {"name": "QualificaÃ§Ã£o DesejÃ¡vel", "weight": 10}, {"name": "ExperiÃªncia Geral", "weight": 10}, {"name": "ExperiÃªncia EspecÃ­fica", "weight": 10}, {"name": "Habilidade Hard", "weight": 10}, {"name": "Habilidade Soft", "weight": 10}, {"name": "LÃ­nguas", "weight": 30}], "tÃ©cnico": [{"name": "Entendimento da demanda", "weight": 20}, {"name": "Capacidade de resoluÃ§Ã£o de problemas", "weight": 20}, {"name": "OrganizaÃ§Ã£o e MÃ©todo", "weight": 20}, {"name": "Capacidade de estruturar dados de forma clara e eficaz", "weight": 20}, {"name": "Habilidade de otimizaÃ§Ã£o", "weight": 20}]}', NULL, NULL, NULL, 'CLT', 'HÃ­brido', NULL);
INSERT INTO public.jobs VALUES (2, '2025-12-22 13:59:55.830367+00', 'Analista de Marketing Sr. - Vaga Teste', 'active', '279945a9-f523-4eb0-80f1-cd56c1f8c582', '{"cultura": [], "tecnico": [], "triagem": [{"id": "0fac2a90-37aa-46dd-ae9d-4e4eaabff1f7", "text": "QualificaÃ§Ã£o", "weight": 1}]}', NULL, '', '', 'CLT', 'HÃ­brido', NULL);
INSERT INTO public.jobs VALUES (9, '2025-12-22 19:02:41.84766+00', 'Cientista de Dados', 'active', '279945a9-f523-4eb0-80f1-cd56c1f8c582', '{"notas": [{"id": "5140db51-b042-45b2-a5ab-0a99e2982f4b", "nome": "Abaixo", "valor": 0}, {"id": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68", "nome": "Atende", "valor": "5"}, {"id": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1", "nome": "Supera", "valor": "10"}], "cultura": [{"name": "O Cliente Ã© a nossa razÃ£o de existir", "weight": "20"}, {"name": "TransparÃªncia Ã© essencial", "weight": "20"}, {"name": "Colaborar mais do que competir", "weight": "20"}, {"name": "A busca pelo melhor nunca termina", "weight": "20"}, {"name": "NÃ£o hÃ¡ tempo a perder", "weight": "20"}], "tecnico": [{"name": "CompreensÃ£o do escopo da demanda", "weight": "20"}, {"name": "Capacidade de resoluÃ§Ã£o de problemas", "weight": "20"}, {"name": "OrganizaÃ§Ã£o e MÃ©todo", "weight": "20"}, {"name": "Capacidade de estruturar dados de forma eficaz", "weight": "20"}, {"name": "Capacidade de otimizaÃ§Ã£o", "weight": "20"}], "triagem": [{"name": "Escolaridade", "weight": "10"}, {"name": "QualificaÃ§Ã£o exigÃ­vel", "weight": "12.5"}, {"name": "QualificaÃ§Ã£o desejÃ¡vel", "weight": "10"}, {"name": "ExperiÃªncia Geral", "weight": "20"}, {"name": "ExperiÃªncia EspecÃ­fica", "weight": "12.5"}, {"name": "Habilidade hard", "weight": "10"}, {"name": "Habilidade soft", "weight": "10"}, {"name": "LÃ­nguas", "weight": "15"}]}', NULL, 'Profissional com capacidade para desenvolver sistemas utilizando machine learning e manipular grandes bases de dados (bigdata)', 'EstatÃ­stico
Desenvolvedor Python', 'PJ', 'Remoto', 2);
INSERT INTO public.jobs VALUES (8, '2025-12-22 18:58:32.518032+00', 'Executivo de Contas', 'inactive', '279945a9-f523-4eb0-80f1-cd56c1f8c582', '{"notas": [], "cultura": [], "tecnico": [], "triagem": []}', NULL, 'Profissional para atender a clientes B2B de Alto Valor e Alto Potencial na Matriz de SegmentaÃ§Ã£o.', 'Senioridade na Ã¡rea comercial 
Habilidades de relacionamento com clientes', 'CLT', 'HÃ­brido', 1);


--
-- TOC entry 4323 (class 0 OID 19187)
-- Dependencies: 392
-- Data for Name: plans; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.plans VALUES ('basico', 'Plano BÃ¡sico', 99.00, 1, 10, 10);
INSERT INTO public.plans VALUES ('freemium', 'Plano Freemium', 0.00, 1, 5, 3);
INSERT INTO public.plans VALUES ('intermediario', 'Plano IntermediÃ¡rio', 149.00, 5, 30, -1);
INSERT INTO public.plans VALUES ('premium', 'Plano Premium', 229.00, -1, -1, -1);


--
-- TOC entry 4320 (class 0 OID 17751)
-- Dependencies: 389
-- Data for Name: tenants; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.tenants VALUES ('279945a9-f523-4eb0-80f1-cd56c1f8c582', 'Novva - Desenvolvimento Empresarial', '26.424.282/0001-48', 'premium', '2025-12-19 13:07:51.150663+00');
INSERT INTO public.tenants VALUES ('e64d1e73-452a-47f7-a71b-dac7f6adb2f4', 'Minha Empresa', NULL, 'premium', '2025-12-22 19:18:59.259862+00');


--
-- TOC entry 4321 (class 0 OID 17761)
-- Dependencies: 390
-- Data for Name: user_profiles; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.user_profiles VALUES ('631e295b-b7e9-4d8a-9d05-79898cef103f', '279945a9-f523-4eb0-80f1-cd56c1f8c582', 'Admin Teste', 'seu.email@exemplo.com', 'admin', true, '2025-12-19 13:12:37.821644+00', true);
INSERT INTO public.user_profiles VALUES ('844decb8-a0f0-4a74-ab02-ab1ba0001c5b', '279945a9-f523-4eb0-80f1-cd56c1f8c582', 'eider.arantes.oliveira', 'eider@novvaempresa.com.br', 'rh', true, '2025-12-22 19:18:59.355871+00', true);


--
-- TOC entry 4315 (class 0 OID 17482)
-- Dependencies: 384
-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: postgres
--

INSERT INTO public.users VALUES ('631e295b-b7e9-4d8a-9d05-79898cef103f', 'eider@novvaempresa.com.br', '279945a9-f523-4eb0-80f1-cd56c1f8c582', true, 'recruiter', 'active', 'UsuÃ¡rio teste 1 (eider@novvaempresa)');
INSERT INTO public.users VALUES ('844decb8-a0f0-4a74-ab02-ab1ba0001c5b', 'eider.arantes.oliveira@gmail.com', '279945a9-f523-4eb0-80f1-cd56c1f8c582', true, 'recruiter', 'active', 'UsuÃ¡rio teste 2 (eider.arantes.oliveira@gmail.com)');


--
-- TOC entry 4303 (class 0 OID 17076)
-- Dependencies: 368
-- Data for Name: schema_migrations; Type: TABLE DATA; Schema: realtime; Owner: supabase_admin
--

INSERT INTO realtime.schema_migrations VALUES (20211116024918, '2025-12-18 17:54:09');
INSERT INTO realtime.schema_migrations VALUES (20211116045059, '2025-12-18 17:54:14');
INSERT INTO realtime.schema_migrations VALUES (20211116050929, '2025-12-18 17:54:18');
INSERT INTO realtime.schema_migrations VALUES (20211116051442, '2025-12-18 17:54:21');
INSERT INTO realtime.schema_migrations VALUES (20211116212300, '2025-12-18 17:54:25');
INSERT INTO realtime.schema_migrations VALUES (20211116213355, '2025-12-18 17:54:29');
INSERT INTO realtime.schema_migrations VALUES (20211116213934, '2025-12-18 17:54:32');
INSERT INTO realtime.schema_migrations VALUES (20211116214523, '2025-12-18 17:54:37');
INSERT INTO realtime.schema_migrations VALUES (20211122062447, '2025-12-18 17:54:40');
INSERT INTO realtime.schema_migrations VALUES (20211124070109, '2025-12-18 17:54:43');
INSERT INTO realtime.schema_migrations VALUES (20211202204204, '2025-12-18 17:54:47');
INSERT INTO realtime.schema_migrations VALUES (20211202204605, '2025-12-18 17:54:50');
INSERT INTO realtime.schema_migrations VALUES (20211210212804, '2025-12-18 17:55:01');
INSERT INTO realtime.schema_migrations VALUES (20211228014915, '2025-12-18 17:55:04');
INSERT INTO realtime.schema_migrations VALUES (20220107221237, '2025-12-18 17:55:08');
INSERT INTO realtime.schema_migrations VALUES (20220228202821, '2025-12-18 17:55:11');
INSERT INTO realtime.schema_migrations VALUES (20220312004840, '2025-12-18 17:55:15');
INSERT INTO realtime.schema_migrations VALUES (20220603231003, '2025-12-18 17:55:20');
INSERT INTO realtime.schema_migrations VALUES (20220603232444, '2025-12-18 17:55:23');
INSERT INTO realtime.schema_migrations VALUES (20220615214548, '2025-12-18 17:55:27');
INSERT INTO realtime.schema_migrations VALUES (20220712093339, '2025-12-18 17:55:31');
INSERT INTO realtime.schema_migrations VALUES (20220908172859, '2025-12-18 17:55:34');
INSERT INTO realtime.schema_migrations VALUES (20220916233421, '2025-12-18 17:55:38');
INSERT INTO realtime.schema_migrations VALUES (20230119133233, '2025-12-18 17:55:41');
INSERT INTO realtime.schema_migrations VALUES (20230128025114, '2025-12-18 17:55:46');
INSERT INTO realtime.schema_migrations VALUES (20230128025212, '2025-12-18 17:55:49');
INSERT INTO realtime.schema_migrations VALUES (20230227211149, '2025-12-18 17:55:53');
INSERT INTO realtime.schema_migrations VALUES (20230228184745, '2025-12-18 17:55:56');
INSERT INTO realtime.schema_migrations VALUES (20230308225145, '2025-12-18 17:55:59');
INSERT INTO realtime.schema_migrations VALUES (20230328144023, '2025-12-18 17:56:03');
INSERT INTO realtime.schema_migrations VALUES (20231018144023, '2025-12-18 17:56:07');
INSERT INTO realtime.schema_migrations VALUES (20231204144023, '2025-12-18 17:56:12');
INSERT INTO realtime.schema_migrations VALUES (20231204144024, '2025-12-18 17:56:16');
INSERT INTO realtime.schema_migrations VALUES (20231204144025, '2025-12-18 17:56:19');
INSERT INTO realtime.schema_migrations VALUES (20240108234812, '2025-12-18 17:56:23');
INSERT INTO realtime.schema_migrations VALUES (20240109165339, '2025-12-18 17:56:26');
INSERT INTO realtime.schema_migrations VALUES (20240227174441, '2025-12-18 17:56:32');
INSERT INTO realtime.schema_migrations VALUES (20240311171622, '2025-12-18 17:56:37');
INSERT INTO realtime.schema_migrations VALUES (20240321100241, '2025-12-18 17:56:44');
INSERT INTO realtime.schema_migrations VALUES (20240401105812, '2025-12-18 17:56:54');
INSERT INTO realtime.schema_migrations VALUES (20240418121054, '2025-12-18 17:56:59');
INSERT INTO realtime.schema_migrations VALUES (20240523004032, '2025-12-18 17:57:11');
INSERT INTO realtime.schema_migrations VALUES (20240618124746, '2025-12-18 17:57:14');
INSERT INTO realtime.schema_migrations VALUES (20240801235015, '2025-12-18 17:57:18');
INSERT INTO realtime.schema_migrations VALUES (20240805133720, '2025-12-18 17:57:21');
INSERT INTO realtime.schema_migrations VALUES (20240827160934, '2025-12-18 17:57:24');
INSERT INTO realtime.schema_migrations VALUES (20240919163303, '2025-12-18 17:57:29');
INSERT INTO realtime.schema_migrations VALUES (20240919163305, '2025-12-18 17:57:32');
INSERT INTO realtime.schema_migrations VALUES (20241019105805, '2025-12-18 17:57:36');
INSERT INTO realtime.schema_migrations VALUES (20241030150047, '2025-12-18 17:57:48');
INSERT INTO realtime.schema_migrations VALUES (20241108114728, '2025-12-18 17:57:53');
INSERT INTO realtime.schema_migrations VALUES (20241121104152, '2025-12-18 17:57:56');
INSERT INTO realtime.schema_migrations VALUES (20241130184212, '2025-12-18 17:58:00');
INSERT INTO realtime.schema_migrations VALUES (20241220035512, '2025-12-18 17:58:04');
INSERT INTO realtime.schema_migrations VALUES (20241220123912, '2025-12-18 17:58:07');
INSERT INTO realtime.schema_migrations VALUES (20241224161212, '2025-12-18 17:58:10');
INSERT INTO realtime.schema_migrations VALUES (20250107150512, '2025-12-18 17:58:14');
INSERT INTO realtime.schema_migrations VALUES (20250110162412, '2025-12-18 17:58:17');
INSERT INTO realtime.schema_migrations VALUES (20250123174212, '2025-12-18 17:58:20');
INSERT INTO realtime.schema_migrations VALUES (20250128220012, '2025-12-18 17:58:24');
INSERT INTO realtime.schema_migrations VALUES (20250506224012, '2025-12-18 17:58:27');
INSERT INTO realtime.schema_migrations VALUES (20250523164012, '2025-12-18 17:58:30');
INSERT INTO realtime.schema_migrations VALUES (20250714121412, '2025-12-18 17:58:34');
INSERT INTO realtime.schema_migrations VALUES (20250905041441, '2025-12-18 17:58:37');
INSERT INTO realtime.schema_migrations VALUES (20251103001201, '2025-12-18 17:58:40');


--
-- TOC entry 4314 (class 0 OID 17325)
-- Dependencies: 380
-- Data for Name: subscription; Type: TABLE DATA; Schema: realtime; Owner: supabase_admin
--



--
-- TOC entry 4305 (class 0 OID 17089)
-- Dependencies: 370
-- Data for Name: buckets; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--

INSERT INTO storage.buckets VALUES ('resumes', 'resumes', NULL, '2025-12-19 14:37:52.698031+00', '2025-12-19 14:37:52.698031+00', true, false, NULL, NULL, NULL, 'STANDARD');


--
-- TOC entry 4310 (class 0 OID 17246)
-- Dependencies: 375
-- Data for Name: buckets_analytics; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--



--
-- TOC entry 4311 (class 0 OID 17273)
-- Dependencies: 376
-- Data for Name: buckets_vectors; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--



--
-- TOC entry 4304 (class 0 OID 17081)
-- Dependencies: 369
-- Data for Name: migrations; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--

INSERT INTO storage.migrations VALUES (0, 'create-migrations-table', 'e18db593bcde2aca2a408c4d1100f6abba2195df', '2025-12-18 17:54:04.682167');
INSERT INTO storage.migrations VALUES (1, 'initialmigration', '6ab16121fbaa08bbd11b712d05f358f9b555d777', '2025-12-18 17:54:04.703664');
INSERT INTO storage.migrations VALUES (2, 'storage-schema', '5c7968fd083fcea04050c1b7f6253c9771b99011', '2025-12-18 17:54:04.718953');
INSERT INTO storage.migrations VALUES (3, 'pathtoken-column', '2cb1b0004b817b29d5b0a971af16bafeede4b70d', '2025-12-18 17:54:04.752545');
INSERT INTO storage.migrations VALUES (4, 'add-migrations-rls', '427c5b63fe1c5937495d9c635c263ee7a5905058', '2025-12-18 17:54:04.815833');
INSERT INTO storage.migrations VALUES (5, 'add-size-functions', '79e081a1455b63666c1294a440f8ad4b1e6a7f84', '2025-12-18 17:54:04.827918');
INSERT INTO storage.migrations VALUES (6, 'change-column-name-in-get-size', 'f93f62afdf6613ee5e7e815b30d02dc990201044', '2025-12-18 17:54:04.848369');
INSERT INTO storage.migrations VALUES (7, 'add-rls-to-buckets', 'e7e7f86adbc51049f341dfe8d30256c1abca17aa', '2025-12-18 17:54:04.865985');
INSERT INTO storage.migrations VALUES (8, 'add-public-to-buckets', 'fd670db39ed65f9d08b01db09d6202503ca2bab3', '2025-12-18 17:54:04.882889');
INSERT INTO storage.migrations VALUES (9, 'fix-search-function', '3a0af29f42e35a4d101c259ed955b67e1bee6825', '2025-12-18 17:54:04.904158');
INSERT INTO storage.migrations VALUES (10, 'search-files-search-function', '68dc14822daad0ffac3746a502234f486182ef6e', '2025-12-18 17:54:04.917237');
INSERT INTO storage.migrations VALUES (11, 'add-trigger-to-auto-update-updated_at-column', '7425bdb14366d1739fa8a18c83100636d74dcaa2', '2025-12-18 17:54:04.939311');
INSERT INTO storage.migrations VALUES (12, 'add-automatic-avif-detection-flag', '8e92e1266eb29518b6a4c5313ab8f29dd0d08df9', '2025-12-18 17:54:04.955776');
INSERT INTO storage.migrations VALUES (13, 'add-bucket-custom-limits', 'cce962054138135cd9a8c4bcd531598684b25e7d', '2025-12-18 17:54:05.01623');
INSERT INTO storage.migrations VALUES (14, 'use-bytes-for-max-size', '941c41b346f9802b411f06f30e972ad4744dad27', '2025-12-18 17:54:05.094651');
INSERT INTO storage.migrations VALUES (15, 'add-can-insert-object-function', '934146bc38ead475f4ef4b555c524ee5d66799e5', '2025-12-18 17:54:05.121283');
INSERT INTO storage.migrations VALUES (16, 'add-version', '76debf38d3fd07dcfc747ca49096457d95b1221b', '2025-12-18 17:54:05.131454');
INSERT INTO storage.migrations VALUES (17, 'drop-owner-foreign-key', 'f1cbb288f1b7a4c1eb8c38504b80ae2a0153d101', '2025-12-18 17:54:05.143621');
INSERT INTO storage.migrations VALUES (18, 'add_owner_id_column_deprecate_owner', 'e7a511b379110b08e2f214be852c35414749fe66', '2025-12-18 17:54:05.173811');
INSERT INTO storage.migrations VALUES (19, 'alter-default-value-objects-id', '02e5e22a78626187e00d173dc45f58fa66a4f043', '2025-12-18 17:54:05.186561');
INSERT INTO storage.migrations VALUES (20, 'list-objects-with-delimiter', 'cd694ae708e51ba82bf012bba00caf4f3b6393b7', '2025-12-18 17:54:05.204635');
INSERT INTO storage.migrations VALUES (21, 's3-multipart-uploads', '8c804d4a566c40cd1e4cc5b3725a664a9303657f', '2025-12-18 17:54:05.216415');
INSERT INTO storage.migrations VALUES (22, 's3-multipart-uploads-big-ints', '9737dc258d2397953c9953d9b86920b8be0cdb73', '2025-12-18 17:54:05.235414');
INSERT INTO storage.migrations VALUES (23, 'optimize-search-function', '9d7e604cddc4b56a5422dc68c9313f4a1b6f132c', '2025-12-18 17:54:05.256745');
INSERT INTO storage.migrations VALUES (24, 'operation-function', '8312e37c2bf9e76bbe841aa5fda889206d2bf8aa', '2025-12-18 17:54:05.268844');
INSERT INTO storage.migrations VALUES (25, 'custom-metadata', 'd974c6057c3db1c1f847afa0e291e6165693b990', '2025-12-18 17:54:05.294059');
INSERT INTO storage.migrations VALUES (26, 'objects-prefixes', 'ef3f7871121cdc47a65308e6702519e853422ae2', '2025-12-18 17:54:05.303806');
INSERT INTO storage.migrations VALUES (27, 'search-v2', '33b8f2a7ae53105f028e13e9fcda9dc4f356b4a2', '2025-12-18 17:54:05.356947');
INSERT INTO storage.migrations VALUES (28, 'object-bucket-name-sorting', 'ba85ec41b62c6a30a3f136788227ee47f311c436', '2025-12-18 17:54:05.415378');
INSERT INTO storage.migrations VALUES (29, 'create-prefixes', 'a7b1a22c0dc3ab630e3055bfec7ce7d2045c5b7b', '2025-12-18 17:54:05.422696');
INSERT INTO storage.migrations VALUES (30, 'update-object-levels', '6c6f6cc9430d570f26284a24cf7b210599032db7', '2025-12-18 17:54:05.432877');
INSERT INTO storage.migrations VALUES (31, 'objects-level-index', '33f1fef7ec7fea08bb892222f4f0f5d79bab5eb8', '2025-12-18 17:54:05.52018');
INSERT INTO storage.migrations VALUES (32, 'backward-compatible-index-on-objects', '2d51eeb437a96868b36fcdfb1ddefdf13bef1647', '2025-12-18 17:54:05.529763');
INSERT INTO storage.migrations VALUES (33, 'backward-compatible-index-on-prefixes', 'fe473390e1b8c407434c0e470655945b110507bf', '2025-12-18 17:54:05.54217');
INSERT INTO storage.migrations VALUES (34, 'optimize-search-function-v1', '82b0e469a00e8ebce495e29bfa70a0797f7ebd2c', '2025-12-18 17:54:05.545097');
INSERT INTO storage.migrations VALUES (35, 'add-insert-trigger-prefixes', '63bb9fd05deb3dc5e9fa66c83e82b152f0caf589', '2025-12-18 17:54:05.558531');
INSERT INTO storage.migrations VALUES (36, 'optimise-existing-functions', '81cf92eb0c36612865a18016a38496c530443899', '2025-12-18 17:54:05.572947');
INSERT INTO storage.migrations VALUES (37, 'add-bucket-name-length-trigger', '3944135b4e3e8b22d6d4cbb568fe3b0b51df15c1', '2025-12-18 17:54:05.591375');
INSERT INTO storage.migrations VALUES (38, 'iceberg-catalog-flag-on-buckets', '19a8bd89d5dfa69af7f222a46c726b7c41e462c5', '2025-12-18 17:54:05.601404');
INSERT INTO storage.migrations VALUES (39, 'add-search-v2-sort-support', '39cf7d1e6bf515f4b02e41237aba845a7b492853', '2025-12-18 17:54:05.616957');
INSERT INTO storage.migrations VALUES (40, 'fix-prefix-race-conditions-optimized', 'fd02297e1c67df25a9fc110bf8c8a9af7fb06d1f', '2025-12-18 17:54:05.633276');
INSERT INTO storage.migrations VALUES (41, 'add-object-level-update-trigger', '44c22478bf01744b2129efc480cd2edc9a7d60e9', '2025-12-18 17:54:05.649687');
INSERT INTO storage.migrations VALUES (42, 'rollback-prefix-triggers', 'f2ab4f526ab7f979541082992593938c05ee4b47', '2025-12-18 17:54:05.669149');
INSERT INTO storage.migrations VALUES (43, 'fix-object-level', 'ab837ad8f1c7d00cc0b7310e989a23388ff29fc6', '2025-12-18 17:54:05.680581');
INSERT INTO storage.migrations VALUES (44, 'vector-bucket-type', '99c20c0ffd52bb1ff1f32fb992f3b351e3ef8fb3', '2025-12-18 17:54:05.691574');
INSERT INTO storage.migrations VALUES (45, 'vector-buckets', '049e27196d77a7cb76497a85afae669d8b230953', '2025-12-18 17:54:05.708885');
INSERT INTO storage.migrations VALUES (46, 'buckets-objects-grants', 'fedeb96d60fefd8e02ab3ded9fbde05632f84aed', '2025-12-18 17:54:05.727158');
INSERT INTO storage.migrations VALUES (47, 'iceberg-table-metadata', '649df56855c24d8b36dd4cc1aeb8251aa9ad42c2', '2025-12-18 17:54:05.738011');
INSERT INTO storage.migrations VALUES (48, 'iceberg-catalog-ids', '2666dff93346e5d04e0a878416be1d5fec345d6f', '2025-12-18 17:54:05.748994');
INSERT INTO storage.migrations VALUES (49, 'buckets-objects-grants-postgres', '072b1195d0d5a2f888af6b2302a1938dd94b8b3d', '2025-12-19 11:39:57.704824');


--
-- TOC entry 4306 (class 0 OID 17099)
-- Dependencies: 371
-- Data for Name: objects; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--

INSERT INTO storage.objects VALUES ('f3ff287d-c45d-4099-a1e4-c86eceba1e64', 'resumes', 'teste_teste_com_br_1766155240539.pdf', NULL, '2025-12-19 14:40:41.209505+00', '2025-12-19 14:40:41.209505+00', '2025-12-19 14:40:41.209505+00', '{"eTag": "\"f2c5ce99696626aece13b50f5f857bb8\"", "size": 368155, "mimetype": "application/pdf", "cacheControl": "max-age=3600", "lastModified": "2025-12-19T14:40:42.000Z", "contentLength": 368155, "httpStatusCode": 200}', DEFAULT, '13012aa2-7f95-46f0-b0ab-3dcf67f9a5f3', NULL, '{}', 1);
INSERT INTO storage.objects VALUES ('9ef5c925-4c14-403a-84e9-6bd852f1adc6', 'resumes', 'teste_teste_com_br_1766155860050.pdf', NULL, '2025-12-19 14:51:00.758037+00', '2025-12-19 14:51:00.758037+00', '2025-12-19 14:51:00.758037+00', '{"eTag": "\"f2c5ce99696626aece13b50f5f857bb8\"", "size": 368155, "mimetype": "application/pdf", "cacheControl": "max-age=3600", "lastModified": "2025-12-19T14:51:01.000Z", "contentLength": 368155, "httpStatusCode": 200}', DEFAULT, '5dad6d6a-9a53-43d1-9eaa-447b088b8e3d', NULL, '{}', 1);
INSERT INTO storage.objects VALUES ('2f95b50a-3208-4dfb-9c93-b402e861a7a8', 'resumes', 'teste_teste_com_br_1766155945615.pdf', NULL, '2025-12-19 14:52:26.363347+00', '2025-12-19 14:52:26.363347+00', '2025-12-19 14:52:26.363347+00', '{"eTag": "\"f2c5ce99696626aece13b50f5f857bb8\"", "size": 368155, "mimetype": "application/pdf", "cacheControl": "max-age=3600", "lastModified": "2025-12-19T14:52:27.000Z", "contentLength": 368155, "httpStatusCode": 200}', DEFAULT, '9927b3d6-4ef5-4248-b538-079a63cce8bd', NULL, '{}', 1);
INSERT INTO storage.objects VALUES ('0a160c0f-ad05-41a6-aab7-a16e8b2b84d1', 'resumes', 'teste_teste_com_br_1766156128277.pdf', NULL, '2025-12-19 14:55:29.198336+00', '2025-12-19 14:55:29.198336+00', '2025-12-19 14:55:29.198336+00', '{"eTag": "\"f2c5ce99696626aece13b50f5f857bb8\"", "size": 368155, "mimetype": "application/pdf", "cacheControl": "max-age=3600", "lastModified": "2025-12-19T14:55:30.000Z", "contentLength": 368155, "httpStatusCode": 200}', DEFAULT, 'f392a57f-0003-4775-a3f8-671a9588c014', NULL, '{}', 1);
INSERT INTO storage.objects VALUES ('b5ff3313-af89-458d-b881-b15ecd668961', 'resumes', 'eider_novvaempresa_com_br_1766414073143.pdf', NULL, '2025-12-22 14:34:34.119649+00', '2025-12-22 14:34:34.119649+00', '2025-12-22 14:34:34.119649+00', '{"eTag": "\"f2c5ce99696626aece13b50f5f857bb8\"", "size": 368155, "mimetype": "application/pdf", "cacheControl": "max-age=3600", "lastModified": "2025-12-22T14:34:35.000Z", "contentLength": 368155, "httpStatusCode": 200}', DEFAULT, '2ca9c6ac-442f-4302-a2d5-b4270d799e5e', NULL, '{}', 1);
INSERT INTO storage.objects VALUES ('be75d55d-975c-4ad7-80d6-947210344c4f', 'resumes', '1766506758246_z3hjoe4y8.pdf', '631e295b-b7e9-4d8a-9d05-79898cef103f', '2025-12-23 16:19:19.925318+00', '2025-12-23 16:19:19.925318+00', '2025-12-23 16:19:19.925318+00', '{"eTag": "\"f2c5ce99696626aece13b50f5f857bb8\"", "size": 368155, "mimetype": "application/pdf", "cacheControl": "max-age=3600", "lastModified": "2025-12-23T16:19:20.000Z", "contentLength": 368155, "httpStatusCode": 200}', DEFAULT, '3e05b649-796c-4c89-9089-6a8136d3e900', '631e295b-b7e9-4d8a-9d05-79898cef103f', '{}', 1);


--
-- TOC entry 4309 (class 0 OID 17202)
-- Dependencies: 374
-- Data for Name: prefixes; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--



--
-- TOC entry 4307 (class 0 OID 17149)
-- Dependencies: 372
-- Data for Name: s3_multipart_uploads; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--



--
-- TOC entry 4308 (class 0 OID 17163)
-- Dependencies: 373
-- Data for Name: s3_multipart_uploads_parts; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--



--
-- TOC entry 4312 (class 0 OID 17283)
-- Dependencies: 377
-- Data for Name: vector_indexes; Type: TABLE DATA; Schema: storage; Owner: supabase_storage_admin
--



--
-- TOC entry 3716 (class 0 OID 16608)
-- Dependencies: 350
-- Data for Name: secrets; Type: TABLE DATA; Schema: vault; Owner: supabase_admin
--



--
-- TOC entry 4510 (class 0 OID 0)
-- Dependencies: 345
-- Name: refresh_tokens_id_seq; Type: SEQUENCE SET; Schema: auth; Owner: supabase_auth_admin
--

SELECT pg_catalog.setval('auth.refresh_tokens_id_seq', 124, true);


--
-- TOC entry 4511 (class 0 OID 0)
-- Dependencies: 387
-- Name: applications_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.applications_id_seq', 5, true);


--
-- TOC entry 4512 (class 0 OID 0)
-- Dependencies: 395
-- Name: company_departments_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.company_departments_id_seq', 3, true);


--
-- TOC entry 4513 (class 0 OID 0)
-- Dependencies: 385
-- Name: jobs_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.jobs_id_seq', 9, true);


--
-- TOC entry 4514 (class 0 OID 0)
-- Dependencies: 379
-- Name: subscription_id_seq; Type: SEQUENCE SET; Schema: realtime; Owner: supabase_admin
--

SELECT pg_catalog.setval('realtime.subscription_id_seq', 1, false);


--
-- TOC entry 3896 (class 2606 OID 16783)
-- Name: mfa_amr_claims amr_id_pk; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_amr_claims
    ADD CONSTRAINT amr_id_pk PRIMARY KEY (id);


--
-- TOC entry 3865 (class 2606 OID 16531)
-- Name: audit_log_entries audit_log_entries_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.audit_log_entries
    ADD CONSTRAINT audit_log_entries_pkey PRIMARY KEY (id);


--
-- TOC entry 3919 (class 2606 OID 16889)
-- Name: flow_state flow_state_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.flow_state
    ADD CONSTRAINT flow_state_pkey PRIMARY KEY (id);


--
-- TOC entry 3874 (class 2606 OID 16907)
-- Name: identities identities_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.identities
    ADD CONSTRAINT identities_pkey PRIMARY KEY (id);


--
-- TOC entry 3876 (class 2606 OID 16917)
-- Name: identities identities_provider_id_provider_unique; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.identities
    ADD CONSTRAINT identities_provider_id_provider_unique UNIQUE (provider_id, provider);


--
-- TOC entry 3863 (class 2606 OID 16524)
-- Name: instances instances_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.instances
    ADD CONSTRAINT instances_pkey PRIMARY KEY (id);


--
-- TOC entry 3898 (class 2606 OID 16776)
-- Name: mfa_amr_claims mfa_amr_claims_session_id_authentication_method_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_amr_claims
    ADD CONSTRAINT mfa_amr_claims_session_id_authentication_method_pkey UNIQUE (session_id, authentication_method);


--
-- TOC entry 3894 (class 2606 OID 16764)
-- Name: mfa_challenges mfa_challenges_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_challenges
    ADD CONSTRAINT mfa_challenges_pkey PRIMARY KEY (id);


--
-- TOC entry 3886 (class 2606 OID 16957)
-- Name: mfa_factors mfa_factors_last_challenged_at_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_factors
    ADD CONSTRAINT mfa_factors_last_challenged_at_key UNIQUE (last_challenged_at);


--
-- TOC entry 3888 (class 2606 OID 16751)
-- Name: mfa_factors mfa_factors_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_factors
    ADD CONSTRAINT mfa_factors_pkey PRIMARY KEY (id);


--
-- TOC entry 3932 (class 2606 OID 17016)
-- Name: oauth_authorizations oauth_authorizations_authorization_code_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_authorizations
    ADD CONSTRAINT oauth_authorizations_authorization_code_key UNIQUE (authorization_code);


--
-- TOC entry 3934 (class 2606 OID 17014)
-- Name: oauth_authorizations oauth_authorizations_authorization_id_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_authorizations
    ADD CONSTRAINT oauth_authorizations_authorization_id_key UNIQUE (authorization_id);


--
-- TOC entry 3936 (class 2606 OID 17012)
-- Name: oauth_authorizations oauth_authorizations_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_authorizations
    ADD CONSTRAINT oauth_authorizations_pkey PRIMARY KEY (id);


--
-- TOC entry 3946 (class 2606 OID 17074)
-- Name: oauth_client_states oauth_client_states_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_client_states
    ADD CONSTRAINT oauth_client_states_pkey PRIMARY KEY (id);


--
-- TOC entry 3929 (class 2606 OID 16976)
-- Name: oauth_clients oauth_clients_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_clients
    ADD CONSTRAINT oauth_clients_pkey PRIMARY KEY (id);


--
-- TOC entry 3940 (class 2606 OID 17038)
-- Name: oauth_consents oauth_consents_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_consents
    ADD CONSTRAINT oauth_consents_pkey PRIMARY KEY (id);


--
-- TOC entry 3942 (class 2606 OID 17040)
-- Name: oauth_consents oauth_consents_user_client_unique; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_consents
    ADD CONSTRAINT oauth_consents_user_client_unique UNIQUE (user_id, client_id);


--
-- TOC entry 3923 (class 2606 OID 16942)
-- Name: one_time_tokens one_time_tokens_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.one_time_tokens
    ADD CONSTRAINT one_time_tokens_pkey PRIMARY KEY (id);


--
-- TOC entry 3857 (class 2606 OID 16514)
-- Name: refresh_tokens refresh_tokens_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.refresh_tokens
    ADD CONSTRAINT refresh_tokens_pkey PRIMARY KEY (id);


--
-- TOC entry 3860 (class 2606 OID 16694)
-- Name: refresh_tokens refresh_tokens_token_unique; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.refresh_tokens
    ADD CONSTRAINT refresh_tokens_token_unique UNIQUE (token);


--
-- TOC entry 3908 (class 2606 OID 16823)
-- Name: saml_providers saml_providers_entity_id_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_providers
    ADD CONSTRAINT saml_providers_entity_id_key UNIQUE (entity_id);


--
-- TOC entry 3910 (class 2606 OID 16821)
-- Name: saml_providers saml_providers_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_providers
    ADD CONSTRAINT saml_providers_pkey PRIMARY KEY (id);


--
-- TOC entry 3915 (class 2606 OID 16837)
-- Name: saml_relay_states saml_relay_states_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_relay_states
    ADD CONSTRAINT saml_relay_states_pkey PRIMARY KEY (id);


--
-- TOC entry 3868 (class 2606 OID 16537)
-- Name: schema_migrations schema_migrations_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.schema_migrations
    ADD CONSTRAINT schema_migrations_pkey PRIMARY KEY (version);


--
-- TOC entry 3881 (class 2606 OID 16715)
-- Name: sessions sessions_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sessions
    ADD CONSTRAINT sessions_pkey PRIMARY KEY (id);


--
-- TOC entry 3905 (class 2606 OID 16804)
-- Name: sso_domains sso_domains_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sso_domains
    ADD CONSTRAINT sso_domains_pkey PRIMARY KEY (id);


--
-- TOC entry 3900 (class 2606 OID 16795)
-- Name: sso_providers sso_providers_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sso_providers
    ADD CONSTRAINT sso_providers_pkey PRIMARY KEY (id);


--
-- TOC entry 3850 (class 2606 OID 16877)
-- Name: users users_phone_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.users
    ADD CONSTRAINT users_phone_key UNIQUE (phone);


--
-- TOC entry 3852 (class 2606 OID 16501)
-- Name: users users_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- TOC entry 3994 (class 2606 OID 17532)
-- Name: applications applications_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.applications
    ADD CONSTRAINT applications_pkey PRIMARY KEY (id);


--
-- TOC entry 4006 (class 2606 OID 22999)
-- Name: candidates candidates_email_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.candidates
    ADD CONSTRAINT candidates_email_key UNIQUE (email);


--
-- TOC entry 4008 (class 2606 OID 19444)
-- Name: candidates candidates_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.candidates
    ADD CONSTRAINT candidates_pkey PRIMARY KEY (id);


--
-- TOC entry 4015 (class 2606 OID 22975)
-- Name: company_departments company_departments_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.company_departments
    ADD CONSTRAINT company_departments_pkey PRIMARY KEY (id);


--
-- TOC entry 4000 (class 2606 OID 17792)
-- Name: evaluation_assignments_v2 evaluation_assignments_v2_application_id_evaluator_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.evaluation_assignments_v2
    ADD CONSTRAINT evaluation_assignments_v2_application_id_evaluator_id_key UNIQUE (application_id, evaluator_id);


--
-- TOC entry 4002 (class 2606 OID 17790)
-- Name: evaluation_assignments_v2 evaluation_assignments_v2_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.evaluation_assignments_v2
    ADD CONSTRAINT evaluation_assignments_v2_pkey PRIMARY KEY (id);


--
-- TOC entry 4011 (class 2606 OID 22950)
-- Name: evaluations evaluations_application_id_evaluator_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.evaluations
    ADD CONSTRAINT evaluations_application_id_evaluator_id_key UNIQUE (application_id, evaluator_id);


--
-- TOC entry 4013 (class 2606 OID 22948)
-- Name: evaluations evaluations_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.evaluations
    ADD CONSTRAINT evaluations_pkey PRIMARY KEY (id);


--
-- TOC entry 3992 (class 2606 OID 17516)
-- Name: jobs jobs_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.jobs
    ADD CONSTRAINT jobs_pkey PRIMARY KEY (id);


--
-- TOC entry 4004 (class 2606 OID 19197)
-- Name: plans plans_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.plans
    ADD CONSTRAINT plans_pkey PRIMARY KEY (id);


--
-- TOC entry 3996 (class 2606 OID 17760)
-- Name: tenants tenants_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tenants
    ADD CONSTRAINT tenants_pkey PRIMARY KEY (id);


--
-- TOC entry 3998 (class 2606 OID 17770)
-- Name: user_profiles user_profiles_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_profiles
    ADD CONSTRAINT user_profiles_pkey PRIMARY KEY (id);


--
-- TOC entry 3988 (class 2606 OID 17489)
-- Name: users users_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- TOC entry 3986 (class 2606 OID 17479)
-- Name: messages messages_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_realtime_admin
--

ALTER TABLE ONLY realtime.messages
    ADD CONSTRAINT messages_pkey PRIMARY KEY (id, inserted_at);


--
-- TOC entry 3982 (class 2606 OID 17333)
-- Name: subscription pk_subscription; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
--

ALTER TABLE ONLY realtime.subscription
    ADD CONSTRAINT pk_subscription PRIMARY KEY (id);


--
-- TOC entry 3948 (class 2606 OID 17080)
-- Name: schema_migrations schema_migrations_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
--

ALTER TABLE ONLY realtime.schema_migrations
    ADD CONSTRAINT schema_migrations_pkey PRIMARY KEY (version);


--
-- TOC entry 3973 (class 2606 OID 17306)
-- Name: buckets_analytics buckets_analytics_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.buckets_analytics
    ADD CONSTRAINT buckets_analytics_pkey PRIMARY KEY (id);


--
-- TOC entry 3955 (class 2606 OID 17097)
-- Name: buckets buckets_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.buckets
    ADD CONSTRAINT buckets_pkey PRIMARY KEY (id);


--
-- TOC entry 3976 (class 2606 OID 17282)
-- Name: buckets_vectors buckets_vectors_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.buckets_vectors
    ADD CONSTRAINT buckets_vectors_pkey PRIMARY KEY (id);


--
-- TOC entry 3950 (class 2606 OID 17088)
-- Name: migrations migrations_name_key; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.migrations
    ADD CONSTRAINT migrations_name_key UNIQUE (name);


--
-- TOC entry 3952 (class 2606 OID 17086)
-- Name: migrations migrations_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.migrations
    ADD CONSTRAINT migrations_pkey PRIMARY KEY (id);


--
-- TOC entry 3963 (class 2606 OID 17109)
-- Name: objects objects_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.objects
    ADD CONSTRAINT objects_pkey PRIMARY KEY (id);


--
-- TOC entry 3971 (class 2606 OID 17211)
-- Name: prefixes prefixes_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.prefixes
    ADD CONSTRAINT prefixes_pkey PRIMARY KEY (bucket_id, level, name);


--
-- TOC entry 3968 (class 2606 OID 17172)
-- Name: s3_multipart_uploads_parts s3_multipart_uploads_parts_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads_parts
    ADD CONSTRAINT s3_multipart_uploads_parts_pkey PRIMARY KEY (id);


--
-- TOC entry 3966 (class 2606 OID 17157)
-- Name: s3_multipart_uploads s3_multipart_uploads_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads
    ADD CONSTRAINT s3_multipart_uploads_pkey PRIMARY KEY (id);


--
-- TOC entry 3979 (class 2606 OID 17292)
-- Name: vector_indexes vector_indexes_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.vector_indexes
    ADD CONSTRAINT vector_indexes_pkey PRIMARY KEY (id);


--
-- TOC entry 3866 (class 1259 OID 16532)
-- Name: audit_logs_instance_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX audit_logs_instance_id_idx ON auth.audit_log_entries USING btree (instance_id);


--
-- TOC entry 3840 (class 1259 OID 16704)
-- Name: confirmation_token_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX confirmation_token_idx ON auth.users USING btree (confirmation_token) WHERE ((confirmation_token)::text !~ '^[0-9 ]*$'::text);


--
-- TOC entry 3841 (class 1259 OID 16706)
-- Name: email_change_token_current_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX email_change_token_current_idx ON auth.users USING btree (email_change_token_current) WHERE ((email_change_token_current)::text !~ '^[0-9 ]*$'::text);


--
-- TOC entry 3842 (class 1259 OID 16707)
-- Name: email_change_token_new_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX email_change_token_new_idx ON auth.users USING btree (email_change_token_new) WHERE ((email_change_token_new)::text !~ '^[0-9 ]*$'::text);


--
-- TOC entry 3884 (class 1259 OID 16785)
-- Name: factor_id_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX factor_id_created_at_idx ON auth.mfa_factors USING btree (user_id, created_at);


--
-- TOC entry 3917 (class 1259 OID 16893)
-- Name: flow_state_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX flow_state_created_at_idx ON auth.flow_state USING btree (created_at DESC);


--
-- TOC entry 3872 (class 1259 OID 16873)
-- Name: identities_email_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX identities_email_idx ON auth.identities USING btree (email text_pattern_ops);


--
-- TOC entry 4515 (class 0 OID 0)
-- Dependencies: 3872
-- Name: INDEX identities_email_idx; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON INDEX auth.identities_email_idx IS 'Auth: Ensures indexed queries on the email column';


--
-- TOC entry 3877 (class 1259 OID 16701)
-- Name: identities_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX identities_user_id_idx ON auth.identities USING btree (user_id);


--
-- TOC entry 3920 (class 1259 OID 16890)
-- Name: idx_auth_code; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX idx_auth_code ON auth.flow_state USING btree (auth_code);


--
-- TOC entry 3944 (class 1259 OID 17075)
-- Name: idx_oauth_client_states_created_at; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX idx_oauth_client_states_created_at ON auth.oauth_client_states USING btree (created_at);


--
-- TOC entry 3921 (class 1259 OID 16891)
-- Name: idx_user_id_auth_method; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX idx_user_id_auth_method ON auth.flow_state USING btree (user_id, authentication_method);


--
-- TOC entry 3892 (class 1259 OID 16896)
-- Name: mfa_challenge_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX mfa_challenge_created_at_idx ON auth.mfa_challenges USING btree (created_at DESC);


--
-- TOC entry 3889 (class 1259 OID 16757)
-- Name: mfa_factors_user_friendly_name_unique; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX mfa_factors_user_friendly_name_unique ON auth.mfa_factors USING btree (friendly_name, user_id) WHERE (TRIM(BOTH FROM friendly_name) <> ''::text);


--
-- TOC entry 3890 (class 1259 OID 16902)
-- Name: mfa_factors_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX mfa_factors_user_id_idx ON auth.mfa_factors USING btree (user_id);


--
-- TOC entry 3930 (class 1259 OID 17027)
-- Name: oauth_auth_pending_exp_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX oauth_auth_pending_exp_idx ON auth.oauth_authorizations USING btree (expires_at) WHERE (status = 'pending'::auth.oauth_authorization_status);


--
-- TOC entry 3927 (class 1259 OID 16980)
-- Name: oauth_clients_deleted_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX oauth_clients_deleted_at_idx ON auth.oauth_clients USING btree (deleted_at);


--
-- TOC entry 3937 (class 1259 OID 17053)
-- Name: oauth_consents_active_client_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX oauth_consents_active_client_idx ON auth.oauth_consents USING btree (client_id) WHERE (revoked_at IS NULL);


--
-- TOC entry 3938 (class 1259 OID 17051)
-- Name: oauth_consents_active_user_client_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX oauth_consents_active_user_client_idx ON auth.oauth_consents USING btree (user_id, client_id) WHERE (revoked_at IS NULL);


--
-- TOC entry 3943 (class 1259 OID 17052)
-- Name: oauth_consents_user_order_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX oauth_consents_user_order_idx ON auth.oauth_consents USING btree (user_id, granted_at DESC);


--
-- TOC entry 3924 (class 1259 OID 16949)
-- Name: one_time_tokens_relates_to_hash_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX one_time_tokens_relates_to_hash_idx ON auth.one_time_tokens USING hash (relates_to);


--
-- TOC entry 3925 (class 1259 OID 16948)
-- Name: one_time_tokens_token_hash_hash_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX one_time_tokens_token_hash_hash_idx ON auth.one_time_tokens USING hash (token_hash);


--
-- TOC entry 3926 (class 1259 OID 16950)
-- Name: one_time_tokens_user_id_token_type_key; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX one_time_tokens_user_id_token_type_key ON auth.one_time_tokens USING btree (user_id, token_type);


--
-- TOC entry 3843 (class 1259 OID 16708)
-- Name: reauthentication_token_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX reauthentication_token_idx ON auth.users USING btree (reauthentication_token) WHERE ((reauthentication_token)::text !~ '^[0-9 ]*$'::text);


--
-- TOC entry 3844 (class 1259 OID 16705)
-- Name: recovery_token_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX recovery_token_idx ON auth.users USING btree (recovery_token) WHERE ((recovery_token)::text !~ '^[0-9 ]*$'::text);


--
-- TOC entry 3853 (class 1259 OID 16515)
-- Name: refresh_tokens_instance_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_instance_id_idx ON auth.refresh_tokens USING btree (instance_id);


--
-- TOC entry 3854 (class 1259 OID 16516)
-- Name: refresh_tokens_instance_id_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_instance_id_user_id_idx ON auth.refresh_tokens USING btree (instance_id, user_id);


--
-- TOC entry 3855 (class 1259 OID 16700)
-- Name: refresh_tokens_parent_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_parent_idx ON auth.refresh_tokens USING btree (parent);


--
-- TOC entry 3858 (class 1259 OID 16787)
-- Name: refresh_tokens_session_id_revoked_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_session_id_revoked_idx ON auth.refresh_tokens USING btree (session_id, revoked);


--
-- TOC entry 3861 (class 1259 OID 16892)
-- Name: refresh_tokens_updated_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX refresh_tokens_updated_at_idx ON auth.refresh_tokens USING btree (updated_at DESC);


--
-- TOC entry 3911 (class 1259 OID 16829)
-- Name: saml_providers_sso_provider_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX saml_providers_sso_provider_id_idx ON auth.saml_providers USING btree (sso_provider_id);


--
-- TOC entry 3912 (class 1259 OID 16894)
-- Name: saml_relay_states_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX saml_relay_states_created_at_idx ON auth.saml_relay_states USING btree (created_at DESC);


--
-- TOC entry 3913 (class 1259 OID 16844)
-- Name: saml_relay_states_for_email_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX saml_relay_states_for_email_idx ON auth.saml_relay_states USING btree (for_email);


--
-- TOC entry 3916 (class 1259 OID 16843)
-- Name: saml_relay_states_sso_provider_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX saml_relay_states_sso_provider_id_idx ON auth.saml_relay_states USING btree (sso_provider_id);


--
-- TOC entry 3878 (class 1259 OID 16895)
-- Name: sessions_not_after_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX sessions_not_after_idx ON auth.sessions USING btree (not_after DESC);


--
-- TOC entry 3879 (class 1259 OID 17065)
-- Name: sessions_oauth_client_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX sessions_oauth_client_id_idx ON auth.sessions USING btree (oauth_client_id);


--
-- TOC entry 3882 (class 1259 OID 16786)
-- Name: sessions_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX sessions_user_id_idx ON auth.sessions USING btree (user_id);


--
-- TOC entry 3903 (class 1259 OID 16811)
-- Name: sso_domains_domain_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX sso_domains_domain_idx ON auth.sso_domains USING btree (lower(domain));


--
-- TOC entry 3906 (class 1259 OID 16810)
-- Name: sso_domains_sso_provider_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX sso_domains_sso_provider_id_idx ON auth.sso_domains USING btree (sso_provider_id);


--
-- TOC entry 3901 (class 1259 OID 16796)
-- Name: sso_providers_resource_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX sso_providers_resource_id_idx ON auth.sso_providers USING btree (lower(resource_id));


--
-- TOC entry 3902 (class 1259 OID 16958)
-- Name: sso_providers_resource_id_pattern_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX sso_providers_resource_id_pattern_idx ON auth.sso_providers USING btree (resource_id text_pattern_ops);


--
-- TOC entry 3891 (class 1259 OID 16955)
-- Name: unique_phone_factor_per_user; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX unique_phone_factor_per_user ON auth.mfa_factors USING btree (user_id, phone);


--
-- TOC entry 3883 (class 1259 OID 16784)
-- Name: user_id_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX user_id_created_at_idx ON auth.sessions USING btree (user_id, created_at);


--
-- TOC entry 3845 (class 1259 OID 16864)
-- Name: users_email_partial_key; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE UNIQUE INDEX users_email_partial_key ON auth.users USING btree (email) WHERE (is_sso_user = false);


--
-- TOC entry 4516 (class 0 OID 0)
-- Dependencies: 3845
-- Name: INDEX users_email_partial_key; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
--

COMMENT ON INDEX auth.users_email_partial_key IS 'Auth: A partial unique index that applies only when is_sso_user is false';


--
-- TOC entry 3846 (class 1259 OID 16702)
-- Name: users_instance_id_email_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX users_instance_id_email_idx ON auth.users USING btree (instance_id, lower((email)::text));


--
-- TOC entry 3847 (class 1259 OID 16505)
-- Name: users_instance_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX users_instance_id_idx ON auth.users USING btree (instance_id);


--
-- TOC entry 3848 (class 1259 OID 16919)
-- Name: users_is_anonymous_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
--

CREATE INDEX users_is_anonymous_idx ON auth.users USING btree (is_anonymous);


--
-- TOC entry 4009 (class 1259 OID 19445)
-- Name: idx_candidates_email; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_candidates_email ON public.candidates USING btree (email);


--
-- TOC entry 3989 (class 1259 OID 22851)
-- Name: idx_jobs_status; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_jobs_status ON public.jobs USING btree (status);


--
-- TOC entry 3990 (class 1259 OID 19152)
-- Name: idx_jobs_tenant; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_jobs_tenant ON public.jobs USING btree ("tenantId");


--
-- TOC entry 3980 (class 1259 OID 17480)
-- Name: ix_realtime_subscription_entity; Type: INDEX; Schema: realtime; Owner: supabase_admin
--

CREATE INDEX ix_realtime_subscription_entity ON realtime.subscription USING btree (entity);


--
-- TOC entry 3984 (class 1259 OID 17481)
-- Name: messages_inserted_at_topic_index; Type: INDEX; Schema: realtime; Owner: supabase_realtime_admin
--

CREATE INDEX messages_inserted_at_topic_index ON ONLY realtime.messages USING btree (inserted_at DESC, topic) WHERE ((extension = 'broadcast'::text) AND (private IS TRUE));


--
-- TOC entry 3983 (class 1259 OID 17382)
-- Name: subscription_subscription_id_entity_filters_key; Type: INDEX; Schema: realtime; Owner: supabase_admin
--

CREATE UNIQUE INDEX subscription_subscription_id_entity_filters_key ON realtime.subscription USING btree (subscription_id, entity, filters);


--
-- TOC entry 3953 (class 1259 OID 17098)
-- Name: bname; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX bname ON storage.buckets USING btree (name);


--
-- TOC entry 3956 (class 1259 OID 17115)
-- Name: bucketid_objname; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX bucketid_objname ON storage.objects USING btree (bucket_id, name);


--
-- TOC entry 3974 (class 1259 OID 17307)
-- Name: buckets_analytics_unique_name_idx; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX buckets_analytics_unique_name_idx ON storage.buckets_analytics USING btree (name) WHERE (deleted_at IS NULL);


--
-- TOC entry 3964 (class 1259 OID 17183)
-- Name: idx_multipart_uploads_list; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX idx_multipart_uploads_list ON storage.s3_multipart_uploads USING btree (bucket_id, key, created_at);


--
-- TOC entry 3957 (class 1259 OID 17229)
-- Name: idx_name_bucket_level_unique; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX idx_name_bucket_level_unique ON storage.objects USING btree (name COLLATE "C", bucket_id, level);


--
-- TOC entry 3958 (class 1259 OID 17148)
-- Name: idx_objects_bucket_id_name; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX idx_objects_bucket_id_name ON storage.objects USING btree (bucket_id, name COLLATE "C");


--
-- TOC entry 3959 (class 1259 OID 17231)
-- Name: idx_objects_lower_name; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX idx_objects_lower_name ON storage.objects USING btree ((path_tokens[level]), lower(name) text_pattern_ops, bucket_id, level);


--
-- TOC entry 3969 (class 1259 OID 17232)
-- Name: idx_prefixes_lower_name; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX idx_prefixes_lower_name ON storage.prefixes USING btree (bucket_id, level, ((string_to_array(name, '/'::text))[level]), lower(name) text_pattern_ops);


--
-- TOC entry 3960 (class 1259 OID 17116)
-- Name: name_prefix_search; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE INDEX name_prefix_search ON storage.objects USING btree (name text_pattern_ops);


--
-- TOC entry 3961 (class 1259 OID 17230)
-- Name: objects_bucket_id_level_idx; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX objects_bucket_id_level_idx ON storage.objects USING btree (bucket_id, level, name COLLATE "C");


--
-- TOC entry 3977 (class 1259 OID 17298)
-- Name: vector_indexes_name_bucket_id_idx; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
--

CREATE UNIQUE INDEX vector_indexes_name_bucket_id_idx ON storage.vector_indexes USING btree (name, bucket_id);


--
-- TOC entry 4051 (class 2620 OID 17539)
-- Name: users on_auth_user_created; Type: TRIGGER; Schema: auth; Owner: supabase_auth_admin
--

CREATE TRIGGER on_auth_user_created AFTER INSERT ON auth.users FOR EACH ROW EXECUTE FUNCTION public.handle_new_user();


--
-- TOC entry 4059 (class 2620 OID 17338)
-- Name: subscription tr_check_filters; Type: TRIGGER; Schema: realtime; Owner: supabase_admin
--

CREATE TRIGGER tr_check_filters BEFORE INSERT OR UPDATE ON realtime.subscription FOR EACH ROW EXECUTE FUNCTION realtime.subscription_check_filters();


--
-- TOC entry 4052 (class 2620 OID 17239)
-- Name: buckets enforce_bucket_name_length_trigger; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER enforce_bucket_name_length_trigger BEFORE INSERT OR UPDATE OF name ON storage.buckets FOR EACH ROW EXECUTE FUNCTION storage.enforce_bucket_name_length();


--
-- TOC entry 4053 (class 2620 OID 17269)
-- Name: objects objects_delete_delete_prefix; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER objects_delete_delete_prefix AFTER DELETE ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.delete_prefix_hierarchy_trigger();


--
-- TOC entry 4054 (class 2620 OID 17225)
-- Name: objects objects_insert_create_prefix; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER objects_insert_create_prefix BEFORE INSERT ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.objects_insert_prefix_trigger();


--
-- TOC entry 4055 (class 2620 OID 17268)
-- Name: objects objects_update_create_prefix; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER objects_update_create_prefix BEFORE UPDATE ON storage.objects FOR EACH ROW WHEN (((new.name <> old.name) OR (new.bucket_id <> old.bucket_id))) EXECUTE FUNCTION storage.objects_update_prefix_trigger();


--
-- TOC entry 4057 (class 2620 OID 17235)
-- Name: prefixes prefixes_create_hierarchy; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER prefixes_create_hierarchy BEFORE INSERT ON storage.prefixes FOR EACH ROW WHEN ((pg_trigger_depth() < 1)) EXECUTE FUNCTION storage.prefixes_insert_trigger();


--
-- TOC entry 4058 (class 2620 OID 17270)
-- Name: prefixes prefixes_delete_hierarchy; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER prefixes_delete_hierarchy AFTER DELETE ON storage.prefixes FOR EACH ROW EXECUTE FUNCTION storage.delete_prefix_hierarchy_trigger();


--
-- TOC entry 4056 (class 2620 OID 17136)
-- Name: objects update_objects_updated_at; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
--

CREATE TRIGGER update_objects_updated_at BEFORE UPDATE ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.update_updated_at_column();


--
-- TOC entry 4017 (class 2606 OID 16688)
-- Name: identities identities_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.identities
    ADD CONSTRAINT identities_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4022 (class 2606 OID 16777)
-- Name: mfa_amr_claims mfa_amr_claims_session_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_amr_claims
    ADD CONSTRAINT mfa_amr_claims_session_id_fkey FOREIGN KEY (session_id) REFERENCES auth.sessions(id) ON DELETE CASCADE;


--
-- TOC entry 4021 (class 2606 OID 16765)
-- Name: mfa_challenges mfa_challenges_auth_factor_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_challenges
    ADD CONSTRAINT mfa_challenges_auth_factor_id_fkey FOREIGN KEY (factor_id) REFERENCES auth.mfa_factors(id) ON DELETE CASCADE;


--
-- TOC entry 4020 (class 2606 OID 16752)
-- Name: mfa_factors mfa_factors_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.mfa_factors
    ADD CONSTRAINT mfa_factors_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4028 (class 2606 OID 17017)
-- Name: oauth_authorizations oauth_authorizations_client_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_authorizations
    ADD CONSTRAINT oauth_authorizations_client_id_fkey FOREIGN KEY (client_id) REFERENCES auth.oauth_clients(id) ON DELETE CASCADE;


--
-- TOC entry 4029 (class 2606 OID 17022)
-- Name: oauth_authorizations oauth_authorizations_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_authorizations
    ADD CONSTRAINT oauth_authorizations_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4030 (class 2606 OID 17046)
-- Name: oauth_consents oauth_consents_client_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_consents
    ADD CONSTRAINT oauth_consents_client_id_fkey FOREIGN KEY (client_id) REFERENCES auth.oauth_clients(id) ON DELETE CASCADE;


--
-- TOC entry 4031 (class 2606 OID 17041)
-- Name: oauth_consents oauth_consents_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.oauth_consents
    ADD CONSTRAINT oauth_consents_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4027 (class 2606 OID 16943)
-- Name: one_time_tokens one_time_tokens_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.one_time_tokens
    ADD CONSTRAINT one_time_tokens_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4016 (class 2606 OID 16721)
-- Name: refresh_tokens refresh_tokens_session_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.refresh_tokens
    ADD CONSTRAINT refresh_tokens_session_id_fkey FOREIGN KEY (session_id) REFERENCES auth.sessions(id) ON DELETE CASCADE;


--
-- TOC entry 4024 (class 2606 OID 16824)
-- Name: saml_providers saml_providers_sso_provider_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_providers
    ADD CONSTRAINT saml_providers_sso_provider_id_fkey FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers(id) ON DELETE CASCADE;


--
-- TOC entry 4025 (class 2606 OID 16897)
-- Name: saml_relay_states saml_relay_states_flow_state_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_relay_states
    ADD CONSTRAINT saml_relay_states_flow_state_id_fkey FOREIGN KEY (flow_state_id) REFERENCES auth.flow_state(id) ON DELETE CASCADE;


--
-- TOC entry 4026 (class 2606 OID 16838)
-- Name: saml_relay_states saml_relay_states_sso_provider_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.saml_relay_states
    ADD CONSTRAINT saml_relay_states_sso_provider_id_fkey FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers(id) ON DELETE CASCADE;


--
-- TOC entry 4018 (class 2606 OID 17060)
-- Name: sessions sessions_oauth_client_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sessions
    ADD CONSTRAINT sessions_oauth_client_id_fkey FOREIGN KEY (oauth_client_id) REFERENCES auth.oauth_clients(id) ON DELETE CASCADE;


--
-- TOC entry 4019 (class 2606 OID 16716)
-- Name: sessions sessions_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sessions
    ADD CONSTRAINT sessions_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;


--
-- TOC entry 4023 (class 2606 OID 16805)
-- Name: sso_domains sso_domains_sso_provider_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE ONLY auth.sso_domains
    ADD CONSTRAINT sso_domains_sso_provider_id_fkey FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers(id) ON DELETE CASCADE;


--
-- TOC entry 4042 (class 2606 OID 23020)
-- Name: applications applications_candidate_link; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.applications
    ADD CONSTRAINT applications_candidate_link FOREIGN KEY ("candidateId") REFERENCES public.candidates(id) ON DELETE CASCADE;


--
-- TOC entry 4043 (class 2606 OID 23015)
-- Name: applications applications_job_link; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.applications
    ADD CONSTRAINT applications_job_link FOREIGN KEY ("jobId") REFERENCES public.jobs(id) ON DELETE CASCADE;


--
-- TOC entry 4044 (class 2606 OID 19147)
-- Name: applications applications_tenantId_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.applications
    ADD CONSTRAINT "applications_tenantId_fkey" FOREIGN KEY ("tenantId") REFERENCES public.tenants(id);


--
-- TOC entry 4050 (class 2606 OID 22976)
-- Name: company_departments company_departments_tenantId_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.company_departments
    ADD CONSTRAINT "company_departments_tenantId_fkey" FOREIGN KEY ("tenantId") REFERENCES public.tenants(id);


--
-- TOC entry 4048 (class 2606 OID 17793)
-- Name: evaluation_assignments_v2 evaluation_assignments_v2_application_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.evaluation_assignments_v2
    ADD CONSTRAINT evaluation_assignments_v2_application_id_fkey FOREIGN KEY (application_id) REFERENCES public.applications(id) ON DELETE CASCADE;


--
-- TOC entry 4049 (class 2606 OID 17798)
-- Name: evaluation_assignments_v2 evaluation_assignments_v2_evaluator_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.evaluation_assignments_v2
    ADD CONSTRAINT evaluation_assignments_v2_evaluator_id_fkey FOREIGN KEY (evaluator_id) REFERENCES public.user_profiles(id) ON DELETE CASCADE;


--
-- TOC entry 4040 (class 2606 OID 19139)
-- Name: jobs jobs_createdBy_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.jobs
    ADD CONSTRAINT "jobs_createdBy_fkey" FOREIGN KEY ("createdBy") REFERENCES public.user_profiles(id);


--
-- TOC entry 4041 (class 2606 OID 19160)
-- Name: jobs jobs_tenantid_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.jobs
    ADD CONSTRAINT jobs_tenantid_fkey FOREIGN KEY ("tenantId") REFERENCES public.tenants(id);


--
-- TOC entry 4045 (class 2606 OID 19199)
-- Name: tenants tenants_planId_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tenants
    ADD CONSTRAINT "tenants_planId_fkey" FOREIGN KEY ("planId") REFERENCES public.plans(id);


--
-- TOC entry 4046 (class 2606 OID 17771)
-- Name: user_profiles user_profiles_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_profiles
    ADD CONSTRAINT user_profiles_id_fkey FOREIGN KEY (id) REFERENCES auth.users(id);


--
-- TOC entry 4047 (class 2606 OID 19354)
-- Name: user_profiles user_profiles_tenant_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_profiles
    ADD CONSTRAINT user_profiles_tenant_id_fkey FOREIGN KEY ("tenantId") REFERENCES public.tenants(id);


--
-- TOC entry 4038 (class 2606 OID 17490)
-- Name: users users_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_id_fkey FOREIGN KEY (id) REFERENCES auth.users(id);


--
-- TOC entry 4039 (class 2606 OID 19349)
-- Name: users users_tenantid_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_tenantid_fkey FOREIGN KEY ("tenantId") REFERENCES public.tenants(id);


--
-- TOC entry 4032 (class 2606 OID 17110)
-- Name: objects objects_bucketId_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.objects
    ADD CONSTRAINT "objects_bucketId_fkey" FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id);


--
-- TOC entry 4036 (class 2606 OID 17212)
-- Name: prefixes prefixes_bucketId_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.prefixes
    ADD CONSTRAINT "prefixes_bucketId_fkey" FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id);


--
-- TOC entry 4033 (class 2606 OID 17158)
-- Name: s3_multipart_uploads s3_multipart_uploads_bucket_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads
    ADD CONSTRAINT s3_multipart_uploads_bucket_id_fkey FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id);


--
-- TOC entry 4034 (class 2606 OID 17178)
-- Name: s3_multipart_uploads_parts s3_multipart_uploads_parts_bucket_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads_parts
    ADD CONSTRAINT s3_multipart_uploads_parts_bucket_id_fkey FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id);


--
-- TOC entry 4035 (class 2606 OID 17173)
-- Name: s3_multipart_uploads_parts s3_multipart_uploads_parts_upload_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.s3_multipart_uploads_parts
    ADD CONSTRAINT s3_multipart_uploads_parts_upload_id_fkey FOREIGN KEY (upload_id) REFERENCES storage.s3_multipart_uploads(id) ON DELETE CASCADE;


--
-- TOC entry 4037 (class 2606 OID 17293)
-- Name: vector_indexes vector_indexes_bucket_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE ONLY storage.vector_indexes
    ADD CONSTRAINT vector_indexes_bucket_id_fkey FOREIGN KEY (bucket_id) REFERENCES storage.buckets_vectors(id);


--
-- TOC entry 4211 (class 0 OID 16525)
-- Dependencies: 348
-- Name: audit_log_entries; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.audit_log_entries ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4222 (class 0 OID 16883)
-- Dependencies: 362
-- Name: flow_state; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.flow_state ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4213 (class 0 OID 16681)
-- Dependencies: 353
-- Name: identities; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.identities ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4210 (class 0 OID 16518)
-- Dependencies: 347
-- Name: instances; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.instances ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4217 (class 0 OID 16770)
-- Dependencies: 357
-- Name: mfa_amr_claims; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.mfa_amr_claims ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4216 (class 0 OID 16758)
-- Dependencies: 356
-- Name: mfa_challenges; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.mfa_challenges ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4215 (class 0 OID 16745)
-- Dependencies: 355
-- Name: mfa_factors; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.mfa_factors ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4223 (class 0 OID 16933)
-- Dependencies: 363
-- Name: one_time_tokens; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.one_time_tokens ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4209 (class 0 OID 16507)
-- Dependencies: 346
-- Name: refresh_tokens; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.refresh_tokens ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4220 (class 0 OID 16812)
-- Dependencies: 360
-- Name: saml_providers; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.saml_providers ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4221 (class 0 OID 16830)
-- Dependencies: 361
-- Name: saml_relay_states; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.saml_relay_states ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4212 (class 0 OID 16533)
-- Dependencies: 349
-- Name: schema_migrations; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.schema_migrations ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4214 (class 0 OID 16711)
-- Dependencies: 354
-- Name: sessions; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.sessions ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4219 (class 0 OID 16797)
-- Dependencies: 359
-- Name: sso_domains; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.sso_domains ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4218 (class 0 OID 16788)
-- Dependencies: 358
-- Name: sso_providers; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.sso_providers ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4208 (class 0 OID 16495)
-- Dependencies: 344
-- Name: users; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
--

ALTER TABLE auth.users ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4267 (class 3256 OID 22959)
-- Name: jobs Acesso total a jobs; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total a jobs" ON public.jobs USING (true) WITH CHECK (true);


--
-- TOC entry 4259 (class 3256 OID 22928)
-- Name: jobs Acesso total a jobs do tenant; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total a jobs do tenant" ON public.jobs USING (("tenantId" IN ( SELECT user_profiles."tenantId"
   FROM public.user_profiles
  WHERE (user_profiles.id = auth.uid()))));


--
-- TOC entry 4266 (class 3256 OID 22958)
-- Name: user_profiles Acesso total a perfis; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total a perfis" ON public.user_profiles USING (true) WITH CHECK (true);


--
-- TOC entry 4265 (class 3256 OID 22957)
-- Name: tenants Acesso total a tenants; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total a tenants" ON public.tenants USING (true) WITH CHECK (true);


--
-- TOC entry 4272 (class 3256 OID 22985)
-- Name: applications Acesso total applications; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total applications" ON public.applications USING ((auth.role() = 'authenticated'::text));


--
-- TOC entry 4271 (class 3256 OID 22984)
-- Name: candidates Acesso total candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total candidates" ON public.candidates USING ((auth.role() = 'authenticated'::text));


--
-- TOC entry 4269 (class 3256 OID 22982)
-- Name: company_departments Acesso total departamentos; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total departamentos" ON public.company_departments USING ((auth.role() = 'authenticated'::text));


--
-- TOC entry 4270 (class 3256 OID 22983)
-- Name: jobs Acesso total jobs; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total jobs" ON public.jobs USING ((auth.role() = 'authenticated'::text));


--
-- TOC entry 4268 (class 3256 OID 22981)
-- Name: tenants Acesso total tenants; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Acesso total tenants" ON public.tenants USING ((auth.role() = 'authenticated'::text));


--
-- TOC entry 4279 (class 3256 OID 24181)
-- Name: users Admins can update team members; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Admins can update team members" ON public.users FOR UPDATE USING (((auth.uid() IN ( SELECT users_1.id
   FROM public.users users_1
  WHERE (users_1."isAdmin" = true))) AND ("tenantId" = ( SELECT users_1."tenantId"
   FROM public.users users_1
  WHERE (users_1.id = auth.uid())))));


--
-- TOC entry 4278 (class 3256 OID 24180)
-- Name: users Admins can view team members; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Admins can view team members" ON public.users FOR SELECT USING (((auth.uid() IN ( SELECT users_1.id
   FROM public.users users_1
  WHERE (users_1."isAdmin" = true))) AND ("tenantId" = ( SELECT users_1."tenantId"
   FROM public.users users_1
  WHERE (users_1.id = auth.uid())))));


--
-- TOC entry 4243 (class 3256 OID 19230)
-- Name: plans Anyone can read plans; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Anyone can read plans" ON public.plans FOR SELECT USING (true);


--
-- TOC entry 4247 (class 3256 OID 19447)
-- Name: candidates Auth Read Candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Auth Read Candidates" ON public.candidates FOR SELECT TO authenticated USING (true);


--
-- TOC entry 4280 (class 3256 OID 24211)
-- Name: plans Authenticated can read plans; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Authenticated can read plans" ON public.plans FOR SELECT TO authenticated USING (true);


--
-- TOC entry 4258 (class 3256 OID 22923)
-- Name: jobs Criar jobs no tenant; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Criar jobs no tenant" ON public.jobs FOR INSERT WITH CHECK (("tenantId" IN ( SELECT user_profiles."tenantId"
   FROM public.user_profiles
  WHERE (user_profiles.id = auth.uid()))));


--
-- TOC entry 4276 (class 3256 OID 22992)
-- Name: evaluations Editar minha avaliacao; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Editar minha avaliacao" ON public.evaluations FOR UPDATE USING ((evaluator_id = auth.uid())) WITH CHECK ((evaluator_id = auth.uid()));


--
-- TOC entry 4264 (class 3256 OID 22954)
-- Name: evaluations Escrever avaliacoes; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Escrever avaliacoes" ON public.evaluations FOR INSERT WITH CHECK ((auth.uid() IS NOT NULL));


--
-- TOC entry 4263 (class 3256 OID 22952)
-- Name: jobs Escrever jobs; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Escrever jobs" ON public.jobs FOR INSERT WITH CHECK ((auth.uid() IS NOT NULL));


--
-- TOC entry 4275 (class 3256 OID 22991)
-- Name: evaluations Inserir minha avaliacao; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Inserir minha avaliacao" ON public.evaluations FOR INSERT WITH CHECK ((evaluator_id = auth.uid()));


--
-- TOC entry 4274 (class 3256 OID 22990)
-- Name: evaluations Ler avaliacoes; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Ler avaliacoes" ON public.evaluations FOR SELECT USING ((auth.role() = 'authenticated'::text));


--
-- TOC entry 4262 (class 3256 OID 22951)
-- Name: jobs Ler jobs; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Ler jobs" ON public.jobs FOR SELECT USING (true);


--
-- TOC entry 4248 (class 3256 OID 22919)
-- Name: jobs Ler jobs do tenant; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Ler jobs do tenant" ON public.jobs FOR SELECT USING (("tenantId" IN ( SELECT user_profiles."tenantId"
   FROM public.user_profiles
  WHERE (user_profiles.id = auth.uid()))));


--
-- TOC entry 4273 (class 3256 OID 22989)
-- Name: plans Ler planos; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Ler planos" ON public.plans FOR SELECT USING (true);


--
-- TOC entry 4257 (class 3256 OID 22922)
-- Name: user_profiles Ler proprio perfil; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Ler proprio perfil" ON public.user_profiles FOR SELECT USING ((id = auth.uid()));


--
-- TOC entry 4256 (class 3256 OID 22921)
-- Name: tenants Ler tenants vinculados; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Ler tenants vinculados" ON public.tenants FOR SELECT USING ((id IN ( SELECT user_profiles."tenantId"
   FROM public.user_profiles
  WHERE (user_profiles.id = auth.uid()))));


--
-- TOC entry 4246 (class 3256 OID 19446)
-- Name: candidates Public Insert Candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Public Insert Candidates" ON public.candidates FOR INSERT TO authenticated, anon WITH CHECK (true);


--
-- TOC entry 4252 (class 3256 OID 22997)
-- Name: applications Public insert applications; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Public insert applications" ON public.applications FOR INSERT TO anon WITH CHECK (true);


--
-- TOC entry 4249 (class 3256 OID 22994)
-- Name: candidates Public insert candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Public insert candidates" ON public.candidates FOR INSERT TO anon WITH CHECK (true);


--
-- TOC entry 4277 (class 3256 OID 22993)
-- Name: jobs Public read jobs; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Public read jobs" ON public.jobs FOR SELECT TO anon USING (true);


--
-- TOC entry 4250 (class 3256 OID 22995)
-- Name: candidates Public select candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Public select candidates" ON public.candidates FOR SELECT TO anon USING (true);


--
-- TOC entry 4251 (class 3256 OID 22996)
-- Name: candidates Public update candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Public update candidates" ON public.candidates FOR UPDATE TO anon USING (true);


--
-- TOC entry 4254 (class 3256 OID 23003)
-- Name: applications Recruiters read applications; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Recruiters read applications" ON public.applications FOR SELECT TO authenticated USING (true);


--
-- TOC entry 4253 (class 3256 OID 23002)
-- Name: candidates Recruiters read candidates; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Recruiters read candidates" ON public.candidates FOR SELECT TO authenticated USING (true);


--
-- TOC entry 4242 (class 3256 OID 17803)
-- Name: evaluation_assignments_v2 Users manage own assignments; Type: POLICY; Schema: public; Owner: postgres
--

CREATE POLICY "Users manage own assignments" ON public.evaluation_assignments_v2 USING ((evaluator_id = auth.uid()));


--
-- TOC entry 4235 (class 0 OID 17524)
-- Dependencies: 388
-- Name: applications; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.applications ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4239 (class 0 OID 19435)
-- Dependencies: 393
-- Name: candidates; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.candidates ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4241 (class 0 OID 22968)
-- Dependencies: 396
-- Name: company_departments; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.company_departments ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4237 (class 0 OID 17781)
-- Dependencies: 391
-- Name: evaluation_assignments_v2; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.evaluation_assignments_v2 ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4240 (class 0 OID 22939)
-- Dependencies: 394
-- Name: evaluations; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.evaluations ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4234 (class 0 OID 17508)
-- Dependencies: 386
-- Name: jobs; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.jobs ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4238 (class 0 OID 19187)
-- Dependencies: 392
-- Name: plans; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.plans ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4236 (class 0 OID 17761)
-- Dependencies: 390
-- Name: user_profiles; Type: ROW SECURITY; Schema: public; Owner: postgres
--

ALTER TABLE public.user_profiles ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4233 (class 0 OID 17465)
-- Dependencies: 383
-- Name: messages; Type: ROW SECURITY; Schema: realtime; Owner: supabase_realtime_admin
--

ALTER TABLE realtime.messages ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4245 (class 3256 OID 19388)
-- Name: objects Authenticated Users Read Resumes; Type: POLICY; Schema: storage; Owner: supabase_storage_admin
--

CREATE POLICY "Authenticated Users Read Resumes" ON storage.objects FOR SELECT TO authenticated USING ((bucket_id = 'resumes'::text));


--
-- TOC entry 4261 (class 3256 OID 23001)
-- Name: objects Public Select Resume; Type: POLICY; Schema: storage; Owner: supabase_storage_admin
--

CREATE POLICY "Public Select Resume" ON storage.objects FOR SELECT TO anon USING ((bucket_id = 'resumes'::text));


--
-- TOC entry 4260 (class 3256 OID 23000)
-- Name: objects Public Upload Resume; Type: POLICY; Schema: storage; Owner: supabase_storage_admin
--

CREATE POLICY "Public Upload Resume" ON storage.objects FOR INSERT TO anon WITH CHECK ((bucket_id = 'resumes'::text));


--
-- TOC entry 4244 (class 3256 OID 19387)
-- Name: objects Public Upload Resumes; Type: POLICY; Schema: storage; Owner: supabase_storage_admin
--

CREATE POLICY "Public Upload Resumes" ON storage.objects FOR INSERT WITH CHECK ((bucket_id = 'resumes'::text));


--
-- TOC entry 4255 (class 3256 OID 23004)
-- Name: objects Recruiters read resumes; Type: POLICY; Schema: storage; Owner: supabase_storage_admin
--

CREATE POLICY "Recruiters read resumes" ON storage.objects FOR SELECT TO authenticated USING ((bucket_id = 'resumes'::text));


--
-- TOC entry 4225 (class 0 OID 17089)
-- Dependencies: 370
-- Name: buckets; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.buckets ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4230 (class 0 OID 17246)
-- Dependencies: 375
-- Name: buckets_analytics; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.buckets_analytics ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4231 (class 0 OID 17273)
-- Dependencies: 376
-- Name: buckets_vectors; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.buckets_vectors ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4224 (class 0 OID 17081)
-- Dependencies: 369
-- Name: migrations; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.migrations ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4226 (class 0 OID 17099)
-- Dependencies: 371
-- Name: objects; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.objects ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4229 (class 0 OID 17202)
-- Dependencies: 374
-- Name: prefixes; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.prefixes ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4227 (class 0 OID 17149)
-- Dependencies: 372
-- Name: s3_multipart_uploads; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.s3_multipart_uploads ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4228 (class 0 OID 17163)
-- Dependencies: 373
-- Name: s3_multipart_uploads_parts; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.s3_multipart_uploads_parts ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4232 (class 0 OID 17283)
-- Dependencies: 377
-- Name: vector_indexes; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
--

ALTER TABLE storage.vector_indexes ENABLE ROW LEVEL SECURITY;

--
-- TOC entry 4281 (class 6104 OID 16426)
-- Name: supabase_realtime; Type: PUBLICATION; Schema: -; Owner: postgres
--

CREATE PUBLICATION supabase_realtime WITH (publish = 'insert, update, delete, truncate');


ALTER PUBLICATION supabase_realtime OWNER TO postgres;

--
-- TOC entry 4333 (class 0 OID 0)
-- Dependencies: 37
-- Name: SCHEMA auth; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT USAGE ON SCHEMA auth TO anon;
GRANT USAGE ON SCHEMA auth TO authenticated;
GRANT USAGE ON SCHEMA auth TO service_role;
GRANT ALL ON SCHEMA auth TO supabase_auth_admin;
GRANT ALL ON SCHEMA auth TO dashboard_user;
GRANT USAGE ON SCHEMA auth TO postgres;


--
-- TOC entry 4334 (class 0 OID 0)
-- Dependencies: 23
-- Name: SCHEMA extensions; Type: ACL; Schema: -; Owner: postgres
--

GRANT USAGE ON SCHEMA extensions TO anon;
GRANT USAGE ON SCHEMA extensions TO authenticated;
GRANT USAGE ON SCHEMA extensions TO service_role;
GRANT ALL ON SCHEMA extensions TO dashboard_user;


--
-- TOC entry 4335 (class 0 OID 0)
-- Dependencies: 39
-- Name: SCHEMA public; Type: ACL; Schema: -; Owner: pg_database_owner
--

GRANT USAGE ON SCHEMA public TO postgres;
GRANT USAGE ON SCHEMA public TO anon;
GRANT USAGE ON SCHEMA public TO authenticated;
GRANT USAGE ON SCHEMA public TO service_role;


--
-- TOC entry 4336 (class 0 OID 0)
-- Dependencies: 13
-- Name: SCHEMA realtime; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT USAGE ON SCHEMA realtime TO postgres;
GRANT USAGE ON SCHEMA realtime TO anon;
GRANT USAGE ON SCHEMA realtime TO authenticated;
GRANT USAGE ON SCHEMA realtime TO service_role;
GRANT ALL ON SCHEMA realtime TO supabase_realtime_admin;


--
-- TOC entry 4337 (class 0 OID 0)
-- Dependencies: 38
-- Name: SCHEMA storage; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT USAGE ON SCHEMA storage TO postgres WITH GRANT OPTION;
GRANT USAGE ON SCHEMA storage TO anon;
GRANT USAGE ON SCHEMA storage TO authenticated;
GRANT USAGE ON SCHEMA storage TO service_role;
GRANT ALL ON SCHEMA storage TO supabase_storage_admin WITH GRANT OPTION;
GRANT ALL ON SCHEMA storage TO dashboard_user;


--
-- TOC entry 4338 (class 0 OID 0)
-- Dependencies: 32
-- Name: SCHEMA vault; Type: ACL; Schema: -; Owner: supabase_admin
--

GRANT USAGE ON SCHEMA vault TO postgres WITH GRANT OPTION;
GRANT USAGE ON SCHEMA vault TO service_role;


--
-- TOC entry 4345 (class 0 OID 0)
-- Dependencies: 439
-- Name: FUNCTION email(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON FUNCTION auth.email() TO dashboard_user;


--
-- TOC entry 4346 (class 0 OID 0)
-- Dependencies: 513
-- Name: FUNCTION jwt(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON FUNCTION auth.jwt() TO postgres;
GRANT ALL ON FUNCTION auth.jwt() TO dashboard_user;


--
-- TOC entry 4348 (class 0 OID 0)
-- Dependencies: 405
-- Name: FUNCTION role(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON FUNCTION auth.role() TO dashboard_user;


--
-- TOC entry 4350 (class 0 OID 0)
-- Dependencies: 418
-- Name: FUNCTION uid(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON FUNCTION auth.uid() TO dashboard_user;


--
-- TOC entry 4351 (class 0 OID 0)
-- Dependencies: 449
-- Name: FUNCTION armor(bytea); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.armor(bytea) FROM postgres;
GRANT ALL ON FUNCTION extensions.armor(bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.armor(bytea) TO dashboard_user;


--
-- TOC entry 4352 (class 0 OID 0)
-- Dependencies: 482
-- Name: FUNCTION armor(bytea, text[], text[]); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.armor(bytea, text[], text[]) FROM postgres;
GRANT ALL ON FUNCTION extensions.armor(bytea, text[], text[]) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.armor(bytea, text[], text[]) TO dashboard_user;


--
-- TOC entry 4353 (class 0 OID 0)
-- Dependencies: 472
-- Name: FUNCTION crypt(text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.crypt(text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.crypt(text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.crypt(text, text) TO dashboard_user;


--
-- TOC entry 4354 (class 0 OID 0)
-- Dependencies: 458
-- Name: FUNCTION dearmor(text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.dearmor(text) FROM postgres;
GRANT ALL ON FUNCTION extensions.dearmor(text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.dearmor(text) TO dashboard_user;


--
-- TOC entry 4355 (class 0 OID 0)
-- Dependencies: 460
-- Name: FUNCTION decrypt(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.decrypt(bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.decrypt(bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.decrypt(bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4356 (class 0 OID 0)
-- Dependencies: 430
-- Name: FUNCTION decrypt_iv(bytea, bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.decrypt_iv(bytea, bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.decrypt_iv(bytea, bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.decrypt_iv(bytea, bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4357 (class 0 OID 0)
-- Dependencies: 496
-- Name: FUNCTION digest(bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.digest(bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.digest(bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.digest(bytea, text) TO dashboard_user;


--
-- TOC entry 4358 (class 0 OID 0)
-- Dependencies: 477
-- Name: FUNCTION digest(text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.digest(text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.digest(text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.digest(text, text) TO dashboard_user;


--
-- TOC entry 4359 (class 0 OID 0)
-- Dependencies: 424
-- Name: FUNCTION encrypt(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.encrypt(bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.encrypt(bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.encrypt(bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4360 (class 0 OID 0)
-- Dependencies: 410
-- Name: FUNCTION encrypt_iv(bytea, bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.encrypt_iv(bytea, bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.encrypt_iv(bytea, bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.encrypt_iv(bytea, bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4361 (class 0 OID 0)
-- Dependencies: 480
-- Name: FUNCTION gen_random_bytes(integer); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.gen_random_bytes(integer) FROM postgres;
GRANT ALL ON FUNCTION extensions.gen_random_bytes(integer) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.gen_random_bytes(integer) TO dashboard_user;


--
-- TOC entry 4362 (class 0 OID 0)
-- Dependencies: 406
-- Name: FUNCTION gen_random_uuid(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.gen_random_uuid() FROM postgres;
GRANT ALL ON FUNCTION extensions.gen_random_uuid() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.gen_random_uuid() TO dashboard_user;


--
-- TOC entry 4363 (class 0 OID 0)
-- Dependencies: 527
-- Name: FUNCTION gen_salt(text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.gen_salt(text) FROM postgres;
GRANT ALL ON FUNCTION extensions.gen_salt(text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.gen_salt(text) TO dashboard_user;


--
-- TOC entry 4364 (class 0 OID 0)
-- Dependencies: 523
-- Name: FUNCTION gen_salt(text, integer); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.gen_salt(text, integer) FROM postgres;
GRANT ALL ON FUNCTION extensions.gen_salt(text, integer) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.gen_salt(text, integer) TO dashboard_user;


--
-- TOC entry 4366 (class 0 OID 0)
-- Dependencies: 435
-- Name: FUNCTION grant_pg_cron_access(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

REVOKE ALL ON FUNCTION extensions.grant_pg_cron_access() FROM supabase_admin;
GRANT ALL ON FUNCTION extensions.grant_pg_cron_access() TO supabase_admin WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.grant_pg_cron_access() TO dashboard_user;


--
-- TOC entry 4368 (class 0 OID 0)
-- Dependencies: 503
-- Name: FUNCTION grant_pg_graphql_access(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.grant_pg_graphql_access() TO postgres WITH GRANT OPTION;


--
-- TOC entry 4370 (class 0 OID 0)
-- Dependencies: 397
-- Name: FUNCTION grant_pg_net_access(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

REVOKE ALL ON FUNCTION extensions.grant_pg_net_access() FROM supabase_admin;
GRANT ALL ON FUNCTION extensions.grant_pg_net_access() TO supabase_admin WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.grant_pg_net_access() TO dashboard_user;


--
-- TOC entry 4371 (class 0 OID 0)
-- Dependencies: 409
-- Name: FUNCTION hmac(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.hmac(bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.hmac(bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.hmac(bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4372 (class 0 OID 0)
-- Dependencies: 510
-- Name: FUNCTION hmac(text, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.hmac(text, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.hmac(text, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.hmac(text, text, text) TO dashboard_user;


--
-- TOC entry 4373 (class 0 OID 0)
-- Dependencies: 485
-- Name: FUNCTION pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone) FROM postgres;
GRANT ALL ON FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone) TO dashboard_user;


--
-- TOC entry 4374 (class 0 OID 0)
-- Dependencies: 519
-- Name: FUNCTION pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone) FROM postgres;
GRANT ALL ON FUNCTION extensions.pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone) TO dashboard_user;


--
-- TOC entry 4375 (class 0 OID 0)
-- Dependencies: 479
-- Name: FUNCTION pg_stat_statements_reset(userid oid, dbid oid, queryid bigint, minmax_only boolean); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pg_stat_statements_reset(userid oid, dbid oid, queryid bigint, minmax_only boolean) FROM postgres;
GRANT ALL ON FUNCTION extensions.pg_stat_statements_reset(userid oid, dbid oid, queryid bigint, minmax_only boolean) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pg_stat_statements_reset(userid oid, dbid oid, queryid bigint, minmax_only boolean) TO dashboard_user;


--
-- TOC entry 4376 (class 0 OID 0)
-- Dependencies: 437
-- Name: FUNCTION pgp_armor_headers(text, OUT key text, OUT value text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_armor_headers(text, OUT key text, OUT value text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_armor_headers(text, OUT key text, OUT value text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_armor_headers(text, OUT key text, OUT value text) TO dashboard_user;


--
-- TOC entry 4377 (class 0 OID 0)
-- Dependencies: 432
-- Name: FUNCTION pgp_key_id(bytea); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_key_id(bytea) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_key_id(bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_key_id(bytea) TO dashboard_user;


--
-- TOC entry 4378 (class 0 OID 0)
-- Dependencies: 504
-- Name: FUNCTION pgp_pub_decrypt(bytea, bytea); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea) TO dashboard_user;


--
-- TOC entry 4379 (class 0 OID 0)
-- Dependencies: 401
-- Name: FUNCTION pgp_pub_decrypt(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4380 (class 0 OID 0)
-- Dependencies: 506
-- Name: FUNCTION pgp_pub_decrypt(bytea, bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text, text) TO dashboard_user;


--
-- TOC entry 4381 (class 0 OID 0)
-- Dependencies: 414
-- Name: FUNCTION pgp_pub_decrypt_bytea(bytea, bytea); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea) TO dashboard_user;


--
-- TOC entry 4382 (class 0 OID 0)
-- Dependencies: 516
-- Name: FUNCTION pgp_pub_decrypt_bytea(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4383 (class 0 OID 0)
-- Dependencies: 512
-- Name: FUNCTION pgp_pub_decrypt_bytea(bytea, bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text, text) TO dashboard_user;


--
-- TOC entry 4384 (class 0 OID 0)
-- Dependencies: 443
-- Name: FUNCTION pgp_pub_encrypt(text, bytea); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea) TO dashboard_user;


--
-- TOC entry 4385 (class 0 OID 0)
-- Dependencies: 438
-- Name: FUNCTION pgp_pub_encrypt(text, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt(text, bytea, text) TO dashboard_user;


--
-- TOC entry 4386 (class 0 OID 0)
-- Dependencies: 422
-- Name: FUNCTION pgp_pub_encrypt_bytea(bytea, bytea); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea) TO dashboard_user;


--
-- TOC entry 4387 (class 0 OID 0)
-- Dependencies: 499
-- Name: FUNCTION pgp_pub_encrypt_bytea(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea, text) TO dashboard_user;


--
-- TOC entry 4388 (class 0 OID 0)
-- Dependencies: 502
-- Name: FUNCTION pgp_sym_decrypt(bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text) TO dashboard_user;


--
-- TOC entry 4389 (class 0 OID 0)
-- Dependencies: 440
-- Name: FUNCTION pgp_sym_decrypt(bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt(bytea, text, text) TO dashboard_user;


--
-- TOC entry 4390 (class 0 OID 0)
-- Dependencies: 505
-- Name: FUNCTION pgp_sym_decrypt_bytea(bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text) TO dashboard_user;


--
-- TOC entry 4391 (class 0 OID 0)
-- Dependencies: 501
-- Name: FUNCTION pgp_sym_decrypt_bytea(bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text, text) TO dashboard_user;


--
-- TOC entry 4392 (class 0 OID 0)
-- Dependencies: 526
-- Name: FUNCTION pgp_sym_encrypt(text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text) TO dashboard_user;


--
-- TOC entry 4393 (class 0 OID 0)
-- Dependencies: 454
-- Name: FUNCTION pgp_sym_encrypt(text, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt(text, text, text) TO dashboard_user;


--
-- TOC entry 4394 (class 0 OID 0)
-- Dependencies: 417
-- Name: FUNCTION pgp_sym_encrypt_bytea(bytea, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text) TO dashboard_user;


--
-- TOC entry 4395 (class 0 OID 0)
-- Dependencies: 507
-- Name: FUNCTION pgp_sym_encrypt_bytea(bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text, text) FROM postgres;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text, text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text, text) TO dashboard_user;


--
-- TOC entry 4396 (class 0 OID 0)
-- Dependencies: 522
-- Name: FUNCTION pgrst_ddl_watch(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgrst_ddl_watch() TO postgres WITH GRANT OPTION;


--
-- TOC entry 4397 (class 0 OID 0)
-- Dependencies: 515
-- Name: FUNCTION pgrst_drop_watch(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.pgrst_drop_watch() TO postgres WITH GRANT OPTION;


--
-- TOC entry 4399 (class 0 OID 0)
-- Dependencies: 497
-- Name: FUNCTION set_graphql_placeholder(); Type: ACL; Schema: extensions; Owner: supabase_admin
--

GRANT ALL ON FUNCTION extensions.set_graphql_placeholder() TO postgres WITH GRANT OPTION;


--
-- TOC entry 4400 (class 0 OID 0)
-- Dependencies: 445
-- Name: FUNCTION uuid_generate_v1(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_generate_v1() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_generate_v1() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_generate_v1() TO dashboard_user;


--
-- TOC entry 4401 (class 0 OID 0)
-- Dependencies: 488
-- Name: FUNCTION uuid_generate_v1mc(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_generate_v1mc() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_generate_v1mc() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_generate_v1mc() TO dashboard_user;


--
-- TOC entry 4402 (class 0 OID 0)
-- Dependencies: 399
-- Name: FUNCTION uuid_generate_v3(namespace uuid, name text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_generate_v3(namespace uuid, name text) FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_generate_v3(namespace uuid, name text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_generate_v3(namespace uuid, name text) TO dashboard_user;


--
-- TOC entry 4403 (class 0 OID 0)
-- Dependencies: 415
-- Name: FUNCTION uuid_generate_v4(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_generate_v4() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_generate_v4() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_generate_v4() TO dashboard_user;


--
-- TOC entry 4404 (class 0 OID 0)
-- Dependencies: 421
-- Name: FUNCTION uuid_generate_v5(namespace uuid, name text); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_generate_v5(namespace uuid, name text) FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_generate_v5(namespace uuid, name text) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_generate_v5(namespace uuid, name text) TO dashboard_user;


--
-- TOC entry 4405 (class 0 OID 0)
-- Dependencies: 474
-- Name: FUNCTION uuid_nil(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_nil() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_nil() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_nil() TO dashboard_user;


--
-- TOC entry 4406 (class 0 OID 0)
-- Dependencies: 423
-- Name: FUNCTION uuid_ns_dns(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_ns_dns() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_ns_dns() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_ns_dns() TO dashboard_user;


--
-- TOC entry 4407 (class 0 OID 0)
-- Dependencies: 508
-- Name: FUNCTION uuid_ns_oid(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_ns_oid() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_ns_oid() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_ns_oid() TO dashboard_user;


--
-- TOC entry 4408 (class 0 OID 0)
-- Dependencies: 464
-- Name: FUNCTION uuid_ns_url(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_ns_url() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_ns_url() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_ns_url() TO dashboard_user;


--
-- TOC entry 4409 (class 0 OID 0)
-- Dependencies: 476
-- Name: FUNCTION uuid_ns_x500(); Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON FUNCTION extensions.uuid_ns_x500() FROM postgres;
GRANT ALL ON FUNCTION extensions.uuid_ns_x500() TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION extensions.uuid_ns_x500() TO dashboard_user;


--
-- TOC entry 4410 (class 0 OID 0)
-- Dependencies: 509
-- Name: FUNCTION graphql("operationName" text, query text, variables jsonb, extensions jsonb); Type: ACL; Schema: graphql_public; Owner: supabase_admin
--

GRANT ALL ON FUNCTION graphql_public.graphql("operationName" text, query text, variables jsonb, extensions jsonb) TO postgres;
GRANT ALL ON FUNCTION graphql_public.graphql("operationName" text, query text, variables jsonb, extensions jsonb) TO anon;
GRANT ALL ON FUNCTION graphql_public.graphql("operationName" text, query text, variables jsonb, extensions jsonb) TO authenticated;
GRANT ALL ON FUNCTION graphql_public.graphql("operationName" text, query text, variables jsonb, extensions jsonb) TO service_role;


--
-- TOC entry 4411 (class 0 OID 0)
-- Dependencies: 412
-- Name: FUNCTION pg_reload_conf(); Type: ACL; Schema: pg_catalog; Owner: supabase_admin
--

GRANT ALL ON FUNCTION pg_catalog.pg_reload_conf() TO postgres WITH GRANT OPTION;


--
-- TOC entry 4412 (class 0 OID 0)
-- Dependencies: 441
-- Name: FUNCTION get_auth(p_usename text); Type: ACL; Schema: pgbouncer; Owner: supabase_admin
--

REVOKE ALL ON FUNCTION pgbouncer.get_auth(p_usename text) FROM PUBLIC;
GRANT ALL ON FUNCTION pgbouncer.get_auth(p_usename text) TO pgbouncer;


--
-- TOC entry 4413 (class 0 OID 0)
-- Dependencies: 518
-- Name: FUNCTION check_plan_limit(target_tenant_id uuid); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.check_plan_limit(target_tenant_id uuid) TO anon;
GRANT ALL ON FUNCTION public.check_plan_limit(target_tenant_id uuid) TO authenticated;
GRANT ALL ON FUNCTION public.check_plan_limit(target_tenant_id uuid) TO service_role;


--
-- TOC entry 4414 (class 0 OID 0)
-- Dependencies: 487
-- Name: FUNCTION get_candidate_summary_v2(target_app_id bigint); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.get_candidate_summary_v2(target_app_id bigint) TO anon;
GRANT ALL ON FUNCTION public.get_candidate_summary_v2(target_app_id bigint) TO authenticated;
GRANT ALL ON FUNCTION public.get_candidate_summary_v2(target_app_id bigint) TO service_role;


--
-- TOC entry 4415 (class 0 OID 0)
-- Dependencies: 413
-- Name: FUNCTION handle_new_user(); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.handle_new_user() TO anon;
GRANT ALL ON FUNCTION public.handle_new_user() TO authenticated;
GRANT ALL ON FUNCTION public.handle_new_user() TO service_role;


--
-- TOC entry 4416 (class 0 OID 0)
-- Dependencies: 494
-- Name: FUNCTION initialize_job_criteria_v2(target_job_id bigint); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.initialize_job_criteria_v2(target_job_id bigint) TO anon;
GRANT ALL ON FUNCTION public.initialize_job_criteria_v2(target_job_id bigint) TO authenticated;
GRANT ALL ON FUNCTION public.initialize_job_criteria_v2(target_job_id bigint) TO service_role;


--
-- TOC entry 4417 (class 0 OID 0)
-- Dependencies: 431
-- Name: FUNCTION update_application_general_score(); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.update_application_general_score() TO anon;
GRANT ALL ON FUNCTION public.update_application_general_score() TO authenticated;
GRANT ALL ON FUNCTION public.update_application_general_score() TO service_role;


--
-- TOC entry 4418 (class 0 OID 0)
-- Dependencies: 451
-- Name: FUNCTION update_general_score(); Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON FUNCTION public.update_general_score() TO anon;
GRANT ALL ON FUNCTION public.update_general_score() TO authenticated;
GRANT ALL ON FUNCTION public.update_general_score() TO service_role;


--
-- TOC entry 4419 (class 0 OID 0)
-- Dependencies: 461
-- Name: FUNCTION apply_rls(wal jsonb, max_record_bytes integer); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO postgres;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO anon;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO authenticated;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO service_role;
GRANT ALL ON FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) TO supabase_realtime_admin;


--
-- TOC entry 4420 (class 0 OID 0)
-- Dependencies: 400
-- Name: FUNCTION broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text) TO postgres;
GRANT ALL ON FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text) TO dashboard_user;


--
-- TOC entry 4421 (class 0 OID 0)
-- Dependencies: 491
-- Name: FUNCTION build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO postgres;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO anon;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO authenticated;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO service_role;
GRANT ALL ON FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) TO supabase_realtime_admin;


--
-- TOC entry 4422 (class 0 OID 0)
-- Dependencies: 457
-- Name: FUNCTION "cast"(val text, type_ regtype); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO postgres;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO dashboard_user;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO anon;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO authenticated;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO service_role;
GRANT ALL ON FUNCTION realtime."cast"(val text, type_ regtype) TO supabase_realtime_admin;


--
-- TOC entry 4423 (class 0 OID 0)
-- Dependencies: 467
-- Name: FUNCTION check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO postgres;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO anon;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO authenticated;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO service_role;
GRANT ALL ON FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) TO supabase_realtime_admin;


--
-- TOC entry 4424 (class 0 OID 0)
-- Dependencies: 420
-- Name: FUNCTION is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO postgres;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO anon;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO authenticated;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO service_role;
GRANT ALL ON FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) TO supabase_realtime_admin;


--
-- TOC entry 4425 (class 0 OID 0)
-- Dependencies: 428
-- Name: FUNCTION list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO postgres;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO anon;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO authenticated;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO service_role;
GRANT ALL ON FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) TO supabase_realtime_admin;


--
-- TOC entry 4426 (class 0 OID 0)
-- Dependencies: 521
-- Name: FUNCTION quote_wal2json(entity regclass); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO postgres;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO anon;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO authenticated;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO service_role;
GRANT ALL ON FUNCTION realtime.quote_wal2json(entity regclass) TO supabase_realtime_admin;


--
-- TOC entry 4427 (class 0 OID 0)
-- Dependencies: 436
-- Name: FUNCTION send(payload jsonb, event text, topic text, private boolean); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean) TO postgres;
GRANT ALL ON FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean) TO dashboard_user;


--
-- TOC entry 4428 (class 0 OID 0)
-- Dependencies: 433
-- Name: FUNCTION subscription_check_filters(); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO postgres;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO dashboard_user;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO anon;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO authenticated;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO service_role;
GRANT ALL ON FUNCTION realtime.subscription_check_filters() TO supabase_realtime_admin;


--
-- TOC entry 4429 (class 0 OID 0)
-- Dependencies: 452
-- Name: FUNCTION to_regrole(role_name text); Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO postgres;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO dashboard_user;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO anon;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO authenticated;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO service_role;
GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO supabase_realtime_admin;


--
-- TOC entry 4430 (class 0 OID 0)
-- Dependencies: 475
-- Name: FUNCTION topic(); Type: ACL; Schema: realtime; Owner: supabase_realtime_admin
--

GRANT ALL ON FUNCTION realtime.topic() TO postgres;
GRANT ALL ON FUNCTION realtime.topic() TO dashboard_user;


--
-- TOC entry 4431 (class 0 OID 0)
-- Dependencies: 447
-- Name: FUNCTION _crypto_aead_det_decrypt(message bytea, additional bytea, key_id bigint, context bytea, nonce bytea); Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT ALL ON FUNCTION vault._crypto_aead_det_decrypt(message bytea, additional bytea, key_id bigint, context bytea, nonce bytea) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION vault._crypto_aead_det_decrypt(message bytea, additional bytea, key_id bigint, context bytea, nonce bytea) TO service_role;


--
-- TOC entry 4432 (class 0 OID 0)
-- Dependencies: 469
-- Name: FUNCTION create_secret(new_secret text, new_name text, new_description text, new_key_id uuid); Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT ALL ON FUNCTION vault.create_secret(new_secret text, new_name text, new_description text, new_key_id uuid) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION vault.create_secret(new_secret text, new_name text, new_description text, new_key_id uuid) TO service_role;


--
-- TOC entry 4433 (class 0 OID 0)
-- Dependencies: 398
-- Name: FUNCTION update_secret(secret_id uuid, new_secret text, new_name text, new_description text, new_key_id uuid); Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT ALL ON FUNCTION vault.update_secret(secret_id uuid, new_secret text, new_name text, new_description text, new_key_id uuid) TO postgres WITH GRANT OPTION;
GRANT ALL ON FUNCTION vault.update_secret(secret_id uuid, new_secret text, new_name text, new_description text, new_key_id uuid) TO service_role;


--
-- TOC entry 4435 (class 0 OID 0)
-- Dependencies: 348
-- Name: TABLE audit_log_entries; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.audit_log_entries TO dashboard_user;
GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.audit_log_entries TO postgres;
GRANT SELECT ON TABLE auth.audit_log_entries TO postgres WITH GRANT OPTION;


--
-- TOC entry 4437 (class 0 OID 0)
-- Dependencies: 362
-- Name: TABLE flow_state; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.flow_state TO postgres;
GRANT SELECT ON TABLE auth.flow_state TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.flow_state TO dashboard_user;


--
-- TOC entry 4440 (class 0 OID 0)
-- Dependencies: 353
-- Name: TABLE identities; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.identities TO postgres;
GRANT SELECT ON TABLE auth.identities TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.identities TO dashboard_user;


--
-- TOC entry 4442 (class 0 OID 0)
-- Dependencies: 347
-- Name: TABLE instances; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.instances TO dashboard_user;
GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.instances TO postgres;
GRANT SELECT ON TABLE auth.instances TO postgres WITH GRANT OPTION;


--
-- TOC entry 4444 (class 0 OID 0)
-- Dependencies: 357
-- Name: TABLE mfa_amr_claims; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.mfa_amr_claims TO postgres;
GRANT SELECT ON TABLE auth.mfa_amr_claims TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.mfa_amr_claims TO dashboard_user;


--
-- TOC entry 4446 (class 0 OID 0)
-- Dependencies: 356
-- Name: TABLE mfa_challenges; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.mfa_challenges TO postgres;
GRANT SELECT ON TABLE auth.mfa_challenges TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.mfa_challenges TO dashboard_user;


--
-- TOC entry 4449 (class 0 OID 0)
-- Dependencies: 355
-- Name: TABLE mfa_factors; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.mfa_factors TO postgres;
GRANT SELECT ON TABLE auth.mfa_factors TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.mfa_factors TO dashboard_user;


--
-- TOC entry 4450 (class 0 OID 0)
-- Dependencies: 365
-- Name: TABLE oauth_authorizations; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.oauth_authorizations TO postgres;
GRANT ALL ON TABLE auth.oauth_authorizations TO dashboard_user;


--
-- TOC entry 4452 (class 0 OID 0)
-- Dependencies: 367
-- Name: TABLE oauth_client_states; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.oauth_client_states TO postgres;
GRANT ALL ON TABLE auth.oauth_client_states TO dashboard_user;


--
-- TOC entry 4453 (class 0 OID 0)
-- Dependencies: 364
-- Name: TABLE oauth_clients; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.oauth_clients TO postgres;
GRANT ALL ON TABLE auth.oauth_clients TO dashboard_user;


--
-- TOC entry 4454 (class 0 OID 0)
-- Dependencies: 366
-- Name: TABLE oauth_consents; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.oauth_consents TO postgres;
GRANT ALL ON TABLE auth.oauth_consents TO dashboard_user;


--
-- TOC entry 4455 (class 0 OID 0)
-- Dependencies: 363
-- Name: TABLE one_time_tokens; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.one_time_tokens TO postgres;
GRANT SELECT ON TABLE auth.one_time_tokens TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.one_time_tokens TO dashboard_user;


--
-- TOC entry 4457 (class 0 OID 0)
-- Dependencies: 346
-- Name: TABLE refresh_tokens; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.refresh_tokens TO dashboard_user;
GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.refresh_tokens TO postgres;
GRANT SELECT ON TABLE auth.refresh_tokens TO postgres WITH GRANT OPTION;


--
-- TOC entry 4459 (class 0 OID 0)
-- Dependencies: 345
-- Name: SEQUENCE refresh_tokens_id_seq; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON SEQUENCE auth.refresh_tokens_id_seq TO dashboard_user;
GRANT ALL ON SEQUENCE auth.refresh_tokens_id_seq TO postgres;


--
-- TOC entry 4461 (class 0 OID 0)
-- Dependencies: 360
-- Name: TABLE saml_providers; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.saml_providers TO postgres;
GRANT SELECT ON TABLE auth.saml_providers TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.saml_providers TO dashboard_user;


--
-- TOC entry 4463 (class 0 OID 0)
-- Dependencies: 361
-- Name: TABLE saml_relay_states; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.saml_relay_states TO postgres;
GRANT SELECT ON TABLE auth.saml_relay_states TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.saml_relay_states TO dashboard_user;


--
-- TOC entry 4465 (class 0 OID 0)
-- Dependencies: 349
-- Name: TABLE schema_migrations; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT SELECT ON TABLE auth.schema_migrations TO postgres WITH GRANT OPTION;


--
-- TOC entry 4470 (class 0 OID 0)
-- Dependencies: 354
-- Name: TABLE sessions; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.sessions TO postgres;
GRANT SELECT ON TABLE auth.sessions TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.sessions TO dashboard_user;


--
-- TOC entry 4472 (class 0 OID 0)
-- Dependencies: 359
-- Name: TABLE sso_domains; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.sso_domains TO postgres;
GRANT SELECT ON TABLE auth.sso_domains TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.sso_domains TO dashboard_user;


--
-- TOC entry 4475 (class 0 OID 0)
-- Dependencies: 358
-- Name: TABLE sso_providers; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.sso_providers TO postgres;
GRANT SELECT ON TABLE auth.sso_providers TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE auth.sso_providers TO dashboard_user;


--
-- TOC entry 4478 (class 0 OID 0)
-- Dependencies: 344
-- Name: TABLE users; Type: ACL; Schema: auth; Owner: supabase_auth_admin
--

GRANT ALL ON TABLE auth.users TO dashboard_user;
GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.users TO postgres;
GRANT SELECT ON TABLE auth.users TO postgres WITH GRANT OPTION;


--
-- TOC entry 4479 (class 0 OID 0)
-- Dependencies: 343
-- Name: TABLE pg_stat_statements; Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON TABLE extensions.pg_stat_statements FROM postgres;
GRANT ALL ON TABLE extensions.pg_stat_statements TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE extensions.pg_stat_statements TO dashboard_user;


--
-- TOC entry 4480 (class 0 OID 0)
-- Dependencies: 342
-- Name: TABLE pg_stat_statements_info; Type: ACL; Schema: extensions; Owner: postgres
--

REVOKE ALL ON TABLE extensions.pg_stat_statements_info FROM postgres;
GRANT ALL ON TABLE extensions.pg_stat_statements_info TO postgres WITH GRANT OPTION;
GRANT ALL ON TABLE extensions.pg_stat_statements_info TO dashboard_user;


--
-- TOC entry 4481 (class 0 OID 0)
-- Dependencies: 388
-- Name: TABLE applications; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.applications TO anon;
GRANT ALL ON TABLE public.applications TO authenticated;
GRANT ALL ON TABLE public.applications TO service_role;


--
-- TOC entry 4482 (class 0 OID 0)
-- Dependencies: 387
-- Name: SEQUENCE applications_id_seq; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON SEQUENCE public.applications_id_seq TO anon;
GRANT ALL ON SEQUENCE public.applications_id_seq TO authenticated;
GRANT ALL ON SEQUENCE public.applications_id_seq TO service_role;


--
-- TOC entry 4483 (class 0 OID 0)
-- Dependencies: 393
-- Name: TABLE candidates; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.candidates TO anon;
GRANT ALL ON TABLE public.candidates TO authenticated;
GRANT ALL ON TABLE public.candidates TO service_role;


--
-- TOC entry 4484 (class 0 OID 0)
-- Dependencies: 396
-- Name: TABLE company_departments; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.company_departments TO anon;
GRANT ALL ON TABLE public.company_departments TO authenticated;
GRANT ALL ON TABLE public.company_departments TO service_role;


--
-- TOC entry 4485 (class 0 OID 0)
-- Dependencies: 395
-- Name: SEQUENCE company_departments_id_seq; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON SEQUENCE public.company_departments_id_seq TO anon;
GRANT ALL ON SEQUENCE public.company_departments_id_seq TO authenticated;
GRANT ALL ON SEQUENCE public.company_departments_id_seq TO service_role;


--
-- TOC entry 4486 (class 0 OID 0)
-- Dependencies: 391
-- Name: TABLE evaluation_assignments_v2; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.evaluation_assignments_v2 TO anon;
GRANT ALL ON TABLE public.evaluation_assignments_v2 TO authenticated;
GRANT ALL ON TABLE public.evaluation_assignments_v2 TO service_role;


--
-- TOC entry 4487 (class 0 OID 0)
-- Dependencies: 394
-- Name: TABLE evaluations; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.evaluations TO anon;
GRANT ALL ON TABLE public.evaluations TO authenticated;
GRANT ALL ON TABLE public.evaluations TO service_role;


--
-- TOC entry 4488 (class 0 OID 0)
-- Dependencies: 386
-- Name: TABLE jobs; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.jobs TO anon;
GRANT ALL ON TABLE public.jobs TO authenticated;
GRANT ALL ON TABLE public.jobs TO service_role;


--
-- TOC entry 4489 (class 0 OID 0)
-- Dependencies: 385
-- Name: SEQUENCE jobs_id_seq; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON SEQUENCE public.jobs_id_seq TO anon;
GRANT ALL ON SEQUENCE public.jobs_id_seq TO authenticated;
GRANT ALL ON SEQUENCE public.jobs_id_seq TO service_role;


--
-- TOC entry 4490 (class 0 OID 0)
-- Dependencies: 392
-- Name: TABLE plans; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.plans TO anon;
GRANT ALL ON TABLE public.plans TO authenticated;
GRANT ALL ON TABLE public.plans TO service_role;


--
-- TOC entry 4491 (class 0 OID 0)
-- Dependencies: 389
-- Name: TABLE tenants; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.tenants TO anon;
GRANT ALL ON TABLE public.tenants TO authenticated;
GRANT ALL ON TABLE public.tenants TO service_role;


--
-- TOC entry 4492 (class 0 OID 0)
-- Dependencies: 390
-- Name: TABLE user_profiles; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.user_profiles TO anon;
GRANT ALL ON TABLE public.user_profiles TO authenticated;
GRANT ALL ON TABLE public.user_profiles TO service_role;


--
-- TOC entry 4493 (class 0 OID 0)
-- Dependencies: 384
-- Name: TABLE users; Type: ACL; Schema: public; Owner: postgres
--

GRANT ALL ON TABLE public.users TO anon;
GRANT ALL ON TABLE public.users TO authenticated;
GRANT ALL ON TABLE public.users TO service_role;


--
-- TOC entry 4494 (class 0 OID 0)
-- Dependencies: 383
-- Name: TABLE messages; Type: ACL; Schema: realtime; Owner: supabase_realtime_admin
--

GRANT ALL ON TABLE realtime.messages TO postgres;
GRANT ALL ON TABLE realtime.messages TO dashboard_user;
GRANT SELECT,INSERT,UPDATE ON TABLE realtime.messages TO anon;
GRANT SELECT,INSERT,UPDATE ON TABLE realtime.messages TO authenticated;
GRANT SELECT,INSERT,UPDATE ON TABLE realtime.messages TO service_role;


--
-- TOC entry 4495 (class 0 OID 0)
-- Dependencies: 368
-- Name: TABLE schema_migrations; Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON TABLE realtime.schema_migrations TO postgres;
GRANT ALL ON TABLE realtime.schema_migrations TO dashboard_user;
GRANT SELECT ON TABLE realtime.schema_migrations TO anon;
GRANT SELECT ON TABLE realtime.schema_migrations TO authenticated;
GRANT SELECT ON TABLE realtime.schema_migrations TO service_role;
GRANT ALL ON TABLE realtime.schema_migrations TO supabase_realtime_admin;


--
-- TOC entry 4496 (class 0 OID 0)
-- Dependencies: 380
-- Name: TABLE subscription; Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON TABLE realtime.subscription TO postgres;
GRANT ALL ON TABLE realtime.subscription TO dashboard_user;
GRANT SELECT ON TABLE realtime.subscription TO anon;
GRANT SELECT ON TABLE realtime.subscription TO authenticated;
GRANT SELECT ON TABLE realtime.subscription TO service_role;
GRANT ALL ON TABLE realtime.subscription TO supabase_realtime_admin;


--
-- TOC entry 4497 (class 0 OID 0)
-- Dependencies: 379
-- Name: SEQUENCE subscription_id_seq; Type: ACL; Schema: realtime; Owner: supabase_admin
--

GRANT ALL ON SEQUENCE realtime.subscription_id_seq TO postgres;
GRANT ALL ON SEQUENCE realtime.subscription_id_seq TO dashboard_user;
GRANT USAGE ON SEQUENCE realtime.subscription_id_seq TO anon;
GRANT USAGE ON SEQUENCE realtime.subscription_id_seq TO authenticated;
GRANT USAGE ON SEQUENCE realtime.subscription_id_seq TO service_role;
GRANT ALL ON SEQUENCE realtime.subscription_id_seq TO supabase_realtime_admin;


--
-- TOC entry 4499 (class 0 OID 0)
-- Dependencies: 370
-- Name: TABLE buckets; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

REVOKE ALL ON TABLE storage.buckets FROM supabase_storage_admin;
GRANT ALL ON TABLE storage.buckets TO supabase_storage_admin WITH GRANT OPTION;
GRANT ALL ON TABLE storage.buckets TO service_role;
GRANT ALL ON TABLE storage.buckets TO authenticated;
GRANT ALL ON TABLE storage.buckets TO anon;
GRANT ALL ON TABLE storage.buckets TO postgres WITH GRANT OPTION;


--
-- TOC entry 4500 (class 0 OID 0)
-- Dependencies: 375
-- Name: TABLE buckets_analytics; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.buckets_analytics TO service_role;
GRANT ALL ON TABLE storage.buckets_analytics TO authenticated;
GRANT ALL ON TABLE storage.buckets_analytics TO anon;


--
-- TOC entry 4501 (class 0 OID 0)
-- Dependencies: 376
-- Name: TABLE buckets_vectors; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT SELECT ON TABLE storage.buckets_vectors TO service_role;
GRANT SELECT ON TABLE storage.buckets_vectors TO authenticated;
GRANT SELECT ON TABLE storage.buckets_vectors TO anon;


--
-- TOC entry 4503 (class 0 OID 0)
-- Dependencies: 371
-- Name: TABLE objects; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

REVOKE ALL ON TABLE storage.objects FROM supabase_storage_admin;
GRANT ALL ON TABLE storage.objects TO supabase_storage_admin WITH GRANT OPTION;
GRANT ALL ON TABLE storage.objects TO service_role;
GRANT ALL ON TABLE storage.objects TO authenticated;
GRANT ALL ON TABLE storage.objects TO anon;
GRANT ALL ON TABLE storage.objects TO postgres WITH GRANT OPTION;


--
-- TOC entry 4504 (class 0 OID 0)
-- Dependencies: 374
-- Name: TABLE prefixes; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.prefixes TO service_role;
GRANT ALL ON TABLE storage.prefixes TO authenticated;
GRANT ALL ON TABLE storage.prefixes TO anon;


--
-- TOC entry 4505 (class 0 OID 0)
-- Dependencies: 372
-- Name: TABLE s3_multipart_uploads; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.s3_multipart_uploads TO service_role;
GRANT SELECT ON TABLE storage.s3_multipart_uploads TO authenticated;
GRANT SELECT ON TABLE storage.s3_multipart_uploads TO anon;


--
-- TOC entry 4506 (class 0 OID 0)
-- Dependencies: 373
-- Name: TABLE s3_multipart_uploads_parts; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT ALL ON TABLE storage.s3_multipart_uploads_parts TO service_role;
GRANT SELECT ON TABLE storage.s3_multipart_uploads_parts TO authenticated;
GRANT SELECT ON TABLE storage.s3_multipart_uploads_parts TO anon;


--
-- TOC entry 4507 (class 0 OID 0)
-- Dependencies: 377
-- Name: TABLE vector_indexes; Type: ACL; Schema: storage; Owner: supabase_storage_admin
--

GRANT SELECT ON TABLE storage.vector_indexes TO service_role;
GRANT SELECT ON TABLE storage.vector_indexes TO authenticated;
GRANT SELECT ON TABLE storage.vector_indexes TO anon;


--
-- TOC entry 4508 (class 0 OID 0)
-- Dependencies: 350
-- Name: TABLE secrets; Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT SELECT,REFERENCES,DELETE,TRUNCATE ON TABLE vault.secrets TO postgres WITH GRANT OPTION;
GRANT SELECT,DELETE ON TABLE vault.secrets TO service_role;


--
-- TOC entry 4509 (class 0 OID 0)
-- Dependencies: 351
-- Name: TABLE decrypted_secrets; Type: ACL; Schema: vault; Owner: supabase_admin
--

GRANT SELECT,REFERENCES,DELETE,TRUNCATE ON TABLE vault.decrypted_secrets TO postgres WITH GRANT OPTION;
GRANT SELECT,DELETE ON TABLE vault.decrypted_secrets TO service_role;


--
-- TOC entry 2528 (class 826 OID 16553)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: auth; Owner: supabase_auth_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON SEQUENCES TO dashboard_user;


--
-- TOC entry 2529 (class 826 OID 16554)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: auth; Owner: supabase_auth_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON FUNCTIONS TO dashboard_user;


--
-- TOC entry 2527 (class 826 OID 16552)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: auth; Owner: supabase_auth_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON TABLES TO dashboard_user;


--
-- TOC entry 2538 (class 826 OID 16632)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: extensions; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA extensions GRANT ALL ON SEQUENCES TO postgres WITH GRANT OPTION;


--
-- TOC entry 2537 (class 826 OID 16631)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: extensions; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA extensions GRANT ALL ON FUNCTIONS TO postgres WITH GRANT OPTION;


--
-- TOC entry 2536 (class 826 OID 16630)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: extensions; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA extensions GRANT ALL ON TABLES TO postgres WITH GRANT OPTION;


--
-- TOC entry 2541 (class 826 OID 16587)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: graphql; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON SEQUENCES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON SEQUENCES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON SEQUENCES TO service_role;


--
-- TOC entry 2540 (class 826 OID 16586)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: graphql; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON FUNCTIONS TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON FUNCTIONS TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON FUNCTIONS TO service_role;


--
-- TOC entry 2539 (class 826 OID 16585)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: graphql; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES TO service_role;


--
-- TOC entry 2533 (class 826 OID 16567)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: graphql_public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON SEQUENCES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON SEQUENCES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON SEQUENCES TO service_role;


--
-- TOC entry 2535 (class 826 OID 16566)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: graphql_public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON FUNCTIONS TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON FUNCTIONS TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON FUNCTIONS TO service_role;


--
-- TOC entry 2534 (class 826 OID 16565)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: graphql_public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES TO service_role;


--
-- TOC entry 2520 (class 826 OID 16490)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: public; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON SEQUENCES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON SEQUENCES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON SEQUENCES TO service_role;


--
-- TOC entry 2521 (class 826 OID 16491)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON SEQUENCES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON SEQUENCES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON SEQUENCES TO service_role;


--
-- TOC entry 2519 (class 826 OID 16489)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: public; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON FUNCTIONS TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON FUNCTIONS TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON FUNCTIONS TO service_role;


--
-- TOC entry 2523 (class 826 OID 16493)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON FUNCTIONS TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON FUNCTIONS TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON FUNCTIONS TO service_role;


--
-- TOC entry 2518 (class 826 OID 16488)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: public; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES TO service_role;


--
-- TOC entry 2522 (class 826 OID 16492)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: public; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES TO service_role;


--
-- TOC entry 2531 (class 826 OID 16557)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: realtime; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON SEQUENCES TO dashboard_user;


--
-- TOC entry 2532 (class 826 OID 16558)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: realtime; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON FUNCTIONS TO dashboard_user;


--
-- TOC entry 2530 (class 826 OID 16556)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: realtime; Owner: supabase_admin
--

ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON TABLES TO dashboard_user;


--
-- TOC entry 2526 (class 826 OID 16546)
-- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: storage; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON SEQUENCES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON SEQUENCES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON SEQUENCES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON SEQUENCES TO service_role;


--
-- TOC entry 2525 (class 826 OID 16545)
-- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: storage; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON FUNCTIONS TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON FUNCTIONS TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON FUNCTIONS TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON FUNCTIONS TO service_role;


--
-- TOC entry 2524 (class 826 OID 16544)
-- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: storage; Owner: postgres
--

ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES TO postgres;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES TO anon;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES TO authenticated;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES TO service_role;


--
-- TOC entry 3709 (class 3466 OID 16571)
-- Name: issue_graphql_placeholder; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER issue_graphql_placeholder ON sql_drop
         WHEN TAG IN ('DROP EXTENSION')
   EXECUTE FUNCTION extensions.set_graphql_placeholder();


ALTER EVENT TRIGGER issue_graphql_placeholder OWNER TO supabase_admin;

--
-- TOC entry 3714 (class 3466 OID 16650)
-- Name: issue_pg_cron_access; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER issue_pg_cron_access ON ddl_command_end
         WHEN TAG IN ('CREATE EXTENSION')
   EXECUTE FUNCTION extensions.grant_pg_cron_access();


ALTER EVENT TRIGGER issue_pg_cron_access OWNER TO supabase_admin;

--
-- TOC entry 3708 (class 3466 OID 16569)
-- Name: issue_pg_graphql_access; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER issue_pg_graphql_access ON ddl_command_end
         WHEN TAG IN ('CREATE FUNCTION')
   EXECUTE FUNCTION extensions.grant_pg_graphql_access();


ALTER EVENT TRIGGER issue_pg_graphql_access OWNER TO supabase_admin;

--
-- TOC entry 3715 (class 3466 OID 16653)
-- Name: issue_pg_net_access; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER issue_pg_net_access ON ddl_command_end
         WHEN TAG IN ('CREATE EXTENSION')
   EXECUTE FUNCTION extensions.grant_pg_net_access();


ALTER EVENT TRIGGER issue_pg_net_access OWNER TO supabase_admin;

--
-- TOC entry 3710 (class 3466 OID 16572)
-- Name: pgrst_ddl_watch; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER pgrst_ddl_watch ON ddl_command_end
   EXECUTE FUNCTION extensions.pgrst_ddl_watch();


ALTER EVENT TRIGGER pgrst_ddl_watch OWNER TO supabase_admin;

--
-- TOC entry 3711 (class 3466 OID 16573)
-- Name: pgrst_drop_watch; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
--

CREATE EVENT TRIGGER pgrst_drop_watch ON sql_drop
   EXECUTE FUNCTION extensions.pgrst_drop_watch();


ALTER EVENT TRIGGER pgrst_drop_watch OWNER TO supabase_admin;

-- Completed on 2026-01-02 09:56:03

--
-- PostgreSQL database dump complete
--

\unrestrict SnG6n6rFCxlzFOAs6HcFTd9omcHAejOdhbJ7DNglS7NHVN310DEMsx6dVbjWX2X



==================================================
ARQUIVO: functions\.eslintrc.js
==================================================
module.exports = {
  root: true,
  env: {
    es6: true,
    node: true,
  },
  extends: [
    "eslint:recommended",
    "google",
  ],
  rules: {
    quotes: ["error", "double"],
  },
};

==================================================
ARQUIVO: functions\index.js
==================================================
const functions = require("firebase-functions");
const admin = require("firebase-admin");

admin.initializeApp();

exports.getJobsByTenant = functions.https.onCall(async (data, context) => {
  if (!context.auth) {
    throw new functions.https.HttpsError(
      "unauthenticated",
      "VocÃª precisa estar autenticado."
    );
  }

  const uid = context.auth.uid;
  const db = admin.firestore();

  try {
    const userDoc = await db.collection("users").doc(uid).get();
    if (!userDoc.exists) {
      throw new functions.https.HttpsError(
        "not-found",
        "UsuÃ¡rio nÃ£o encontrado."
      );
    }
    const tenantId = userDoc.data().tenantId;
    if (!tenantId) {
      throw new functions.https.HttpsError(
        "permission-denied",
        "UsuÃ¡rio sem tenantId."
      );
    }

    const jobsSnapshot = await db.collection("jobs").where("tenantId", "==", tenantId).get();
    const jobs = [];
    jobsSnapshot.forEach((doc) => {
      jobs.push({ id: doc.id, ...doc.data() });
    });

    return { jobs };

  } catch (error) {
    console.error("Erro ao buscar vagas:", error);
    throw new functions.https.HttpsError(
      "internal",
      "Ocorreu um erro ao buscar as vagas."
    );
  }
});

==================================================
ARQUIVO: functions\package.json
==================================================
{
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "lint": "eslint .",
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "20"
  },
  "main": "index.js",
  "dependencies": {
    "firebase-admin": "^11.11.1",
    "firebase-functions": "^3.24.1"
  },
  "devDependencies": {
    "eslint": "^8.15.0",
    "eslint-plugin-promise": "^6.0.0",
    "firebase-functions-test": "^0.2.0"
  },
  "private": true
}

==================================================
ARQUIVO: functions\functions\package.json
==================================================
{
  "dependencies": {
    "functions": "file:.."
  }
}


==================================================
ARQUIVO: src\App.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';
import { supabase } from './supabase/client';
import Login from './pages/Login';
import Register from './pages/Register';
import Dashboard from './pages/Dashboard';
import JobDetails from './pages/JobDetails';
import ApplicationDetails from './pages/ApplicationDetails';
import Settings from './pages/Settings';
import ApplyJob from './pages/ApplyJob';
import SuperAdminDashboard from './pages/SuperAdminDashboard';
import SelectCompany from './pages/SelectCompany'; // NOVO IMPORT

export default function App() {
  const [session, setSession] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    supabase.auth.getSession().then(({ data: { session } }) => {
      setSession(session);
      setLoading(false);
    });

    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {
      setSession(session);
    });

    return () => subscription.unsubscribe();
  }, []);

  if (loading) return <div className="p-10 text-center">Carregando Sistema...</div>;

  return (
    <BrowserRouter>
      <Routes>
        {/* ROTAS PÃšBLICAS */}
        <Route path="/apply/:jobId" element={<ApplyJob />} />

        {/* ROTAS DE AUTENTICAÃ‡ÃƒO */}
        <Route path="/login" element={!session ? <Login /> : <Navigate to="/" />} />
        <Route path="/register" element={!session ? <Register /> : <Navigate to="/" />} />
        
        {/* ROTAS PROTEGIDAS */}
        <Route path="/" element={session ? <Dashboard /> : <Navigate to="/login" />} />
        
        {/* ROTA DE SELEÃ‡ÃƒO DE EMPRESA (NOVA) */}
        <Route path="/select-company" element={session ? <SelectCompany /> : <Navigate to="/login" />} />

        <Route path="/jobs/:jobId" element={session ? <JobDetails /> : <Navigate to="/login" />} />
        <Route path="/applications/:appId" element={session ? <ApplicationDetails /> : <Navigate to="/login" />} />
        <Route path="/settings" element={session ? <Settings /> : <Navigate to="/login" />} />
        <Route path="/admin/super" element={session ? <SuperAdminDashboard /> : <Navigate to="/login" />} />
      </Routes>
    </BrowserRouter>
  );
}

==================================================
ARQUIVO: src\index.css
==================================================
@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  @apply bg-gray-50 text-gray-900;
}

==================================================
ARQUIVO: src\main.jsx
==================================================
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App.jsx'
import './index.css'

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>,
)

==================================================
ARQUIVO: src\components\AreaSelect.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { supabase } from '../supabase/client';

export default function AreaSelect({ tenantId, value, onChange }) {
  const [departments, setDepartments] = useState([]);
  const [loading, setLoading] = useState(false);
  const [isCreating, setIsCreating] = useState(false);
  const [newName, setNewName] = useState('');

  useEffect(() => {
    if (tenantId) fetchDepts();
  }, [tenantId]);

  const fetchDepts = async () => {
    const { data } = await supabase
      .from('company_departments')
      .select('*')
      .eq('tenantId', tenantId)
      .order('name');
    setDepartments(data || []);
  };

  const handleCreate = async () => {
    if (!newName.trim()) return;
    setLoading(true);
    // Insere direto na tabela criada no SQL anterior
    const { data, error } = await supabase
      .from('company_departments')
      .insert({ name: newName, tenantId })
      .select()
      .single();
    
    if (!error && data) {
      setDepartments([...departments, data]);
      onChange(data.id); // Seleciona o novo
      setIsCreating(false);
      setNewName('');
    } else {
      alert('Erro ao criar departamento.');
    }
    setLoading(false);
  };

  if (isCreating) {
    return (
      <div className="flex gap-2 items-end">
        <div className="flex-1">
          <label className="block text-sm font-medium text-gray-700 mb-1">Nome da Nova Ãrea</label>
          <input 
            className="w-full border p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none"
            value={newName}
            onChange={e => setNewName(e.target.value)}
            placeholder="Ex: Financeiro"
            autoFocus
          />
        </div>
        <button 
          type="button"
          onClick={handleCreate} 
          disabled={loading}
          className="bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700 h-[42px]"
        >
          {loading ? '...' : 'Salvar'}
        </button>
        <button 
          type="button"
          onClick={() => setIsCreating(false)} 
          className="bg-gray-200 text-gray-700 px-3 py-2 rounded hover:bg-gray-300 h-[42px]"
        >
          X
        </button>
      </div>
    );
  }

  return (
    <div>
      <label className="block text-sm font-medium text-gray-700 mb-1">Departamento / Ãrea</label>
      <select 
        className="w-full border p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none bg-white"
        value={value || ''}
        onChange={e => {
          if (e.target.value === 'NEW') setIsCreating(true);
          else onChange(e.target.value);
        }}
      >
        <option value="">Selecione...</option>
        {departments.map(d => (
          <option key={d.id} value={d.id}>{d.name}</option>
        ))}
        <option value="NEW" className="font-bold text-blue-600">+ Criar Nova Ãrea</option>
      </select>
    </div>
  );
}

==================================================
ARQUIVO: src\components\EvaluationForm.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { supabase } from '../supabase/client';
import { Save, UserCheck, MessageSquare } from 'lucide-react';
import { Box, Typography, Paper, Grid, Button, TextField, Alert } from '@mui/material';
import { processEvaluation } from '../utils/evaluationLogic';

export default function EvaluationForm({ applicationId, jobParameters, initialData, allEvaluations, onSaved }) {
  const [answers, setAnswers] = useState({ triagem: {}, cultura: {}, tecnico: {} });
  const [notes, setNotes] = useState('');
  const [saving, setSaving] = useState(false);

  useEffect(() => {
    if (initialData) {
        setAnswers({
            triagem: initialData.triagem || {},
            cultura: initialData.cultura || {},
            tecnico: initialData.tecnico || {}
        });
        setNotes(initialData.anotacoes_gerais || '');
    }
  }, [initialData]);

  const currentScores = processEvaluation({ scores: answers }, jobParameters);

  const handleSelection = (section, criteriaName, noteId) => {
      setAnswers(prev => {
          const newSection = { ...prev[section] };
          if (newSection[criteriaName] === noteId) delete newSection[criteriaName];
          else newSection[criteriaName] = noteId;
          return { ...prev, [section]: newSection };
      });
  };

  const handleSave = async () => {
    setSaving(true);
    try {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) throw new Error("UsuÃ¡rio nÃ£o logado");

      const finalCalc = processEvaluation({ scores: answers }, jobParameters);

      const payload = {
        triagem: answers.triagem,
        cultura: answers.cultura,
        tecnico: answers.tecnico,
        anotacoes_gerais: notes,
        pillar_scores: finalCalc,
        evaluator_name: user.email,
        updated_at: new Date()
      };

      const { error: evalError } = await supabase.from('evaluations').upsert({
            application_id: applicationId,
            evaluator_id: user.id,
            scores: payload, 
            notes: notes,
            final_score: finalCalc.total
        }, { onConflict: 'application_id, evaluator_id' });

      if (evalError) throw evalError;
      alert("Salvo!");
      if (onSaved) onSaved();
    } catch (error) { alert("Erro: " + error.message); } finally { setSaving(false); }
  };

  const renderSectionCompact = (key, title, criteria) => {
    if (!criteria?.length) return null;
    const ratingScale = jobParameters.notas || [];
    const tempScores = processEvaluation({ scores: answers }, jobParameters);
    
    return (
      <Paper variant="outlined" sx={{ p: 1.5, mb: 2, borderColor: '#e0e0e0', bgcolor: '#fff' }}>
        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 1 }}>
            <Typography variant="subtitle2" sx={{ fontWeight: 'bold', fontSize: '0.85rem', color: '#1976d2' }}>{title}</Typography>
            <Typography variant="caption" sx={{ fontWeight: 'bold', bgcolor: '#e3f2fd', px: 1, py: 0.5, borderRadius: 1 }}>Nota: {tempScores[key].toFixed(1)}</Typography>
        </Box>
        {criteria.map((crit, idx) => (
            <Box key={idx} sx={{ mb: 1.5, borderBottom: '1px dashed #eee', pb: 1 }}>
                <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 0.5 }}>
                    <Typography variant="caption" sx={{ fontWeight: 500, width: '80%', lineHeight: 1.2 }}>{crit.name}</Typography>
                    <Typography variant="caption" color="text.secondary">{crit.weight}%</Typography>
                </Box>
                <Box sx={{ display: 'flex', gap: 0.5, flexWrap: 'wrap' }}>
                    {ratingScale.map(option => (
                        <Button key={option.id} size="small" onClick={() => handleSelection(key, crit.name, option.id)}
                                sx={{ minWidth: '30px', height: '24px', fontSize: '0.65rem', p: '0 8px', textTransform: 'none', bgcolor: answers[key]?.[crit.name] === option.id ? '#1976d2' : '#f5f5f5', color: answers[key]?.[crit.name] === option.id ? '#fff' : '#666', '&:hover': { bgcolor: answers[key]?.[crit.name] === option.id ? '#1565c0' : '#eeeeee' } }}>
                            {option.nome}
                        </Button>
                    ))}
                </Box>
            </Box>
        ))}
      </Paper>
    );
  };

  if (!jobParameters) return <Typography variant="caption">Carregando...</Typography>;

  return (
    <Box sx={{ height: '100%', display: 'flex', flexDirection: 'column' }}>
      <Box sx={{ mb: 2, display: 'flex', justifyContent: 'space-between', alignItems: 'center', bgcolor: '#fff', p: 1.5, borderRadius: 1, border: '1px solid #e0e0e0' }}>
        <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
            <UserCheck size={16} color="#666" />
            <Typography variant="body2" sx={{ fontWeight: 'bold' }}>Minha AvaliaÃ§Ã£o</Typography>
        </Box>
        <Typography variant="h6" sx={{ fontWeight: 'bold', color: '#1976d2' }}>
            {currentScores.total.toFixed(1)} <Typography component="span" variant="caption" color="text.secondary">/10</Typography>
        </Typography>
      </Box>

      <Box sx={{ flex: 1, overflowY: 'auto', pr: 1 }}>
          <Grid container spacing={1}>
              <Grid item xs={12} md={4}>{renderSectionCompact("triagem", "Triagem", jobParameters.triagem)}</Grid>
              <Grid item xs={12} md={4}>{renderSectionCompact("cultura", "Fit Cultural", jobParameters.cultura)}</Grid>
              <Grid item xs={12} md={4}>{renderSectionCompact("tecnico", "TÃ©cnico", jobParameters.tecnico || jobParameters['tÃ©cnico'])}</Grid>
          </Grid>
          
          <Paper variant="outlined" sx={{ p: 2, mt: 1 }}>
            <Typography variant="caption" fontWeight="bold" color="text.secondary" sx={{ textTransform: 'uppercase', mb: 1, display: 'block' }}>Minhas AnotaÃ§Ãµes</Typography>
            <TextField multiline rows={2} fullWidth variant="outlined" size="small" value={notes} onChange={e => setNotes(e.target.value)} placeholder="ComentÃ¡rios..." sx={{ bgcolor: '#fff' }} InputProps={{ style: { fontSize: '0.8rem' } }} />
          </Paper>

          {/* HISTÃ“RICO DE TODAS AS ANOTAÃ‡Ã•ES */}
          <Box sx={{ mt: 3, borderTop: '1px solid #eee', pt: 2 }}>
              <Typography variant="caption" fontWeight="bold" color="text.secondary" sx={{ textTransform: 'uppercase', mb: 1, display: 'flex', alignItems: 'center', gap: 1 }}>
                  <MessageSquare size={14} /> HistÃ³rico de ObservaÃ§Ãµes ({allEvaluations?.length || 0})
              </Typography>
              {allEvaluations && allEvaluations.length > 0 ? allEvaluations.map((ev, i) => (
                  <Box key={i} sx={{ mb: 1, p: 1.5, bgcolor: '#f9fafb', borderRadius: 1, border: '1px solid #eee' }}>
                      <Box display="flex" justifyContent="space-between" mb={0.5}>
                          {/* Usa o nome mapeado ou fallback */}
                          <Typography variant="caption" fontWeight="bold" color="primary">{ev.evaluator_name || 'UsuÃ¡rio'}</Typography>
                          <Typography variant="caption" color="text.secondary">Nota: {Number(ev.final_score).toFixed(1)}</Typography>
                      </Box>
                      <Typography variant="body2" sx={{ fontSize: '0.8rem', color: '#444' }}>{ev.notes || ev.scores?.anotacoes_gerais || 'Sem comentÃ¡rios.'}</Typography>
                  </Box>
              )) : <Typography variant="caption" color="text.secondary">Nenhuma avaliaÃ§Ã£o registrada ainda.</Typography>}
          </Box>
      </Box>

      <Box sx={{ mt: 2, pt: 1, borderTop: '1px solid #eee' }}>
        <Button onClick={handleSave} disabled={saving} variant="contained" fullWidth color="primary" startIcon={<Save size={16}/>} sx={{ textTransform: 'none', fontWeight: 'bold' }}>{saving ? "Salvando..." : "Salvar Minha Nota"}</Button>
      </Box>
    </Box>
  );
}

==================================================
ARQUIVO: src\components\jobs\CopyParametersModal.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { supabase } from '../../supabase/client';
import { 
    Dialog, DialogTitle, DialogContent, List, ListItem, 
    ListItemText, ListItemButton, CircularProgress, 
    Typography, Alert, Box 
} from '@mui/material';
import { Copy } from 'lucide-react';

export default function CopyParametersModal({ open, onClose, onSelect }) {
  const [jobs, setJobs] = useState([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  useEffect(() => {
    if (open) {
      fetchJobs();
    }
  }, [open]);

  const fetchJobs = async () => {
    setLoading(true);
    setError(null);
    try {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) return;

      const { data: profile } = await supabase.from('user_profiles').select('tenantId').eq('id', user.id).single();
      
      if (profile?.tenantId) {
        const { data } = await supabase
          .from('jobs')
          .select('id, title, created_at, parameters')
          .eq('tenantId', profile.tenantId)
          .order('created_at', { ascending: false })
          .limit(20);
        
        setJobs(data || []);
      }
    } catch (err) {
      setError('Erro ao carregar vagas anteriores.');
    } finally {
      setLoading(false);
    }
  };

  const handleSelectJob = (job) => {
    if (job.parameters) {
      onSelect(job.parameters);
      onClose();
    } else {
      setError('Esta vaga nÃ£o possui parÃ¢metros salvos.');
    }
  };

  return (
    <Dialog open={open} onClose={onClose} maxWidth="sm" fullWidth>
      <DialogTitle sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
        <Copy size={20} />
        Copiar CritÃ©rios de AvaliaÃ§Ã£o
      </DialogTitle>
      <DialogContent dividers>
        {loading && <Box display="flex" justifyContent="center" p={3}><CircularProgress /></Box>}
        
        {error && <Alert severity="error" sx={{ mb: 2 }}>{error}</Alert>}
        
        {!loading && jobs.length === 0 && (
          <Typography color="text.secondary" align="center" py={4}>
            Nenhuma vaga anterior encontrada.
          </Typography>
        )}

        <List>
          {!loading && jobs.map((job) => (
            <ListItem disablePadding key={job.id} divider>
              <ListItemButton onClick={() => handleSelectJob(job)}>
                <ListItemText 
                  primary={job.title} 
                  secondary={`Criada em: ${new Date(job.created_at).toLocaleDateString()}`} 
                />
              </ListItemButton>
            </ListItem>
          ))}
        </List>
      </DialogContent>
    </Dialog>
  );
}

==================================================
ARQUIVO: src\components\jobs\CreateJobModal.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { supabase } from '../../supabase/client';
import AreaSelect from '../AreaSelect';
import { AlertTriangle, Copy } from 'lucide-react';

export default function CreateJobModal({ open, onClose, onSuccess }) {
  const [tenantId, setTenantId] = useState(null);
  const [loading, setLoading] = useState(false);
  const [limitError, setLimitError] = useState(null);
  const [previousJobs, setPreviousJobs] = useState([]); // Lista de vagas para cÃ³pia
  const [copyFromId, setCopyFromId] = useState(''); // ID da vaga selecionada para cÃ³pia

  const [formData, setFormData] = useState({
    title: '', description: '', requirements: '', type: 'CLT', location_type: 'HÃ­brido', company_department_id: ''
  });

  // CritÃ©rios da Vaga Exemplo (Fixos)
  const EXAMPLE_CRITERIA = {
    "notas": [
      {
        "id": "5140db51-b042-45b2-a5ab-0a99e2982f4b",
        "nome": "Abaixo",
        "valor": 0
      },
      {
        "id": "789fcdc0-9fb9-4ca0-ae8a-50ccb11b5e68",
        "nome": "Atende",
        "valor": "5"
      },
      {
        "id": "e02c63cc-d9e5-448f-8ad3-ae2176eff9e1",
        "nome": "Supera",
        "valor": "10"
      }
    ],
    "cultura": [
      { "name": "O Cliente Ã© a nossa razÃ£o de existir", "weight": "20" },
      { "name": "TransparÃªncia Ã© essencial", "weight": "20" },
      { "name": "Colaborar mais do que competir", "weight": "20" },
      { "name": "A busca pelo melhor nunca termina", "weight": "20" },
      { "name": "NÃ£o hÃ¡ tempo a perder", "weight": "20" }
    ],
    "tecnico": [
      { "name": "CompreensÃ£o do escopo da demanda", "weight": "20" },
      { "name": "Capacidade de resoluÃ§Ã£o de problemas", "weight": "20" },
      { "name": "OrganizaÃ§Ã£o e MÃ©todo", "weight": "20" },
      { "name": "Capacidade de estruturar dados de forma eficaz", "weight": "20" },
      { "name": "Capacidade de otimizaÃ§Ã£o", "weight": "20" }
    ],
    "triagem": [
      { "name": "Escolaridade", "weight": "12.5" },
      { "name": "QualificaÃ§Ã£o exigÃ­vel", "weight": "12.5" },
      { "name": "QualificaÃ§Ã£o desejÃ¡vel", "weight": "12.5" },
      { "name": "ExperiÃªncia Geral", "weight": "12.5" },
      { "name": "ExperiÃªncia EspecÃ­fica", "weight": "12.5" },
      { "name": "Habilidade hard", "weight": "12.5" },
      { "name": "Habilidade soft", "weight": "12.5" },
      { "name": "LÃ­nguas", "weight": "12.5" }
    ]
  };

  useEffect(() => {
    if (open) {
      initialize();
    }
  }, [open]);

  const initialize = async () => {
    setLimitError(null);
    const { data: { user } } = await supabase.auth.getUser();
    if (!user) return;

    // 1. Pega Tenant
    const { data: profile } = await supabase.from('user_profiles').select('tenantId').eq('id', user.id).single();
    if (!profile?.tenantId) return;
    setTenantId(profile.tenantId);

    // 2. Verifica Limites
    const { data: tenant } = await supabase.from('tenants').select('planId').eq('id', profile.tenantId).single();
    const { data: plan } = await supabase.from('plans').select('job_limit').eq('id', tenant.planId || 'freemium').single();
    
    const limit = plan?.job_limit || 2;
    const isUnlimited = limit === -1;

    const { count } = await supabase
        .from('jobs')
        .select('*', { count: 'exact', head: true })
        .eq('tenantId', profile.tenantId)
        .eq('status', 'active');

    if (!isUnlimited && count >= limit) {
        setLimitError(`Limite de vagas ativas atingido (${limit}).`);
    }

    // 3. Busca vagas anteriores para permitir cÃ³pia de critÃ©rios
    const { data: jobs } = await supabase
        .from('jobs')
        .select('id, title')
        .eq('tenantId', profile.tenantId)
        .order('created_at', { ascending: false });
    setPreviousJobs(jobs || []);
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    if (limitError) return;
    
    setLoading(true);
    
    let parameters = {}; // PadrÃ£o vazio

    // Verifica a origem dos critÃ©rios
    if (copyFromId === 'EXAMPLE_TEMPLATE') {
        // OpÃ§Ã£o Fixa: Vaga Exemplo
        parameters = EXAMPLE_CRITERIA;
    } else if (copyFromId) {
        // OpÃ§Ã£o DinÃ¢mica: Vaga existente no banco
        const { data } = await supabase.from('jobs').select('parameters').eq('id', copyFromId).single();
        if (data?.parameters) {
            parameters = data.parameters;
        }
    } else {
        // ParÃ¢metros Default (Zero)
        parameters = {
            triagem: [], cultura: [], tecnico: [],
            notas: [{id:'1',nome:'Abaixo',valor:0}, {id:'2',nome:'Atende',valor:50}, {id:'3',nome:'Supera',valor:100}]
        };
    }

    const payload = {
      ...formData,
      tenantId: tenantId,
      status: 'active',
      company_department_id: formData.company_department_id ? parseInt(formData.company_department_id) : null,
      parameters: parameters // Salva os critÃ©rios copiados ou padrÃ£o
    };

    const { error } = await supabase.from('jobs').insert(payload);

    if (error) alert('Erro: ' + error.message);
    else {
      setFormData({ title: '', description: '', requirements: '', type: 'CLT', location_type: 'HÃ­brido', company_department_id: '' });
      setCopyFromId('');
      onSuccess();
      onClose();
    }
    setLoading(false);
  };

  if (!open) return null;

  return (
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
      <div className="bg-white rounded-lg shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto">
        <div className="p-6 border-b flex justify-between items-center">
          <h2 className="text-xl font-bold">Nova Vaga</h2>
          <button onClick={onClose} className="text-gray-500 hover:text-gray-700">âœ•</button>
        </div>
        
        {limitError ? (
            <div className="p-6 text-center">
                <div className="bg-red-50 text-red-700 p-4 rounded border border-red-200 mb-4 flex items-start gap-3 text-left">
                    <AlertTriangle className="w-6 h-6 shrink-0" />
                    <div>
                        <p className="font-bold">Limite Atingido</p>
                        <p className="text-sm mt-1">{limitError}</p>
                    </div>
                </div>
                <button onClick={onClose} className="bg-gray-200 px-4 py-2 rounded">Fechar</button>
            </div>
        ) : (
            <form onSubmit={handleSubmit} className="p-6 space-y-4">
            
            {/* Seletor de CÃ³pia - NOVIDADE */}
            <div className="bg-blue-50 p-3 rounded border border-blue-100 mb-4">
                <label className="block text-xs font-bold text-blue-800 mb-1 flex items-center gap-1">
                    <Copy size={12}/> Copiar critÃ©rios de avaliaÃ§Ã£o de:
                </label>
                <select 
                    className="w-full border p-2 rounded text-sm bg-white"
                    value={copyFromId}
                    onChange={e => setCopyFromId(e.target.value)}
                >
                    <option value="">-- ComeÃ§ar do Zero --</option>
                    
                    {/* OpÃ§Ã£o Fixa de Exemplo */}
                    <option value="EXAMPLE_TEMPLATE" className="font-bold text-blue-600">
                        â˜… Vaga Exemplo (Modelo PadrÃ£o)
                    </option>

                    {/* Vagas Existentes */}
                    {previousJobs.length > 0 && (
                        <optgroup label="Minhas Vagas Anteriores">
                            {previousJobs.map(j => (
                                <option key={j.id} value={j.id}>{j.title}</option>
                            ))}
                        </optgroup>
                    )}
                </select>
            </div>

            <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">TÃ­tulo da Vaga *</label>
                <input required className="w-full border p-2 rounded outline-none focus:ring-2 focus:ring-blue-500" value={formData.title} onChange={e => setFormData({...formData, title: e.target.value})} />
            </div>

            {tenantId && <AreaSelect tenantId={tenantId} value={formData.company_department_id} onChange={val => setFormData({...formData, company_department_id: val})} />}

            <div className="grid grid-cols-2 gap-4">
                <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Modelo</label>
                <select className="w-full border p-2 rounded bg-white" value={formData.location_type} onChange={e => setFormData({...formData, location_type: e.target.value})}>
                    <option>Presencial</option><option>HÃ­brido</option><option>Remoto</option>
                </select>
                </div>
                <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Contrato</label>
                <select className="w-full border p-2 rounded bg-white" value={formData.type} onChange={e => setFormData({...formData, type: e.target.value})}>
                    <option>CLT</option><option>PJ</option><option>EstÃ¡gio</option>
                </select>
                </div>
            </div>

            <div><label className="block text-sm font-medium text-gray-700 mb-1">DescriÃ§Ã£o</label><textarea className="w-full border p-2 rounded outline-none" rows="3" value={formData.description} onChange={e => setFormData({...formData, description: e.target.value})} /></div>
            <div><label className="block text-sm font-medium text-gray-700 mb-1">Requisitos</label><textarea className="w-full border p-2 rounded outline-none" rows="3" value={formData.requirements} onChange={e => setFormData({...formData, requirements: e.target.value})} /></div>

            <div className="flex justify-end gap-2 pt-4">
                <button type="button" onClick={onClose} className="px-4 py-2 text-gray-700 hover:bg-gray-100 rounded">Cancelar</button>
                <button type="submit" disabled={loading} className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50">{loading ? 'Criando...' : 'Criar Vaga'}</button>
            </div>
            </form>
        )}
      </div>
    </div>
  );
}

==================================================
ARQUIVO: src\components\jobs\JobCriteria.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { supabase } from '../../supabase/client';
import { Save, Plus, Trash2, Copy, AlertCircle, CheckCircle2 } from 'lucide-react';

export default function JobCriteria({ job, onUpdate }) {
  const defaultParams = {
    triagem: [],
    cultura: [],
    tecnico: [],
    notas: [
      { id: '1', nome: 'Abaixo', valor: 0 },
      { id: '2', nome: 'Atende', valor: 5 },
      { id: '3', nome: 'Supera', valor: 10 }
    ]
  };

  const [params, setParams] = useState(job.parameters || defaultParams);
  const [loading, setLoading] = useState(false);
  const [importJobId, setImportJobId] = useState('');
  const [allJobs, setAllJobs] = useState([]);

  useEffect(() => {
    const fetchJobs = async () => {
      const { data } = await supabase
        .from('jobs')
        .select('id, title')
        .neq('id', job.id)
        .order('created_at', { ascending: false });
      setAllJobs(data || []);
    };
    fetchJobs();
  }, [job.id]);

  // --- LÃ“GICA DE CRITÃ‰RIOS (PESOS) ---
  const getSectionTotal = (sectionKey) => {
    const items = params[sectionKey] || [];
    return items.reduce((acc, item) => acc + (Number(item.weight) || 0), 0);
  };

  const addItem = (section) => {
    const newItem = { name: '', weight: 0 };
    setParams({ ...params, [section]: [...(params[section] || []), newItem] });
  };

  const removeItem = (section, index) => {
    const newList = [...params[section]];
    newList.splice(index, 1);
    setParams({ ...params, [section]: newList });
  };

  const updateItem = (section, index, field, value) => {
    const newList = [...params[section]];
    newList[index][field] = value;
    setParams({ ...params, [section]: newList });
  };

  // --- LÃ“GICA DA RÃ‰GUA DE NOTAS (NOVA) ---
  const addNoteLevel = () => {
    const newNote = { id: crypto.randomUUID(), nome: '', valor: 0 };
    setParams({ ...params, notas: [...(params.notas || []), newNote] });
  };

  const removeNoteLevel = (index) => {
    const newNotas = [...params.notas];
    newNotas.splice(index, 1);
    setParams({ ...params, notas: newNotas });
  };

  const updateNoteLevel = (index, field, value) => {
    const newNotas = [...params.notas];
    newNotas[index][field] = value;
    setParams({ ...params, notas: newNotas });
  };

  // --- SALVAR E IMPORTAR ---
  const handleSave = async () => {
    // 1. ValidaÃ§Ã£o de Pesos
    const sections = ['triagem', 'cultura', 'tecnico'];
    const errors = [];

    sections.forEach(sec => {
      const total = getSectionTotal(sec);
      if ((params[sec] && params[sec].length > 0) && total !== 100) {
        errors.push(`A seÃ§Ã£o ${sec.toUpperCase()} soma ${total}% (deve ser 100%).`);
      }
    });

    // 2. ValidaÃ§Ã£o da RÃ©gua de Notas
    if (!params.notas || params.notas.length < 2) {
      errors.push("A RÃ©gua de Notas deve ter pelo menos 2 nÃ­veis (ex: Min e Max).");
    }

    if (errors.length > 0) {
      alert(`Erro de ValidaÃ§Ã£o:\n\n${errors.join('\n')}\n\nAjuste antes de salvar.`);
      return;
    }

    setLoading(true);
    const { error } = await supabase
      .from('jobs')
      .update({ parameters: params })
      .eq('id', job.id);

    if (error) alert("Erro ao salvar: " + error.message);
    else {
      alert("CritÃ©rios atualizados com sucesso!");
      if (onUpdate) onUpdate();
    }
    setLoading(false);
  };

  const importCriteria = async () => {
    if (!importJobId) return;
    const { data } = await supabase.from('jobs').select('parameters').eq('id', importJobId).single();
    if (data?.parameters) {
      setParams(data.parameters);
      alert("CritÃ©rios importados! Verifique os pesos e salve.");
    }
  };

  // --- RENDERIZADORES ---
  const renderSection = (title, key, color) => {
    const totalWeight = getSectionTotal(key);
    const isValid = totalWeight === 100;
    const isEmpty = !params[key] || params[key].length === 0;

    let statusColor = "text-gray-400";
    let statusIcon = null;
    let statusText = "Vazio (0%)";

    if (!isEmpty) {
      if (isValid) {
        statusColor = "text-green-600";
        statusIcon = <CheckCircle2 size={16} />;
        statusText = "Total: 100% (OK)";
      } else {
        statusColor = "text-red-600";
        statusIcon = <AlertCircle size={16} />;
        statusText = `Total: ${totalWeight}% (Faltam ${100 - totalWeight}%)`;
      }
    }

    return (
      <div className={`bg-gray-50 p-4 rounded border mb-4 ${!isEmpty && !isValid ? 'border-red-200 bg-red-50' : ''}`}>
        <div className="flex justify-between items-center mb-3">
          <div className="flex flex-col">
            <h3 className={`font-bold uppercase text-sm ${color}`}>{title}</h3>
            <div className={`text-xs font-bold flex items-center gap-1 mt-1 ${statusColor}`}>
              {statusIcon} {statusText}
            </div>
          </div>
          <button onClick={() => addItem(key)} className="text-xs flex items-center gap-1 text-blue-600 font-bold hover:underline">
            <Plus size={14}/> Adicionar CritÃ©rio
          </button>
        </div>
        
        {isEmpty && <p className="text-sm text-gray-400 italic">Nenhum critÃ©rio definido.</p>}

        <div className="space-y-2">
          {(params[key] || []).map((item, idx) => (
            <div key={idx} className="flex gap-2 items-center">
              <input 
                className="flex-1 border p-1 rounded text-sm outline-none focus:ring-1 focus:ring-blue-500"
                placeholder="Nome do CritÃ©rio (Ex: ComunicaÃ§Ã£o)"
                value={item.name}
                onChange={e => updateItem(key, idx, 'name', e.target.value)}
              />
              <div className="w-24 relative">
                <input 
                  type="number"
                  className="w-full border p-1 rounded text-sm text-center pr-6 outline-none focus:ring-1 focus:ring-blue-500"
                  placeholder="%"
                  value={item.weight}
                  onChange={e => updateItem(key, idx, 'weight', e.target.value)}
                />
                <span className="absolute right-2 top-1 text-gray-400 text-xs">%</span>
              </div>
              <button onClick={() => removeItem(key, idx)} className="text-red-500 hover:bg-red-100 p-1 rounded">
                <Trash2 size={14}/>
              </button>
            </div>
          ))}
        </div>
      </div>
    );
  };

  return (
    <div className="space-y-6">
      <div className="flex justify-between items-end border-b pb-4">
        <div>
          <h2 className="text-lg font-bold text-gray-800">ConfiguraÃ§Ã£o da AvaliaÃ§Ã£o</h2>
          <p className="text-sm text-gray-500">Defina os critÃ©rios e seus pesos (Soma deve ser 100%).</p>
        </div>
        
        <div className="flex gap-2 items-center">
          <select 
            className="border p-2 rounded text-sm max-w-[200px]"
            value={importJobId}
            onChange={e => setImportJobId(e.target.value)}
          >
            <option value="">Copiar de outra vaga...</option>
            {allJobs.map(j => <option key={j.id} value={j.id}>{j.title}</option>)}
          </select>
          <button onClick={importCriteria} disabled={!importJobId} className="bg-gray-200 p-2 rounded hover:bg-gray-300" title="Copiar">
            <Copy size={16}/>
          </button>
        </div>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          {renderSection('Triagem (RH)', 'triagem', 'text-purple-600')}
          {renderSection('Fit Cultural', 'cultura', 'text-green-600')}
        </div>
        
        <div>
          {renderSection('TÃ©cnico / Hard Skills', 'tecnico', 'text-blue-600')}
          
          {/* CONFIGURAÃ‡ÃƒO DA RÃ‰GUA DE NOTAS (DINÃ‚MICA) */}
          <div className="bg-white p-4 rounded border shadow-sm border-l-4 border-l-orange-400">
            <div className="flex justify-between items-center mb-3">
              <div>
                <h3 className="font-bold uppercase text-sm text-gray-800">RÃ©gua de Notas</h3>
                <p className="text-xs text-gray-500">Defina os nÃ­veis e valores para o cÃ¡lculo.</p>
              </div>
              <button onClick={addNoteLevel} className="text-xs flex items-center gap-1 text-orange-600 font-bold hover:underline">
                <Plus size={14}/> Novo NÃ­vel
              </button>
            </div>

            <div className="space-y-2">
              <div className="flex gap-2 text-xs font-bold text-gray-400 px-1">
                <span className="flex-1">Nome do NÃ­vel</span>
                <span className="w-20 text-center">Nota</span>
                <span className="w-6"></span>
              </div>
              
              {(params.notas || []).map((nota, idx) => (
                <div key={idx} className="flex gap-2 items-center">
                  <input 
                    className="flex-1 border p-1 rounded text-sm outline-none focus:ring-1 focus:ring-orange-500"
                    value={nota.nome}
                    placeholder="Ex: Atende"
                    onChange={e => updateNoteLevel(idx, 'nome', e.target.value)}
                  />
                  <input 
                    type="number"
                    className="w-20 border p-1 rounded text-sm text-center outline-none focus:ring-1 focus:ring-orange-500"
                    value={nota.valor}
                    placeholder="0"
                    onChange={e => updateNoteLevel(idx, 'valor', e.target.value)}
                  />
                  <button onClick={() => removeNoteLevel(idx)} className="text-red-400 hover:text-red-600 p-1">
                    <Trash2 size={14}/>
                  </button>
                </div>
              ))}
              
              {(!params.notas || params.notas.length === 0) && (
                <p className="text-sm text-red-500 italic py-2 text-center bg-red-50 rounded">
                  Defina pelo menos 2 nÃ­veis de nota.
                </p>
              )}
            </div>
          </div>
        </div>
      </div>

      <div className="flex justify-end pt-4 border-t">
        <button 
          onClick={handleSave} 
          disabled={loading}
          className="bg-blue-600 text-white px-6 py-2 rounded flex items-center gap-2 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium shadow-sm"
        >
          <Save size={18}/> {loading ? 'Salvando...' : 'Salvar ConfiguraÃ§Ã£o'}
        </button>
      </div>
    </div>
  );
}

==================================================
ARQUIVO: src\pages\ApplicationDetails.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import { supabase } from '../supabase/client';
import EvaluationForm from '../components/EvaluationForm';
import { ArrowLeft, Mail, MapPin, BookOpen, FileText, Download, Linkedin, Github, Phone, Calendar } from 'lucide-react';
import { Box, Grid, Paper, Typography, Button, CircularProgress, Divider, Avatar } from '@mui/material';
import { processEvaluation } from '../utils/evaluationLogic';
import { formatPhone, formatUrl } from '../utils/formatters';

export default function ApplicationDetails() {
  const { appId } = useParams();
  const navigate = useNavigate();
  
  const [appData, setAppData] = useState(null);
  const [job, setJob] = useState(null);
  const [currentUserEvaluation, setCurrentUserEvaluation] = useState(null);
  const [globalScore, setGlobalScore] = useState(0);
  const [evaluatorsCount, setEvaluatorsCount] = useState(0);
  const [allEvaluations, setAllEvaluations] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetchData();
  }, [appId]);

  const fetchData = async () => {
    setLoading(true);
    try {
      const { data: { user } } = await supabase.auth.getUser();
      const { data: application } = await supabase.from('applications').select('*, candidates(*)').eq('id', appId).single();
      const candidateObj = Array.isArray(application.candidates) ? application.candidates[0] : application.candidates;
      
      // Parse Seguro do formData
      let safeFormData = application.formData;
      if (typeof safeFormData === 'string') {
          try { safeFormData = JSON.parse(safeFormData); } catch(e) { console.log('Erro parse formData', e); }
      }
      
      setAppData({ ...application, formData: safeFormData, candidate: candidateObj });

      let jobParams = {};
      if (application.jobId) {
        const { data: jobData } = await supabase.from('jobs').select('*').eq('id', application.jobId).single();
        setJob(jobData);
        jobParams = jobData.parameters || {};
      }

      const { data: allEvals } = await supabase.from('evaluations').select('*').eq('application_id', appId);
      if (allEvals) {
          const userIds = [...new Set(allEvals.map(e => e.evaluator_id))];
          let usersMap = {};
          if (userIds.length > 0) {
              const { data: users } = await supabase.from('users').select('id, name, email').in('id', userIds);
              users?.forEach(u => usersMap[u.id] = u.name || u.email);
          }
          const evalsWithNames = allEvals.map(e => ({ ...e, evaluator_name: usersMap[e.evaluator_id] || 'Avaliador' }));
          setAllEvaluations(evalsWithNames);
          setEvaluatorsCount(evalsWithNames.length);
          
          let sumTotal = 0, validCount = 0;
          evalsWithNames.forEach(ev => {
              const scores = processEvaluation(ev, jobParams);
              if (scores.total > 0) { sumTotal += scores.total; validCount++; }
          });
          setGlobalScore(validCount > 0 ? (sumTotal / validCount) : 0);

          if (user) {
              const myEval = allEvals.find(e => e.evaluator_id === user.id);
              if (myEval) {
                  const myScores = processEvaluation(myEval, jobParams);
                  setCurrentUserEvaluation({ ...myEval.scores, anotacoes_gerais: myEval.notes || myEval.scores?.anotacoes_gerais, final_score: myScores.total });
              } else { setCurrentUserEvaluation(null); }
          }
      }
    } catch (err) { console.error(err); } finally { setLoading(false); }
  };

  const renderInfo = (data) => {
    if (!data) return null;
    
    // Suporte para estrutura plana (novo JSON) ou aninhada (antigo)
    const course = data.course || data.education?.course;
    const institution = data.institution || data.education?.institution;
    const year = data.completionYear || data.education?.date;
    const birth = data.birthDate;
    const eng = data.englishLevel;

    return (
        <>
            {/* Bloco FormaÃ§Ã£o */}
            <Box sx={{ mt: 3 }}>
                <Typography variant="caption" fontWeight="bold" sx={{textTransform: 'uppercase', color: 'text.secondary', display:'flex', alignItems:'center', gap:1}}>
                    <BookOpen size={14}/> FormaÃ§Ã£o
                </Typography>
                <Box sx={{ bgcolor: '#f9fafb', p: 1.5, borderRadius: 1, border: '1px solid #eee', mt: 0.5 }}>
                    <Typography variant="caption" display="block" fontWeight="bold">{course || 'Curso nÃ£o informado'}</Typography>
                    <Typography variant="caption" display="block" color="text.secondary">{institution || 'InstituiÃ§Ã£o nÃ£o informada'}</Typography>
                    {year && <Typography variant="caption" display="block" color="text.secondary">ConclusÃ£o: {year}</Typography>}
                </Box>
            </Box>

            {/* Bloco Extras (InglÃªs, Nasc) */}
            {(birth || eng) && (
                <Box sx={{ mt: 2 }}>
                    <Typography variant="caption" fontWeight="bold" sx={{textTransform: 'uppercase', color: 'text.secondary', display:'flex', alignItems:'center', gap:1}}>
                        <Calendar size={14}/> Detalhes
                    </Typography>
                    <Box sx={{ bgcolor: '#f9fafb', p: 1.5, borderRadius: 1, border: '1px solid #eee', mt: 0.5 }}>
                        {birth && <Typography variant="caption" display="block">Nascimento: {birth}</Typography>}
                        {eng && <Typography variant="caption" display="block">InglÃªs: {eng}</Typography>}
                    </Box>
                </Box>
            )}
        </>
    );
  };

  const renderScoreBadges = (gScore, myScore, count) => {
    const getBgColor = (s) => s >= 8 ? '#e8f5e9' : s >= 5 ? '#fff3e0' : '#ffebee';
    const getTextColor = (s) => s >= 8 ? '#2e7d32' : s >= 5 ? '#ef6c00' : '#c62828';
    return (
        <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2, mt: 3, width: '100%' }}>
            <Paper elevation={0} sx={{ bgcolor: getBgColor(gScore), p: 2, borderRadius: 2, border: '1px solid', borderColor: 'divider', textAlign: 'center' }}>
                <Typography variant="subtitle2" sx={{ textTransform: 'uppercase', fontWeight: 'bold', color: 'text.secondary', fontSize: '0.75rem' }}>Nota Global</Typography>
                <Typography variant="caption" sx={{ display:'block', fontSize: '0.7rem', color: 'text.secondary', mb: 0.5 }}>({count} {count === 1 ? 'avaliaÃ§Ã£o' : 'avaliaÃ§Ãµes'})</Typography>
                <Typography variant="h3" sx={{ fontWeight: 800, color: getTextColor(gScore), lineHeight: 1 }}>{Number(gScore || 0).toFixed(1)}</Typography>
            </Paper>
            <Paper elevation={0} sx={{ bgcolor: '#f3f4f6', p: 2, borderRadius: 2, border: '1px solid', borderColor: 'divider', textAlign: 'center' }}>
                <Typography variant="subtitle2" sx={{ textTransform: 'uppercase', fontWeight: 'bold', color: 'text.secondary', fontSize: '0.75rem', mb: 1 }}>Minha Nota</Typography>
                <Typography variant="h3" sx={{ fontWeight: 800, color: '#374151', lineHeight: 1 }}>{Number(myScore || 0).toFixed(1)}</Typography>
            </Paper>
        </Box>
    );
  };

  if (loading) return <Box p={4} display="flex" justifyContent="center"><CircularProgress /></Box>;
  if (!appData) return <Box p={4} textAlign="center">Candidato nÃ£o encontrado.</Box>;

  const params = job?.parameters || {};
  const formData = appData.formData || {};
  const candidate = appData.candidate || {};
  
  // Mescla dados do formData com a tabela candidate
  const displayPhone = candidate.phone || formData.phone;
  const displayCity = candidate.city || formData.city;
  const displayState = candidate.state || formData.state;
  const linkedIn = candidate.linkedin_profile || formData.linkedinProfile || formData.linkedin_profile;
  const gitHub = candidate.github_profile || formData.githubProfile;

  return (
    <Box sx={{ bgcolor: '#f8f9fa', minHeight: '100vh', p: 2 }}>
      <Button onClick={() => navigate(-1)} startIcon={<ArrowLeft size={16}/>} sx={{ mb: 2, color: 'text.secondary' }}>Voltar</Button>
      <Grid container spacing={3}>
        <Grid item xs={12} md={3}>
          <Paper sx={{ p: 3, height: '100%' }} elevation={0} variant="outlined">
            <Box sx={{ display: 'flex', flexDirection: 'column', alignItems: 'center', textAlign: 'center' }}>
              <Avatar sx={{ width: 80, height: 80, bgcolor: '#1976d2', fontSize: '2rem', mb: 2, fontWeight: 'bold' }}>{candidate.name?.[0]}</Avatar>
              <Typography variant="h6" sx={{ fontSize: '1.1rem', fontWeight: 'bold', lineHeight: 1.2 }}>{candidate.name}</Typography>
              <Typography variant="caption" color="text.secondary" sx={{ mb: 2 }}>{job?.title}</Typography>
              {renderScoreBadges(globalScore, currentUserEvaluation?.final_score, evaluatorsCount)}
            </Box>
            <Divider sx={{ my: 3 }} />
            <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1.5 }}>
                <Box display="flex" alignItems="center" gap={1.5}><Mail size={16} className="text-gray-400"/><Typography variant="body2" sx={{wordBreak: 'break-all'}}>{candidate.email || formData.email}</Typography></Box>
                <Box display="flex" alignItems="center" gap={1.5}><Phone size={16} className="text-gray-400"/><Typography variant="body2">{formatPhone(displayPhone)}</Typography></Box>
                <Box display="flex" alignItems="center" gap={1.5}><MapPin size={16} className="text-gray-400"/><Typography variant="body2">{displayCity} - {displayState}</Typography></Box>
            </Box>
            <Box sx={{ mt: 3, display: 'flex', flexDirection: 'column', gap: 1 }}>
                {candidate.resume_url && (<Button variant="contained" color="primary" fullWidth href={candidate.resume_url} target="_blank" startIcon={<Download size={18}/>} sx={{ mb: 1, textTransform: 'none', fontWeight: 'bold' }}>Ver CurrÃ­culo</Button>)}
                {linkedIn && (<Button variant="outlined" fullWidth href={formatUrl(linkedIn)} target="_blank" startIcon={<Linkedin size={16}/>} sx={{ textTransform: 'none', color: '#0077b5', borderColor: '#0077b5' }}>LinkedIn</Button>)}
                {gitHub && (<Button variant="outlined" fullWidth href={formatUrl(gitHub)} target="_blank" startIcon={<Github size={16}/>} sx={{ textTransform: 'none', color: '#333', borderColor: '#333' }}>GitHub</Button>)}
            </Box>
            <Divider sx={{ my: 3 }} />
            
            {renderInfo(formData)}

            <Box sx={{ mt: 3 }}>
               <Typography variant="caption" fontWeight="bold" sx={{textTransform: 'uppercase', color: 'text.secondary', display:'flex', alignItems:'center', gap:1}}><FileText size={14}/> MotivaÃ§Ã£o</Typography>
               <Typography variant="body2" paragraph sx={{ bgcolor: '#f9fafb', p: 1.5, borderRadius: 1, border: '1px solid #eee', mt: 1, whiteSpace: 'pre-line', fontSize: '0.85rem' }}>{formData.motivation || 'NÃ£o informada'}</Typography>
            </Box>
            <Box sx={{ mt: 2 }}><Typography variant="caption" color="text.secondary">Candidatou-se em: {new Date(appData.created_at).toLocaleDateString('pt-BR')}</Typography></Box>
          </Paper>
        </Grid>
        <Grid item xs={12} md={9}>
          <Paper sx={{ p: 0, height: '100%', overflow: 'hidden', bgcolor: 'transparent' }} elevation={0}>
             <EvaluationForm applicationId={appData.id} jobParameters={params} initialData={currentUserEvaluation} allEvaluations={allEvaluations} onSaved={fetchData} />
          </Paper>
        </Grid>
      </Grid>
    </Box>
  );
}

==================================================
ARQUIVO: src\pages\ApplyJob.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { useParams } from 'react-router-dom';
import { supabase } from '../supabase/client';
import { Building, MapPin, Briefcase, CheckCircle, Send, GraduationCap, User, Link as LinkIcon, FileText, Upload, Paperclip, AlertCircle } from 'lucide-react';

export default function ApplyJob() {
  const { jobId } = useParams();
  const [job, setJob] = useState(null);
  const [loading, setLoading] = useState(true);
  const [submitting, setSubmitting] = useState(false);
  const [success, setSuccess] = useState(false);

  // Controle de Tipo de CurrÃ­culo (Arquivo ou Link)
  const [resumeType, setResumeType] = useState('file'); 
  const [resumeFile, setResumeFile] = useState(null);

  // Estado do FormulÃ¡rio
  // PADRONIZADO: Usamos snake_case onde o dado vai para o banco (candidates)
  // E mantemos os campos de educaÃ§Ã£o que vÃ£o para o JSON (applications)
  const [formData, setFormData] = useState({
    // Grupo A: Candidates (Perfil)
    name: '',
    email: '',
    phone: '',
    city: '',
    state: '',
    linkedin_profile: '', // Corrigido para snake_case
    github_profile: '',   // Corrigido para snake_case
    resume_link_input: '', // Campo visual para quando o usuÃ¡rio cola link

    // Grupo B: Applications (JSON form_data)
    motivation: '',
    education_level: '',
    education_status: '',
    course_name: '',
    institution: '',
    conclusion_date: '',
    current_period: ''
  });

  useEffect(() => {
    fetchJobDetails();
  }, [jobId]);

  const fetchJobDetails = async () => {
    const { data, error } = await supabase
      .from('jobs')
      .select('title, description, requirements, location_type, type, status')
      .eq('id', jobId)
      .single();

    if (error || !data) {
      alert("Vaga nÃ£o encontrada ou encerrada.");
    } else {
      setJob(data);
    }
    setLoading(false);
  };

  const handleInputChange = (field, value) => {
    setFormData(prev => ({ ...prev, [field]: value }));
  };

  const handleFileChange = (e) => {
    if (e.target.files && e.target.files.length > 0) {
      setResumeFile(e.target.files[0]);
    }
  };

  // FunÃ§Ã£o que faz o upload para o Supabase Storage e retorna a URL pÃºblica
  const uploadResumeToStorage = async () => {
    if (!resumeFile) return null;

    // Sanitiza nome do arquivo para evitar erros no Storage
    const fileExt = resumeFile.name.split('.').pop();
    const sanitizedEmail = formData.email.replace(/[^a-zA-Z0-9]/g, '');
    const fileName = `${sanitizedEmail}_${Date.now()}.${fileExt}`;
    
    // Caminho dentro do bucket 'resumes'
    const filePath = `${fileName}`;

    // Upload
    const { error: uploadError } = await supabase.storage
      .from('resumes')
      .upload(filePath, resumeFile);

    if (uploadError) throw new Error("Erro no upload do arquivo: " + uploadError.message);

    // Gera URL pÃºblica
    const { data } = supabase.storage.from('resumes').getPublicUrl(filePath);
    return data.publicUrl;
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setSubmitting(true);

    try {
      if (job.status !== 'active') throw new Error("Esta vaga nÃ£o estÃ¡ mais aceitando candidaturas.");
      
      let finalResumeUrl = '';

      // --- 1. RESOLVER URL DO CURRÃCULO ---
      if (resumeType === 'file') {
        if (!resumeFile) throw new Error("Por favor, selecione um arquivo de currÃ­culo (PDF/DOC).");
        // Faz o upload agora e pega a URL
        finalResumeUrl = await uploadResumeToStorage();
      } else {
        // Usa o link colado pelo usuÃ¡rio
        if (!formData.resume_link_input) throw new Error("Por favor, cole o link do seu currÃ­culo (Google Drive/Dropbox).");
        finalResumeUrl = formData.resume_link_input;
      }

      // --- 2. PREPARAR ENVIO PARA API ---
      const payload = new FormData();
      payload.append('jobId', jobId);
      
      // Campos do Perfil (Candidates)
      payload.append('name', formData.name);
      payload.append('email', formData.email);
      payload.append('phone', formData.phone);
      payload.append('city', formData.city);
      payload.append('state', formData.state);
      payload.append('linkedin_profile', formData.linkedin_profile);
      payload.append('github_profile', formData.github_profile);
      payload.append('resume_url', finalResumeUrl); // Mandamos a URL final processada

      // Campos da AplicaÃ§Ã£o (JSON)
      payload.append('motivation', formData.motivation);
      payload.append('education_level', formData.education_level);
      payload.append('education_status', formData.education_status);
      payload.append('course_name', formData.course_name);
      payload.append('institution', formData.institution);
      payload.append('conclusion_date', formData.conclusion_date);
      payload.append('current_period', formData.current_period);

      const response = await fetch('/api/apply', {
          method: 'POST',
          body: payload
      });

      const result = await response.json();
      if (!response.ok) throw new Error(result.error || "Erro ao enviar.");

      setSuccess(true);

    } catch (err) {
      alert("Erro ao enviar: " + err.message);
    } finally {
      setSubmitting(false);
    }
  };

  // LÃ³gica visual para mostrar campos de educaÃ§Ã£o
  const isSuperiorOrTech = ['tecnico', 'superior', 'pos', 'mestrado'].includes(formData.education_level);
  const isStudying = formData.education_status === 'cursando';
  const isCompleted = formData.education_status === 'completo';

  if (loading) return <div className="min-h-screen flex items-center justify-center bg-gray-50">Carregando...</div>;
  if (!job) return <div className="min-h-screen flex items-center justify-center bg-gray-50">Vaga indisponÃ­vel.</div>;

  if (success) {
    return (
        <div className="min-h-screen bg-gray-50 flex items-center justify-center p-4">
            <div className="bg-white p-8 rounded-lg shadow-md text-center max-w-md w-full border-t-4 border-green-500">
                <div className="flex justify-center mb-4">
                    <div className="bg-green-100 p-3 rounded-full">
                        <CheckCircle className="text-green-600 w-12 h-12" />
                    </div>
                </div>
                <h2 className="text-2xl font-bold text-gray-800 mb-2">Candidatura Recebida!</h2>
                <p className="text-gray-600 mb-6">
                    Seus dados foram enviados com sucesso para a vaga de <strong>{job.title}</strong>.
                    Boa sorte!
                </p>
                <button onClick={() => window.location.reload()} className="text-blue-600 font-medium hover:underline text-sm">
                    Voltar para a vaga
                </button>
            </div>
        </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-50 py-10 px-4 font-sans">
      <div className="max-w-5xl mx-auto bg-white rounded-xl shadow-xl overflow-hidden border border-gray-100">
        
        {/* Header da Vaga */}
        <div className="bg-slate-800 p-8 text-white relative">
            <h1 className="text-3xl font-bold mb-3">{job.title}</h1>
            <div className="flex flex-wrap gap-4 text-slate-300 text-sm font-medium">
                <span className="flex items-center gap-1 bg-slate-700 px-3 py-1 rounded-full"><Briefcase size={14}/> {job.type}</span>
                <span className="flex items-center gap-1 bg-slate-700 px-3 py-1 rounded-full"><MapPin size={14}/> {job.location_type}</span>
                <span className="flex items-center gap-1 bg-slate-700 px-3 py-1 rounded-full"><Building size={14}/> Novva R&S</span>
            </div>
        </div>

        <div className="grid lg:grid-cols-12">
            {/* Coluna Esquerda: DescriÃ§Ã£o */}
            <div className="lg:col-span-5 p-8 bg-gray-50 border-r border-gray-100 sticky top-0 h-fit">
                <div className="space-y-8">
                    <div>
                        <h3 className="font-bold text-slate-800 text-lg mb-3 flex items-center gap-2">
                            <FileText size={20} className="text-blue-600"/> DescriÃ§Ã£o
                        </h3>
                        <p className="text-slate-600 whitespace-pre-line text-sm leading-relaxed">{job.description || "Sem descriÃ§Ã£o."}</p>
                    </div>
                    {job.requirements && (
                        <div>
                            <h3 className="font-bold text-slate-800 text-lg mb-3 flex items-center gap-2">
                                <CheckCircle size={20} className="text-green-600"/> Requisitos
                            </h3>
                            <p className="text-slate-600 whitespace-pre-line text-sm leading-relaxed">{job.requirements}</p>
                        </div>
                    )}
                </div>
            </div>

            {/* Coluna Direita: FormulÃ¡rio */}
            <div className="lg:col-span-7 p-8 bg-white">
                <h2 className="text-2xl font-bold text-slate-800 mb-6 pb-2 border-b border-gray-100">Ficha de InscriÃ§Ã£o</h2>
                
                <form onSubmit={handleSubmit} className="space-y-8">
                    
                    {/* DADOS PESSOAIS */}
                    <section>
                        <h4 className="flex items-center gap-2 text-sm font-bold text-blue-600 uppercase mb-4 tracking-wide">
                            <User size={16}/> Dados BÃ¡sicos
                        </h4>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-5">
                            <div className="md:col-span-2">
                                <label className="block text-xs font-bold text-gray-500 mb-1">Nome Completo *</label>
                                <input required className="w-full border p-2.5 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition" 
                                    value={formData.name} onChange={e => handleInputChange('name', e.target.value)} />
                            </div>
                            <div className="md:col-span-2">
                                <label className="block text-xs font-bold text-gray-500 mb-1">Email *</label>
                                <input required type="email" className="w-full border p-2.5 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition" 
                                    value={formData.email} onChange={e => handleInputChange('email', e.target.value)} />
                            </div>
                            <div>
                                <label className="block text-xs font-bold text-gray-500 mb-1">Telefone / Celular *</label>
                                <input required className="w-full border p-2.5 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition" 
                                    value={formData.phone} onChange={e => handleInputChange('phone', e.target.value)} />
                            </div>
                            <div className="grid grid-cols-3 gap-2">
                                <div className="col-span-2">
                                    <label className="block text-xs font-bold text-gray-500 mb-1">Cidade</label>
                                    <input className="w-full border p-2.5 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition" 
                                        value={formData.city} onChange={e => handleInputChange('city', e.target.value)} />
                                </div>
                                <div>
                                    <label className="block text-xs font-bold text-gray-500 mb-1">UF</label>
                                    <select className="w-full border p-2.5 rounded-lg text-sm bg-white outline-none focus:ring-2 focus:ring-blue-100"
                                        value={formData.state} onChange={e => handleInputChange('state', e.target.value)}>
                                        <option value="">--</option>
                                        {['AC','AL','AP','AM','BA','CE','DF','ES','GO','MA','MT','MS','MG','PA','PB','PR','PE','PI','RJ','RN','RS','RO','RR','SC','SP','SE','TO'].map(uf => (
                                            <option key={uf} value={uf}>{uf}</option>
                                        ))}
                                    </select>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* CURRÃCULO E LINKS */}
                    <section>
                        <h4 className="flex items-center gap-2 text-sm font-bold text-blue-600 uppercase mb-4 tracking-wide border-t border-gray-100 pt-6">
                            <Paperclip size={16}/> CurrÃ­culo e Links
                        </h4>
                        
                        <div className="bg-gray-50 p-4 rounded-lg border mb-4">
                            <label className="block text-xs font-bold text-gray-500 mb-2">Como deseja enviar seu currÃ­culo?</label>
                            <div className="flex gap-4 mb-4">
                                <label className="flex items-center gap-2 text-sm cursor-pointer p-2 hover:bg-gray-100 rounded">
                                    <input type="radio" name="resumeType" checked={resumeType === 'file'} onChange={() => setResumeType('file')} className="text-blue-600"/>
                                    <Upload size={16} className="text-gray-600 ml-1"/> Arquivo (PDF/DOC)
                                </label>
                                <label className="flex items-center gap-2 text-sm cursor-pointer p-2 hover:bg-gray-100 rounded">
                                    <input type="radio" name="resumeType" checked={resumeType === 'link'} onChange={() => setResumeType('link')} className="text-blue-600"/>
                                    <LinkIcon size={16} className="text-gray-600 ml-1"/> Link (Drive/LinkedIn)
                                </label>
                            </div>

                            {resumeType === 'file' ? (
                                <div>
                                    <input 
                                      type="file" 
                                      accept=".pdf,.doc,.docx"
                                      onChange={handleFileChange}
                                      className="block w-full text-sm text-slate-500
                                        file:mr-4 file:py-2 file:px-4
                                        file:rounded-full file:border-0
                                        file:text-sm file:font-semibold
                                        file:bg-blue-50 file:text-blue-700
                                        hover:file:bg-blue-100"
                                    />
                                    <p className="text-xs text-gray-400 mt-1 flex items-center gap-1">
                                        <AlertCircle size={10}/> Formatos: PDF, DOC. MÃ¡x 5MB.
                                    </p>
                                </div>
                            ) : (
                                <div>
                                    <input 
                                        className="w-full border p-2.5 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition" 
                                        placeholder="Ex: https://docs.google.com/..."
                                        value={formData.resume_link_input} 
                                        onChange={e => handleInputChange('resume_link_input', e.target.value)} 
                                    />
                                    <p className="text-xs text-gray-400 mt-1">Certifique-se de que o link esteja acessÃ­vel publicamente.</p>
                                </div>
                            )}
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label className="block text-xs font-bold text-gray-500 mb-1">Linkedin (Opcional)</label>
                                <input className="w-full border p-2.5 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition" 
                                    placeholder="linkedin.com/in/..."
                                    value={formData.linkedin_profile} onChange={e => handleInputChange('linkedin_profile', e.target.value)} />
                            </div>
                            <div>
                                <label className="block text-xs font-bold text-gray-500 mb-1">GitHub / PortfÃ³lio (Opcional)</label>
                                <input className="w-full border p-2.5 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition" 
                                    placeholder="github.com/..."
                                    value={formData.github_profile} onChange={e => handleInputChange('github_profile', e.target.value)} />
                            </div>
                        </div>
                    </section>

                    {/* ESCOLARIDADE (CONDICIONAL) */}
                    <section>
                        <h4 className="flex items-center gap-2 text-sm font-bold text-blue-600 uppercase mb-4 tracking-wide border-t border-gray-100 pt-6">
                            <GraduationCap size={16}/> FormaÃ§Ã£o
                        </h4>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label className="block text-xs font-bold text-gray-500 mb-1">NÃ­vel de Escolaridade *</label>
                                <select required className="w-full border p-2.5 rounded-lg text-sm bg-white outline-none focus:ring-2 focus:ring-blue-100"
                                    value={formData.education_level} onChange={e => handleInputChange('education_level', e.target.value)}
                                >
                                    <option value="">Selecione...</option>
                                    <option value="medio">Ensino MÃ©dio</option>
                                    <option value="tecnico">Ensino TÃ©cnico</option>
                                    <option value="superior">Superior (GraduaÃ§Ã£o)</option>
                                    <option value="pos">PÃ³s-GraduaÃ§Ã£o / MBA</option>
                                    <option value="mestrado">Mestrado / Doutorado</option>
                                </select>
                            </div>

                            {formData.education_level && (
                                <div>
                                    <label className="block text-xs font-bold text-gray-500 mb-1">Status *</label>
                                    <select required className="w-full border p-2.5 rounded-lg text-sm bg-white outline-none focus:ring-2 focus:ring-blue-100"
                                        value={formData.education_status} onChange={e => handleInputChange('education_status', e.target.value)}
                                    >
                                        <option value="">Selecione...</option>
                                        <option value="completo">Completo</option>
                                        <option value="cursando">Cursando</option>
                                        <option value="incompleto">Incompleto / Trancado</option>
                                    </select>
                                </div>
                            )}

                            {isSuperiorOrTech && formData.education_status && (
                                <>
                                    <div className="md:col-span-2">
                                        <label className="block text-xs font-bold text-gray-500 mb-1">Nome do Curso *</label>
                                        <input required className="w-full border p-2.5 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition" 
                                            value={formData.course_name} onChange={e => handleInputChange('course_name', e.target.value)} />
                                    </div>
                                    <div className="md:col-span-2">
                                        <label className="block text-xs font-bold text-gray-500 mb-1">InstituiÃ§Ã£o de Ensino *</label>
                                        <input required className="w-full border p-2.5 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition" 
                                            value={formData.institution} onChange={e => handleInputChange('institution', e.target.value)} />
                                    </div>
                                </>
                            )}

                            {isSuperiorOrTech && isStudying && (
                                <>
                                    <div>
                                        <label className="block text-xs font-bold text-gray-500 mb-1">PrevisÃ£o de Formatura *</label>
                                        <input required type="month" className="w-full border p-2.5 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100" 
                                            value={formData.conclusion_date} onChange={e => handleInputChange('conclusion_date', e.target.value)} />
                                    </div>
                                    <div>
                                        <label className="block text-xs font-bold text-gray-500 mb-1">PerÃ­odo Atual *</label>
                                        <select required className="w-full border p-2.5 rounded-lg text-sm bg-white outline-none focus:ring-2 focus:ring-blue-100"
                                            value={formData.current_period} onChange={e => handleInputChange('current_period', e.target.value)}
                                        >
                                            <option value="">Selecione...</option>
                                            {[1,2,3,4,5,6,7,8,9,10].map(n => <option key={n} value={`${n}Âº Semestre`}>{n}Âº Semestre</option>)}
                                        </select>
                                    </div>
                                </>
                            )}

                            {isSuperiorOrTech && isCompleted && (
                                <div>
                                    <label className="block text-xs font-bold text-gray-500 mb-1">Ano de ConclusÃ£o *</label>
                                    <input required type="number" min="1970" max="2030" className="w-full border p-2.5 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100" 
                                        value={formData.conclusion_date} onChange={e => handleInputChange('conclusion_date', e.target.value)} />
                                </div>
                            )}
                        </div>
                    </section>

                    {/* MOTIVAÃ‡ÃƒO */}
                    <section>
                        <h4 className="flex items-center gap-2 text-sm font-bold text-blue-600 uppercase mb-4 tracking-wide border-t border-gray-100 pt-6">
                            <FileText size={16}/> MotivaÃ§Ã£o
                        </h4>
                        <label className="block text-xs font-bold text-gray-500 mb-1">Por que vocÃª quer esta vaga?</label>
                        <textarea className="w-full border p-2.5 rounded-lg text-sm outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition" rows="4" 
                            value={formData.motivation} onChange={e => handleInputChange('motivation', e.target.value)} />
                    </section>

                    <div className="pt-4">
                        <button 
                            disabled={submitting}
                            className="w-full bg-blue-600 text-white font-bold py-4 rounded-lg hover:bg-blue-700 transition flex justify-center items-center gap-2 shadow-lg disabled:opacity-70"
                        >
                           {submitting ? 'Enviando...' : <><Send size={18}/> Confirmar Candidatura</>}
                        </button>
                    </div>
                </form>
            </div>
        </div>
      </div>
    </div>
  );
}

==================================================
ARQUIVO: src\pages\Dashboard.jsx
==================================================
import React, { useState, useEffect, useMemo } from 'react';
import { supabase } from '../supabase/client';
import { useNavigate } from 'react-router-dom';
import CreateJobModal from '../components/jobs/CreateJobModal';
import { Briefcase, Users, Plus, Settings as SettingsIcon, Clock, Link as LinkIcon, CheckCircle, Ban } from 'lucide-react';
import { differenceInDays, parseISO } from 'date-fns';

export default function Dashboard() {
  const navigate = useNavigate();
  const [profile, setProfile] = useState(null);
  const [companyName, setCompanyName] = useState('');
  const [jobs, setJobs] = useState([]);
  const [loading, setLoading] = useState(true);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [deptFilter, setDeptFilter] = useState('all');
  const [fixing, setFixing] = useState(false);
  const [copiedId, setCopiedId] = useState(null);

  useEffect(() => {
    fetchData();
  }, []);

  const fetchData = async () => {
    setLoading(true);
    try {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) return;

      const { data: userProfile } = await supabase
        .from('user_profiles')
        .select('*')
        .eq('id', user.id)
        .single();

      setProfile(userProfile);

      if (userProfile?.tenantId) {
        const { data: tenantData } = await supabase
            .from('tenants')
            .select('companyName')
            .eq('id', userProfile.tenantId)
            .single();
        
        if (tenantData) setCompanyName(tenantData.companyName);

        const [jobsResult, deptsResult] = await Promise.all([
          supabase.from('jobs').select('*, applications(count)').eq('tenantId', userProfile.tenantId),
          supabase.from('company_departments').select('*').eq('tenantId', userProfile.tenantId)
        ]);

        const rawJobs = jobsResult.data || [];
        const depts = deptsResult.data || [];
        
        const deptMap = {};
        depts.forEach(d => deptMap[d.id] = d.name);

        const processed = rawJobs.map(j => ({
          ...j,
          deptName: j.company_department_id ? (deptMap[j.company_department_id] || 'Geral') : 'Geral',
          candidateCount: j.applications?.[0]?.count || 0,
          daysOpen: differenceInDays(new Date(), parseISO(j.created_at))
        }));

        processed.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
        setJobs(processed);
      }
    } catch (error) {
      console.error("Erro ao carregar:", error);
    } finally {
      setLoading(false);
    }
  };

  const fixAccount = async () => {
    setFixing(true);
    try {
      const { data: { user } } = await supabase.auth.getUser();
      const { data: newTenant, error: tError } = await supabase
        .from('tenants')
        .insert({ "companyName": "Minha Empresa" })
        .select()
        .single();
      if (tError) throw tError;

      const { error: pError } = await supabase
        .from('user_profiles')
        .upsert({
          id: user.id,
          name: user.email.split('@')[0],
          "tenantId": newTenant.id,
          role: 'admin'
        });
      if (pError) throw pError;

      await supabase.from('user_tenants').insert({
          user_id: user.id,
          tenant_id: newTenant.id,
          role: 'admin'
      });

      alert("Conta configurada com sucesso!");
      fetchData();
    } catch (err) {
      alert("Erro ao configurar: " + err.message);
    } finally {
      setFixing(false);
    }
  };

  const copyJobLink = (e, job) => {
    e.stopPropagation();
    // Bloqueio extra no clique
    if (job.status !== 'active') return;

    const link = `${window.location.origin}/apply/${job.id}`;
    navigator.clipboard.writeText(link).then(() => {
      setCopiedId(job.id);
      setTimeout(() => setCopiedId(null), 2000);
    });
  };

  // Helper para Status (Texto e Cor)
  const getStatusConfig = (status) => {
    switch (status) {
        case 'active': return { label: 'Ativa', classes: 'bg-green-100 text-green-800 border-green-200' };
        case 'inactive': return { label: 'Inativa', classes: 'bg-gray-100 text-gray-600 border-gray-200' };
        case 'filled': return { label: 'Preenchida', classes: 'bg-blue-100 text-blue-800 border-blue-200' };
        case 'suspended': return { label: 'Suspensa', classes: 'bg-orange-100 text-orange-800 border-orange-200' };
        case 'cancelled': return { label: 'Cancelada', classes: 'bg-red-100 text-red-800 border-red-200' };
        default: return { label: status, classes: 'bg-gray-100 text-gray-600' };
    }
  };

  const filteredJobs = useMemo(() => {
    if (deptFilter === 'all') return jobs;
    return jobs.filter(j => j.deptName === deptFilter);
  }, [jobs, deptFilter]);

  const uniqueDepts = [...new Set(jobs.map(j => j.deptName))].sort();

  if (loading) return <div className="p-10 text-center">Carregando Dashboard...</div>;

  return (
    <div className="p-8 max-w-7xl mx-auto">
      {/* Header */}
      <div className="flex flex-col md:flex-row justify-between items-center mb-8 gap-4 border-b pb-4">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Dashboard</h1>
          <div className="flex items-center gap-2 text-sm text-gray-500 mt-1">
            <span className="bg-gray-100 px-2 py-0.5 rounded text-gray-600">
               {companyName ? `${companyName} / ` : ''}{profile?.name || 'UsuÃ¡rio'}
            </span>
            <span className="text-gray-300">|</span>
            <button onClick={() => navigate('/settings')} className="text-gray-600 hover:text-blue-600 flex items-center gap-1">
               <SettingsIcon size={14} /> ConfiguraÃ§Ãµes
            </button>
            <span className="text-gray-300">|</span>
            <button onClick={() => supabase.auth.signOut()} className="text-red-500 hover:underline">
              Sair
            </button>
          </div>
        </div>
        
        {profile?.tenantId && (
          <button 
            onClick={() => setIsModalOpen(true)}
            className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center shadow transition"
          >
            <Plus className="w-4 h-4 mr-2" /> Nova Vaga
          </button>
        )}
      </div>

      {!profile?.tenantId ? (
        <div className="bg-yellow-50 border border-yellow-200 p-8 rounded-lg text-center shadow-sm max-w-2xl mx-auto">
          <h2 className="text-xl font-bold text-yellow-800 mb-2">Finalizar ConfiguraÃ§Ã£o da Conta</h2>
          <p className="text-yellow-700 mb-6">
            Bem-vindo ao Novva R&S! Para comeÃ§ar, precisamos configurar sua empresa.
          </p>
          <button 
            onClick={fixAccount} 
            disabled={fixing}
            className="bg-yellow-600 text-white px-6 py-3 rounded-md font-bold hover:bg-yellow-700 shadow transition"
          >
            {fixing ? 'Configurando...' : 'âš™ï¸ Configurar Minha Empresa Agora'}
          </button>
        </div>
      ) : (
        <>
          {/* KPI Cards */}
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
            <div className="bg-white p-6 rounded shadow border border-gray-100 flex items-center gap-4">
              <div className="p-3 bg-blue-100 text-blue-600 rounded-full"><Briefcase size={24}/></div>
              <div>
                <p className="text-sm text-gray-500">Vagas Ativas</p>
                <p className="text-2xl font-bold">{jobs.filter(j => j.status === 'active').length}</p>
              </div>
            </div>
            <div className="bg-white p-6 rounded shadow border border-gray-100 flex items-center gap-4">
              <div className="p-3 bg-green-100 text-green-600 rounded-full"><Users size={24}/></div>
              <div>
                <p className="text-sm text-gray-500">Total Candidatos</p>
                <p className="text-2xl font-bold">{jobs.reduce((acc, j) => acc + j.candidateCount, 0)}</p>
              </div>
            </div>
          </div>

          {/* Tabela de Vagas */}
          <div className="bg-white rounded shadow border overflow-hidden">
            <div className="p-4 border-b bg-gray-50 flex justify-between items-center">
              <h2 className="font-semibold text-gray-700">Listagem de Vagas</h2>
              <div className="flex items-center gap-2">
                <span className="text-sm text-gray-500">Filtrar:</span>
                <select 
                  className="border p-1 rounded text-sm bg-white outline-none"
                  value={deptFilter}
                  onChange={e => setDeptFilter(e.target.value)}
                >
                  <option value="all">Todas as Ãreas</option>
                  {uniqueDepts.map(d => <option key={d} value={d}>{d}</option>)}
                </select>
              </div>
            </div>

            <table className="w-full text-left text-sm">
              <thead className="bg-gray-50 text-gray-500 border-b">
                <tr>
                  <th className="p-4 font-medium">Ãrea / Depto</th>
                  <th className="p-4 font-medium">TÃ­tulo</th>
                  <th className="p-4 font-medium text-center">Inscritos</th>
                  <th className="p-4 font-medium text-center">Tempo</th>
                  <th className="p-4 font-medium text-center">DivulgaÃ§Ã£o</th>
                  <th className="p-4 font-medium">Status</th>
                  <th className="p-4 font-medium text-right">AÃ§Ã£o</th>
                </tr>
              </thead>
              <tbody>
                {filteredJobs.length === 0 ? (
                  <tr><td colSpan="7" className="p-8 text-center text-gray-500">Nenhuma vaga encontrada.</td></tr>
                ) : (
                  filteredJobs.map(job => {
                    const statusConfig = getStatusConfig(job.status);
                    const isActive = job.status === 'active';

                    return (
                        <tr 
                          key={job.id} 
                          onClick={() => navigate(`/jobs/${job.id}`)}
                          className="border-b hover:bg-blue-50 transition cursor-pointer group"
                        >
                          <td className="p-4 text-gray-600">{job.deptName}</td>
                          <td className="p-4 font-bold text-gray-800 group-hover:text-blue-600">{job.title}</td>
                          
                          <td className="p-4 text-center">
                              <span className="bg-blue-100 text-blue-800 px-3 py-1 rounded-full font-bold text-xs">{job.candidateCount}</span>
                          </td>
                          <td className="p-4 text-center text-gray-500">
                              <div className="flex items-center justify-center gap-1">
                                <Clock size={14}/> {job.daysOpen} dias
                              </div>
                          </td>

                          {/* BOTÃƒO DE LINK (Bloqueado se nÃ£o estiver ativo) */}
                          <td className="p-4 text-center">
                            <button 
                              onClick={(e) => copyJobLink(e, job)}
                              disabled={!isActive}
                              className={`p-1.5 rounded transition ${
                                copiedId === job.id 
                                ? 'bg-green-100 text-green-700' 
                                : isActive 
                                    ? 'text-gray-400 hover:text-blue-600 hover:bg-white border border-transparent hover:border-gray-200' 
                                    : 'text-gray-200 cursor-not-allowed'
                              }`}
                              title={isActive ? "Copiar Link para Candidatos" : "Vaga inativa - Link indisponÃ­vel"}
                            >
                              {copiedId === job.id ? <CheckCircle size={16}/> : isActive ? <LinkIcon size={16}/> : <Ban size={16}/>}
                            </button>
                          </td>

                          <td className="p-4">
                            <span className={`px-2 py-1 rounded text-xs font-semibold border ${statusConfig.classes}`}>
                              {statusConfig.label}
                            </span>
                          </td>
                          <td className="p-4 text-right text-blue-600 font-medium">
                            Gerenciar â†’
                          </td>
                        </tr>
                    );
                  })
                )}
              </tbody>
            </table>
          </div>
        </>
      )}

      <CreateJobModal 
        open={isModalOpen} 
        onClose={() => setIsModalOpen(false)} 
        onSuccess={fetchData} 
      />
    </div>
  );
}

==================================================
ARQUIVO: src\pages\JobDetails.jsx
==================================================
import React, { useState, useEffect, useMemo } from 'react';
import { useParams, Link as RouterLink, useNavigate } from 'react-router-dom';
import { supabase } from '../supabase/client';
import { 
    Container, Typography, Box, AppBar, Toolbar, Button, CircularProgress, 
    Paper, Tabs, Tab, TextField, IconButton, Snackbar,
    List, ListItem, ListItemText, Divider, Grid,
    Table, TableHead, TableRow, TableCell, TableBody, Checkbox,
    FormControl, InputLabel, Select, MenuItem, Chip, Modal, Alert
} from '@mui/material';
import { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, ReferenceLine, LabelList } from 'recharts';
import { 
    Delete as DeleteIcon, 
    ContentCopy as ContentCopyIcon, 
    Save as SaveIcon,
    Add as AddIcon 
} from '@mui/icons-material';
import { Share2, MapPin, Briefcase, Calendar, ArrowLeft } from 'lucide-react'; // Certifique-se que esses icones existem no lucide
import { processEvaluation } from '../utils/evaluationLogic';

// --- COMPONENTES AUXILIARES ---
const modalStyle = { position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', width: 500, bgcolor: 'background.paper', boxShadow: 24, p: 4, borderRadius: 2 };

const CopyParametersModal = ({ open, onClose, currentJobId, onCopy }) => {
  const [jobs, setJobs] = useState([]);
  const [selectedJobId, setSelectedJobId] = useState('');
  useEffect(() => { if (open) { const f = async () => { const { data } = await supabase.from('jobs').select('id, title').neq('id', currentJobId).eq('status', 'active'); setJobs(data || []); }; f(); } }, [open, currentJobId]);
  const handleConfirm = async () => { if (!selectedJobId) return; const { data } = await supabase.from('jobs').select('parameters').eq('id', selectedJobId).single(); if (data?.parameters) onCopy(data.parameters); onClose(); };
  return ( <Modal open={open} onClose={onClose}><Box sx={modalStyle}><Typography variant="h6">Copiar de Vaga</Typography><FormControl fullWidth margin="normal"><InputLabel>Vaga</InputLabel><Select value={selectedJobId} onChange={e=>setSelectedJobId(e.target.value)} label="Vaga">{jobs.map(j=><MenuItem key={j.id} value={j.id}>{j.title}</MenuItem>)}</Select></FormControl><Box sx={{ mt: 3, display: 'flex', justifyContent: 'flex-end', gap: 1 }}><Button onClick={onClose}>Cancelar</Button><Button onClick={handleConfirm} variant="contained" disabled={!selectedJobId}>Copiar</Button></Box></Box></Modal> );
};

const ParametersSection = ({ criteria = [], onCriteriaChange }) => {
  const handleChange = (i, f, v) => { const n = [...criteria]; n[i] = { ...n[i], [f]: f==='weight'?Number(v):v }; onCriteriaChange(n); };
  const total = criteria.reduce((acc, c) => acc + (Number(c.weight)||0), 0);
  return (
    <Box sx={{mt:2}}>
        {criteria.map((c, i) => (
            <Box key={i} display="flex" gap={2} mb={1}>
                <TextField value={c.name} onChange={e=>handleChange(i,'name',e.target.value)} fullWidth size="small" label="CritÃ©rio" />
                <TextField type="number" value={c.weight} onChange={e=>handleChange(i,'weight',e.target.value)} sx={{width:100}} size="small" label="Peso %" />
                <IconButton onClick={()=>onCriteriaChange(criteria.filter((_,idx)=>idx!==i))} color="error"><DeleteIcon/></IconButton>
            </Box>
        ))}
        <Button onClick={()=>onCriteriaChange([...criteria, {name:'', weight:0}])} variant="outlined" size="small" startIcon={<AddIcon />}>Adicionar</Button>
        <Typography color={total===100?'green':'red'} variant="caption" display="block" sx={{mt:1, fontWeight:'bold'}}>Total: {total}%</Typography>
    </Box>
  );
};

const RatingScaleSection = ({ notes = [], onNotesChange }) => {
    const handleChange = (i, field, value) => {
        const newNotes = [...notes];
        newNotes[i] = { ...newNotes[i], [field]: field === 'valor' ? Number(value) : value };
        onNotesChange(newNotes);
    };
    const handleAdd = () => {
        const id = crypto.randomUUID ? crypto.randomUUID() : Date.now().toString();
        onNotesChange([...notes, { id, nome: 'Nova Nota', valor: 0 }]);
    };
    const handleRemove = (i) => { onNotesChange(notes.filter((_, idx) => idx !== i)); };

    return (
        <Box sx={{ mt: 2 }}>
            {notes.map((n, i) => (
                <Box key={n.id || i} display="flex" gap={2} mb={1} alignItems="center">
                    <TextField value={n.nome} onChange={(e) => handleChange(i, 'nome', e.target.value)} fullWidth size="small" label="Nome do NÃ­vel" />
                    <TextField type="number" value={n.valor} onChange={(e) => handleChange(i, 'valor', e.target.value)} sx={{ width: 120 }} size="small" label="Valor (0-100)" />
                    <IconButton onClick={() => handleRemove(i)} color="error"><DeleteIcon /></IconButton>
                </Box>
            ))}
            <Button onClick={handleAdd} variant="outlined" size="small" startIcon={<AddIcon />}>Adicionar NÃ­vel</Button>
            {notes.length < 2 && <Typography color="warning.main" variant="caption" display="block" sx={{ mt: 1 }}>Recomendado ter pelo menos 2 nÃ­veis.</Typography>}
        </Box>
    );
};

export default function JobDetails() {
  const { jobId } = useParams();
  const [job, setJob] = useState(null);
  const [parameters, setParameters] = useState(null);
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [statusUpdating, setStatusUpdating] = useState(false);
  const [tabValue, setTabValue] = useState(0);
  const [applicants, setApplicants] = useState([]);
  const [allEvaluations, setAllEvaluations] = useState([]);
  const [usersMap, setUsersMap] = useState({});
  const [evaluatorFilter, setEvaluatorFilter] = useState('all');
  const [isCopyModalOpen, setIsCopyModalOpen] = useState(false);
  const [feedback, setFeedback] = useState({ open: false, message: '', severity: 'success' });

  useEffect(() => {
    const fetchAllData = async () => {
      setLoading(true);
      try {
        const { data: jobData, error: jobError } = await supabase.from('jobs').select('*').eq('id', jobId).single();
        if (jobError) throw jobError;
        setJob(jobData);
        setParameters(jobData.parameters || { triagem: [], cultura: [], tecnico: [], notas: [] });

        const { data: appsData } = await supabase.from('applications').select('*, candidate:candidates(name, email)').eq('jobId', jobId);
        setApplicants(appsData || []);

        const appIds = (appsData || []).map(a => a.id);
        if (appIds.length > 0) {
            const { data: evalsData } = await supabase.from('evaluations').select('*').in('application_id', appIds);
            setAllEvaluations(evalsData || []);
        }

        // Busca toda a equipe para o dropdown
        if (jobData.tenantId) {
            const { data: teamData, error: teamError } = await supabase
                .from('user_tenants')
                .select('user:user_profiles(id, name, email)')
                .eq('tenant_id', jobData.tenantId);

            if (!teamError && teamData) {
                const map = {};
                teamData.forEach(item => {
                    if (item.user) {
                        map[item.user.id] = item.user.name || item.user.email;
                    }
                });
                setUsersMap(map);
            }
        }
      } catch (err) { console.error(err); } finally { setLoading(false); }
    };
    fetchAllData();
  }, [jobId]);

  const handleStatusChange = async (e) => {
    const newStatus = e.target.value;
    setStatusUpdating(true);
    try {
        const { data: { session } } = await supabase.auth.getSession();
        
        const res = await fetch('/api/jobs', {
            method: 'POST',
            headers: { 
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${session.access_token}`
            },
            body: JSON.stringify({ 
                action: 'updateJobStatus', 
                jobId: job.id, 
                newStatus 
            })
        });

        if (!res.ok) throw new Error('Falha ao atualizar status');

        setJob(prev => ({ ...prev, status: newStatus }));
        setFeedback({ open: true, message: 'Status da vaga atualizado!', severity: 'success' });
    } catch (err) {
        console.error(err);
        setFeedback({ open: true, message: 'Erro ao atualizar status.', severity: 'error' });
    } finally {
        setStatusUpdating(false);
    }
  };

  const handleCopyLink = () => {
    if (job.status !== 'active') return;
    navigator.clipboard.writeText(`${window.location.origin}/apply/${jobId}`);
    setFeedback({ open: true, message: 'Link copiado para a Ã¡rea de transferÃªncia!', severity: 'info' });
  };

  const processedData = useMemo(() => {
    if (!parameters) return { chartData: [], evaluators: [] };

    const evaluators = Object.keys(usersMap).map(id => ({ id, name: usersMap[id] }));

    const chartData = applicants.map(app => {
        const appEvals = allEvaluations.filter(e => String(e.application_id) === String(app.id));
        const evalsToConsider = evaluatorFilter === 'all' 
            ? appEvals 
            : appEvals.filter(e => e.evaluator_id === evaluatorFilter);

        let sumT = 0, sumC = 0, sumTc = 0, count = 0, sumTotal = 0;
        evalsToConsider.forEach(ev => {
            const scores = processEvaluation(ev, parameters);
            if (scores.total > 0 || scores.triagem > 0) {
                sumT += scores.triagem; sumC += scores.cultura; sumTc += scores.tecnico; sumTotal += scores.total; count++;
            }
        });

        const avgT = count > 0 ? sumT / count : 0;
        const avgC = count > 0 ? sumC / count : 0;
        const avgTc = count > 0 ? sumTc / count : 0;
        const general = count > 0 ? sumTotal / count : 0;

        return {
            appId: app.id,
            name: app.candidate?.name || 'Sem Nome',
            email: app.candidate?.email,
            triagem: Number(avgT.toFixed(1)),
            cultura: Number(avgC.toFixed(1)),
            tecnico: Number(avgTc.toFixed(1)),
            total: Number(general.toFixed(1)),
            count: count,
            hired: app.isHired
        };
    }).sort((a, b) => b.total - a.total);

    return { chartData, evaluators };
  }, [applicants, allEvaluations, evaluatorFilter, parameters, usersMap]);

  const handleHireToggle = async (appId, currentStatus) => {
      const newStatus = !currentStatus;
      setApplicants(prev => prev.map(a => a.id === appId ? {...a, isHired: newStatus} : a));
      await supabase.from('applications').update({ isHired: newStatus }).eq('id', appId);
  };

  const handleSaveParameters = async () => {
      setSaving(true);
      await supabase.from('jobs').update({ parameters }).eq('id', jobId);
      setSaving(false);
      setFeedback({ open: true, message: 'ConfiguraÃ§Ãµes salvas!', severity: 'success' });
  };

  if (loading) return <Box p={5} display="flex" justifyContent="center"><CircularProgress /></Box>;
  if (!job) return <Box p={5} textAlign="center">Vaga nÃ£o encontrada</Box>;

  return (
    <Box>
        <AppBar position="static" color="default" elevation={1}>
            <Toolbar>
                <Typography variant="h6" sx={{flexGrow:1}}>{job?.title}</Typography>
                
                {/* SELETOR DE STATUS */}
                <FormControl size="small" sx={{ minWidth: 150, mr: 2 }}>
                    <Select 
                        value={job?.status || 'active'} 
                        onChange={handleStatusChange}
                        disabled={statusUpdating}
                        sx={{ bgcolor: 'white', '& .MuiSelect-select': { py: 1 } }}
                    >
                        <MenuItem value="active">Ativa</MenuItem>
                        <MenuItem value="inactive">Inativa</MenuItem>
                        <MenuItem value="filled">Preenchida</MenuItem>
                        <MenuItem value="suspended">Suspensa</MenuItem>
                        <MenuItem value="cancelled">Cancelada</MenuItem>
                    </Select>
                </FormControl>

                <Button color="inherit" component={RouterLink} to="/">Voltar</Button>
            </Toolbar>
        </AppBar>

        <Container maxWidth="xl" sx={{ mt: 4, mb: 4 }}>
            
            <Box mb={4}>
                <Box display="flex" justifyContent="space-between" alignItems="start">
                    <Box>
                        <Typography variant="h4" fontWeight="bold" color="text.primary">{job.title}</Typography>
                        <Box display="flex" gap={3} mt={1} color="text.secondary">
                            <Box display="flex" alignItems="center" gap={0.5}><MapPin size={16}/> <Typography variant="body2">{job.location_type || 'Remoto'}</Typography></Box>
                            <Box display="flex" alignItems="center" gap={0.5}><Briefcase size={16}/> <Typography variant="body2">{job.type || 'CLT'}</Typography></Box>
                            <Box display="flex" alignItems="center" gap={0.5}><Calendar size={16}/> <Typography variant="body2">{new Date(job.created_at).toLocaleDateString()}</Typography></Box>
                        </Box>
                    </Box>
                    
                    {/* BOTÃƒO DE COMPARTILHAR - ATIVO APENAS SE STATUS FOR 'active' */}
                    <Button 
                        variant="outlined" 
                        onClick={handleCopyLink}
                        disabled={job.status !== 'active'}
                        startIcon={<Share2 size={18}/>}
                        sx={{ textTransform: 'none', fontWeight: 'bold' }}
                    >
                        {job.status === 'active' ? 'Compartilhar FormulÃ¡rio' : 'Link IndisponÃ­vel (Vaga Inativa)'}
                    </Button>
                </Box>
            </Box>

            <Paper sx={{ mb: 3 }}><Tabs value={tabValue} onChange={(e, v) => setTabValue(v)} centered><Tab label="Candidatos" /><Tab label="ClassificaÃ§Ã£o" /><Tab label="ConfiguraÃ§Ãµes da Vaga" /></Tabs></Paper>
            
            {tabValue === 0 && (
                <Paper sx={{ p: 0 }}>
                    <Box p={3} borderBottom="1px solid #eee">
                        <Grid container spacing={3}>
                            <Grid item xs={12} md={6}>
                                <Typography variant="subtitle2" fontWeight="bold">DescriÃ§Ã£o</Typography>
                                <Typography variant="body2" color="text.secondary" whiteSpace="pre-wrap">{job.description || 'Sem descriÃ§Ã£o.'}</Typography>
                            </Grid>
                            <Grid item xs={12} md={6}>
                                <Typography variant="subtitle2" fontWeight="bold">Requisitos</Typography>
                                <Typography variant="body2" color="text.secondary" whiteSpace="pre-wrap">{job.requirements || 'Sem requisitos.'}</Typography>
                            </Grid>
                        </Grid>
                    </Box>

                    <Table>
                        <TableHead sx={{ bgcolor: '#f5f5f5' }}><TableRow><TableCell><strong>Nome</strong></TableCell><TableCell><strong>Email</strong></TableCell><TableCell align="center"><strong>AvaliaÃ§Ãµes</strong></TableCell><TableCell align="center"><strong>Nota Geral</strong></TableCell></TableRow></TableHead>
                        <TableBody>{processedData.chartData.map(d => (
                            <TableRow key={d.appId} hover component={RouterLink} to={`/applications/${d.appId}`} style={{textDecoration:'none', cursor:'pointer'}}>
                                <TableCell>{d.name}</TableCell>
                                <TableCell>{d.email}</TableCell>
                                <TableCell align="center"><Chip label={d.count} size="small" /></TableCell>
                                <TableCell align="center"><Chip label={d.total.toFixed(1)} color={d.total >= 8 ? 'success' : d.total >= 5 ? 'warning' : 'default'} variant={d.count > 0 ? 'filled' : 'outlined'}/></TableCell>
                            </TableRow>
                        ))}</TableBody>
                    </Table>
                </Paper>
            )}

            {tabValue === 1 && (
                <Grid container spacing={3}>
                    <Grid item xs={12} md={8}>
                        <Paper sx={{ p: 3, height: '600px', display: 'flex', flexDirection: 'column' }} elevation={3}>
                            <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 3, pb: 2, borderBottom: '1px solid #f0f0f0' }}>
                                <Typography variant="h6" color="text.primary" fontWeight="bold">Comparativo de Desempenho</Typography>
                                <FormControl size="small" sx={{ minWidth: 220 }}>
                                    <InputLabel>Filtrar por Avaliador</InputLabel>
                                    <Select value={evaluatorFilter} label="Filtrar por Avaliador" onChange={(e) => setEvaluatorFilter(e.target.value)}>
                                        <MenuItem value="all">VisÃ£o Geral (MÃ©dia da Equipe)</MenuItem>
                                        {processedData.evaluators.map(ev => <MenuItem key={ev.id} value={ev.id}>{ev.name}</MenuItem>)}
                                    </Select>
                                </FormControl>
                            </Box>
                            {processedData.chartData.some(d => d.total > 0 || d.count > 0) ? (
                                <Box sx={{ flex: 1, width: '100%', minHeight: 0 }}>
                                    <ResponsiveContainer width="100%" height="100%">
                                        <BarChart 
                                            data={processedData.chartData} 
                                            layout="vertical" 
                                            margin={{ top: 10, right: 30, left: 10, bottom: 5 }} 
                                            barGap={4}
                                        >
                                            <CartesianGrid strokeDasharray="3 3" horizontal={true} vertical={true} stroke="#eee" />
                                            <XAxis type="number" domain={[0, 10]} ticks={[0, 2, 4, 6, 8, 10]} stroke="#999" />
                                            <YAxis dataKey="name" type="category" width={150} style={{fontSize: '0.8rem', fontWeight: 500, fill: '#444'}} />
                                            <Tooltip cursor={{fill: '#f5f5f5'}} contentStyle={{ borderRadius: 8, border: 'none', boxShadow: '0 4px 12px rgba(0,0,0,0.1)' }} formatter={(val, name) => [val, name]} />
                                            <Legend verticalAlign="top" height={40} iconType="circle" />
                                            <Bar dataKey="triagem" name="Triagem" fill="#90caf9" barSize={20} radius={[0, 4, 4, 0]}><LabelList dataKey="triagem" position="right" style={{fontSize:'0.7rem', fill:'#666'}} formatter={(v)=>v>0?v:''}/></Bar>
                                            <Bar dataKey="cultura" name="Fit Cultural" fill="#a5d6a7" barSize={20} radius={[0, 4, 4, 0]}><LabelList dataKey="cultura" position="right" style={{fontSize:'0.7rem', fill:'#666'}} formatter={(v)=>v>0?v:''}/></Bar>
                                            <Bar dataKey="tecnico" name="TÃ©cnico" fill="#ffcc80" barSize={20} radius={[0, 4, 4, 0]}><LabelList dataKey="tecnico" position="right" style={{fontSize:'0.7rem', fill:'#666'}} formatter={(v)=>v>0?v:''}/></Bar>
                                            <Bar dataKey="total" name="MÃ©dia Geral" fill="#4caf50" barSize={20} radius={[0, 4, 4, 0]}><LabelList dataKey="total" position="right" style={{fontSize:'0.8rem', fontWeight:'bold', fill:'#2e7d32'}} /></Bar>
                                            <ReferenceLine x={5} stroke="red" strokeDasharray="3 3" />
                                        </BarChart>
                                    </ResponsiveContainer>
                                </Box>
                            ) : (
                                <Box sx={{ flex: 1, display: 'flex', flexDirection:'column', alignItems: 'center', justifyContent: 'center', color: 'text.secondary', bgcolor:'#fafafa', borderRadius:2 }}>
                                    <Typography variant="body1">Ainda nÃ£o hÃ¡ dados suficientes.</Typography>
                                    <Typography variant="caption">Realize avaliaÃ§Ãµes para visualizar o grÃ¡fico.</Typography>
                                </Box>
                            )}
                        </Paper>
                    </Grid>
                    <Grid item xs={12} md={4}>
                        <Paper sx={{ height: '600px', display: 'flex', flexDirection: 'column' }} elevation={3}>
                            <Box sx={{ p: 2, bgcolor: '#f5f5f5', borderBottom: '1px solid #e0e0e0' }}><Typography variant="subtitle1" fontWeight="bold">Ranking Final</Typography></Box>
                            <List sx={{ overflowY: 'auto', flex: 1 }}>
                                {processedData.chartData.map((d, index) => (
                                    <React.Fragment key={d.appId}>
                                        <ListItem secondaryAction={<Checkbox checked={d.hired || false} onChange={() => handleHireToggle(d.appId, d.hired)} color="success" />}>
                                            <ListItemText 
                                                primary={<Typography variant="body2" fontWeight="bold">#{index + 1} {d.name}</Typography>} 
                                                secondary={<Typography variant="caption" color="text.secondary">MÃ©dia: <strong style={{color:'#2e7d32', fontSize:'0.9rem'}}>{d.total.toFixed(1)}</strong></Typography>} 
                                            />
                                        </ListItem>
                                        <Divider component="li" />
                                    </React.Fragment>
                                ))}
                            </List>
                        </Paper>
                    </Grid>
                </Grid>
            )}

            {tabValue === 2 && (
                <Box p={3} sx={{ bgcolor: 'white', borderRadius: 1, boxShadow: 1 }}>
                    <Paper variant="outlined" sx={{p:3, mb:3}}>
                        <Typography variant="subtitle1" fontWeight="bold" gutterBottom>1. Triagem</Typography>
                        <ParametersSection criteria={parameters?.triagem || []} onCriteriaChange={(c) => setParameters({...parameters, triagem: c})} />
                    </Paper>
                    <Paper variant="outlined" sx={{p:3, mb:3}}>
                        <Typography variant="subtitle1" fontWeight="bold" gutterBottom>2. Fit Cultural</Typography>
                        <ParametersSection criteria={parameters?.cultura || []} onCriteriaChange={(c) => setParameters({...parameters, cultura: c})} />
                    </Paper>
                    <Paper variant="outlined" sx={{p:3, mb:3}}>
                        <Typography variant="subtitle1" fontWeight="bold" gutterBottom>3. Teste TÃ©cnico</Typography>
                        <ParametersSection criteria={parameters?.tecnico || parameters?.['tÃ©cnico'] || []} onCriteriaChange={(c) => setParameters({...parameters, tecnico: c})} />
                    </Paper>
                    
                    <Paper variant="outlined" sx={{p:3, mb:3, borderColor: 'orange'}}>
                        <Typography variant="subtitle1" fontWeight="bold" gutterBottom color="orange">4. RÃ©gua de Notas</Typography>
                        <Typography variant="caption" color="text.secondary" gutterBottom>
                            Defina os nomes e valores (0 a 100) que aparecerÃ£o nas opÃ§Ãµes de avaliaÃ§Ã£o.
                        </Typography>
                        <RatingScaleSection 
                            notes={parameters?.notas || []} 
                            onNotesChange={(n) => setParameters({...parameters, notas: n})} 
                        />
                    </Paper>

                    <Box display="flex" justifyContent="flex-end">
                        <Button 
                            variant="contained" 
                            color="primary" 
                            onClick={handleSaveParameters}
                            disabled={saving}
                            startIcon={<SaveIcon />} 
                        >
                            {saving ? 'Salvando...' : 'Salvar ConfiguraÃ§Ãµes'}
                        </Button>
                    </Box>
                </Box>
            )}
        </Container>
        <CopyParametersModal open={isCopyModalOpen} onClose={() => setIsCopyModalOpen(false)} currentJobId={jobId} onCopy={(p) => { setParameters(p); setFeedback({open:true, message:'Copiado!', severity:'info'}); }} />
        <Snackbar open={feedback.open} autoHideDuration={4000} onClose={() => setFeedback({...feedback, open:false})}><Alert severity={feedback.severity} variant="filled">{feedback.message}</Alert></Snackbar>
    </Box>
  );
}

==================================================
ARQUIVO: src\pages\Login.jsx
==================================================
import React, { useState } from 'react';
import { supabase } from '../supabase/client';
import { Link, useNavigate } from 'react-router-dom';
import { Loader2, LayoutDashboard } from 'lucide-react';

export default function Login() {
  const navigate = useNavigate();
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  const handleLogin = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError('');

    try {
      // 1. AutenticaÃ§Ã£o no Supabase
      const { data: { user }, error: authError } = await supabase.auth.signInWithPassword({
        email,
        password,
      });

      if (authError) throw authError;

      // 2. Verifica a quantidade de empresas vinculadas (LÃ³gica de Consultoria)
      const { count, error: countError } = await supabase
        .from('user_tenants')
        .select('*', { count: 'exact', head: true })
        .eq('user_id', user.id);

      if (countError) {
          console.warn("Erro ao verificar user_tenants. Redirecionando para padrÃ£o.", countError);
          navigate('/'); // Fallback de seguranÃ§a
          return;
      }

      // 3. Roteamento Inteligente
      if (count > 1) {
          // Consultora (EmÃ­lia) ou Dono de vÃ¡rias empresas -> Tela de SeleÃ§Ã£o
          navigate('/select-company');
      } else {
          // UsuÃ¡rio comum (1 empresa) -> Dashboard direto
          // Garantimos que o profile esteja com o tenantId correto (caso tenha apenas 1)
          if (count === 1) {
              const { data: link } = await supabase.from('user_tenants').select('tenant_id').eq('user_id', user.id).single();
              if (link) {
                  await supabase.from('user_profiles').update({ tenantId: link.tenant_id }).eq('id', user.id);
              }
          }
          navigate('/');
      }

    } catch (error) {
      console.error(error);
      setError('E-mail ou senha incorretos.');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50 px-4">
      <div className="max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-sm border border-gray-200">
        <div className="text-center">
          <div className="mx-auto h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 mb-4">
            <LayoutDashboard size={24} />
          </div>
          <h2 className="text-3xl font-extrabold text-gray-900">Novva R&S</h2>
          <p className="mt-2 text-sm text-gray-600">Acesse sua conta</p>
        </div>
        
        <form className="mt-8 space-y-6" onSubmit={handleLogin}>
          <div className="space-y-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1" htmlFor="email">E-mail</label>
              <input
                id="email"
                type="email"
                required
                className="w-full border p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none border-gray-300"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                autoComplete="email"
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1" htmlFor="password">Senha</label>
              <input
                id="password"
                type="password"
                required
                className="w-full border p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none border-gray-300"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                autoComplete="current-password"
              />
            </div>
          </div>

          {error && (
            <div className="p-3 rounded-md bg-red-50 text-red-700 text-sm border border-red-200">
              {error}
            </div>
          )}

          <button 
            type="submit" 
            disabled={loading} 
            className="w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700 transition flex justify-center items-center font-medium disabled:opacity-70"
          >
            {loading ? <Loader2 className="mr-2 h-4 w-4 animate-spin" /> : 'Entrar'}
          </button>

          <div className="text-center text-sm">
            <Link to="/register" className="font-medium text-blue-600 hover:text-blue-500">
              Criar conta gratuita
            </Link>
          </div>
        </form>
      </div>
    </div>
  );
}

==================================================
ARQUIVO: src\pages\Register.jsx
==================================================
import React, { useState } from 'react';
import { supabase } from '../supabase/client';
import { Link, useNavigate } from 'react-router-dom';
import { Loader2, UserPlus, CheckCircle } from 'lucide-react';

export default function Register() {
  const [formData, setFormData] = useState({ name: '', email: '', password: '', companyId: '' });
  const [loading, setLoading] = useState(false);
  const [success, setSuccess] = useState(false);
  const navigate = useNavigate();

  const handleRegister = async (e) => {
    e.preventDefault();
    setLoading(true);
    
    try {
      // Prepara metadados para a Trigger do Banco
      const metaData = {
          name: formData.name,
      };

      // Se tiver cÃ³digo de convite, adiciona ao metadata
      // A trigger vai ler isso e colocar o usuÃ¡rio na empresa certa
      if (formData.companyId.trim()) {
          // ValidaÃ§Ã£o rÃ¡pida se o tenant existe (opcional, mas boa prÃ¡tica)
          const { data: tenant, error: tError } = await supabase
              .from('tenants')
              .select('id')
              .eq('id', formData.companyId.trim())
              .single();
          
          if (tError || !tenant) throw new Error("CÃ³digo da empresa invÃ¡lido.");
          
          metaData.tenant_id = tenant.id;
          metaData.role = 'recruiter'; // Entra como recrutador por padrÃ£o via convite simples
      }

      // O CADASTRO SIMPLIFICADO
      const { error } = await supabase.auth.signUp({
        email: formData.email,
        password: formData.password,
        options: {
            data: metaData // Envia nome e possÃ­vel tenant_id
        }
      });

      if (error) throw error;

      setSuccess(true);
      setTimeout(() => navigate('/login'), 3000);

    } catch (error) {
      alert("Erro: " + error.message);
    } finally {
      setLoading(false);
    }
  };

  if (success) {
      return (
        <div className="flex h-screen items-center justify-center bg-gray-50 px-4">
             <div className="text-center bg-white p-8 rounded shadow-lg">
                <CheckCircle className="w-16 h-16 text-green-500 mx-auto mb-4"/>
                <h2 className="text-2xl font-bold text-gray-800">Cadastro Realizado!</h2>
                <p className="text-gray-600 mt-2">Sua conta e empresa foram configuradas.</p>
                <p className="text-sm text-gray-400 mt-4">Redirecionando para login...</p>
             </div>
        </div>
      );
  }

  return (
    <div className="flex h-screen items-center justify-center bg-gray-100 px-4">
      <form onSubmit={handleRegister} className="p-8 bg-white rounded shadow-md w-96 border border-gray-200 space-y-5">
        <div className="text-center">
             <div className="mx-auto h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center text-green-600 mb-4">
                <UserPlus size={24} />
             </div>
            <h1 className="text-2xl font-bold mb-2 text-center text-green-600">Criar Conta</h1>
            <p className="text-center text-gray-500 text-sm">Crie sua empresa Freemium ou entre em uma existente.</p>
        </div>
        
        <div>
            <label className="block text-xs font-bold text-gray-700 mb-1">Nome Completo *</label>
            <input className="w-full border p-2 rounded outline-none focus:ring-2 focus:ring-green-500" 
              value={formData.name} onChange={e => setFormData({...formData, name: e.target.value})} required />
        </div>

        <div>
            <label className="block text-xs font-bold text-gray-700 mb-1">Email *</label>
            <input className="w-full border p-2 rounded outline-none focus:ring-2 focus:ring-green-500" 
              value={formData.email} onChange={e => setFormData({...formData, email: e.target.value})} required />
        </div>

        <div>
            <label className="block text-xs font-bold text-gray-700 mb-1">Senha *</label>
            <input type="password" className="w-full border p-2 rounded outline-none focus:ring-2 focus:ring-green-500" 
              placeholder="Min. 6 caracteres" value={formData.password} onChange={e => setFormData({...formData, password: e.target.value})} required />
        </div>
        
        <div className="pt-2 border-t">
            <label className="block text-xs font-bold text-gray-500 mb-1">CÃ³digo de Convite (Opcional)</label>
            <input className="w-full border p-2 rounded outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50" 
              placeholder="ID da empresa" value={formData.companyId} onChange={e => setFormData({...formData, companyId: e.target.value})} />
        </div>
        
        <button disabled={loading} className="w-full bg-green-600 text-white p-2 rounded hover:bg-green-700 transition font-medium flex justify-center items-center">
          {loading ? <Loader2 className="animate-spin mr-2 h-4 w-4"/> : 'Criar Conta'}
        </button>
        <div className="mt-4 text-center text-sm">
          <Link to="/login" className="text-blue-600 hover:underline">JÃ¡ tenho conta</Link>
        </div>
      </form>
    </div>
  );
}

==================================================
ARQUIVO: src\pages\SelectCompany.jsx
==================================================
import React, { useEffect, useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { supabase } from '../supabase/client';
import { Building, ArrowRight, LogOut, Loader2 } from 'lucide-react';

export default function SelectCompany() {
  const navigate = useNavigate();
  const [tenants, setTenants] = useState([]);
  const [loading, setLoading] = useState(true);
  const [switching, setSwitching] = useState(null);

  useEffect(() => {
    const fetchUserTenants = async () => {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) return navigate('/login');

      // Busca empresas na tabela de ligaÃ§Ã£o
      const { data, error } = await supabase
        .from('user_tenants')
        .select(`
            tenant_id,
            role,
            tenant:tenants ( id, companyName, planId )
        `)
        .eq('user_id', user.id);

      if (error) {
        console.error('Erro ao buscar empresas:', error);
      } else {
        // Mapeia para um formato limpo
        const formatted = data.map(d => ({
            id: d.tenant.id,
            companyName: d.tenant.companyName,
            planId: d.tenant.planId,
            role: d.role
        }));
        setTenants(formatted);
      }
      setLoading(false);
    };

    fetchUserTenants();
  }, []);

  const handleSelect = async (tenant) => {
    setSwitching(tenant.id);
    const { data: { user } } = await supabase.auth.getUser();

    // --- CONTEXT SWITCHING ---
    // Atualiza o perfil principal para refletir a empresa escolhida.
    // Assim, todas as outras telas (Dashboard, Vagas) carregarÃ£o dados desta empresa.
    const { error } = await supabase
        .from('user_profiles')
        .update({ 
            tenantId: tenant.id,
            role: tenant.role // Atualiza tambÃ©m o cargo para o contexto atual
        }) 
        .eq('id', user.id);

    if (error) {
        alert("Erro ao entrar na empresa: " + error.message);
        setSwitching(null);
    } else {
        navigate('/');
    }
  };

  const handleLogout = async () => {
      await supabase.auth.signOut();
      navigate('/login');
  };

  if (loading) return <div className="min-h-screen flex items-center justify-center bg-gray-50"><Loader2 className="animate-spin text-blue-600"/></div>;

  return (
    <div className="min-h-screen bg-gray-100 flex flex-col items-center justify-center p-4 font-sans">
      <div className="max-w-md w-full">
        <div className="text-center mb-8">
            <h1 className="text-3xl font-bold text-gray-900">Selecionar Empresa</h1>
            <p className="text-gray-500 mt-2">VocÃª tem acesso a {tenants.length} organizaÃ§Ãµes. Onde deseja atuar agora?</p>
        </div>

        <div className="space-y-4">
            {tenants.map((t) => (
                <button
                    key={t.id}
                    onClick={() => handleSelect(t)}
                    disabled={switching}
                    className="w-full bg-white p-6 rounded-xl shadow-sm border border-gray-200 hover:border-blue-500 hover:shadow-md transition-all flex items-center justify-between group text-left relative overflow-hidden"
                >
                    <div className="flex items-center gap-4 relative z-10">
                        <div className="bg-blue-50 p-3 rounded-full text-blue-600 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                            <Building size={24} />
                        </div>
                        <div>
                            <h3 className="font-bold text-gray-800 text-lg group-hover:text-blue-700 transition-colors">{t.companyName}</h3>
                            <div className="flex items-center gap-2">
                                <span className="text-xs uppercase font-bold text-gray-400 tracking-wider border px-1.5 rounded">{t.planId || 'Standard'}</span>
                                <span className="text-xs text-gray-500 capitalize">â€¢ {t.role}</span>
                            </div>
                        </div>
                    </div>
                    {switching === t.id ? <Loader2 className="animate-spin text-blue-600"/> : <ArrowRight className="text-gray-300 group-hover:text-blue-600 transition-colors"/>}
                </button>
            ))}
        </div>

        <div className="mt-8 text-center">
            <button onClick={handleLogout} className="text-gray-400 hover:text-red-600 text-sm flex items-center justify-center gap-2 w-full transition-colors">
                <LogOut size={16}/> Sair da conta
            </button>
        </div>
      </div>
    </div>
  );
}

==================================================
ARQUIVO: src\pages\Settings.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { supabase } from '../supabase/client';
import { Building, Users, ArrowLeft, Shield, Plus, Trash2, Mail, Lock, AlertCircle, Briefcase, Crown, User, Save, Key } from 'lucide-react';

export default function Settings() {
  const navigate = useNavigate();
  const [activeTab, setActiveTab] = useState('company'); // company, team, profile
  const [loading, setLoading] = useState(true);
  
  const [tenant, setTenant] = useState(null);
  const [team, setTeam] = useState([]);
  const [currentUserProfile, setCurrentUserProfile] = useState(null);

  // Estados para EdiÃ§Ã£o do PrÃ³prio Perfil
  const [myProfileForm, setMyProfileForm] = useState({ name: '', email: '', password: '', confirmPassword: '' });
  const [isUpdatingProfile, setIsUpdatingProfile] = useState(false);

  // Estados para Novo UsuÃ¡rio da Equipe
  const [newUser, setNewUser] = useState({ name: '', email: '', password: '', role: '', isAdmin: false });
  const [isAddingUser, setIsAddingUser] = useState(false);

  useEffect(() => {
    fetchData();
  }, []);

  const fetchData = async () => {
    setLoading(true);
    try {
      const { data: { session } } = await supabase.auth.getSession();
      if (!session) return navigate('/login');

      // 1. Pega perfil do usuÃ¡rio logado
      const { data: profile } = await supabase.from('user_profiles').select('*').eq('id', session.user.id).single();
      setCurrentUserProfile(profile);

      // Preenche o formulÃ¡rio de perfil com os dados atuais
      setMyProfileForm(prev => ({ ...prev, name: profile.name || '', email: profile.email || session.user.email }));

      if (profile?.tenantId) {
        // 2. Busca EMPRESA
        const { data: tenantData } = await supabase
            .from('tenants')
            .select('*')
            .eq('id', profile.tenantId)
            .single();
        setTenant(tenantData);

        // 3. Busca EQUIPE
        const { data: teamRelations, error: teamError } = await supabase
            .from('user_tenants')
            .select(`
                role,
                user_id,
                user:user_profiles (
                    id, name, email, is_admin_system
                )
            `)
            .eq('tenant_id', profile.tenantId);

        if (teamError) throw teamError;

        // Formata os dados para a estrutura que a tela espera
        const formattedTeam = [];
        if (teamRelations) {
            teamRelations.forEach(item => {
                if (item.user) {
                    formattedTeam.push({
                        id: item.user.id,
                        name: item.user.name,
                        email: item.user.email,
                        is_admin_system: item.user.is_admin_system,
                        role: item.role, 
                        isAdmin: item.role === 'Administrador' || item.role === 'admin'
                    });
                }
            });
        }
        
        setTeam(formattedTeam);
      }
    } catch (error) {
      console.error("Erro ao carregar dados:", error);
    } finally {
      setLoading(false);
    }
  };

  // --- FUNÃ‡Ã•ES DE MEU PERFIL ---
  const handleUpdateProfile = async (e) => {
    e.preventDefault();
    setIsUpdatingProfile(true);
    try {
        const { data: { user } } = await supabase.auth.getUser();
        let emailChanged = false;

        // 1. AtualizaÃ§Ã£o de Senha
        if (myProfileForm.password) {
            if (myProfileForm.password !== myProfileForm.confirmPassword) {
                throw new Error("As senhas nÃ£o conferem.");
            }
            if (myProfileForm.password.length < 6) {
                throw new Error("A senha deve ter pelo menos 6 caracteres.");
            }
            const { error: passError } = await supabase.auth.updateUser({ password: myProfileForm.password });
            if (passError) throw passError;
            alert("Senha atualizada com sucesso!");
        }

        // 2. AtualizaÃ§Ã£o de E-mail
        if (myProfileForm.email !== user.email) {
            const { error: emailError } = await supabase.auth.updateUser({ email: myProfileForm.email });
            if (emailError) throw emailError;
            emailChanged = true;
        }

        // 3. AtualizaÃ§Ã£o de Perfil
        const { error: profileError } = await supabase
            .from('user_profiles')
            .update({ 
                name: myProfileForm.name,
                email: myProfileForm.email
            })
            .eq('id', user.id);

        if (profileError) throw profileError;

        let msg = "Perfil atualizado com sucesso!";
        if (emailChanged) msg += " Verifique seu novo e-mail para confirmar a alteraÃ§Ã£o.";
        
        alert(msg);
        setMyProfileForm(prev => ({ ...prev, password: '', confirmPassword: '' })); // Limpa senhas
        fetchData();

    } catch (error) {
        alert("Erro ao atualizar perfil: " + error.message);
    } finally {
        setIsUpdatingProfile(false);
    }
  };

  // --- FUNÃ‡Ã•ES DE EQUIPE ---
  const handleAddUser = async (e) => {
    e.preventDefault();
    if (!newUser.name || !newUser.email || !newUser.password) return alert("Preencha os campos obrigatÃ³rios.");

    const { data: { session } } = await supabase.auth.getSession();
    
    try {
      const res = await fetch('/api/admin', {
        method: 'POST',
        headers: { 
            'Content-Type': 'application/json',
            Authorization: `Bearer ${session.access_token}`
        },
        body: JSON.stringify({
            action: 'createUser',
            tenantId: tenant.id,
            ...newUser,
            role: newUser.role || (newUser.isAdmin ? 'Administrador' : 'Recrutador') 
        })
      });

      const data = await res.json();
      if (!res.ok) throw new Error(data.error || "Erro ao conectar na API.");

      alert(data.message || "UsuÃ¡rio adicionado com sucesso!");
      setIsAddingUser(false);
      setNewUser({ name: '', email: '', password: '', role: '', isAdmin: false });
      fetchData();
      
    } catch (err) {
      console.error(err);
      alert("Erro ao criar usuÃ¡rio: " + err.message);
    }
  };

  const handleDeleteUser = async (userId) => {
    if (!confirm("Tem certeza? O acesso deste usuÃ¡rio serÃ¡ revogado apenas para ESTA empresa.")) return;
    const { data: { session } } = await supabase.auth.getSession();
    
    try {
        const res = await fetch('/api/admin', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${session.access_token}` },
            body: JSON.stringify({ action: 'deleteUser', userId, tenantId: tenant.id })
        });

        if (res.ok) {
            alert("Acesso revogado com sucesso.");
            fetchData();
        } else {
            const err = await res.json();
            throw new Error(err.error || "Falha na API");
        }
    } catch (e) {
        alert("Erro: " + e.message);
    }
  };

  if (loading) return <div className="min-h-screen flex items-center justify-center bg-gray-50"><div className="text-gray-500 font-medium">Carregando configuraÃ§Ãµes...</div></div>;

  return (
    <div className="p-8 max-w-5xl mx-auto font-sans min-h-screen">
      <button onClick={() => navigate('/')} className="flex items-center text-gray-500 mb-6 hover:text-blue-600 transition-colors group">
        <ArrowLeft className="mr-2 group-hover:-translate-x-1 transition-transform" size={20}/> Voltar ao Dashboard
      </button>

      <div className="flex justify-between items-center mb-8">
        <div>
            <h1 className="text-3xl font-bold text-gray-900">ConfiguraÃ§Ãµes</h1>
            <p className="text-gray-500 mt-1">Gerencie seus dados e sua organizaÃ§Ã£o</p>
        </div>
        {currentUserProfile?.is_admin_system && (
            <button onClick={() => navigate('/admin/super')} className="text-xs bg-slate-800 text-white px-4 py-2 rounded-lg hover:bg-slate-700 transition shadow-sm font-medium flex items-center gap-2">
                <Shield size={14} /> Painel Super Admin
            </button>
        )}
      </div>

      <div className="flex gap-8 border-b border-gray-200 mb-8 overflow-x-auto">
        <button 
            onClick={() => setActiveTab('company')} 
            className={`pb-4 px-2 border-b-2 flex items-center gap-2 font-medium transition-all whitespace-nowrap ${activeTab === 'company' ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'}`}
        >
          <Building size={18}/> Minha Empresa
        </button>
        <button 
            onClick={() => setActiveTab('team')} 
            className={`pb-4 px-2 border-b-2 flex items-center gap-2 font-medium transition-all whitespace-nowrap ${activeTab === 'team' ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'}`}
        >
          <Users size={18}/> GestÃ£o de Equipe
        </button>
        <button 
            onClick={() => setActiveTab('profile')} 
            className={`pb-4 px-2 border-b-2 flex items-center gap-2 font-medium transition-all whitespace-nowrap ${activeTab === 'profile' ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'}`}
        >
          <User size={18}/> Meu Perfil
        </button>
      </div>

      {/* ABA 1: EMPRESA (LEITURA) */}
      {activeTab === 'company' && tenant && (
        <div className="bg-white p-8 rounded-xl shadow-sm border border-gray-200 max-w-3xl animate-in fade-in slide-in-from-left-2 duration-300">
            <div className="flex items-center justify-between mb-8">
                <div>
                    <h2 className="text-xl font-bold text-gray-900">Dados da OrganizaÃ§Ã£o</h2>
                    <p className="text-sm text-gray-500">InformaÃ§Ãµes do seu ambiente SaaS</p>
                </div>
                <div className="bg-blue-50 text-blue-700 px-3 py-1 rounded-full text-xs font-bold border border-blue-100 uppercase tracking-wide">
                    {tenant.planId || 'Plano BÃ¡sico'}
                </div>
            </div>

            <div className="grid gap-6">
                <div>
                    <label className="block text-xs font-bold text-gray-500 uppercase mb-1.5">RazÃ£o Social</label>
                    <div className="flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200 text-gray-700 font-medium">
                        <Building size={18} className="text-gray-400" />
                        {tenant.companyName}
                        <Lock size={14} className="text-gray-400 ml-auto" title="Campo gerenciado pela Novva"/>
                    </div>
                </div>
                
                <div>
                     <label className="block text-xs font-bold text-gray-500 uppercase mb-1.5">Identificador do Tenant (ID)</label>
                     <div className="font-mono text-sm bg-slate-100 p-3 rounded-lg text-slate-600 break-all border border-slate-200 select-all">
                         {tenant.id}
                     </div>
                </div>

                <div className="bg-blue-50 p-5 rounded-xl border border-blue-100 mt-2">
                    <div className="flex items-start gap-4">
                        <Shield className="text-blue-600 mt-1 shrink-0" size={24} />
                        <div>
                            <h3 className="font-bold text-blue-900">Gerenciamento do Plano</h3>
                            <p className="text-sm text-blue-700 mt-2 leading-relaxed">
                                Seu plano atual Ã© gerenciado pela equipe da <strong>Novva Desenvolvimento</strong>.
                                Para upgrades, downgrades ou alteraÃ§Ãµes cadastrais (CNPJ), entre em contato com nosso suporte.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
      )}

      {/* ABA 2: EQUIPE (CRUD) */}
      {activeTab === 'team' && (
        <div className="animate-in fade-in slide-in-from-right-2 duration-300">
            <div className="flex justify-between items-end mb-6">
                <div>
                    <h2 className="text-xl font-bold text-gray-900">Membros da Equipe</h2>
                    <p className="text-sm text-gray-500">Gerencie quem tem acesso aos dados da {tenant?.companyName}.</p>
                </div>
                {!isAddingUser && (
                    <button onClick={() => setIsAddingUser(true)} className="bg-blue-600 text-white px-4 py-2.5 rounded-lg flex items-center gap-2 hover:bg-blue-700 shadow-sm transition font-medium">
                        <Plus size={18}/> Adicionar UsuÃ¡rio
                    </button>
                )}
            </div>

            {isAddingUser && (
                <div className="bg-white p-6 rounded-xl border border-blue-100 mb-8 shadow-sm ring-4 ring-blue-50">
                    <h3 className="font-bold mb-6 text-gray-900 flex items-center gap-2 pb-4 border-b"><Plus size={18} className="text-blue-600"/> Cadastrar Novo Membro</h3>
                    
                    {/* CORREÃ‡ÃƒO AQUI: AUTOCOMPLETE OFF */}
                    <form onSubmit={handleAddUser} autoComplete="off">
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-5 mb-6">
                            <div>
                                <label className="block text-xs font-bold text-gray-700 mb-1.5">Nome Completo *</label>
                                <input required className="w-full border border-gray-300 p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition" 
                                    value={newUser.name} onChange={e => setNewUser({...newUser, name: e.target.value})} 
                                    autoComplete="off" // PrevenÃ§Ã£o extra
                                />
                            </div>
                            <div>
                                <label className="block text-xs font-bold text-gray-700 mb-1.5">E-mail Corporativo *</label>
                                <input required type="email" className="w-full border border-gray-300 p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition" 
                                    value={newUser.email} onChange={e => setNewUser({...newUser, email: e.target.value})} 
                                    autoComplete="off" // Evita sugestÃ£o de email do usuÃ¡rio atual
                                />
                            </div>
                            {/* NOVO CAMPO: CARGO */}
                            <div>
                                <label className="block text-xs font-bold text-gray-700 mb-1.5">Cargo / FunÃ§Ã£o</label>
                                <div className="relative">
                                    <Briefcase className="absolute left-3 top-3 text-gray-400 w-4 h-4" />
                                    <input 
                                        className="w-full border border-gray-300 p-2.5 pl-9 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition" 
                                        value={newUser.role} 
                                        onChange={e => setNewUser({...newUser, role: e.target.value})} 
                                        placeholder="Ex: Gerente de RH"
                                    />
                                </div>
                            </div>
                            <div>
                                <label className="block text-xs font-bold text-gray-700 mb-1.5">Senha Inicial *</label>
                                <input required type="password" className="w-full border border-gray-300 p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition" 
                                    value={newUser.password} onChange={e => setNewUser({...newUser, password: e.target.value})} 
                                    autoComplete="new-password" // CHAVE MESTRA: ForÃ§a o navegador a nÃ£o preencher
                                />
                            </div>
                            <div className="flex items-center h-full pt-1 md:col-span-2">
                                <label className={`flex items-center gap-3 cursor-pointer p-4 rounded-lg border w-full transition ${newUser.isAdmin ? 'bg-purple-50 border-purple-200 ring-1 ring-purple-200' : 'bg-gray-50 border-gray-200 hover:border-gray-300'}`}>
                                    <input type="checkbox" className="w-5 h-5 text-purple-600 rounded focus:ring-purple-500" checked={newUser.isAdmin} onChange={e => setNewUser({...newUser, isAdmin: e.target.checked})} />
                                    <div>
                                        <span className="text-sm font-bold text-gray-800 flex items-center gap-2">
                                            {newUser.isAdmin ? <Crown size={16} className="text-purple-600"/> : null} 
                                            Conceder acesso de Administrador?
                                        </span>
                                        <span className="text-xs text-gray-500 block mt-1">Administradores podem gerenciar configuraÃ§Ãµes e remover usuÃ¡rios.</span>
                                    </div>
                                </label>
                            </div>
                        </div>
                        <div className="flex gap-3 pt-2 justify-end">
                            <button type="button" onClick={() => setIsAddingUser(false)} className="px-6 py-2.5 rounded-lg border border-gray-300 hover:bg-gray-50 font-medium text-gray-700 transition">Cancelar</button>
                            <button type="submit" className="bg-blue-600 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-blue-700 shadow-md transition">Salvar UsuÃ¡rio</button>
                        </div>
                    </form>
                </div>
            )}

            <div className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                <table className="w-full text-left border-collapse">
                    <thead className="bg-gray-50 border-b border-gray-200">
                        <tr>
                            <th className="p-5 font-semibold text-gray-600 text-xs uppercase tracking-wider">Nome</th>
                            <th className="p-5 font-semibold text-gray-600 text-xs uppercase tracking-wider">Email</th>
                            <th className="p-5 font-semibold text-gray-600 text-xs uppercase tracking-wider">Cargo</th>
                            <th className="p-5 font-semibold text-gray-600 text-xs uppercase tracking-wider">PermissÃ£o</th>
                            <th className="p-5 font-semibold text-gray-600 text-xs uppercase tracking-wider text-right">AÃ§Ãµes</th>
                        </tr>
                    </thead>
                    <tbody className="divide-y divide-gray-100">
                        {team.map(user => (
                            <tr key={user.id} className="hover:bg-blue-50/50 transition-colors">
                                <td className="p-5 font-medium text-gray-900">{user.name || 'Sem nome'}</td>
                                <td className="p-5 text-gray-600 text-sm flex items-center gap-2"><Mail size={14} className="text-gray-400"/> {user.email}</td>
                                <td className="p-5 text-slate-700 font-medium text-sm">{user.role}</td>
                                <td className="p-5">
                                    <span className={`px-2.5 py-1 rounded-full text-xs font-bold uppercase tracking-wide border ${user.isAdmin || user.role === 'admin' ? 'bg-purple-100 text-purple-700 border-purple-200' : 'bg-gray-100 text-gray-600 border-gray-200'}`}>
                                        {user.isAdmin || user.role === 'admin' ? 'Admin' : 'Membro'}
                                    </span>
                                </td>
                                <td className="p-5 text-right">
                                    {user.id !== currentUserProfile?.id ? (
                                        <button onClick={() => handleDeleteUser(user.id)} className="text-gray-400 hover:text-red-600 hover:bg-red-50 p-2 rounded-lg transition-all" title="Remover UsuÃ¡rio">
                                            <Trash2 size={18} />
                                        </button>
                                    ) : (
                                        <span className="text-xs font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded">VOCÃŠ</span>
                                    )}
                                </td>
                            </tr>
                        ))}
                    </tbody>
                </table>
                {team.length === 0 && (
                    <div className="p-12 text-center flex flex-col items-center">
                        <div className="bg-gray-100 p-4 rounded-full mb-3">
                            <AlertCircle className="text-gray-400" size={32} />
                        </div>
                        <p className="text-gray-900 font-medium text-lg">Nenhum membro encontrado</p>
                        <p className="text-sm text-gray-500 mt-1">Adicione usuÃ¡rios para colaborar nesta empresa.</p>
                    </div>
                )}
            </div>
        </div>
      )}

      {/* ABA 3: MEU PERFIL (NOVO) */}
      {activeTab === 'profile' && (
        <div className="bg-white p-8 rounded-xl shadow-sm border border-gray-200 max-w-2xl animate-in fade-in slide-in-from-right-2 duration-300">
            <div className="flex items-center gap-4 mb-8 pb-6 border-b">
                <div className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold text-2xl border-4 border-white shadow-sm">
                    {myProfileForm.name?.[0]?.toUpperCase() || 'U'}
                </div>
                <div>
                    <h2 className="text-xl font-bold text-gray-900">Editar Meu Perfil</h2>
                    <p className="text-sm text-gray-500">Mantenha seus dados atualizados.</p>
                </div>
            </div>

            <form onSubmit={handleUpdateProfile} className="space-y-6">
                <div>
                    <label className="block text-xs font-bold text-gray-700 uppercase mb-1.5">Nome Completo</label>
                    <input 
                        required 
                        className="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition"
                        value={myProfileForm.name}
                        onChange={e => setMyProfileForm({...myProfileForm, name: e.target.value})}
                    />
                </div>

                <div>
                    <label className="block text-xs font-bold text-gray-700 uppercase mb-1.5">E-mail de Acesso</label>
                    <div className="relative">
                        <Mail className="absolute left-3 top-3.5 text-gray-400 w-5 h-5" />
                        <input 
                            required 
                            type="email"
                            className="w-full border border-gray-300 p-3 pl-10 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition"
                            value={myProfileForm.email}
                            onChange={e => setMyProfileForm({...myProfileForm, email: e.target.value})}
                        />
                    </div>
                    <p className="text-xs text-orange-600 mt-2 flex items-center gap-1">
                        <AlertCircle size={12}/> AtenÃ§Ã£o: Alterar o e-mail exigirÃ¡ confirmaÃ§Ã£o na nova caixa de entrada.
                    </p>
                </div>

                <div className="pt-4 border-t border-gray-100">
                    <h3 className="text-sm font-bold text-gray-900 mb-4 flex items-center gap-2"><Key size={16}/> Alterar Senha</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label className="block text-xs font-bold text-gray-500 mb-1.5">Nova Senha</label>
                            <input 
                                type="password"
                                className="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition"
                                placeholder="Min. 6 caracteres"
                                value={myProfileForm.password}
                                onChange={e => setMyProfileForm({...myProfileForm, password: e.target.value})}
                            />
                        </div>
                        <div>
                            <label className="block text-xs font-bold text-gray-500 mb-1.5">Confirmar Nova Senha</label>
                            <input 
                                type="password"
                                className="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition"
                                placeholder="Repita a senha"
                                value={myProfileForm.confirmPassword}
                                onChange={e => setMyProfileForm({...myProfileForm, confirmPassword: e.target.value})}
                            />
                        </div>
                    </div>
                </div>

                <div className="pt-4 flex justify-end">
                    <button 
                        type="submit" 
                        disabled={isUpdatingProfile}
                        className="bg-blue-600 text-white px-8 py-3 rounded-lg font-bold hover:bg-blue-700 shadow-lg transition flex items-center gap-2 disabled:opacity-70"
                    >
                        {isUpdatingProfile ? 'Salvando...' : <><Save size={18}/> Salvar AlteraÃ§Ãµes</>}
                    </button>
                </div>
            </form>
        </div>
      )}
    </div>
  );
}

==================================================
ARQUIVO: src\pages\SuperAdminDashboard.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { supabase } from '../supabase/client';
import { useNavigate } from 'react-router-dom';
import { Shield, Building, Users, CreditCard, Edit, Trash2, Plus, Save, X, DollarSign, ArrowLeft, Calendar, FileText, CheckCircle } from 'lucide-react';

export default function SuperAdminDashboard() {
  const navigate = useNavigate();
  const [loading, setLoading] = useState(true);
  const [activeTab, setActiveTab] = useState('tenants'); // 'tenants' | 'plans'
  
  // Dados
  const [tenants, setTenants] = useState([]);
  const [plans, setPlans] = useState([]);

  // Estados de FormulÃ¡rio
  const [isEditingPlan, setIsEditingPlan] = useState(false);
  const [isEditingTenant, setIsEditingTenant] = useState(false); // Novo: EdiÃ§Ã£o de Empresa
  
  // Objeto Modelo do Plano
  const initialPlanState = { 
      id: '', name: '', price: 0, 
      user_limit: 1, job_limit: 1, candidate_limit: -1, 
      plan_billing_period: 'monthly' 
  };
  const [planForm, setPlanForm] = useState(initialPlanState);

  // Objeto Modelo do Tenant
  const [tenantForm, setTenantForm] = useState({ id: '', companyName: '', planId: '', cnpj: '' });

  useEffect(() => {
    fetchData();
  }, []);

  const fetchData = async () => {
    setLoading(true);
    const { data: { session } } = await supabase.auth.getSession();
    if (!session) return navigate('/login');

    try {
        // Chamada Ãºnica para buscar tudo (conforme sua API getTenantsAndPlans)
        const res = await fetch('/api/admin', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${session.access_token}` },
            body: JSON.stringify({ action: 'getTenantsAndPlans' })
        });
        
        if (!res.ok) throw new Error('Falha ao carregar dados.');
        
        const data = await res.json();
        setTenants(data.tenants || []);
        setPlans(data.plans || []);
    } catch (error) {
        console.error(error);
        alert("Erro ao carregar painel: " + error.message);
    } finally {
        setLoading(false);
    }
  };

  // --- GESTÃƒO DE PLANOS ---

  const handleNewPlan = () => {
    setPlanForm(initialPlanState);
    setIsEditingPlan(true);
  };

  const handleEditPlan = (plan) => {
    setPlanForm({ ...plan });
    setIsEditingPlan(true);
  };

  const handleSavePlan = async (e) => {
    e.preventDefault();
    const { data: { session } } = await supabase.auth.getSession();
    
    // Determina se Ã© CRIAÃ‡ÃƒO ou ATUALIZAÃ‡ÃƒO baseado se o plano jÃ¡ existe na lista
    // (Ou poderÃ­amos usar um flag isNew, mas checar o ID na lista atual Ã© seguro)
    const isUpdating = plans.some(p => p.id === planForm.id);
    const action = isUpdating ? 'updatePlan' : 'createPlan';

    try {
        const payload = { 
            action, 
            planData: {
                id: planForm.id,
                name: planForm.name,
                price: parseFloat(planForm.price),
                user_limit: parseInt(planForm.user_limit),
                job_limit: parseInt(planForm.job_limit),
                candidate_limit: parseInt(planForm.candidate_limit),
                plan_billing_period: planForm.plan_billing_period
            }
        };

        if (isUpdating) payload.planId = planForm.id;

        const res = await fetch('/api/admin', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${session.access_token}` },
            body: JSON.stringify(payload)
        });

        if (!res.ok) {
            const err = await res.json();
            throw new Error(err.error || 'Erro ao salvar.');
        }

        alert(`Plano ${isUpdating ? 'atualizado' : 'criado'} com sucesso!`);
        setIsEditingPlan(false);
        fetchData(); // Recarrega a lista
    } catch (err) {
        alert("Erro: " + err.message);
    }
  };

  const handleDeletePlan = async (planId) => {
    if (!confirm("Tem certeza que deseja excluir este plano?")) return;
    const { data: { session } } = await supabase.auth.getSession();

    try {
        const res = await fetch('/api/admin', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${session.access_token}` },
            body: JSON.stringify({ action: 'deletePlan', planId })
        });

        if (!res.ok) {
            const err = await res.json();
            throw new Error(err.error);
        }
        
        alert("Plano excluÃ­do.");
        fetchData();
    } catch (err) {
        alert("Erro: " + err.message);
    }
  };

  // --- GESTÃƒO DE TENANTS (EdiÃ§Ã£o RÃ¡pida) ---
  
  const handleEditTenant = (tenant) => {
      setTenantForm({
          id: tenant.id,
          companyName: tenant.companyName,
          planId: tenant.planId,
          cnpj: tenant.cnpj || ''
      });
      setIsEditingTenant(true);
  };

  const handleSaveTenant = async (e) => {
      e.preventDefault();
      const { data: { session } } = await supabase.auth.getSession();

      try {
          const res = await fetch('/api/admin', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${session.access_token}` },
              body: JSON.stringify({ 
                  action: 'updateTenant', 
                  id: tenantForm.id,
                  companyName: tenantForm.companyName,
                  planId: tenantForm.planId,
                  cnpj: tenantForm.cnpj
              })
          });

          if (!res.ok) throw new Error('Falha ao atualizar empresa.');
          
          alert("Empresa atualizada!");
          setIsEditingTenant(false);
          fetchData();
      } catch (err) {
          alert("Erro: " + err.message);
      }
  };

  if (loading) return <div className="flex items-center justify-center h-screen bg-slate-50 text-slate-500">Carregando Sistema...</div>;

  return (
    <div className="min-h-screen bg-slate-50 p-8 font-sans">
      <div className="max-w-7xl mx-auto mb-8 flex justify-between items-center">
        <div>
            <h1 className="text-3xl font-bold text-slate-900 flex items-center gap-3">
                <Shield className="text-red-600" size={32} /> Painel Super Admin
            </h1>
            <p className="text-slate-500 mt-1 ml-11">GestÃ£o Centralizada do SaaS</p>
        </div>
        <button onClick={() => navigate('/settings')} className="flex items-center text-slate-600 hover:text-blue-600 font-medium transition">
            <ArrowLeft size={18} className="mr-2"/> Voltar
        </button>
      </div>

      <div className="max-w-7xl mx-auto">
        {/* NavegaÃ§Ã£o */}
        <div className="bg-white p-1 rounded-lg border border-slate-200 inline-flex mb-8 shadow-sm">
            <button onClick={() => setActiveTab('tenants')} className={`px-6 py-2.5 rounded-md font-bold text-sm flex items-center gap-2 transition ${activeTab === 'tenants' ? 'bg-blue-50 text-blue-700' : 'text-slate-500 hover:bg-slate-50'}`}>
                <Building size={16}/> Empresas ({tenants.length})
            </button>
            <button onClick={() => setActiveTab('plans')} className={`px-6 py-2.5 rounded-md font-bold text-sm flex items-center gap-2 transition ${activeTab === 'plans' ? 'bg-blue-50 text-blue-700' : 'text-slate-500 hover:bg-slate-50'}`}>
                <CreditCard size={16}/> Planos ({plans.length})
            </button>
        </div>

        {/* TAB 1: EMPRESAS */}
        {activeTab === 'tenants' && (
            <div className="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                <table className="w-full text-left">
                    <thead className="bg-slate-50 text-slate-500 text-xs uppercase font-semibold">
                        <tr>
                            <th className="p-4 pl-6">Empresa</th>
                            <th className="p-4">CNPJ</th>
                            <th className="p-4">Plano Atual</th>
                            <th className="p-4 text-right pr-6">AÃ§Ãµes</th>
                        </tr>
                    </thead>
                    <tbody className="divide-y divide-slate-100">
                        {tenants.map(t => (
                            <tr key={t.id} className="hover:bg-slate-50">
                                <td className="p-4 pl-6">
                                    <div className="font-bold text-slate-800">{t.companyName}</div>
                                    <div className="text-xs text-slate-400 font-mono mt-0.5">{t.id}</div>
                                </td>
                                <td className="p-4 text-sm text-slate-600">{t.cnpj || '-'}</td>
                                <td className="p-4">
                                    <span className="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-bold uppercase border border-blue-200">
                                        {t.plans?.name || t.planId || 'Free'}
                                    </span>
                                </td>
                                <td className="p-4 text-right pr-6">
                                    <button onClick={() => handleEditTenant(t)} className="text-blue-600 font-bold text-sm hover:underline flex items-center justify-end gap-1 w-full">
                                        <Edit size={14}/> Editar
                                    </button>
                                </td>
                            </tr>
                        ))}
                    </tbody>
                </table>
            </div>
        )}

        {/* TAB 2: PLANOS */}
        {activeTab === 'plans' && (
            <div className="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
                <div className="lg:col-span-2 space-y-4">
                    <div className="flex justify-between items-center mb-2">
                         <h2 className="font-bold text-lg text-slate-800">Planos DisponÃ­veis</h2>
                         <button onClick={handleNewPlan} className="bg-green-600 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2 hover:bg-green-700 shadow-sm transition"><Plus size={16}/> Novo Plano</button>
                    </div>
                    {plans.map(plan => (
                        <div key={plan.id} className="bg-white p-5 rounded-xl shadow-sm border border-slate-200 flex justify-between items-center group hover:border-blue-300 transition">
                            <div>
                                <div className="flex items-center gap-3">
                                    <h3 className="font-bold text-lg text-slate-900">{plan.name}</h3>
                                    <span className={`px-2 py-0.5 rounded text-xs font-bold uppercase border ${plan.plan_billing_period === 'yearly' ? 'bg-purple-50 text-purple-700 border-purple-100' : 'bg-slate-100 text-slate-600 border-slate-200'}`}>
                                        {plan.plan_billing_period === 'yearly' ? 'Anual' : 'Mensal'}
                                    </span>
                                </div>
                                <div className="flex flex-wrap gap-4 mt-2 text-sm text-slate-500">
                                    <span className="flex items-center gap-1.5"><Users size={14}/> <strong>{plan.user_limit === -1 ? 'âˆž' : plan.user_limit}</strong> Users</span>
                                    <span className="flex items-center gap-1.5"><Building size={14}/> <strong>{plan.job_limit === -1 ? 'âˆž' : plan.job_limit}</strong> Vagas</span>
                                    <span className="flex items-center gap-1.5"><FileText size={14}/> <strong>{plan.candidate_limit === -1 ? 'âˆž' : plan.candidate_limit}</strong> Cands.</span>
                                </div>
                            </div>
                            <div className="text-right flex items-center gap-4">
                                <div className="text-xl font-bold text-green-700 bg-green-50 px-3 py-1 rounded-lg border border-green-100">
                                    {Number(plan.price).toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'})}
                                </div>
                                <div className="flex gap-1">
                                    <button onClick={() => handleEditPlan(plan)} className="p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition"><Edit size={18}/></button>
                                    <button onClick={() => handleDeletePlan(plan.id)} className="p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition"><Trash2 size={18}/></button>
                                </div>
                            </div>
                        </div>
                    ))}
                </div>

                {/* MODAL/SIDEBAR DE EDIÃ‡ÃƒO DE PLANO */}
                {isEditingPlan && (
                    <div className="lg:col-span-1 animate-in fade-in slide-in-from-right-4 duration-300">
                        <div className="bg-white p-6 rounded-xl shadow-xl border border-blue-100 sticky top-8 ring-4 ring-blue-50">
                            <div className="flex justify-between items-center mb-6 pb-4 border-b border-slate-100">
                                <h3 className="font-bold text-lg text-slate-900 flex items-center gap-2">
                                    {plans.some(p => p.id === planForm.id) ? 'Editar Plano' : 'Novo Plano'}
                                </h3>
                                <button onClick={() => setIsEditingPlan(false)} className="text-slate-400 hover:text-slate-600"><X size={20}/></button>
                            </div>

                            <form onSubmit={handleSavePlan} className="space-y-5">
                                <div>
                                    <label className="block text-xs font-bold text-slate-500 uppercase mb-1.5">ID (Slug Ãšnico)</label>
                                    <input 
                                        className="w-full border p-2.5 rounded-lg bg-slate-50 font-mono text-sm disabled:opacity-60" 
                                        value={planForm.id} 
                                        onChange={e => setPlanForm({...planForm, id: e.target.value})}
                                        disabled={plans.some(p => p.id === planForm.id)} // Trava ID na ediÃ§Ã£o
                                        placeholder="ex: pro-mensal"
                                        required
                                    />
                                </div>
                                <div>
                                    <label className="block text-xs font-bold text-slate-500 uppercase mb-1.5">Nome do Plano</label>
                                    <input className="w-full border p-2.5 rounded-lg text-sm" value={planForm.name} onChange={e => setPlanForm({...planForm, name: e.target.value})} required />
                                </div>
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-xs font-bold text-slate-500 uppercase mb-1.5">PreÃ§o (R$)</label>
                                        <input type="number" step="0.01" className="w-full border p-2.5 rounded-lg text-sm" value={planForm.price} onChange={e => setPlanForm({...planForm, price: e.target.value})} />
                                    </div>
                                    <div>
                                        <label className="block text-xs font-bold text-slate-500 uppercase mb-1.5">Ciclo</label>
                                        <select className="w-full border p-2.5 rounded-lg text-sm bg-white" value={planForm.plan_billing_period} onChange={e => setPlanForm({...planForm, plan_billing_period: e.target.value})}>
                                            <option value="monthly">Mensal</option>
                                            <option value="yearly">Anual</option>
                                        </select>
                                    </div>
                                </div>
                                <div className="space-y-3 pt-2 border-t border-dashed border-slate-200">
                                    <div className="flex items-center gap-4">
                                        <label className="w-20 text-xs font-bold text-slate-500">UsuÃ¡rios</label>
                                        <input type="number" className="flex-1 border p-2 rounded text-sm" value={planForm.user_limit} onChange={e => setPlanForm({...planForm, user_limit: e.target.value})} />
                                    </div>
                                    <div className="flex items-center gap-4">
                                        <label className="w-20 text-xs font-bold text-slate-500">Vagas</label>
                                        <input type="number" className="flex-1 border p-2 rounded text-sm" value={planForm.job_limit} onChange={e => setPlanForm({...planForm, job_limit: e.target.value})} />
                                    </div>
                                    <div className="flex items-center gap-4">
                                        <label className="w-20 text-xs font-bold text-slate-500">Candidatos</label>
                                        <input type="number" className="flex-1 border p-2 rounded text-sm" value={planForm.candidate_limit} onChange={e => setPlanForm({...planForm, candidate_limit: e.target.value})} />
                                    </div>
                                    <p className="text-[10px] text-center text-slate-400">-1 para Ilimitado</p>
                                </div>
                                <button type="submit" className="w-full py-2.5 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 shadow-lg flex justify-center items-center gap-2">
                                    <Save size={18}/> Salvar Plano
                                </button>
                            </form>
                        </div>
                    </div>
                )}

                {/* MODAL DE EDIÃ‡ÃƒO DE TENANT */}
                {isEditingTenant && (
                    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                        <div className="bg-white rounded-xl shadow-2xl w-full max-w-md p-6">
                            <h3 className="text-lg font-bold mb-4">Editar Empresa</h3>
                            <form onSubmit={handleSaveTenant} className="space-y-4">
                                <div>
                                    <label className="block text-xs font-bold text-gray-500 mb-1">Nome da Empresa</label>
                                    <input className="w-full border p-2 rounded" value={tenantForm.companyName} onChange={e => setTenantForm({...tenantForm, companyName: e.target.value})} required />
                                </div>
                                <div>
                                    <label className="block text-xs font-bold text-gray-500 mb-1">CNPJ</label>
                                    <input className="w-full border p-2 rounded" value={tenantForm.cnpj} onChange={e => setTenantForm({...tenantForm, cnpj: e.target.value})} />
                                </div>
                                <div>
                                    <label className="block text-xs font-bold text-gray-500 mb-1">Plano AtribuÃ­do</label>
                                    <select className="w-full border p-2 rounded bg-white" value={tenantForm.planId} onChange={e => setTenantForm({...tenantForm, planId: e.target.value})}>
                                        {plans.map(p => <option key={p.id} value={p.id}>{p.name} ({p.plan_billing_period})</option>)}
                                    </select>
                                </div>
                                <div className="flex justify-end gap-2 pt-4">
                                    <button type="button" onClick={() => setIsEditingTenant(false)} className="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded">Cancelar</button>
                                    <button type="submit" className="px-4 py-2 bg-blue-600 text-white font-bold rounded hover:bg-blue-700">Salvar AlteraÃ§Ãµes</button>
                                </div>
                            </form>
                        </div>
                    </div>
                )}
            </div>
        )}
      </div>
    </div>
  );
}

==================================================
ARQUIVO: src\supabase\client.js
==================================================
import { createClient } from '@supabase/supabase-js';

const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;
const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;

if (!supabaseUrl || !supabaseAnonKey) {
  throw new Error('Chaves do Supabase ausentes no arquivo .env');
}

export const supabase = createClient(supabaseUrl, supabaseAnonKey);

==================================================
ARQUIVO: src\utils\evaluationLogic.js
==================================================
// src/utils/evaluationLogic.js

export const calculatePillarScore = (sectionName, criteriaList, answers, ratingScale) => {
    // Se nÃ£o houver critÃ©rios ou respostas, retorna null (neutro)
    if (!criteriaList || !Array.isArray(criteriaList) || criteriaList.length === 0) return null;
    if (!answers) return null;
    
    let totalScore = 0;
    let totalWeightAnswered = 0;
    let hasAnswers = false;

    criteriaList.forEach(criterion => {
        // Tenta achar a resposta (suporta estrutura v2 aninhada ou v1 plana)
        const noteId = answers?.[sectionName]?.[criterion.name] || answers?.[criterion.name];
        
        // Ignora 'NA', null ou undefined
        if (noteId && noteId !== 'NA') {
            // CORREÃ‡ÃƒO CRÃTICA: Converte ambos para String para garantir o match (1 vs "1")
            const noteObj = ratingScale.find(n => String(n.id) === String(noteId));
            
            if (noteObj) {
                hasAnswers = true;
                const weight = Number(criterion.weight) || 0;
                
                // CÃ¡lculo: Valor da Nota * Peso
                totalScore += (Number(noteObj.valor) * weight);
                totalWeightAnswered += weight;
            }
        }
    });

    if (!hasAnswers || totalWeightAnswered === 0) return null;

    // Normaliza para escala 0-10
    return (totalScore / totalWeightAnswered);
};

export const processEvaluation = (evaluationObj, parameters) => {
    if (!evaluationObj || !parameters) {
        return { triagem: 0, cultura: 0, tecnico: 0, total: 0 };
    }

    const answers = evaluationObj.scores || evaluationObj; 
    const ratingScale = parameters.notas || [];
    
    const pTriagem = parameters.triagem || [];
    const pCultura = parameters.cultura || [];
    const pTecnico = parameters.tecnico || parameters['tÃ©cnico'] || parameters['tÃƒÂ©cnico'] || [];

    // Calcula parciais
    const triagem = calculatePillarScore('triagem', pTriagem, answers, ratingScale);
    const cultura = calculatePillarScore('cultura', pCultura, answers, ratingScale);
    const tecnico = calculatePillarScore('tecnico', pTecnico, answers, ratingScale);

    // MÃ©dia AritmÃ©tica Simples dos pilares respondidos
    let sum = 0;
    let count = 0;

    if (triagem !== null) { sum += triagem; count++; }
    if (cultura !== null) { sum += cultura; count++; }
    if (tecnico !== null) { sum += tecnico; count++; }

    // Se count for 0 (nenhum pilar avaliado), nota Ã© 0.
    const total = count > 0 ? (sum / count) : 0;

    return {
        triagem: triagem !== null ? Number(triagem) : 0,
        cultura: cultura !== null ? Number(cultura) : 0,
        tecnico: tecnico !== null ? Number(tecnico) : 0,
        total: Number(total)
    };
};

==================================================
ARQUIVO: src\utils\formatters.js
==================================================
import { format, parseISO } from 'date-fns';

export const formatStatus = (status) => {
  const statusMap = {
    active: 'Ativa',
    inactive: 'Inativa',
    filled: 'Preenchida',
  };
  return statusMap[status] || status;
};

export const formatPhone = (phone) => {
  if (!phone) return 'NÃ£o informado';
  const cleaned = phone.replace(/\D/g, '');
  if (cleaned.length === 11) {
    return `(${cleaned.substring(0, 2)}) ${cleaned.substring(2, 7)}-${cleaned.substring(7)}`;
  }
  if (cleaned.length === 10) {
    return `(${cleaned.substring(0, 2)}) ${cleaned.substring(2, 6)}-${cleaned.substring(6)}`;
  }
  return phone;
};

export const formatUrl = (url) => {
  if (!url) return '#';
  if (url.startsWith('http://') || url.startsWith('https://')) { return url; }
  return `//${url}`;
};

export const formatDate = (dateStr) => {
    if (!dateStr) return 'NÃ£o informado';
    try {
        return format(parseISO(dateStr), 'dd/MM/yyyy');
    } catch (error) {
        console.error("Erro ao formatar data:", dateStr, error);
        return 'Data invÃ¡lida';
    }
};

==================================================
ARQUIVO: src_old\App.jsx
==================================================
import { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';
import { AuthProvider } from './context/AuthContext';
import PrivateRoute from './components/PrivateRoute';
import Layout from './components/Layout';

import Login from './pages/Login';
import Register from './pages/Register';
import Dashboard from './pages/Dashboard';
import JobDetails from './pages/JobDetails';
import ApplyPage from './pages/ApplyPage';
import Jobs from './pages/Jobs';
import Candidates from './pages/Candidates';
import CompanySettings from './pages/CompanySettings';
import Evaluation from './pages/Evaluation';

function App() {
  return (
    <Router>
      <AuthProvider>
        <Routes>
          {/* Rotas PÃºblicas */}
          <Route path="/login" element={<Login />} />
          <Route path="/register" element={<Register />} />
          <Route path="/vagas/:id/candidatar" element={<ApplyPage />} />

          {/* Rotas Privadas (Protegidas) */}
          <Route element={<PrivateRoute />}>
            {/* O Layout envolve todas as pÃ¡ginas internas */}
            <Route element={<Layout />}>
              <Route path="/" element={<Navigate to="/dashboard" replace />} />
              <Route path="/dashboard" element={<Dashboard />} />
              
              <Route path="/jobs" element={<Jobs />} />
              <Route path="/jobs/:id" element={<JobDetails />} />
              
              <Route path="/candidates" element={<Candidates />} />
              <Route path="/settings" element={<CompanySettings />} />
              <Route path="/evaluations/:applicationId" element={<Evaluation />} />
            </Route>
          </Route>

          <Route path="*" element={<Navigate to="/login" replace />} />
        </Routes>
      </AuthProvider>
    </Router>
  );
}

export default App;

==================================================
ARQUIVO: src_old\index.css
==================================================
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Seus estilos globais extras aqui, se houver */
body {
  @apply bg-gray-50;
}

==================================================
ARQUIVO: src_old\main.jsx
==================================================
import React from 'react'
import ReactDOM from 'react-dom/client'
import { BrowserRouter } from 'react-router-dom';
import App from './App.jsx'
import { AuthProvider } from './context/AuthContext.jsx';
import './index.css'

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <AuthProvider>
      <BrowserRouter>
        <App />
      </BrowserRouter>
    </AuthProvider>
  </React.StrictMode>,
)

==================================================
ARQUIVO: src_old\components\AreaSelect.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { supabase } from '../supabase/client';
import { Input } from './ui/input';
import { Button } from './ui/button';
import { Label } from './ui/label';
import { Loader2, Plus, X } from 'lucide-react';

export default function AreaSelect({ currentTenantId, selectedAreaId, onSelectArea, error }) {
  const [departments, setDepartments] = useState([]);
  const [isCreatingNew, setIsCreatingNew] = useState(false);
  const [newDeptName, setNewDeptName] = useState('');
  const [loading, setLoading] = useState(false);

  // Busca Ã¡reas da empresa atual
  useEffect(() => {
    if (!currentTenantId) return;

    async function fetchDepartments() {
      setLoading(true);
      try {
        const { data, error } = await supabase
          .from('company_departments')
          .select('id, name')
          .eq('tenantId', currentTenantId)
          .order('name', { ascending: true });

        if (error) throw error;
        setDepartments(data || []);
      } catch (error) {
        console.error('Erro ao buscar Ã¡reas:', error.message);
      } finally {
        setLoading(false);
      }
    }

    fetchDepartments();
  }, [currentTenantId]);

  // Salva nova Ã¡rea
  const handleSaveNew = async () => {
    if (!newDeptName.trim()) return;
    try {
      setLoading(true);
      const { data, error } = await supabase
        .from('company_departments')
        .insert([{ 
          name: newDeptName.trim(), 
          tenantId: currentTenantId 
        }])
        .select()
        .single();

      if (error) throw error;

      setDepartments([...departments, data]);
      onSelectArea(data.id);
      setIsCreatingNew(false);
      setNewDeptName('');
    } catch (error) {
      alert('Erro ao criar Ã¡rea: ' + error.message);
    } finally {
      setLoading(false);
    }
  };

  if (loading && departments.length === 0) {
    return <div className="text-sm text-gray-500 flex items-center"><Loader2 className="w-3 h-3 animate-spin mr-2"/> Carregando Ã¡reas...</div>;
  }

  // Modo de CriaÃ§Ã£o (Input de Texto)
  if (isCreatingNew) {
    return (
      <div className="mb-4 p-4 border border-blue-100 bg-blue-50 rounded-md">
        <Label>Nome da Nova Ãrea</Label>
        <div className="flex gap-2">
          <Input
            value={newDeptName}
            onChange={(e) => setNewDeptName(e.target.value)}
            placeholder="Ex: Marketing, TI..."
            autoFocus
          />
        </div>
        <div className="flex justify-end gap-2 mt-3">
            <Button 
                type="button"
                variant="ghost" 
                size="sm"
                onClick={() => setIsCreatingNew(false)}
            >
                Cancelar
            </Button>
            <Button 
                type="button"
                size="sm"
                onClick={handleSaveNew}
                disabled={!newDeptName.trim() || loading}
            >
                {loading ? <Loader2 className="w-4 h-4 animate-spin"/> : 'Salvar'}
            </Button>
        </div>
      </div>
    );
  }

  // Modo de SeleÃ§Ã£o (Dropdown Nativo Estilizado)
  return (
    <div className="mb-4">
      <Label>Ãrea / Departamento</Label>
      <select
        className="flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
        value={selectedAreaId || ''}
        onChange={(e) => {
          if (e.target.value === 'NEW') setIsCreatingNew(true);
          else onSelectArea(e.target.value);
        }}
      >
        <option value="">Selecione uma Ã¡rea...</option>
        {departments.map((dept) => (
          <option key={dept.id} value={dept.id}>
            {dept.name}
          </option>
        ))}
        <option value="NEW" className="font-bold text-blue-600 bg-blue-50">
          + Cadastrar Nova Ãrea
        </option>
      </select>
      {error && <p className="text-sm text-red-500 mt-1">{error}</p>}
    </div>
  );
}

==================================================
ARQUIVO: src_old\components\Layout.jsx
==================================================
import { useState } from 'react';
import { Outlet, Link, useLocation, useNavigate } from 'react-router-dom';
import { supabase } from '../supabase/client';
import { 
  LayoutDashboard, 
  Briefcase, 
  Users, 
  Settings, 
  LogOut, 
  Menu, 
  X 
} from 'lucide-react';
import { Button } from './ui/button';

export default function Layout() {
  const location = useLocation();
  const navigate = useNavigate();
  const [isSidebarOpen, setIsSidebarOpen] = useState(false);

  const navigation = [
    { name: 'Dashboard', href: '/dashboard', icon: LayoutDashboard },
    { name: 'Vagas', href: '/jobs', icon: Briefcase },
    { name: 'Candidatos', href: '/candidates', icon: Users },
    { name: 'ConfiguraÃ§Ãµes', href: '/settings', icon: Settings },
  ];

  const handleLogout = async () => {
    await supabase.auth.signOut();
    navigate('/login');
  };

  const NavItem = ({ item }) => {
    const isActive = location.pathname.startsWith(item.href);
    return (
      <Link
        to={item.href}
        onClick={() => setIsSidebarOpen(false)}
        className={`flex items-center px-4 py-3 text-sm font-medium rounded-md transition-colors ${
          isActive 
            ? 'bg-blue-50 text-blue-700' 
            : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'
        }`}
      >
        <item.icon className={`mr-3 h-5 w-5 ${isActive ? 'text-blue-700' : 'text-gray-400'}`} />
        {item.name}
      </Link>
    );
  };

  return (
    <div className="min-h-screen bg-gray-50 flex">
      {/* Sidebar Mobile Overlay */}
      {isSidebarOpen && (
        <div 
          className="fixed inset-0 z-40 bg-gray-600 bg-opacity-75 lg:hidden"
          onClick={() => setIsSidebarOpen(false)}
        />
      )}

      {/* Sidebar Navigation */}
      <div className={`
        fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-gray-200 transform transition-transform duration-200 ease-in-out lg:translate-x-0 lg:static lg:inset-0
        ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full'}
      `}>
        <div className="flex items-center justify-between h-16 px-6 border-b border-gray-200">
          <span className="text-xl font-bold text-blue-600 tracking-tight">Novva R&S</span>
          <button onClick={() => setIsSidebarOpen(false)} className="lg:hidden">
            <X className="h-6 w-6 text-gray-500" />
          </button>
        </div>
        
        <nav className="p-4 space-y-1">
          {navigation.map((item) => (
            <NavItem key={item.name} item={item} />
          ))}
        </nav>

        <div className="absolute bottom-0 w-full p-4 border-t border-gray-200">
          <Button 
            variant="ghost" 
            className="w-full justify-start text-red-600 hover:text-red-700 hover:bg-red-50"
            onClick={handleLogout}
          >
            <LogOut className="mr-3 h-5 w-5" />
            Sair
          </Button>
        </div>
      </div>

      {/* Main Content Area */}
      <div className="flex-1 flex flex-col min-w-0 overflow-hidden">
        {/* Mobile Header */}
        <div className="lg:hidden flex items-center justify-between bg-white border-b border-gray-200 px-4 py-2">
          <span className="font-semibold text-gray-700">Menu</span>
          <button 
            onClick={() => setIsSidebarOpen(true)}
            className="p-2 -mr-2 text-gray-500 hover:text-gray-700"
          >
            <Menu className="h-6 w-6" />
          </button>
        </div>

        {/* Page Content */}
        <main className="flex-1 overflow-y-auto p-4 sm:p-8">
          <Outlet />
        </main>
      </div>
    </div>
  );
}

==================================================
ARQUIVO: src_old\components\PrivateRoute.jsx
==================================================
import { Navigate, Outlet } from 'react-router-dom';
import { useAuth } from '../context/AuthContext';
import LoadingSpinner from './common/LoadingSpinner';

export default function PrivateRoute() {
  // CORREÃ‡ÃƒO: Mudado de 'user' para 'currentUser' para bater com o AuthContext
  const { currentUser, loading } = useAuth();

  if (loading) {
    return <LoadingSpinner />;
  }

  // Se tem usuÃ¡rio, libera. Se nÃ£o, manda pro login.
  return currentUser ? <Outlet /> : <Navigate to="/login" replace />;
}

==================================================
ARQUIVO: src_old\components\charts\ClassificationChart.jsx
==================================================
import React from 'react';
import { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, LabelList } from 'recharts';

const ClassificationChart = ({ data }) => {
  return (
    <div className="w-full h-[300px] mt-4">
      <ResponsiveContainer>
        <BarChart
          layout="vertical"
          data={data}
          margin={{ top: 5, right: 30, left: 100, bottom: 5 }}
        >
          <CartesianGrid strokeDasharray="3 3" />
          <XAxis type="number" />
          <YAxis dataKey="candidateName" type="category" width={150} />
          <Tooltip />
          <Legend />
          <Bar dataKey="notaTriagem" stackId="a" fill="#3f51b5" name="Nota Triagem">
            <LabelList dataKey="notaTriagem" position="center" fill="#fff" formatter={(value) => value.toFixed(1)} />
          </Bar>
          <Bar dataKey="notaCultura" stackId="a" fill="#8884d8" name="Nota Cultura">
             <LabelList dataKey="notaCultura" position="center" fill="#fff" formatter={(value) => value.toFixed(1)} />
          </Bar>
          <Bar dataKey="notaTecnico" stackId="a" fill="#82ca9d" name="Nota TÃ©cnico">
             <LabelList dataKey="notaTecnico" position="center" fill="#fff" formatter={(value) => value.toFixed(1)} />
          </Bar>
        </BarChart>
      </ResponsiveContainer>
    </div>
  );
};

export default ClassificationChart;

==================================================
ARQUIVO: src_old\components\common\LoadingSpinner.jsx
==================================================
import React from 'react';
import { Loader2 } from 'lucide-react';

const LoadingSpinner = () => {
    return (
        <div className="flex h-screen w-screen items-center justify-center bg-gray-50">
            <Loader2 className="h-10 w-10 animate-spin text-blue-600" />
        </div>
    );
};

export default LoadingSpinner;

==================================================
ARQUIVO: src_old\components\evaluation_v2\EvaluationDashboardV2.jsx
==================================================
import React, { useEffect, useState } from 'react';
import { prepareEvaluationV2, getEvaluationSummaryV2 } from '../../services/evaluationService';
import { supabase } from '../../supabase/client';

export default function EvaluationDashboardV2({ applicationId, jobId, currentUser }) {
  const [loading, setLoading] = useState(true);
  const [summary, setSummary] = useState(null);
  const [viewMode, setViewMode] = useState('summary'); // 'summary' ou 'evaluate'

  useEffect(() => {
    const init = async () => {
      try {
        setLoading(true);
        // Garante que o banco estÃ¡ pronto
        await prepareEvaluationV2(jobId);
        // Carrega dados
        const data = await getEvaluationSummaryV2(applicationId);
        setSummary(data);
      } catch (error) {
        console.error("Erro ao carregar V2:", error);
      } finally {
        setLoading(false);
      }
    };
    if (jobId && applicationId) init();
  }, [applicationId, jobId]);

  if (loading) return <div className="p-4 text-center">Carregando AvaliaÃ§Ã£o 360Âº...</div>;

  return (
    <div className="bg-white rounded-lg shadow p-6 mt-6">
      <div className="flex justify-between items-center mb-6">
        <h2 className="text-2xl font-bold text-gray-800">AvaliaÃ§Ã£o 360Âº</h2>
        <button 
          onClick={() => setViewMode(viewMode === 'summary' ? 'evaluate' : 'summary')}
          className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition"
        >
          {viewMode === 'summary' ? 'Minha AvaliaÃ§Ã£o' : 'Voltar ao Resumo'}
        </button>
      </div>

      {viewMode === 'summary' ? (
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          {/* Card da Nota Final */}
          <div className="bg-gray-50 p-6 rounded-xl border border-gray-200 text-center">
            <span className="block text-gray-500 text-sm uppercase tracking-wide">MÃ©dia Geral</span>
            <span className="block text-5xl font-extrabold text-blue-600 mt-2">
              {summary?.final_score || '-'}
            </span>
          </div>
          
          {/* Lista de Avaliadores */}
          <div className="col-span-2">
            <h3 className="font-semibold text-gray-700 mb-3">Avaliadores Participantes</h3>
            <div className="flex gap-2">
              {summary?.evaluators?.map(ev => (
                <span key={ev.id} className="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">
                  {ev.name}
                </span>
              ))}
              {(!summary?.evaluators || summary.evaluators.length === 0) && (
                <span className="text-gray-400 italic">Nenhuma avaliaÃ§Ã£o concluÃ­da ainda.</span>
              )}
            </div>
          </div>
        </div>
      ) : (
        <div className="p-4 bg-yellow-50 border border-yellow-200 rounded text-yellow-800">
          {/* AQUI ENTRARÃ O FORMULÃRIO DE NOTAS NO PRÃ“XIMO PASSO */}
          <p>O formulÃ¡rio de avaliaÃ§Ã£o individual serÃ¡ carregado aqui.</p>
        </div>
      )}
    </div>
  );
}

==================================================
ARQUIVO: src_old\components\evaluation_v2\EvaluationForm.jsx
==================================================
import React, { useState } from 'react';
import { supabase } from '../supabase/client';
import { useAuth } from '../context/AuthContext';

export default function EvaluationForm({ applicationId, jobParameters, initialData, onSaved }) {
  const { user } = useAuth();
  const [scores, setScores] = useState(initialData?.scores || {});
  const [notes, setNotes] = useState(initialData?.notes || '');
  const [isSaving, setIsSaving] = useState(false);

  // CÃ¡lculo de Nota no Frontend (Regra 3: Ignora N/A)
  const calculateScore = () => {
    let total = 0;
    let max = 0;
    const notesMap = new Map((jobParameters.notas || []).map(n => [n.id, Number(n.valor)]));

    ['triagem', 'cultura', 'tecnico'].forEach(section => {
      const criteria = jobParameters[section] || [];
      criteria.forEach(crit => {
        const vote = scores[section]?.[crit.name];
        if (vote && vote !== 'NA') {
          const val = notesMap.get(vote) || 0;
          const weight = Number(crit.weight) || 1;
          total += val * weight;
          max += 100 * weight;
        }
      });
    });

    return max === 0 ? 0 : Number(((total / max) * 100).toFixed(1));
  };

  const handleSave = async () => {
    setIsSaving(true);
    try {
      const finalScore = calculateScore();
      
      const { error } = await supabase.from('evaluations').upsert({
        application_id: applicationId,
        evaluator_id: user.id,
        scores,
        notes,
        final_score: finalScore,
        created_at: new Date() // Atualiza timestamp
      }, { onConflict: 'application_id, evaluator_id' });

      if (error) throw error;
      alert(`Salvo! Sua nota: ${finalScore}`);
      if (onSaved) onSaved();

    } catch (err) {
      alert("Erro ao salvar: " + err.message);
    } finally {
      setIsSaving(false);
    }
  };

  return (
    <div className="bg-white p-6 border rounded-lg space-y-6">
      <h3 className="font-bold text-lg border-b pb-2">Minha AvaliaÃ§Ã£o (V2.0)</h3>
      
      {['triagem', 'cultura', 'tecnico'].map(section => (
        <div key={section} className="p-4 bg-gray-50 rounded">
          <h4 className="font-semibold capitalize mb-3 text-blue-800">{section}</h4>
          <div className="grid gap-4 md:grid-cols-2">
            {jobParameters[section]?.map(crit => (
              <div key={crit.name}>
                <label className="block text-xs font-medium text-gray-500 mb-1">{crit.name}</label>
                <select 
                  className="w-full border rounded p-2 text-sm"
                  value={scores[section]?.[crit.name] || ''}
                  onChange={e => setScores({
                    ...scores, 
                    [section]: { ...scores[section], [crit.name]: e.target.value }
                  })}
                >
                  <option value="">Selecione...</option>
                  <option value="NA">N/A (NÃ£o Avaliar)</option>
                  <optgroup label="Notas">
                    {jobParameters.notas.map(n => (
                      <option key={n.id} value={n.id}>{n.nome}</option>
                    ))}
                  </optgroup>
                </select>
              </div>
            ))}
          </div>
        </div>
      ))}

      <div>
        <label className="block font-medium mb-1">ObservaÃ§Ãµes</label>
        <textarea 
          className="w-full border rounded p-2" 
          rows="4"
          value={notes}
          onChange={e => setNotes(e.target.value)}
          placeholder="ComentÃ¡rios sobre o candidato..."
        />
      </div>

      <div className="flex justify-end">
        <button 
          onClick={handleSave} 
          disabled={isSaving}
          className="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 disabled:opacity-50"
        >
          {isSaving ? 'Salvando...' : 'Salvar AvaliaÃ§Ã£o'}
        </button>
      </div>
    </div>
  );
}

==================================================
ARQUIVO: src_old\components\inputs\StateSelect.jsx
==================================================
import React from 'react';
import { Label } from '../ui/label';
import { estados } from '../../data/brazil-locations'; 

const StateSelect = ({ value, onChange, error, disabled }) => {
  return (
    <div className="mb-4">
      <Label htmlFor="state">Em que estado vocÃª mora?</Label>
      <select
        id="state"
        name="state"
        value={value || ''}
        onChange={onChange}
        disabled={disabled}
        className="flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
      >
        <option value="" disabled>Selecione uma opÃ§Ã£o</option>
        {estados.map((estado) => (
          <option key={estado.sigla} value={estado.sigla}>
            {estado.nome}
          </option>
        ))}
      </select>
      {error && <p className="text-sm text-red-500 mt-1">{error}</p>}
    </div>
  );
};

export default StateSelect;

==================================================
ARQUIVO: src_old\components\jobs\CreateJobModal.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { supabase } from '../../supabase/client';
import { Modal } from '../ui/modal';
import { Button } from '../ui/button';
import { Input } from '../ui/input';
import { Textarea } from '../ui/textarea';
import { Label } from '../ui/label';
import AreaSelect from '../AreaSelect';
import { Loader2, AlertCircle } from 'lucide-react';

const CreateJobModal = ({ open, handleClose, onJobCreated }) => {
  const initialState = {
    title: '', description: '', requirements: '', type: 'CLT',
    location_type: 'HÃ­brido', company_department_id: null
  };
  const [formData, setFormData] = useState(initialState);
  const [tenantId, setTenantId] = useState(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  useEffect(() => {
    if (open) {
      const fetchTenant = async () => {
        const { data: { user } } = await supabase.auth.getUser();
        if(user) {
            const { data } = await supabase.from('user_profiles').select('tenantId').eq('id', user.id).single();
            if(data) setTenantId(data.tenantId);
        }
      };
      fetchTenant();
    }
  }, [open]);

  const handleSubmit = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError('');

    try {
      if (!formData.title) throw new Error("TÃ­tulo Ã© obrigatÃ³rio.");

      // InserÃ§Ã£o direta no Supabase
      const { error: insertError } = await supabase.from('jobs').insert({
        ...formData,
        tenantId: tenantId,
        status: 'active',
        company_department_id: formData.company_department_id || null,
        parameters: { 
            triagem: [], cultura: [], tecnico: [], 
            notas: [{id:'1',nome:'Abaixo',valor:0},{id:'2',nome:'Atende',valor:50},{id:'3',nome:'Supera',valor:100}] 
        }
      });

      if (insertError) throw insertError;

      setFormData(initialState);
      onJobCreated();
      handleClose();
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  const handleChange = (e) => setFormData(prev => ({ ...prev, [e.target.name]: e.target.value }));

  return (
    <Modal isOpen={open} onClose={handleClose} title="Nova Vaga">
      <form onSubmit={handleSubmit} className="space-y-4 max-h-[80vh] overflow-y-auto px-1">
        <div><Label>TÃ­tulo *</Label><Input name="title" value={formData.title} onChange={handleChange} required /></div>
        {tenantId && <AreaSelect currentTenantId={tenantId} selectedAreaId={formData.company_department_id} onSelectArea={(id) => setFormData(p => ({...p, company_department_id: id}))} />}
        <div className="grid grid-cols-2 gap-4">
            <div><Label>Modelo</Label><select name="location_type" className="w-full border rounded h-10 px-2" value={formData.location_type} onChange={handleChange}><option>Presencial</option><option>HÃ­brido</option><option>Remoto</option></select></div>
            <div><Label>Contrato</Label><select name="type" className="w-full border rounded h-10 px-2" value={formData.type} onChange={handleChange}><option>CLT</option><option>PJ</option><option>EstÃ¡gio</option></select></div>
        </div>
        <div><Label>DescriÃ§Ã£o</Label><Textarea name="description" value={formData.description} onChange={handleChange} /></div>
        <div><Label>Requisitos</Label><Textarea name="requirements" value={formData.requirements} onChange={handleChange} /></div>
        {error && <div className="text-red-500 text-sm">{error}</div>}
        <div className="flex justify-end gap-2 pt-2 border-t"><Button variant="outline" onClick={handleClose}>Cancelar</Button><Button type="submit" disabled={loading}>{loading ? <Loader2 className="animate-spin"/> : 'Criar'}</Button></div>
      </form>
    </Modal>
  );
};

export default CreateJobModal;

==================================================
ARQUIVO: src_old\components\ui\badge.jsx
==================================================
import * as React from "react"
import { cva } from "class-variance-authority"
import { cn } from "../../lib/utils"

const badgeVariants = cva(
  "inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
  {
    variants: {
      variant: {
        default: "border-transparent bg-blue-600 text-white hover:bg-blue-700",
        secondary: "border-transparent bg-gray-100 text-gray-900 hover:bg-gray-200",
        destructive: "border-transparent bg-red-500 text-white hover:bg-red-600",
        outline: "text-gray-900 border-gray-200",
        success: "border-transparent bg-green-100 text-green-800 hover:bg-green-200",
        warning: "border-transparent bg-yellow-100 text-yellow-800 hover:bg-yellow-200",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function Badge({ className, variant, ...props }) {
  return (<div className={cn(badgeVariants({ variant }), className)} {...props} />)
}

export { Badge, badgeVariants }

==================================================
ARQUIVO: src_old\components\ui\button.jsx
==================================================
import * as React from "react"
import { cva } from "class-variance-authority"
import { cn } from "../../lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",
  {
    variants: {
      variant: {
        default: "bg-blue-600 text-white hover:bg-blue-700 shadow-sm",
        destructive: "bg-red-500 text-white hover:bg-red-600 shadow-sm",
        outline: "border border-gray-200 bg-white hover:bg-gray-100 hover:text-gray-900",
        secondary: "bg-gray-100 text-gray-900 hover:bg-gray-200",
        ghost: "hover:bg-gray-100 hover:text-gray-900",
        link: "text-blue-600 underline-offset-4 hover:underline",
      },
      size: {
        default: "h-10 px-4 py-2",
        sm: "h-9 rounded-md px-3",
        lg: "h-11 rounded-md px-8",
        icon: "h-10 w-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

const Button = React.forwardRef(({ className, variant, size, ...props }, ref) => {
  return (
    <button
      className={cn(buttonVariants({ variant, size, className }))}
      ref={ref}
      {...props}
    />
  )
})
Button.displayName = "Button"

export { Button, buttonVariants }

==================================================
ARQUIVO: src_old\components\ui\button.test.jsx
==================================================
import { render, screen } from '@testing-library/react';
import { Button } from './button';
import { describe, it, expect } from 'vitest';

describe('Componente Button', () => {
  it('deve renderizar o texto corretamente', () => {
    render(<Button>Clique aqui</Button>);
    expect(screen.getByText('Clique aqui')).toBeInTheDocument();
  });

  it('deve aplicar a classe de variante destructive', () => {
    render(<Button variant="destructive">Excluir</Button>);
    const button = screen.getByText('Excluir');
    // Verifica se a classe do tailwind para background vermelho estÃ¡ presente
    expect(button).toHaveClass('bg-red-500');
  });
});

==================================================
ARQUIVO: src_old\components\ui\card.jsx
==================================================
import * as React from "react"
import { cn } from "../../lib/utils"

const Card = React.forwardRef(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("rounded-lg border bg-white text-gray-950 shadow-sm", className)} {...props} />
))
Card.displayName = "Card"

const CardHeader = React.forwardRef(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("flex flex-col space-y-1.5 p-6", className)} {...props} />
))
CardHeader.displayName = "CardHeader"

const CardTitle = React.forwardRef(({ className, ...props }, ref) => (
  <h3 ref={ref} className={cn("text-2xl font-semibold leading-none tracking-tight", className)} {...props} />
))
CardTitle.displayName = "CardTitle"

const CardContent = React.forwardRef(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />
))
CardContent.displayName = "CardContent"

export { Card, CardHeader, CardTitle, CardContent }

==================================================
ARQUIVO: src_old\components\ui\input.jsx
==================================================
import * as React from "react"
import { cn } from "../../lib/utils"

const Input = React.forwardRef(({ className, type, ...props }, ref) => {
  return (
    <input
      type={type}
      className={cn(
        "flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      ref={ref}
      {...props}
    />
  )
})
Input.displayName = "Input"

export { Input }

==================================================
ARQUIVO: src_old\components\ui\label.jsx
==================================================
import * as React from "react"
import { cn } from "../../lib/utils"

const Label = React.forwardRef(({ className, ...props }, ref) => (
  <label
    ref={ref}
    className={cn(
      "text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-gray-700 mb-2 block",
      className
    )}
    {...props}
  />
))
Label.displayName = "Label"

export { Label }

==================================================
ARQUIVO: src_old\components\ui\modal.jsx
==================================================
import React, { useEffect } from 'react';
import { X } from 'lucide-react';
import { createPortal } from 'react-dom';

export function Modal({ isOpen, onClose, title, children }) {
  // Fecha ao pressionar ESC
  useEffect(() => {
    const handleEsc = (e) => {
      if (e.key === 'Escape') onClose();
    };
    if (isOpen) window.addEventListener('keydown', handleEsc);
    return () => window.removeEventListener('keydown', handleEsc);
  }, [isOpen, onClose]);

  if (!isOpen) return null;

  return createPortal(
    <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200">
      <div className="relative w-full max-w-md bg-white rounded-lg shadow-xl animate-in zoom-in-95 duration-200" onClick={(e) => e.stopPropagation()}>
        {/* Header */}
        <div className="flex items-center justify-between px-6 py-4 border-b">
          <h3 className="text-lg font-semibold text-gray-900">{title}</h3>
          <button
            onClick={onClose}
            className="text-gray-400 hover:text-gray-500 transition-colors focus:outline-none"
          >
            <X className="w-5 h-5" />
          </button>
        </div>
        
        {/* Content */}
        <div className="p-6">
          {children}
        </div>
      </div>
    </div>,
    document.body
  );
}

==================================================
ARQUIVO: src_old\components\ui\textarea.jsx
==================================================
import * as React from "react"
import { cn } from "../../lib/utils"

const Textarea = React.forwardRef(({ className, ...props }, ref) => {
  return (
    <textarea
      className={cn(
        "flex min-h-[80px] w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      ref={ref}
      {...props}
    />
  )
})
Textarea.displayName = "Textarea"

export { Textarea }

==================================================
ARQUIVO: src_old\context\AuthContext.jsx
==================================================
import { createContext, useContext, useEffect, useState } from 'react';
import { supabase } from '../supabase/client';

const AuthContext = createContext({});

export const useAuth = () => useContext(AuthContext);

export const AuthProvider = ({ children }) => {
  const [user, setUser] = useState(null); // Padronizado como 'user'
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const checkSession = async () => {
      const { data: { session } } = await supabase.auth.getSession();
      setUser(session?.user ?? null);
      setLoading(false);
    };
    checkSession();

    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {
      setUser(session?.user ?? null);
      setLoading(false);
    });

    return () => subscription.unsubscribe();
  }, []);

  return (
    <AuthContext.Provider value={{ user, loading, signUp: supabase.auth.signUp }}>
      {!loading && children}
    </AuthContext.Provider>
  );
};

==================================================
ARQUIVO: src_old\context\gerar_contexto.py
==================================================
import os

# ConfiguraÃ§Ãµes - Adicione ou remova extensÃµes/pastas conforme necessÃ¡rio
EXTENSOES_PERMITIDAS = {
    '.js', '.jsx', '.ts', '.tsx',  # Web / React / Node
    '.html', '.css', '.scss',      # Front-end
    '.py', '.java', '.cs', '.php', # Back-end
    '.sql', '.prisma',             # Banco de Dados
    '.json', '.xml', '.yml',       # ConfiguraÃ§Ãµes
    '.dart', '.swift', '.kt'       # Mobile
}

PASTAS_IGNORADAS = {
    'node_modules', '.git', '.idea', '.vscode', 
    'dist', 'build', 'coverage', 'venv', '__pycache__',
    'bin', 'obj', 'android', 'ios' # Ignorando pastas nativas pesadas se for React Native/Flutter (pode remover se precisar de configs nativas)
}

ARQUIVOS_IGNORADOS = {
    'package-lock.json', 'yarn.lock', 'gerar_contexto.py'
}

def deve_processar(caminho_arquivo):
    _, ext = os.path.splitext(caminho_arquivo)
    nome_arquivo = os.path.basename(caminho_arquivo)
    
    if nome_arquivo in ARQUIVOS_IGNORADOS:
        return False
    return ext in EXTENSOES_PERMITIDAS

def gerar_txt_projeto():
    saida = "projeto_completo.txt"
    
    with open(saida, 'w', encoding='utf-8') as f_out:
        # Adiciona a estrutura de pastas primeiro (TREE)
        f_out.write("--- ESTRUTURA DE DIRETÃ“RIOS ---\n")
        for root, dirs, files in os.walk('.'):
            # Filtra pastas ignoradas para nÃ£o descer nelas
            dirs[:] = [d for d in dirs if d not in PASTAS_IGNORADAS]
            level = root.replace('.', '', 1).count(os.sep)
            indent = ' ' * 4 * (level)
            f_out.write(f"{indent}{os.path.basename(root)}/\n")
            subindent = ' ' * 4 * (level + 1)
            for f in files:
                f_out.write(f"{subindent}{f}\n")
        
        f_out.write("\n\n--- CONTEÃšDO DOS ARQUIVOS ---\n\n")

        # Adiciona o conteÃºdo dos arquivos
        for root, dirs, files in os.walk('.'):
            dirs[:] = [d for d in dirs if d not in PASTAS_IGNORADAS]
            
            for file in files:
                caminho_completo = os.path.join(root, file)
                
                if deve_processar(caminho_completo):
                    f_out.write(f"\n{'='*50}\n")
                    f_out.write(f"CAMINHO: {caminho_completo}\n")
                    f_out.write(f"{'='*50}\n")
                    
                    try:
                        with open(caminho_completo, 'r', encoding='utf-8') as f_in:
                            f_out.write(f_in.read())
                    except Exception as e:
                        f_out.write(f"[Erro ao ler arquivo: {e}]\n")

    print(f"Sucesso! Arquivo '{saida}' gerado. Basta enviÃ¡-lo para a IA.")

if __name__ == "__main__":
    gerar_txt_projeto()

==================================================
ARQUIVO: src_old\data\brazil-locations.js
==================================================
// src/data/brazil-locations.js
export const estados = [
  { sigla: 'AC', nome: 'Acre' },
  { sigla: 'AL', nome: 'Alagoas' },
  { sigla: 'AP', nome: 'AmapÃ¡' },
  { sigla: 'AM', nome: 'Amazonas' },
  { sigla: 'BA', nome: 'Bahia' },
  { sigla: 'CE', nome: 'CearÃ¡' },
  { sigla: 'DF', nome: 'Distrito Federal' },
  { sigla: 'ES', nome: 'EspÃ­rito Santo' },
  { sigla: 'GO', nome: 'GoiÃ¡s' },
  { sigla: 'MA', nome: 'MaranhÃ£o' },
  { sigla: 'MT', nome: 'Mato Grosso' },
  { sigla: 'MS', nome: 'Mato Grosso do Sul' },
  { sigla: 'MG', nome: 'Minas Gerais' },
  { sigla: 'PA', nome: 'ParÃ¡' },
  { sigla: 'PB', nome: 'ParaÃ­ba' },
  { sigla: 'PR', nome: 'ParanÃ¡' },
  { sigla: 'PE', nome: 'Pernambuco' },
  { sigla: 'PI', nome: 'PiauÃ­' },
  { sigla: 'RJ', nome: 'Rio de Janeiro' },
  { sigla: 'RN', nome: 'Rio Grande do Norte' },
  { sigla: 'RS', nome: 'Rio Grande do Sul' },
  { sigla: 'RO', nome: 'RondÃ´nia' },
  { sigla: 'RR', nome: 'Roraima' },
  { sigla: 'SC', nome: 'Santa Catarina' },
  { sigla: 'SP', nome: 'SÃ£o Paulo' },
  { sigla: 'SE', nome: 'Sergipe' },
  { sigla: 'TO', nome: 'Tocantins' }
];

// No futuro, podemos substituir o campo de cidade por uma busca via API de CEP
// Por enquanto, usaremos um campo de texto simples para a cidade.

==================================================
ARQUIVO: src_old\lib\utils.js
==================================================
import { clsx } from "clsx"
import { twMerge } from "tailwind-merge"
 
export function cn(...inputs) {
  return twMerge(clsx(inputs))
}

==================================================
ARQUIVO: src_old\pages\AdminPage.jsx
==================================================
import React from 'react';
import { Link } from 'react-router-dom';
import { Button } from '../components/ui/button';
import { Card, CardHeader, CardTitle, CardContent } from '../components/ui/card';
import { ArrowLeft, ShieldCheck } from 'lucide-react';

const AdminPage = () => {
    return (
        <div className="min-h-screen bg-gray-50 p-8">
            <div className="max-w-4xl mx-auto">
                <div className="flex justify-between items-center mb-8">
                    <h1 className="text-3xl font-bold text-gray-900">Painel Administrativo</h1>
                    <Button variant="outline" asChild>
                        <Link to="/"><ArrowLeft className="mr-2 h-4 w-4"/> Voltar ao Dashboard</Link>
                    </Button>
                </div>

                <div className="grid gap-6 md:grid-cols-2">
                    <Card>
                        <CardHeader>
                            <CardTitle className="flex items-center gap-2">
                                <ShieldCheck className="h-5 w-5 text-blue-600"/>
                                GestÃ£o de Tenants
                            </CardTitle>
                        </CardHeader>
                        <CardContent>
                            <p className="text-gray-500 mb-4">Gerencie as empresas e planos do sistema.</p>
                            <div className="p-4 bg-yellow-50 text-yellow-800 rounded-md text-sm border border-yellow-200">
                                MÃ³dulo em migraÃ§Ã£o para V2.0
                            </div>
                        </CardContent>
                    </Card>
                </div>
            </div>
        </div>
    );
};

export default AdminPage;

==================================================
ARQUIVO: src_old\pages\AdminTenantPage.jsx
==================================================
import React from 'react';
import { Link } from 'react-router-dom';
import { Button } from '../components/ui/button';
import { Card, CardHeader, CardTitle, CardContent } from '../components/ui/card';
import { ArrowLeft, Construction } from 'lucide-react';

const AdminTenantPage = () => {
    return (
        <div className="flex h-screen items-center justify-center bg-gray-50 p-4">
            <Card className="max-w-md w-full text-center">
                <CardHeader>
                    <div className="mx-auto bg-blue-100 p-3 rounded-full w-fit mb-4">
                        <Construction className="h-8 w-8 text-blue-600" />
                    </div>
                    <CardTitle className="text-xl">GestÃ£o de UsuÃ¡rios</CardTitle>
                </CardHeader>
                <CardContent>
                    <p className="text-gray-500 mb-6">
                        Este mÃ³dulo estÃ¡ sendo atualizado para a nova versÃ£o 2.0. 
                        A gestÃ£o de usuÃ¡rios retornarÃ¡ em breve.
                    </p>
                    <Button asChild className="w-full">
                        <Link to="/admin">
                            <ArrowLeft className="mr-2 h-4 w-4" /> Voltar para Admin
                        </Link>
                    </Button>
                </CardContent>
            </Card>
        </div>
    );
};

export default AdminTenantPage;

==================================================
ARQUIVO: src_old\pages\ApplicationDetails.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { useParams, Link as RouterLink } from 'react-router-dom';
import { supabase } from '../supabase/client';
import { formatUrl, formatPhone } from '../utils/formatters';
import { 
    Container, Typography, Box, AppBar, Toolbar, Button, CircularProgress, 
    Alert, Paper, Grid, Divider, Tabs, Tab
} from '@mui/material';
import EvaluationForm from '../components/evaluation_v2/EvaluationForm'; // Importa o novo form

const ApplicationDetails = () => {
  const { jobId, applicationId } = useParams();
  const [application, setApplication] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [resumeUrl, setResumeUrl] = useState('');
  const [tabValue, setTabValue] = useState(0); 
  const [myEvaluation, setMyEvaluation] = useState(null);

  useEffect(() => {
    const fetchDetails = async () => {
      setLoading(true);
      try {
        const { data: { session } } = await supabase.auth.getSession();
        if (!session) throw new Error("SessÃ£o nÃ£o encontrada.");

        // 1. Busca Detalhes da AplicaÃ§Ã£o
        // Note: Usando a API getApplicationDetails que jÃ¡ existia ou fazendo direto. 
        // Vamos fazer fetch direto para garantir que pegamos os parÃ¢metros da vaga atualizados.
        const { data: appData, error: appError } = await supabase
            .from('applications')
            .select(`
                *,
                candidate:candidates(*),
                job:jobs(parameters, title)
            `)
            .eq('id', applicationId)
            .single();
        
        if (appError) throw appError;
        setApplication(appData);

        // 2. Busca Minha AvaliaÃ§Ã£o Existente (Se houver)
        const { data: evalData } = await supabase
            .from('evaluations')
            .select('*')
            .eq('application_id', applicationId)
            .eq('evaluator_id', session.user.id)
            .maybeSingle();
            
        if (evalData) setMyEvaluation(evalData);

        // 3. URL do CurrÃ­culo
        if (appData.resumeUrl) {
            const urlResponse = await fetch(`/api/getResumeSignedUrl?filePath=${appData.resumeUrl}`, { 
                headers: { 'Authorization': `Bearer ${session.access_token}` } 
            });
            const urlData = await urlResponse.json();
            if (urlData.signedUrl) setResumeUrl(urlData.signedUrl);
        }

      } catch (err) {
        console.error(err);
        setError(err.message || "Erro ao carregar.");
      } finally {
        setLoading(false);
      }
    };
    fetchDetails();
  }, [applicationId]);

  const handleTabChange = (event, newValue) => setTabValue(newValue);

  const renderContent = () => {
    if (loading) return <Box sx={{ display: 'flex', justifyContent: 'center', my: 5 }}><CircularProgress /></Box>;
    if (error) return <Alert severity="error">{error}</Alert>;
    if (!application) return null;

    const { candidate, job, formData } = application;

    return (
        <Grid container spacing={3}>
          {/* Coluna Esquerda: Info do Candidato */}
          <Grid item xs={12} md={4}>
            <Paper sx={{ p: 3, height: '100%' }}>
              <Typography variant="h5" gutterBottom>{candidate.name}</Typography>
              <Typography variant="body2" color="textSecondary" gutterBottom>{candidate.email}</Typography>
              <Typography variant="body2" color="textSecondary" gutterBottom>{formatPhone(formData?.phone)}</Typography>
              
              <Divider sx={{ my: 2 }} />
              
              <Typography variant="subtitle2">Cidade</Typography>
              <Typography variant="body2" gutterBottom>{formData?.city || candidate.city} - {formData?.state || candidate.state}</Typography>

              {formData?.linkedinProfile && (
                  <Button sx={{mt: 1, justifyContent: 'flex-start'}} fullWidth href={formatUrl(formData.linkedinProfile)} target="_blank">LinkedIn</Button>
              )}
              
              <Box mt={3}>
                <Button variant="contained" fullWidth href={resumeUrl} target="_blank" disabled={!resumeUrl}>
                    Ver CurrÃ­culo (PDF)
                </Button>
              </Box>
            </Paper>
          </Grid>

          {/* Coluna Direita: Abas de Dados e AvaliaÃ§Ã£o */}
          <Grid item xs={12} md={8}>
            <Paper sx={{ width: '100%', minHeight: '500px' }}>
                <Tabs value={tabValue} onChange={handleTabChange} sx={{ borderBottom: 1, borderColor: 'divider', bgcolor: '#f9fafb' }}>
                    <Tab label="Dados do FormulÃ¡rio" />
                    <Tab label="Minha AvaliaÃ§Ã£o (V2.0)" />
                </Tabs>

                {/* Aba 0: Dados do FormulÃ¡rio */}
                <Box p={3} hidden={tabValue !== 0}>
                    <Grid container spacing={2}>
                        {Object.entries(formData || {}).map(([key, value]) => {
                            if(key === 'linkedinProfile' || key === 'githubProfile') return null;
                            return (
                                <Grid item xs={12} sm={6} key={key}>
                                    <Typography variant="caption" display="block" color="textSecondary" sx={{textTransform:'capitalize', fontWeight: 'bold'}}>
                                        {key.replace(/([A-Z])/g, ' $1').trim()}
                                    </Typography>
                                    <Typography variant="body1" sx={{mb: 1}}>{String(value)}</Typography>
                                </Grid>
                            )
                        })}
                    </Grid>
                </Box>

                {/* Aba 1: FormulÃ¡rio de AvaliaÃ§Ã£o */}
                <Box p={3} hidden={tabValue !== 1}>
                    <EvaluationForm 
                        applicationId={application.id}
                        jobParameters={job.parameters || {}}
                        initialData={myEvaluation}
                        onSaved={() => alert('AvaliaÃ§Ã£o salva com sucesso!')} 
                    />
                </Box>
            </Paper>
          </Grid>
        </Grid>
    );
  };
  
  return (
    <Box>
      <AppBar position="static" color="default" elevation={1}>
        <Toolbar>
          <Typography variant="h6" sx={{ flexGrow: 1 }}>
            AvaliaÃ§Ã£o de Candidato
          </Typography>
          <Button color="inherit" component={RouterLink} to={`/jobs/${jobId}`}>Voltar para Vaga</Button>
        </Toolbar>
      </AppBar>
      <Container sx={{ mt: 4, mb: 4 }}>
        {renderContent()}
      </Container>
    </Box>
  );
};

export default ApplicationDetails;

==================================================
ARQUIVO: src_old\pages\ApplyPage.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { useParams } from 'react-router-dom';
import { Button } from '../components/ui/button';
import { Input } from '../components/ui/input';
import { Textarea } from '../components/ui/textarea';
import { Label } from '../components/ui/label';
import StateSelect from '../components/inputs/StateSelect';
import { Loader2, UploadCloud, CheckCircle, AlertCircle } from 'lucide-react';

const ApplyPage = () => {
  // CORREÃ‡ÃƒO AQUI: O Router passa 'id', nÃ£o 'jobId'
  const { id } = useParams(); 
  // Para facilitar, vamos renomear internamente para jobId
  const jobId = id;

  // Estados de controle
  const [jobTitle, setJobTitle] = useState('');
  const [isVagaClosed, setIsVagaClosed] = useState(false);
  const [loadingPage, setLoadingPage] = useState(true);
  const [errorPage, setErrorPage] = useState('');

  // FormulÃ¡rio
  const [formState, setFormState] = useState({
    name: '', preferredName: '', email: '', phone: '', birthDate: '',
    state: '', city: '', hasGraduated: '', studyPeriod: '', course: '',
    institution: '', completionYear: '', englishLevel: '', spanishLevel: '',
    source: '', motivation: '', linkedinProfile: '', githubProfile: ''
  });
  
  const [resumeFile, setResumeFile] = useState(null);
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [feedback, setFeedback] = useState({ type: '', message: '' });

  useEffect(() => {
    const fetchJobData = async () => {
      if (!jobId) {
        setErrorPage('ID da vaga nÃ£o especificado.');
        setLoadingPage(false);
        return;
      }
      try {
        const response = await fetch(`/api/getPublicJobData?id=${jobId}`);
        if (!response.ok) throw new Error('Vaga nÃ£o encontrada.');
        const data = await response.json();
        
        if (data.job) {
          if (data.job.planId === 'freemium' && data.job.candidateCount >= 3) {
            setIsVagaClosed(true);
          }
          setJobTitle(data.job.title);
        } else {
            throw new Error('Dados da vaga nÃ£o encontrados.');
        }
      } catch (error) {
        setErrorPage(error.message);
      } finally {
        setLoadingPage(false);
      }
    };
    fetchJobData();
  }, [jobId]);

  const handleInputChange = (e) => {
    const { name, value } = e.target;
    setFormState(prev => ({ ...prev, [name]: value }));
  };

  const handleFileChange = (e) => {
    if (e.target.files && e.target.files.length > 0) {
      setResumeFile(e.target.files[0]);
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setIsSubmitting(true);
    setFeedback({ type: '', message: '' });

    if (!resumeFile) {
      setFeedback({ type: 'error', message: 'Por favor, anexe seu currÃ­culo.' });
      setIsSubmitting(false);
      return;
    }

    const formData = new FormData();
    formData.append('jobId', jobId);
    
    Object.keys(formState).forEach(key => {
        if (formState[key]) formData.append(key, formState[key]);
    });
    
    formData.append('resume', resumeFile);

    try {
      const response = await fetch('/api/apply', { method: 'POST', body: formData });
      if (!response.ok) {
        const errorData = await response.json();
        throw new Error(errorData.error || 'Erro ao enviar candidatura.');
      }
      setFeedback({ type: 'success', message: 'Candidatura enviada com sucesso!' });
    } catch (error) {
      setFeedback({ type: 'error', message: error.message });
    } finally {
      setIsSubmitting(false);
    }
  };

  if (loadingPage) return <div className="flex justify-center my-20"><Loader2 className="w-8 h-8 animate-spin text-blue-600"/></div>;
  
  if (errorPage) return <div className="max-w-md mx-auto mt-10 p-4 bg-red-50 text-red-700 rounded border border-red-200">{errorPage}</div>;
  
  if (feedback.type === 'success') {
    return (
        <div className="max-w-md mx-auto mt-20 text-center p-8 bg-green-50 rounded-lg border border-green-100">
            <CheckCircle className="w-16 h-16 text-green-500 mx-auto mb-4" />
            <h1 className="text-2xl font-bold text-green-800 mb-2">Sucesso!</h1>
            <p className="text-green-700">{feedback.message}</p>
        </div>
    );
  }
  
  if (isVagaClosed) {
    return (
        <div className="max-w-md mx-auto mt-20 text-center p-8 bg-yellow-50 rounded-lg border border-yellow-100">
            <AlertCircle className="w-16 h-16 text-yellow-500 mx-auto mb-4" />
            <h1 className="text-2xl font-bold text-yellow-800 mb-2">Vaga Encerrada</h1>
            <p className="text-yellow-700">Esta vaga jÃ¡ atingiu o limite de candidaturas.</p>
        </div>
    );
  }

  return (
    <div className="max-w-3xl mx-auto px-4 py-10">
      <div className="mb-8">
        <h1 className="text-3xl font-bold text-gray-900">Candidatura Ã  Vaga</h1>
        <p className="text-lg text-blue-600 font-medium mt-1">{jobTitle}</p>
      </div>
      
      <form onSubmit={handleSubmit} className="space-y-6 bg-white p-6 md:p-8 rounded-xl shadow-sm border border-gray-100">
        
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <Label htmlFor="name">Nome Completo</Label>
                <Input name="name" id="name" required onChange={handleInputChange} />
            </div>
            <div>
                <Label htmlFor="preferredName">Nome Social / Como prefere ser chamado</Label>
                <Input name="preferredName" id="preferredName" onChange={handleInputChange} />
            </div>
            
            <div>
                <Label htmlFor="email">E-mail</Label>
                <Input name="email" id="email" type="email" required onChange={handleInputChange} />
            </div>
            <div>
                <Label htmlFor="phone">Telefone (Celular)</Label>
                <Input name="phone" id="phone" type="tel" required onChange={handleInputChange} />
            </div>
            
            <div>
                <Label htmlFor="birthDate">Data de Nascimento</Label>
                <Input name="birthDate" id="birthDate" type="date" required value={formState.birthDate} onChange={handleInputChange} />
            </div>
        </div>

        <StateSelect value={formState.state} onChange={handleInputChange} />
        
        <div>
            <Label htmlFor="city">Cidade</Label>
            <Input name="city" id="city" required onChange={handleInputChange} />
        </div>

        <div className="p-4 bg-gray-50 rounded-lg border border-gray-200">
            <Label className="mb-3">VocÃª jÃ¡ concluiu curso superior?</Label>
            <div className="flex gap-6">
                <label className="flex items-center gap-2 cursor-pointer">
                    <input type="radio" name="hasGraduated" value="sim" onChange={handleInputChange} className="w-4 h-4 text-blue-600" />
                    <span className="text-sm text-gray-700">Sim, jÃ¡ concluÃ­</span>
                </label>
                <label className="flex items-center gap-2 cursor-pointer">
                    <input type="radio" name="hasGraduated" value="nao" onChange={handleInputChange} className="w-4 h-4 text-blue-600" />
                    <span className="text-sm text-gray-700">NÃ£o, estou cursando</span>
                </label>
            </div>
        </div>

        {formState.hasGraduated === 'nao' && (
             <div><Label>PerÃ­odo/Ano</Label><Input name="studyPeriod" onChange={handleInputChange} /></div>
        )}
        
        {formState.hasGraduated && (
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div><Label>Curso</Label><Input name="course" required onChange={handleInputChange} /></div>
                <div><Label>InstituiÃ§Ã£o</Label><Input name="institution" required onChange={handleInputChange} /></div>
                {formState.hasGraduated === 'sim' && ( 
                     <div><Label>Ano de ConclusÃ£o</Label><Input name="completionYear" type="number" onChange={handleInputChange} /></div>
                )}
            </div>
        )}

        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            {['englishLevel', 'spanishLevel'].map(lang => (
                <div key={lang}>
                    <Label>{lang === 'englishLevel' ? 'InglÃªs' : 'Espanhol'}</Label>
                    <select name={lang} onChange={handleInputChange} className="flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm">
                        <option value="">Selecione...</option>
                        <option value="basico">BÃ¡sico</option>
                        <option value="intermediario">IntermediÃ¡rio</option>
                        <option value="avancado">AvanÃ§ado</option>
                        <option value="fluente">Fluente/Nativo</option>
                    </select>
                </div>
            ))}
        </div>

        <div>
            <Label htmlFor="motivation">Por que vocÃª deseja esta vaga?</Label>
            <Textarea name="motivation" id="motivation" required rows={4} onChange={handleInputChange} />
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div><Label>LinkedIn (Opcional)</Label><Input name="linkedinProfile" onChange={handleInputChange} /></div>
            <div><Label>GitHub (Opcional)</Label><Input name="githubProfile" onChange={handleInputChange} /></div>
        </div>

        <div className="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:bg-gray-50 transition-colors">
            <Label htmlFor="resume" className="cursor-pointer">
                <div className="flex flex-col items-center gap-2">
                    <UploadCloud className="w-8 h-8 text-gray-400" />
                    <span className="text-sm font-medium text-blue-600">Clique para enviar seu currÃ­culo (PDF/DOC)</span>
                    {resumeFile && <span className="text-xs text-green-600 font-bold">Arquivo selecionado: {resumeFile.name}</span>}
                </div>
                <input id="resume" type="file" hidden required accept=".pdf,.doc,.docx" onChange={handleFileChange} />
            </Label>
        </div>

        {feedback.type === 'error' && <div className="text-red-600 text-sm bg-red-50 p-3 rounded">{feedback.message}</div>}

        <Button type="submit" className="w-full" size="lg" disabled={isSubmitting}>
            {isSubmitting ? <><Loader2 className="w-4 h-4 mr-2 animate-spin"/> Enviando...</> : 'Enviar Candidatura'}
        </Button>
      </form>
    </div>
  );
};

export default ApplyPage;

==================================================
ARQUIVO: src_old\pages\Candidates.jsx
==================================================
export default function Candidates() {
  return (
    <div className="p-8">
      <h1 className="text-2xl font-bold mb-4">Banco de Talentos</h1>
      <p>PÃ¡gina em construÃ§Ã£o. Aqui aparecerÃ£o todos os candidatos.</p>
    </div>
  );
}

==================================================
ARQUIVO: src_old\pages\CompanySettings.jsx
==================================================
export default function CompanySettings() {
  return (
    <div className="p-8">
      <h1 className="text-2xl font-bold mb-4">ConfiguraÃ§Ãµes da Empresa</h1>
      <p>PÃ¡gina em construÃ§Ã£o.</p>
    </div>
  );
}

==================================================
ARQUIVO: src_old\pages\Dashboard.jsx
==================================================
import React, { useState, useEffect, useMemo } from 'react';
import { useNavigate } from 'react-router-dom';
import { supabase } from '../supabase/client';
import { useAuth } from '../context/AuthContext';
import { Plus, Briefcase, Users, Building } from 'lucide-react';
import { Button } from '../components/ui/button'; // Se nÃ£o tiver, use HTML button normal temporariamente
import CreateJobModal from '../components/jobs/CreateJobModal';

export default function Dashboard() {
  const { user } = useAuth();
  const navigate = useNavigate();
  const [jobs, setJobs] = useState([]);
  const [departments, setDepartments] = useState({});
  const [loading, setLoading] = useState(true);
  const [isModalOpen, setIsModalOpen] = useState(false);
  
  // Filtros
  const [deptFilter, setDeptFilter] = useState('all');

  const fetchData = async () => {
    try {
      setLoading(true);
      if (!user) return;

      // 1. Busca Tenant ID
      const { data: profile } = await supabase
        .from('user_profiles')
        .select('tenantId')
        .eq('id', user.id)
        .single();

      if (!profile) return;

      // 2. Busca Departamentos (Para mapear ID -> Nome)
      const { data: depts } = await supabase
        .from('company_departments')
        .select('id, name')
        .eq('tenantId', profile.tenantId);
      
      const deptMap = {};
      depts?.forEach(d => deptMap[d.id] = d.name);
      setDepartments(deptMap);

      // 3. Busca Vagas
      const { data: jobsData } = await supabase
        .from('jobs')
        .select('*, applications(count)')
        .eq('tenantId', profile.tenantId);

      // Processa e Ordena (Regra 5)
      const processed = (jobsData || []).map(j => ({
        ...j,
        deptName: deptMap[j.company_department_id] || 'Geral',
        candidateCount: j.applications?.[0]?.count || 0
      })).sort((a, b) => {
        // Ordem: Depto (A-Z) -> Data (Desc)
        const deptCompare = a.deptName.localeCompare(b.deptName);
        if (deptCompare !== 0) return deptCompare;
        return new Date(b.created_at) - new Date(a.created_at);
      });

      setJobs(processed);

    } catch (error) {
      console.error("Erro Dashboard:", error);
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => { fetchData(); }, [user]);

  const filteredJobs = useMemo(() => {
    return deptFilter === 'all' 
      ? jobs 
      : jobs.filter(j => j.deptName === deptFilter);
  }, [jobs, deptFilter]);

  const uniqueDepts = [...new Set(Object.values(departments))].sort();

  if (loading) return <div className="p-10 text-center">Carregando...</div>;

  return (
    <div className="p-8 max-w-7xl mx-auto">
      <div className="flex justify-between items-center mb-8">
        <h1 className="text-3xl font-bold text-gray-900">Painel de Vagas</h1>
        <button 
          onClick={() => setIsModalOpen(true)}
          className="bg-blue-600 text-white px-4 py-2 rounded-md flex items-center hover:bg-blue-700"
        >
          <Plus className="w-4 h-4 mr-2"/> Nova Vaga
        </button>
      </div>

      {/* Filtros e KPIs */}
      <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
        <div className="bg-white p-4 rounded shadow border">
          <p className="text-sm text-gray-500">Vagas Ativas</p>
          <p className="text-2xl font-bold">{jobs.filter(j => j.status === 'active').length}</p>
        </div>
        <div className="bg-white p-4 rounded shadow border">
          <p className="text-sm text-gray-500">Total Candidatos</p>
          <p className="text-2xl font-bold">{jobs.reduce((acc, j) => acc + j.candidateCount, 0)}</p>
        </div>
      </div>

      <div className="bg-white rounded-lg shadow border overflow-hidden">
        <div className="p-4 border-b bg-gray-50 flex justify-between items-center">
          <h2 className="font-semibold text-gray-700">Listagem</h2>
          <select 
            className="border rounded p-1 text-sm"
            value={deptFilter}
            onChange={(e) => setDeptFilter(e.target.value)}
          >
            <option value="all">Todos Departamentos</option>
            {uniqueDepts.map(d => <option key={d} value={d}>{d}</option>)}
          </select>
        </div>
        
        <table className="w-full text-left text-sm">
          <thead className="bg-gray-50 text-gray-500 border-b">
            <tr>
              <th className="p-4">Empresa / Ãrea</th>
              <th className="p-4">Vaga</th>
              <th className="p-4">Status</th>
              <th className="p-4 text-center">Candidatos</th>
            </tr>
          </thead>
          <tbody>
            {filteredJobs.map(job => (
              <tr 
                key={job.id} 
                className="border-b hover:bg-gray-50 cursor-pointer transition"
                onClick={() => navigate(`/jobs/${job.id}`)}
              >
                <td className="p-4 text-gray-600 font-medium">
                  {/* Assumindo nome fixo da empresa por enquanto para simplificar */}
                  Novva <span className="text-gray-300 mx-1">/</span> {job.deptName}
                </td>
                <td className="p-4 font-semibold text-blue-600">{job.title}</td>
                <td className="p-4">
                  <span className={`px-2 py-1 rounded-full text-xs ${job.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-gray-100'}`}>
                    {job.status === 'active' ? 'Ativa' : 'Fechada'}
                  </span>
                </td>
                <td className="p-4 text-center">
                  <span className="bg-gray-100 px-2 py-1 rounded text-xs">{job.candidateCount}</span>
                </td>
              </tr>
            ))}
            {filteredJobs.length === 0 && (
              <tr><td colSpan="4" className="p-8 text-center text-gray-500">Nenhuma vaga encontrada.</td></tr>
            )}
          </tbody>
        </table>
      </div>

      <CreateJobModal 
        open={isModalOpen} 
        handleClose={() => setIsModalOpen(false)} 
        onJobCreated={fetchData} 
      />
    </div>
  );
}

==================================================
ARQUIVO: src_old\pages\Evaluation.jsx
==================================================
import { useParams } from 'react-router-dom';

export default function Evaluation() {
  const { applicationId } = useParams();
  return (
    <div className="p-8">
      <h1 className="text-2xl font-bold mb-4">AvaliaÃ§Ã£o do Candidato</h1>
      <p>Avaliando candidatura ID: {applicationId}</p>
    </div>
  );
}

==================================================
ARQUIVO: src_old\pages\HiredPage.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { Link as RouterLink } from 'react-router-dom';
import { supabase } from '../supabase/client';
import { format, parseISO } from 'date-fns';
import { Button } from '../components/ui/button';
import { Card } from '../components/ui/card';
import { Loader2, ArrowLeft } from 'lucide-react';

const HiredPage = () => {
    const [hiredData, setHiredData] = useState({});
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState('');

    useEffect(() => {
        const fetchHired = async () => {
            setLoading(true);
            try {
                const { data: { session } } = await supabase.auth.getSession();
                if (!session) return; // AuthContext lida com redirect
       
                const response = await fetch('/api/getHiredApplicants', {
                    headers: { 'Authorization': `Bearer ${session.access_token}` },
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || "Erro ao buscar aprovados.");
                }
                const data = await response.json();
                
                // Agrupa por Vaga
                const groupedByJob = (data.hired || []).reduce((acc, application) => {
                    const jobTitle = application.job.title;
                    if (!acc[jobTitle]) acc[jobTitle] = [];
                    acc[jobTitle].push(application);
                    return acc;
                }, {});
                
                setHiredData(groupedByJob);
            } catch (err) {
                console.error("Erro:", err);
                setError(err.message);
            } finally {
                setLoading(false);
            }
        };
        fetchHired();
    }, []);

    const formatPhone = (phone) => {
        if (!phone) return 'NÃ£o informado';
        const cleaned = phone.replace(/\D/g, '');
        if (cleaned.length === 11) return `(${cleaned.substring(0, 2)}) ${cleaned.substring(2, 7)}-${cleaned.substring(7)}`;
        if (cleaned.length === 10) return `(${cleaned.substring(0, 2)}) ${cleaned.substring(2, 6)}-${cleaned.substring(6)}`;
        return phone;
    };

    if (loading) return <div className="flex justify-center p-10"><Loader2 className="h-8 w-8 animate-spin text-blue-600"/></div>;

    return (
        <div className="max-w-5xl mx-auto px-4 py-8">
            <div className="flex items-center justify-between mb-6">
                <h1 className="text-2xl font-bold text-gray-900">Candidatos Aprovados</h1>
                <Button variant="outline" asChild>
                    <RouterLink to="/"><ArrowLeft className="mr-2 h-4 w-4"/> Voltar ao Painel</RouterLink>
                </Button>
            </div>

            {error && <div className="p-4 bg-red-50 text-red-700 rounded border border-red-200">{error}</div>}

            {Object.keys(hiredData).length === 0 && !error && (
                <div className="text-center py-10 text-gray-500 bg-white rounded border border-dashed">
                    Nenhum candidato aprovado ainda.
                </div>
            )}

            <div className="space-y-6">
                {Object.entries(hiredData).map(([jobTitle, applications]) => (
                    <Card key={jobTitle} className="p-6">
                        <h2 className="text-lg font-semibold border-b pb-2 mb-4 text-gray-800">{jobTitle}</h2>
                        <ul className="space-y-4">
                            {applications.map((app) => (
                                <li key={app.id} className="flex flex-col sm:flex-row sm:items-center justify-between p-3 bg-gray-50 rounded-md hover:bg-gray-100 transition">
                                    <div>
                                        <p className="font-medium text-gray-900">{app.candidate.name}</p>
                                        <p className="text-sm text-gray-600">{app.candidate.email} â€¢ {formatPhone(app.formData.phone)}</p>
                                    </div>
                                    <div className="mt-2 sm:mt-0 text-sm text-green-700 bg-green-100 px-3 py-1 rounded-full font-medium">
                                        Aprovado em: {app.hiredAt ? format(parseISO(app.hiredAt), 'dd/MM/yyyy') : 'N/A'}
                                    </div>
                                </li>
                            ))}
                        </ul>
                    </Card>
                ))}
            </div>
        </div>
    );
};

export default HiredPage;

==================================================
ARQUIVO: src_old\pages\JobDetails.jsx
==================================================
import React, { useState, useEffect } from 'react';
import { useParams, Link } from 'react-router-dom';
import { supabase } from '../supabase/client';
import { Button } from '../components/ui/button';
import { Badge } from '../components/ui/badge';
import { Loader2, ArrowLeft, MapPin, Briefcase, Calendar, Share2, User, Download, Plus, Trash2, Save, Copy } from 'lucide-react';

export default function JobDetails() {
  const { id } = useParams();
  const [job, setJob] = useState(null);
  const [candidates, setCandidates] = useState([]);
  const [loading, setLoading] = useState(true);
  const [activeTab, setActiveTab] = useState('details');
  const [savingParams, setSavingParams] = useState(false);
  
  // Estado inicial garantido para as 3 seÃ§Ãµes
  const [evalParams, setEvalParams] = useState({ 
      triagem: [], 
      cultura: [], 
      tecnico: [],
      notas: [
        {id: '1', nome: 'Abaixo', valor: 0}, 
        {id: '2', nome: 'Atende', valor: 50}, 
        {id: '3', nome: 'Supera', valor: 100}
      ]
  });

  useEffect(() => {
    const fetchJobDetails = async () => {
      try {
        setLoading(true);
        const { data: jobData, error: jobError } = await supabase.from('jobs').select('*').eq('id', id).single();
        if (jobError) throw jobError;
        setJob(jobData);
        
        // Carrega parÃ¢metros existentes ou mantÃ©m o padrÃ£o
        if (jobData.parameters) {
          setEvalParams(prev => ({ ...prev, ...jobData.parameters }));
        }

        const { data: appsData } = await supabase
          .from('applications')
          .select(`*, candidate:candidates(name, email, city, resume_url)`)
          .eq('jobId', id)
          .order('created_at', { ascending: false });
        
        setCandidates(appsData || []);
      } catch (error) {
        console.error('Erro:', error);
      } finally {
        setLoading(false);
      }
    };
    fetchJobDetails();
  }, [id]);

  const handleCopyLink = () => {
    navigator.clipboard.writeText(`${window.location.origin}/vagas/${id}/candidatar`);
    alert('Link copiado!');
  };

  const handleSaveParameters = async () => {
    setSavingParams(true);
    try {
        await supabase.from('jobs').update({ parameters: evalParams }).eq('id', id);
        alert('ConfiguraÃ§Ãµes salvas!');
    } catch(e) { console.error(e); }
    finally { setSavingParams(false); }
  };

  const addCriteria = (type) => {
    const text = prompt(`Novo critÃ©rio para ${type.toUpperCase()}:`);
    if(text) {
        setEvalParams(p => ({
            ...p, 
            [type]: [...(p[type] || []), {id: crypto.randomUUID(), text, weight: 1}]
        }));
    }
  };

  const removeCriteria = (type, id) => {
      setEvalParams(p => ({
          ...p, 
          [type]: p[type].filter(x => x.id !== id)
      }));
  };

  if (loading) return <div className="flex justify-center p-10"><Loader2 className="animate-spin w-8 h-8 text-blue-600"/></div>;
  if (!job) return <div className="text-center p-10">Vaga nÃ£o encontrada</div>;

  return (
    <div className="max-w-7xl mx-auto px-4 py-8">
      <div className="mb-8">
        <Link to="/jobs" className="inline-flex items-center text-gray-500 hover:text-gray-900 mb-4"><ArrowLeft className="w-4 h-4 mr-2"/> Voltar</Link>
        <div className="flex justify-between items-start">
            <div>
                <h1 className="text-3xl font-bold text-gray-900">{job.title}</h1>
                <div className="flex gap-4 mt-2 text-sm text-gray-500">
                    <span className="flex items-center"><MapPin className="w-4 h-4 mr-1"/> {job.location_type || 'Remoto'}</span>
                    <span className="flex items-center"><Briefcase className="w-4 h-4 mr-1"/> {job.type || 'CLT'}</span>
                    <span className="flex items-center"><Calendar className="w-4 h-4 mr-1"/> {new Date(job.created_at).toLocaleDateString()}</span>
                </div>
            </div>
            <Button variant="outline" onClick={handleCopyLink}>
                <Share2 className="w-4 h-4 mr-2"/> Compartilhar FormulÃ¡rio
            </Button>
        </div>
      </div>

      {/* NavegaÃ§Ã£o de Abas */}
      <div className="border-b border-gray-200 mb-6 flex gap-8">
        {['details', 'candidates', 'evaluation'].map(tab => (
            <button 
                key={tab}
                onClick={() => setActiveTab(tab)}
                className={`py-4 px-1 border-b-2 font-medium text-sm capitalize ${activeTab === tab ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'}`}
            >
                {tab === 'details' ? 'Detalhes' : tab === 'candidates' ? `Candidatos (${candidates.length})` : 'ConfiguraÃ§Ã£o da AvaliaÃ§Ã£o'}
            </button>
        ))}
      </div>

      {/* ABA: Detalhes */}
      {activeTab === 'details' && (
        <div className="bg-white p-6 rounded-lg shadow-sm border space-y-6">
            <div><h3 className="font-medium text-gray-900">DescriÃ§Ã£o</h3><p className="mt-2 text-gray-600 whitespace-pre-wrap">{job.description || 'Sem descriÃ§Ã£o.'}</p></div>
            <div><h3 className="font-medium text-gray-900">Requisitos</h3><p className="mt-2 text-gray-600 whitespace-pre-wrap">{job.requirements || 'Sem requisitos.'}</p></div>
        </div>
      )}

      {/* ABA: Candidatos */}
      {activeTab === 'candidates' && (
        <div className="space-y-4">
            {candidates.map(app => (
                <div key={app.id} className="bg-white p-4 rounded-lg border shadow-sm flex justify-between items-center">
                    <div className="flex items-center gap-4">
                        <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold">{app.candidate?.name?.[0]}</div>
                        <div>
                            <p className="font-medium text-gray-900">{app.candidate?.name}</p>
                            <p className="text-sm text-gray-500">{app.candidate?.email}</p>
                        </div>
                    </div>
                    <div className="flex gap-2">
                        {app.resumeUrl && <a href={app.resumeUrl} target="_blank" className="p-2 text-gray-500 border rounded-full hover:bg-gray-50"><Download className="w-4 h-4"/></a>}
                        <Link to={`/vaga/${id}/candidato/${app.id}`}><Button size="sm" variant="outline">Avaliar</Button></Link>
                    </div>
                </div>
            ))}
            {candidates.length === 0 && <div className="text-center py-10 text-gray-500">Nenhum candidato ainda.</div>}
        </div>
      )}

      {/* ABA: ConfiguraÃ§Ã£o da AvaliaÃ§Ã£o (CORRIGIDA) */}
      {activeTab === 'evaluation' && (
        <div className="bg-white p-6 rounded-lg border shadow-sm space-y-8">
            <div className="flex justify-between items-center border-b pb-4">
                <div>
                    <h2 className="text-lg font-semibold">CritÃ©rios de AvaliaÃ§Ã£o</h2>
                    <p className="text-sm text-gray-500">Defina o que serÃ¡ avaliado. O peso padrÃ£o Ã© 1.</p>
                </div>
                <Button onClick={handleSaveParameters} disabled={savingParams}>
                    {savingParams ? <Loader2 className="animate-spin w-4 h-4"/> : <><Save className="w-4 h-4 mr-2"/> Salvar Tudo</>}
                </Button>
            </div>

            {/* SEÃ‡ÃƒO 1: TRIAGEM */}
            <div className="p-4 bg-purple-50 rounded-md border border-purple-100">
                <div className="flex justify-between items-center mb-3">
                    <h3 className="font-semibold text-purple-800 flex items-center"><User className="w-4 h-4 mr-2"/> Triagem (Requisitos BÃ¡sicos)</h3>
                    <Button size="sm" variant="ghost" onClick={() => addCriteria('triagem')} className="text-purple-700 hover:bg-purple-100"><Plus className="w-4 h-4 mr-1"/> Adicionar</Button>
                </div>
                {(!evalParams.triagem || evalParams.triagem.length === 0) && <p className="text-sm text-purple-400 italic">Nenhum critÃ©rio de triagem definido.</p>}
                {evalParams.triagem?.map(item => (
                    <div key={item.id} className="flex justify-between items-center bg-white p-2 rounded mb-2 border shadow-sm">
                        <span className="text-sm">{item.text}</span>
                        <button onClick={() => removeCriteria('triagem', item.id)} className="text-red-400 hover:text-red-600"><Trash2 className="w-4 h-4"/></button>
                    </div>
                ))}
            </div>

            {/* SEÃ‡ÃƒO 2: FIT CULTURAL */}
            <div className="p-4 bg-green-50 rounded-md border border-green-100">
                <div className="flex justify-between items-center mb-3">
                    <h3 className="font-semibold text-green-800 flex items-center"><User className="w-4 h-4 mr-2"/> Fit Cultural (Comportamental)</h3>
                    <Button size="sm" variant="ghost" onClick={() => addCriteria('cultura')} className="text-green-700 hover:bg-green-100"><Plus className="w-4 h-4 mr-1"/> Adicionar</Button>
                </div>
                {(!evalParams.cultura || evalParams.cultura.length === 0) && <p className="text-sm text-green-400 italic">Nenhum critÃ©rio cultural definido.</p>}
                {evalParams.cultura?.map(item => (
                    <div key={item.id} className="flex justify-between items-center bg-white p-2 rounded mb-2 border shadow-sm">
                        <span className="text-sm">{item.text}</span>
                        <button onClick={() => removeCriteria('cultura', item.id)} className="text-red-400 hover:text-red-600"><Trash2 className="w-4 h-4"/></button>
                    </div>
                ))}
            </div>

            {/* SEÃ‡ÃƒO 3: TÃ‰CNICO */}
            <div className="p-4 bg-blue-50 rounded-md border border-blue-100">
                <div className="flex justify-between items-center mb-3">
                    <h3 className="font-semibold text-blue-800 flex items-center"><Briefcase className="w-4 h-4 mr-2"/> CritÃ©rios TÃ©cnicos (Hard Skills)</h3>
                    <Button size="sm" variant="ghost" onClick={() => addCriteria('tecnico')} className="text-blue-700 hover:bg-blue-100"><Plus className="w-4 h-4 mr-1"/> Adicionar</Button>
                </div>
                {(!evalParams.tecnico || evalParams.tecnico.length === 0) && <p className="text-sm text-blue-400 italic">Nenhum critÃ©rio tÃ©cnico definido.</p>}
                {evalParams.tecnico?.map(item => (
                    <div key={item.id} className="flex justify-between items-center bg-white p-2 rounded mb-2 border shadow-sm">
                        <span className="text-sm">{item.text}</span>
                        <button onClick={() => removeCriteria('tecnico', item.id)} className="text-red-400 hover:text-red-600"><Trash2 className="w-4 h-4"/></button>
                    </div>
                ))}
            </div>
        </div>
      )}
    </div>
  );
}

==================================================
ARQUIVO: src_old\pages\Jobs.jsx
==================================================
import { useState, useEffect } from 'react';
import { Link } from 'react-router-dom';
import { supabase } from '../supabase/client';
import { Plus, MapPin, Loader2, AlertCircle } from 'lucide-react';
import CreateJobModal from '../components/jobs/CreateJobModal';
import { Badge } from '../components/ui/badge';
import { Button } from '../components/ui/button';
import { formatStatus } from '../utils/formatters';

export default function Jobs() {
  const [jobs, setJobs] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [isModalOpen, setIsModalOpen] = useState(false);

  const fetchJobs = async () => {
    setLoading(true);
    try {
        const { data: { session } } = await supabase.auth.getSession();
        if (!session) return; 

        // Usa a API que acabamos de blindar
        const response = await fetch('/api/jobs', { 
            headers: { 'Authorization': `Bearer ${session.access_token}` } 
        });

        const data = await response.json();
        if (!response.ok) throw new Error(data.error);
        
        setJobs(data.jobs || []);
    } catch (err) {
        setError(err.message);
    } finally {
        setLoading(false);
    }
  };

  useEffect(() => { fetchJobs(); }, []);

  if (loading) return <div className="flex justify-center p-10"><Loader2 className="w-8 h-8 animate-spin text-blue-600"/></div>;

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div className="flex justify-between items-center mb-6">
        <h1 className="text-2xl font-bold text-gray-900">Gerenciar Vagas</h1>
        <Button onClick={() => setIsModalOpen(true)}>
          <Plus className="w-4 h-4 mr-2" /> Nova Vaga
        </Button>
      </div>

      {error && <div className="p-4 bg-red-50 text-red-700 rounded border border-red-200 mb-4">{error}</div>}

      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
        {jobs.map((job) => (
          <Link key={job.id} to={`/jobs/${job.id}`} className="block p-6 bg-white rounded-lg border hover:shadow-md transition">
            <div className="flex justify-between items-start mb-2">
                <h3 className="text-lg font-medium text-gray-900">{job.title}</h3>
                <Badge variant={job.status === 'active' ? 'success' : 'secondary'}>{formatStatus(job.status)}</Badge>
            </div>
            <div className="flex items-center text-sm text-gray-500 mb-2">
                <MapPin className="w-4 h-4 mr-1"/> {job.location_type}
            </div>
            <div className="text-xs text-gray-400 font-medium">{job.deptName}</div>
          </Link>
        ))}
      </div>

      <CreateJobModal open={isModalOpen} handleClose={() => setIsModalOpen(false)} onJobCreated={fetchJobs} />
    </div>
  );
}

==================================================
ARQUIVO: src_old\pages\Login.jsx
==================================================
import { useState } from 'react';
import { Link, useNavigate } from 'react-router-dom';
import { supabase } from '../supabase/client';
import { Button } from '../components/ui/button';
import { Input } from '../components/ui/input';
import { Label } from '../components/ui/label';
import { Loader2, LayoutDashboard } from 'lucide-react';

export default function Login() {
  const navigate = useNavigate();
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  const handleLogin = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError('');

    try {
      const { error } = await supabase.auth.signInWithPassword({
        email,
        password,
      });
      if (error) throw error;
      // AuthContext detecta a mudanÃ§a e o Router redireciona
      navigate('/dashboard');
    } catch (error) {
      setError('E-mail ou senha incorretos.');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50 px-4">
      <div className="max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-sm border">
        <div className="text-center">
          <div className="mx-auto h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 mb-4">
            <LayoutDashboard size={24} />
          </div>
          <h2 className="text-3xl font-extrabold text-gray-900">Novva R&S</h2>
          <p className="mt-2 text-sm text-gray-600">Acesse sua conta</p>
        </div>
        
        <form className="mt-8 space-y-6" onSubmit={handleLogin}>
          <div className="space-y-4">
            <div>
              <Label htmlFor="email">E-mail</Label>
              <Input
                id="email"
                type="email"
                required
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                autoComplete="email"
              />
            </div>
            <div>
              <Label htmlFor="password">Senha</Label>
              <Input
                id="password"
                type="password"
                required
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                autoComplete="current-password"
              />
            </div>
          </div>

          {error && (
            <div className="p-3 rounded-md bg-red-50 text-red-700 text-sm border border-red-200">
              {error}
            </div>
          )}

          <Button type="submit" disabled={loading} className="w-full">
            {loading ? <Loader2 className="mr-2 h-4 w-4 animate-spin" /> : 'Entrar'}
          </Button>

          <div className="text-center text-sm">
            <Link to="/register" className="font-medium text-blue-600 hover:text-blue-500">
              Criar conta gratuita
            </Link>
          </div>
        </form>
      </div>
    </div>
  );
}

==================================================
ARQUIVO: src_old\pages\Register.jsx
==================================================
import { useState } from 'react';
import { Link, useNavigate } from 'react-router-dom';
import { useAuth } from '../context/AuthContext';
import { Button } from '../components/ui/button';
import { Input } from '../components/ui/input';
import { Label } from '../components/ui/label';
import { Loader2, UserPlus } from 'lucide-react';

export default function Register() {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const { signUp } = useAuth();
  const navigate = useNavigate();
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  const handleSubmit = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError('');
    
    try {
      const { error } = await signUp({ email, password });
      if (error) throw error;
      alert('Cadastro realizado! FaÃ§a login.');
      navigate('/login');
    } catch (error) {
      setError(error.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50 px-4">
      <div className="max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-sm border">
        <div className="text-center">
          <div className="mx-auto h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center text-green-600 mb-4">
            <UserPlus size={24} />
          </div>
          <h2 className="text-3xl font-extrabold text-gray-900">Criar Conta</h2>
          <p className="mt-2 text-sm text-gray-600">Comece a usar o Novva R&S</p>
        </div>
        
        <form className="mt-8 space-y-6" onSubmit={handleSubmit}>
          <div className="space-y-4">
            <div>
              <Label htmlFor="email">E-mail</Label>
              <Input
                id="email"
                type="email"
                required
                value={email}
                onChange={(e) => setEmail(e.target.value)}
              />
            </div>
            <div>
              <Label htmlFor="password">Senha</Label>
              <Input
                id="password"
                type="password"
                required
                value={password}
                onChange={(e) => setPassword(e.target.value)}
              />
            </div>
          </div>

          {error && <div className="text-red-500 text-sm">{error}</div>}

          <Button type="submit" disabled={loading} className="w-full bg-green-600 hover:bg-green-700">
            {loading ? <Loader2 className="animate-spin mr-2 h-4 w-4"/> : 'Cadastrar'}
          </Button>

          <div className="text-center text-sm">
            <Link to="/login" className="font-medium text-blue-600 hover:text-blue-500">
              JÃ¡ tem conta? Login
            </Link>
          </div>
        </form>
      </div>
    </div>
  );
}

==================================================
ARQUIVO: src_old\services\evaluationService.js
==================================================
// src/services/evaluationService.js
import { supabase } from '../supabase/client';

// 1. Prepara o banco (Cria critÃ©rios se nÃ£o existirem)
export const prepareEvaluationV2 = async (jobId) => {
  const { data, error } = await supabase
    .rpc('initialize_job_criteria_v2', { target_job_id: jobId });
  if (error) throw error;
  return data;
};

// 2. Busca o resumo consolidado (MÃ©dias)
export const getEvaluationSummaryV2 = async (applicationId) => {
  const { data, error } = await supabase
    .rpc('get_candidate_summary_v2', { target_app_id: applicationId });
  if (error) throw error;
  return data;
};

// 3. Busca/Cria a sessÃ£o do usuÃ¡rio atual
export const getMyEvaluationSession = async (applicationId, userId) => {
  // Tenta buscar existente
  let { data: session, error } = await supabase
    .from('evaluation_assignments_v2')
    .select('id, status')
    .eq('application_id', applicationId)
    .eq('evaluator_id', userId)
    .maybeSingle();

  // Se nÃ£o existir, cria
  if (!session) {
    const { data: newSession, error: createError } = await supabase
      .from('evaluation_assignments_v2')
      .insert({ application_id: applicationId, evaluator_id: userId })
      .select()
      .single();
    
    if (createError) throw createError;
    session = newSession;
  }
  
  return session;
};

==================================================
ARQUIVO: src_old\supabase\client.js
==================================================
import { createClient } from '@supabase/supabase-js';

const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;
const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;

if (!supabaseUrl || !supabaseAnonKey) {
  throw new Error('Chaves do Supabase ausentes no .env');
}

export const supabase = createClient(supabaseUrl, supabaseAnonKey);

==================================================
ARQUIVO: src_old\utils\formatters.js
==================================================
// src/utils/formatters.js
import { format, parseISO } from 'date-fns';

// Nossa nova funÃ§Ã£o de traduÃ§Ã£o
export const formatStatus = (status) => {
  const statusMap = {
    active: 'Ativa',
    inactive: 'Inativa',
    filled: 'Preenchida',
  };
  return statusMap[status] || status;
};

// Movi as outras funÃ§Ãµes de formataÃ§Ã£o para cÃ¡ para centralizar
export const formatPhone = (phone) => {
  if (!phone) return 'NÃ£o informado';
  const cleaned = phone.replace(/\D/g, '');
  if (cleaned.length === 11) {
    return `(${cleaned.substring(0, 2)}) ${cleaned.substring(2, 7)}-${cleaned.substring(7)}`;
  }
  if (cleaned.length === 10) {
    return `(${cleaned.substring(0, 2)}) ${cleaned.substring(2, 6)}-${cleaned.substring(6)}`;
  }
  return phone;
};

export const formatUrl = (url) => {
  if (!url) return '#';
  if (url.startsWith('http://') || url.startsWith('https://')) { return url; }
  return `//${url}`;
};

export const formatDate = (dateStr) => {
    if (!dateStr) return 'NÃ£o informado';
    try {
        return format(parseISO(dateStr), 'dd/MM/yyyy');
    } catch (error) {
        console.error("Erro ao formatar data:", dateStr, error);
        return 'Data invÃ¡lida';
    }
};

